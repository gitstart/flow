"use strict";const Lc=require("child_process"),nr=require("fs"),Fl=require("https"),jn=require("querystring"),Hn=require("url"),Ml=require("net"),ql=require("tls"),Vl=require("assert"),Fc=require("events"),Mc=require("os"),qc=require("path"),Wr=require("crypto"),Nt=require("stream"),zn=require("buffer"),Pt=require("util"),Kl=require("http2"),$l=require("zlib"),Gl=require("process"),jl=(t,e)=>({slug:t,plugin:e});var Be=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Hl(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var r=function n(){if(this instanceof n){var s=[null];s.push.apply(s,arguments);var c=Function.bind.apply(e,s);return new c}return e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(n){var s=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(r,n,s.get?s:{enumerable:!0,get:function(){return t[n]}})}),r}var zi={},Un={},Qr={},Sr={},Wn={},At={},Qn={},Pn=Object.prototype.hasOwnProperty,Vc=Object.prototype.toString,Os=Object.defineProperty,Us=Object.getOwnPropertyDescriptor,ks=function(e){return typeof Array.isArray=="function"?Array.isArray(e):Vc.call(e)==="[object Array]"},Ds=function(e){if(!e||Vc.call(e)!=="[object Object]")return!1;var r=Pn.call(e,"constructor"),n=e.constructor&&e.constructor.prototype&&Pn.call(e.constructor.prototype,"isPrototypeOf");if(e.constructor&&!r&&!n)return!1;var s;for(s in e);return typeof s>"u"||Pn.call(e,s)},Ls=function(e,r){Os&&r.name==="__proto__"?Os(e,r.name,{enumerable:!0,configurable:!0,value:r.newValue,writable:!0}):e[r.name]=r.newValue},Fs=function(e,r){if(r==="__proto__")if(Pn.call(e,r)){if(Us)return Us(e,r).value}else return;return e[r]},os=function t(){var e,r,n,s,c,u,a=arguments[0],p=1,f=arguments.length,A=!1;for(typeof a=="boolean"&&(A=a,a=arguments[1]||{},p=2),(a==null||typeof a!="object"&&typeof a!="function")&&(a={});p<f;++p)if(e=arguments[p],e!=null)for(r in e)n=Fs(a,r),s=Fs(e,r),a!==s&&(A&&s&&(Ds(s)||(c=ks(s)))?(c?(c=!1,u=n&&ks(n)?n:[]):u=n&&Ds(n)?n:{},Ls(a,{name:r,newValue:t(A,u,s)})):typeof s<"u"&&Ls(a,{name:r,newValue:s}));return a},Wi={exports:{}};(function(t,e){var r=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof Be<"u")return Be;throw new Error("unable to locate global object")},n=r();t.exports=e=n.fetch,n.fetch&&(e.default=n.fetch.bind(n)),e.Headers=n.Headers,e.Request=n.Request,e.Response=n.Response})(Wi,Wi.exports);var zl=Wi.exports;const Ct=t=>t!==null&&typeof t=="object"&&typeof t.pipe=="function";Ct.writable=t=>Ct(t)&&t.writable!==!1&&typeof t._write=="function"&&typeof t._writableState=="object";Ct.readable=t=>Ct(t)&&t.readable!==!1&&typeof t._read=="function"&&typeof t._readableState=="object";Ct.duplex=t=>Ct.writable(t)&&Ct.readable(t);Ct.transform=t=>Ct.duplex(t)&&typeof t._transform=="function";var Wl=Ct,Ir={};Object.defineProperty(Ir,"__esModule",{value:!0});Ir.GaxiosError=void 0;class Ql extends Error{constructor(e,r,n){super(e),this.response=n,this.config=r,this.code=n.status.toString()}}Ir.GaxiosError=Ql;var Yn={};Object.defineProperty(Yn,"__esModule",{value:!0});Yn.getRetryConfig=void 0;async function Yl(t){var e;let r=Kc(t);if(!t||!t.config||!r&&!t.config.retry)return{shouldRetry:!1};r=r||{},r.currentRetryAttempt=r.currentRetryAttempt||0,r.retry=r.retry===void 0||r.retry===null?3:r.retry,r.httpMethodsToRetry=r.httpMethodsToRetry||["GET","HEAD","PUT","OPTIONS","DELETE"],r.noResponseRetries=r.noResponseRetries===void 0||r.noResponseRetries===null?2:r.noResponseRetries;const n=[[100,199],[429,429],[500,599]];if(r.statusCodesToRetry=r.statusCodesToRetry||n,t.config.retryConfig=r,!await(r.shouldRetry||Jl)(t))return{shouldRetry:!1,config:t.config};const u=(r.currentRetryAttempt?0:(e=r.retryDelay)!==null&&e!==void 0?e:100)+(Math.pow(2,r.currentRetryAttempt)-1)/2*1e3;t.config.retryConfig.currentRetryAttempt+=1;const a=r.retryBackoff?r.retryBackoff(t,u):new Promise(p=>{setTimeout(p,u)});return r.onRetryAttempt&&r.onRetryAttempt(t),await a,{shouldRetry:!0,config:t.config}}Yn.getRetryConfig=Yl;function Jl(t){const e=Kc(t);if(t.name==="AbortError"||!e||e.retry===0||!t.response&&(e.currentRetryAttempt||0)>=e.noResponseRetries||!t.config.method||e.httpMethodsToRetry.indexOf(t.config.method.toUpperCase())<0)return!1;if(t.response&&t.response.status){let r=!1;for(const[n,s]of e.statusCodesToRetry){const c=t.response.status;if(c>=n&&c<=s){r=!0;break}}if(!r)return!1}return e.currentRetryAttempt=e.currentRetryAttempt||0,!(e.currentRetryAttempt>=e.retry)}function Kc(t){if(t&&t.config&&t.config.retryConfig)return t.config.retryConfig}var vn={},mn={exports:{}},ba,Ms;function Xl(){if(Ms)return ba;Ms=1;var t=1e3,e=t*60,r=e*60,n=r*24,s=n*7,c=n*365.25;ba=function(A,C){C=C||{};var y=typeof A;if(y==="string"&&A.length>0)return u(A);if(y==="number"&&isFinite(A))return C.long?p(A):a(A);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(A))};function u(A){if(A=String(A),!(A.length>100)){var C=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(A);if(C){var y=parseFloat(C[1]),o=(C[2]||"ms").toLowerCase();switch(o){case"years":case"year":case"yrs":case"yr":case"y":return y*c;case"weeks":case"week":case"w":return y*s;case"days":case"day":case"d":return y*n;case"hours":case"hour":case"hrs":case"hr":case"h":return y*r;case"minutes":case"minute":case"mins":case"min":case"m":return y*e;case"seconds":case"second":case"secs":case"sec":case"s":return y*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return y;default:return}}}}function a(A){var C=Math.abs(A);return C>=n?Math.round(A/n)+"d":C>=r?Math.round(A/r)+"h":C>=e?Math.round(A/e)+"m":C>=t?Math.round(A/t)+"s":A+"ms"}function p(A){var C=Math.abs(A);return C>=n?f(A,C,n,"day"):C>=r?f(A,C,r,"hour"):C>=e?f(A,C,e,"minute"):C>=t?f(A,C,t,"second"):A+" ms"}function f(A,C,y,o){var m=C>=y*1.5;return Math.round(A/y)+" "+o+(m?"s":"")}return ba}var Ba,qs;function Zl(){if(qs)return Ba;qs=1;function t(e){n.debug=n,n.default=n,n.coerce=f,n.disable=u,n.enable=c,n.enabled=a,n.humanize=Xl(),n.destroy=A,Object.keys(e).forEach(C=>{n[C]=e[C]}),n.names=[],n.skips=[],n.formatters={};function r(C){let y=0;for(let o=0;o<C.length;o++)y=(y<<5)-y+C.charCodeAt(o),y|=0;return n.colors[Math.abs(y)%n.colors.length]}n.selectColor=r;function n(C){let y,o=null,m,g;function S(...i){if(!S.enabled)return;const v=S,E=Number(new Date),I=E-(y||E);v.diff=I,v.prev=y,v.curr=E,y=E,i[0]=n.coerce(i[0]),typeof i[0]!="string"&&i.unshift("%O");let B=0;i[0]=i[0].replace(/%([a-zA-Z%])/g,(h,l)=>{if(h==="%%")return"%";B++;const R=n.formatters[l];if(typeof R=="function"){const N=i[B];h=R.call(v,N),i.splice(B,1),B--}return h}),n.formatArgs.call(v,i),(v.log||n.log).apply(v,i)}return S.namespace=C,S.useColors=n.useColors(),S.color=n.selectColor(C),S.extend=s,S.destroy=n.destroy,Object.defineProperty(S,"enabled",{enumerable:!0,configurable:!1,get:()=>o!==null?o:(m!==n.namespaces&&(m=n.namespaces,g=n.enabled(C)),g),set:i=>{o=i}}),typeof n.init=="function"&&n.init(S),S}function s(C,y){const o=n(this.namespace+(typeof y>"u"?":":y)+C);return o.log=this.log,o}function c(C){n.save(C),n.namespaces=C,n.names=[],n.skips=[];let y;const o=(typeof C=="string"?C:"").split(/[\s,]+/),m=o.length;for(y=0;y<m;y++)o[y]&&(C=o[y].replace(/\*/g,".*?"),C[0]==="-"?n.skips.push(new RegExp("^"+C.slice(1)+"$")):n.names.push(new RegExp("^"+C+"$")))}function u(){const C=[...n.names.map(p),...n.skips.map(p).map(y=>"-"+y)].join(",");return n.enable(""),C}function a(C){if(C[C.length-1]==="*")return!0;let y,o;for(y=0,o=n.skips.length;y<o;y++)if(n.skips[y].test(C))return!1;for(y=0,o=n.names.length;y<o;y++)if(n.names[y].test(C))return!0;return!1}function p(C){return C.toString().substring(2,C.toString().length-2).replace(/\.\*\?$/,"*")}function f(C){return C instanceof Error?C.stack||C.message:C}function A(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return n.enable(n.load()),n}return Ba=t,Ba}var Vs;function cs(){return Vs||(Vs=1,function(t,e){e.formatArgs=n,e.save=s,e.load=c,e.useColors=r,e.storage=u(),e.destroy=(()=>{let p=!1;return()=>{p||(p=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function r(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function n(p){if(p[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+p[0]+(this.useColors?"%c ":" ")+"+"+t.exports.humanize(this.diff),!this.useColors)return;const f="color: "+this.color;p.splice(1,0,f,"color: inherit");let A=0,C=0;p[0].replace(/%[a-zA-Z%]/g,y=>{y!=="%%"&&(A++,y==="%c"&&(C=A))}),p.splice(C,0,f)}e.log=console.debug||console.log||(()=>{});function s(p){try{p?e.storage.setItem("debug",p):e.storage.removeItem("debug")}catch{}}function c(){let p;try{p=e.storage.getItem("debug")}catch{}return!p&&typeof process<"u"&&"env"in process&&(p=process.env.DEBUG),p}function u(){try{return localStorage}catch{}}t.exports=Zl()(e);const{formatters:a}=t.exports;a.j=function(p){try{return JSON.stringify(p)}catch(f){return"[UnexpectedJSONParseError]: "+f.message}}}(mn,mn.exports)),mn.exports}var En={},Ks;function ef(){if(Ks)return En;Ks=1,Object.defineProperty(En,"__esModule",{value:!0});function t(e){return function(r,n){return new Promise((s,c)=>{e.call(this,r,n,(u,a)=>{u?c(u):s(a)})})}}return En.default=t,En}var Ra,$s;function tf(){if($s)return Ra;$s=1;var t=Be&&Be.__importDefault||function(p){return p&&p.__esModule?p:{default:p}};const e=Fc,r=t(cs()),n=t(ef()),s=r.default("agent-base");function c(p){return!!p&&typeof p.addRequest=="function"}function u(){const{stack:p}=new Error;return typeof p!="string"?!1:p.split(`
`).some(f=>f.indexOf("(https.js:")!==-1||f.indexOf("node:https:")!==-1)}function a(p,f){return new a.Agent(p,f)}return function(p){class f extends e.EventEmitter{constructor(C,y){super();let o=y;typeof C=="function"?this.callback=C:C&&(o=C),this.timeout=null,o&&typeof o.timeout=="number"&&(this.timeout=o.timeout),this.maxFreeSockets=1,this.maxSockets=1,this.maxTotalSockets=1/0,this.sockets={},this.freeSockets={},this.requests={},this.options={}}get defaultPort(){return typeof this.explicitDefaultPort=="number"?this.explicitDefaultPort:u()?443:80}set defaultPort(C){this.explicitDefaultPort=C}get protocol(){return typeof this.explicitProtocol=="string"?this.explicitProtocol:u()?"https:":"http:"}set protocol(C){this.explicitProtocol=C}callback(C,y,o){throw new Error('"agent-base" has no default implementation, you must subclass and override `callback()`')}addRequest(C,y){const o=Object.assign({},y);typeof o.secureEndpoint!="boolean"&&(o.secureEndpoint=u()),o.host==null&&(o.host="localhost"),o.port==null&&(o.port=o.secureEndpoint?443:80),o.protocol==null&&(o.protocol=o.secureEndpoint?"https:":"http:"),o.host&&o.path&&delete o.path,delete o.agent,delete o.hostname,delete o._defaultAgent,delete o.defaultPort,delete o.createConnection,C._last=!0,C.shouldKeepAlive=!1;let m=!1,g=null;const S=o.timeout||this.timeout,i=B=>{C._hadError||(C.emit("error",B),C._hadError=!0)},v=()=>{g=null,m=!0;const B=new Error(`A "socket" was not created for HTTP request before ${S}ms`);B.code="ETIMEOUT",i(B)},E=B=>{m||(g!==null&&(clearTimeout(g),g=null),i(B))},I=B=>{if(m)return;if(g!=null&&(clearTimeout(g),g=null),c(B)){s("Callback returned another Agent instance %o",B.constructor.name),B.addRequest(C,o);return}if(B){B.once("free",()=>{this.freeSocket(B,o)}),C.onSocket(B);return}const T=new Error(`no Duplex stream was returned to agent-base for \`${C.method} ${C.path}\``);i(T)};if(typeof this.callback!="function"){i(new Error("`callback` is not defined"));return}this.promisifiedCallback||(this.callback.length>=3?(s("Converting legacy callback function to promise"),this.promisifiedCallback=n.default(this.callback)):this.promisifiedCallback=this.callback),typeof S=="number"&&S>0&&(g=setTimeout(v,S)),"port"in o&&typeof o.port!="number"&&(o.port=Number(o.port));try{s("Resolving socket for %o request: %o",o.protocol,`${C.method} ${C.path}`),Promise.resolve(this.promisifiedCallback(C,o)).then(I,E)}catch(B){Promise.reject(B).catch(E)}}freeSocket(C,y){s("Freeing socket %o %o",C.constructor.name,y),C.destroy()}destroy(){s("Destroying agent %o",this.constructor.name)}}p.Agent=f,p.prototype=p.Agent.prototype}(a||(a={})),Ra=a,Ra}var Cn={},Gs;function rf(){if(Gs)return Cn;Gs=1;var t=Be&&Be.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(Cn,"__esModule",{value:!0});const r=t(cs()).default("https-proxy-agent:parse-proxy-response");function n(s){return new Promise((c,u)=>{let a=0;const p=[];function f(){const g=s.read();g?m(g):s.once("readable",f)}function A(){s.removeListener("end",y),s.removeListener("error",o),s.removeListener("close",C),s.removeListener("readable",f)}function C(g){r("onclose had error %o",g)}function y(){r("onend")}function o(g){A(),r("onerror %o",g),u(g)}function m(g){p.push(g),a+=g.length;const S=Buffer.concat(p,a);if(S.indexOf(`\r
\r
`)===-1){r("have not received end of HTTP headers yet..."),f();return}const v=S.toString("ascii",0,S.indexOf(`\r
`)),E=+v.split(" ")[1];r("got proxy server response: %o",v),c({statusCode:E,buffered:S})}s.on("error",o),s.on("close",C),s.on("end",y),f()})}return Cn.default=n,Cn}var js;function nf(){if(js)return vn;js=1;var t=Be&&Be.__awaiter||function(g,S,i,v){function E(I){return I instanceof i?I:new i(function(B){B(I)})}return new(i||(i=Promise))(function(I,B){function T(R){try{l(v.next(R))}catch(N){B(N)}}function h(R){try{l(v.throw(R))}catch(N){B(N)}}function l(R){R.done?I(R.value):E(R.value).then(T,h)}l((v=v.apply(g,S||[])).next())})},e=Be&&Be.__importDefault||function(g){return g&&g.__esModule?g:{default:g}};Object.defineProperty(vn,"__esModule",{value:!0});const r=e(Ml),n=e(ql),s=e(Hn),c=e(Vl),u=e(cs()),a=tf(),p=e(rf()),f=u.default("https-proxy-agent:agent");class A extends a.Agent{constructor(S){let i;if(typeof S=="string"?i=s.default.parse(S):i=S,!i)throw new Error("an HTTP(S) proxy server `host` and `port` must be specified!");f("creating new HttpsProxyAgent instance: %o",i),super(i);const v=Object.assign({},i);this.secureProxy=i.secureProxy||o(v.protocol),v.host=v.hostname||v.host,typeof v.port=="string"&&(v.port=parseInt(v.port,10)),!v.port&&v.host&&(v.port=this.secureProxy?443:80),this.secureProxy&&!("ALPNProtocols"in v)&&(v.ALPNProtocols=["http 1.1"]),v.host&&v.path&&(delete v.path,delete v.pathname),this.proxy=v}callback(S,i){return t(this,void 0,void 0,function*(){const{proxy:v,secureProxy:E}=this;let I;E?(f("Creating `tls.Socket`: %o",v),I=n.default.connect(v)):(f("Creating `net.Socket`: %o",v),I=r.default.connect(v));const B=Object.assign({},v.headers);let h=`CONNECT ${`${i.host}:${i.port}`} HTTP/1.1\r
`;v.auth&&(B["Proxy-Authorization"]=`Basic ${Buffer.from(v.auth).toString("base64")}`);let{host:l,port:R,secureEndpoint:N}=i;y(R,N)||(l+=`:${R}`),B.Host=l,B.Connection="close";for(const H of Object.keys(B))h+=`${H}: ${B[H]}\r
`;const F=p.default(I);I.write(`${h}\r
`);const{statusCode:D,buffered:q}=yield F;if(D===200){if(S.once("socket",C),i.secureEndpoint){f("Upgrading socket connection to TLS");const H=i.servername||i.host;return n.default.connect(Object.assign(Object.assign({},m(i,"host","hostname","path","port")),{socket:I,servername:H}))}return I}I.destroy();const j=new r.default.Socket({writable:!1});return j.readable=!0,S.once("socket",H=>{f("replaying proxy buffer for failed request"),c.default(H.listenerCount("data")>0),H.push(q),H.push(null)}),j})}}vn.default=A;function C(g){g.resume()}function y(g,S){return!!(!S&&g===80||S&&g===443)}function o(g){return typeof g=="string"?/^https:?$/i.test(g):!1}function m(g,...S){const i={};let v;for(v in g)S.includes(v)||(i[v]=g[v]);return i}return vn}var Na,Hs;function af(){if(Hs)return Na;Hs=1;var t=Be&&Be.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};const e=t(nf());function r(n){return new e.default(n)}return function(n){n.HttpsProxyAgent=e.default,n.prototype=e.default.prototype}(r||(r={})),Na=r,Na}var Jn=Be&&Be.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Qn,"__esModule",{value:!0});Qn.Gaxios=void 0;const sf=Jn(os),of=Fl,cf=Jn(zl),uf=Jn(jn),lf=Jn(Wl),$c=Hn,ff=Ir,df=Yn,hf=yf()?window.fetch:cf.default;function pf(){return typeof window<"u"&&!!window}function yf(){return pf()&&!!window.fetch}function gf(){return typeof Buffer<"u"}function zs(t,e){return!!Gc(t,e)}function Gc(t,e){e=e.toLowerCase();for(const r of Object.keys((t==null?void 0:t.headers)||{}))if(e===r.toLowerCase())return t.headers[r]}let Qi;function jc(){var t,e,r,n;const s=((t=process==null?void 0:process.env)===null||t===void 0?void 0:t.HTTPS_PROXY)||((e=process==null?void 0:process.env)===null||e===void 0?void 0:e.https_proxy)||((r=process==null?void 0:process.env)===null||r===void 0?void 0:r.HTTP_PROXY)||((n=process==null?void 0:process.env)===null||n===void 0?void 0:n.http_proxy);return s&&(Qi=af()),s}jc();function vf(t){var e;const r=(e=process.env.NO_PROXY)!==null&&e!==void 0?e:process.env.no_proxy;if(!r)return!1;const n=r.split(","),s=new $c.URL(t);return!!n.find(c=>c.startsWith("*.")||c.startsWith(".")?(c=c.replace(/^\*\./,"."),s.hostname.endsWith(c)):c===s.origin||c===s.hostname)}function mf(t){if(!vf(t))return jc()}class Ef{constructor(e){this.agentCache=new Map,this.defaults=e||{}}async request(e={}){return e=this.validateOpts(e),this._request(e)}async _defaultAdapter(e){const n=await(e.fetchImplementation||hf)(e.url,e),s=await this.getResponseData(e,n);return this.translateResponse(e,n,s)}async _request(e={}){try{let r;if(e.adapter?r=await e.adapter(e,this._defaultAdapter.bind(this)):r=await this._defaultAdapter(e),!e.validateStatus(r.status))throw new ff.GaxiosError(`Request failed with status code ${r.status}`,e,r);return r}catch(r){const n=r;n.config=e;const{shouldRetry:s,config:c}=await(0,df.getRetryConfig)(n);if(s&&c)return n.config.retryConfig.currentRetryAttempt=c.retryConfig.currentRetryAttempt,this._request(n.config);throw n}}async getResponseData(e,r){switch(e.responseType){case"stream":return r.body;case"json":{let n=await r.text();try{n=JSON.parse(n)}catch{}return n}case"arraybuffer":return r.arrayBuffer();case"blob":return r.blob();default:return r.text()}}validateOpts(e){const r=(0,sf.default)(!0,{},this.defaults,e);if(!r.url)throw new Error("URL is required.");const n=r.baseUrl||r.baseURL;if(n&&(r.url=n+r.url),r.paramsSerializer=r.paramsSerializer||this.paramsSerializer,r.params&&Object.keys(r.params).length>0){let c=r.paramsSerializer(r.params);c.startsWith("?")&&(c=c.slice(1));const u=r.url.includes("?")?"&":"?";r.url=r.url+u+c}if(typeof e.maxContentLength=="number"&&(r.size=e.maxContentLength),typeof e.maxRedirects=="number"&&(r.follow=e.maxRedirects),r.headers=r.headers||{},r.data){const c=typeof FormData>"u"?!1:(r==null?void 0:r.data)instanceof FormData;lf.default.readable(r.data)?r.body=r.data:gf()&&Buffer.isBuffer(r.data)?(r.body=r.data,zs(r,"Content-Type")||(r.headers["Content-Type"]="application/json")):typeof r.data=="object"?c||(Gc(r,"content-type")==="application/x-www-form-urlencoded"?r.body=r.paramsSerializer(r.data):(zs(r,"Content-Type")||(r.headers["Content-Type"]="application/json"),r.body=JSON.stringify(r.data))):r.body=r.data}r.validateStatus=r.validateStatus||this.validateStatus,r.responseType=r.responseType||"json",!r.headers.Accept&&r.responseType==="json"&&(r.headers.Accept="application/json"),r.method=r.method||"GET";const s=mf(r.url);if(s)if(this.agentCache.has(s))r.agent=this.agentCache.get(s);else{if(r.cert&&r.key){const c=new $c.URL(s);r.agent=new Qi({port:c.port,host:c.host,protocol:c.protocol,cert:r.cert,key:r.key})}else r.agent=new Qi(s);this.agentCache.set(s,r.agent)}else r.cert&&r.key&&(this.agentCache.has(r.key)?r.agent=this.agentCache.get(r.key):(r.agent=new of.Agent({cert:r.cert,key:r.key}),this.agentCache.set(r.key,r.agent)));return r}validateStatus(e){return e>=200&&e<300}paramsSerializer(e){return uf.default.stringify(e)}translateResponse(e,r,n){const s={};return r.headers.forEach((c,u)=>{s[u]=c}),{config:e,data:n,headers:s,status:r.status,statusText:r.statusText,request:{responseURL:r.url}}}}Qn.Gaxios=Ef;(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.request=t.instance=t.Gaxios=t.GaxiosError=void 0;const e=Qn;Object.defineProperty(t,"Gaxios",{enumerable:!0,get:function(){return e.Gaxios}});var r=Ir;Object.defineProperty(t,"GaxiosError",{enumerable:!0,get:function(){return r.GaxiosError}}),t.instance=new e.Gaxios;async function n(s){return t.instance.request(s)}t.request=n})(At);var Xn={exports:{}},Hc={exports:{}},zc={exports:{}};(function(t){(function(e){var r,n=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,s=Math.ceil,c=Math.floor,u="[BigNumber Error] ",a=u+"Number primitive has more than 15 significant digits: ",p=1e14,f=14,A=9007199254740991,C=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],y=1e7,o=1e9;function m(T){var h,l,R,N=W.prototype={constructor:W,toString:null,valueOf:null},F=new W(1),D=20,q=4,j=-7,H=21,Q=-1e7,J=1e7,X=!1,re=1,se=0,de={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},ye="0123456789abcdefghijklmnopqrstuvwxyz",_e=!0;function W(x,w){var d,b,U,P,K,V,$,M,G=this;if(!(G instanceof W))return new W(x,w);if(w==null){if(x&&x._isBigNumber===!0){G.s=x.s,!x.c||x.e>J?G.c=G.e=null:x.e<Q?G.c=[G.e=0]:(G.e=x.e,G.c=x.c.slice());return}if((V=typeof x=="number")&&x*0==0){if(G.s=1/x<0?(x=-x,-1):1,x===~~x){for(P=0,K=x;K>=10;K/=10,P++);P>J?G.c=G.e=null:(G.e=P,G.c=[x]);return}M=String(x)}else{if(!n.test(M=String(x)))return R(G,M,V);G.s=M.charCodeAt(0)==45?(M=M.slice(1),-1):1}(P=M.indexOf("."))>-1&&(M=M.replace(".","")),(K=M.search(/e/i))>0?(P<0&&(P=K),P+=+M.slice(K+1),M=M.substring(0,K)):P<0&&(P=M.length)}else{if(v(w,2,ye.length,"Base"),w==10&&_e)return G=new W(x),fe(G,D+G.e+1,q);if(M=String(x),V=typeof x=="number"){if(x*0!=0)return R(G,M,V,w);if(G.s=1/x<0?(M=M.slice(1),-1):1,W.DEBUG&&M.replace(/^0\.0*|\./,"").length>15)throw Error(a+x)}else G.s=M.charCodeAt(0)===45?(M=M.slice(1),-1):1;for(d=ye.slice(0,w),P=K=0,$=M.length;K<$;K++)if(d.indexOf(b=M.charAt(K))<0){if(b=="."){if(K>P){P=$;continue}}else if(!U&&(M==M.toUpperCase()&&(M=M.toLowerCase())||M==M.toLowerCase()&&(M=M.toUpperCase()))){U=!0,K=-1,P=0;continue}return R(G,String(x),V,w)}V=!1,M=l(M,w,10,G.s),(P=M.indexOf("."))>-1?M=M.replace(".",""):P=M.length}for(K=0;M.charCodeAt(K)===48;K++);for($=M.length;M.charCodeAt(--$)===48;);if(M=M.slice(K,++$)){if($-=K,V&&W.DEBUG&&$>15&&(x>A||x!==c(x)))throw Error(a+G.s*x);if((P=P-K-1)>J)G.c=G.e=null;else if(P<Q)G.c=[G.e=0];else{if(G.e=P,G.c=[],K=(P+1)%f,P<0&&(K+=f),K<$){for(K&&G.c.push(+M.slice(0,K)),$-=f;K<$;)G.c.push(+M.slice(K,K+=f));K=f-(M=M.slice(K)).length}else K-=$;for(;K--;M+="0");G.c.push(+M)}}else G.c=[G.e=0]}W.clone=m,W.ROUND_UP=0,W.ROUND_DOWN=1,W.ROUND_CEIL=2,W.ROUND_FLOOR=3,W.ROUND_HALF_UP=4,W.ROUND_HALF_DOWN=5,W.ROUND_HALF_EVEN=6,W.ROUND_HALF_CEIL=7,W.ROUND_HALF_FLOOR=8,W.EUCLID=9,W.config=W.set=function(x){var w,d;if(x!=null)if(typeof x=="object"){if(x.hasOwnProperty(w="DECIMAL_PLACES")&&(d=x[w],v(d,0,o,w),D=d),x.hasOwnProperty(w="ROUNDING_MODE")&&(d=x[w],v(d,0,8,w),q=d),x.hasOwnProperty(w="EXPONENTIAL_AT")&&(d=x[w],d&&d.pop?(v(d[0],-o,0,w),v(d[1],0,o,w),j=d[0],H=d[1]):(v(d,-o,o,w),j=-(H=d<0?-d:d))),x.hasOwnProperty(w="RANGE"))if(d=x[w],d&&d.pop)v(d[0],-o,-1,w),v(d[1],1,o,w),Q=d[0],J=d[1];else if(v(d,-o,o,w),d)Q=-(J=d<0?-d:d);else throw Error(u+w+" cannot be zero: "+d);if(x.hasOwnProperty(w="CRYPTO"))if(d=x[w],d===!!d)if(d)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))X=d;else throw X=!d,Error(u+"crypto unavailable");else X=d;else throw Error(u+w+" not true or false: "+d);if(x.hasOwnProperty(w="MODULO_MODE")&&(d=x[w],v(d,0,9,w),re=d),x.hasOwnProperty(w="POW_PRECISION")&&(d=x[w],v(d,0,o,w),se=d),x.hasOwnProperty(w="FORMAT"))if(d=x[w],typeof d=="object")de=d;else throw Error(u+w+" not an object: "+d);if(x.hasOwnProperty(w="ALPHABET"))if(d=x[w],typeof d=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(d))_e=d.slice(0,10)=="0123456789",ye=d;else throw Error(u+w+" invalid: "+d)}else throw Error(u+"Object expected: "+x);return{DECIMAL_PLACES:D,ROUNDING_MODE:q,EXPONENTIAL_AT:[j,H],RANGE:[Q,J],CRYPTO:X,MODULO_MODE:re,POW_PRECISION:se,FORMAT:de,ALPHABET:ye}},W.isBigNumber=function(x){if(!x||x._isBigNumber!==!0)return!1;if(!W.DEBUG)return!0;var w,d,b=x.c,U=x.e,P=x.s;e:if({}.toString.call(b)=="[object Array]"){if((P===1||P===-1)&&U>=-o&&U<=o&&U===c(U)){if(b[0]===0){if(U===0&&b.length===1)return!0;break e}if(w=(U+1)%f,w<1&&(w+=f),String(b[0]).length==w){for(w=0;w<b.length;w++)if(d=b[w],d<0||d>=p||d!==c(d))break e;if(d!==0)return!0}}}else if(b===null&&U===null&&(P===null||P===1||P===-1))return!0;throw Error(u+"Invalid BigNumber: "+x)},W.maximum=W.max=function(){return ae(arguments,N.lt)},W.minimum=W.min=function(){return ae(arguments,N.gt)},W.random=function(){var x=9007199254740992,w=Math.random()*x&2097151?function(){return c(Math.random()*x)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(d){var b,U,P,K,V,$=0,M=[],G=new W(F);if(d==null?d=D:v(d,0,o),K=s(d/f),X)if(crypto.getRandomValues){for(b=crypto.getRandomValues(new Uint32Array(K*=2));$<K;)V=b[$]*131072+(b[$+1]>>>11),V>=9e15?(U=crypto.getRandomValues(new Uint32Array(2)),b[$]=U[0],b[$+1]=U[1]):(M.push(V%1e14),$+=2);$=K/2}else if(crypto.randomBytes){for(b=crypto.randomBytes(K*=7);$<K;)V=(b[$]&31)*281474976710656+b[$+1]*1099511627776+b[$+2]*4294967296+b[$+3]*16777216+(b[$+4]<<16)+(b[$+5]<<8)+b[$+6],V>=9e15?crypto.randomBytes(7).copy(b,$):(M.push(V%1e14),$+=7);$=K/7}else throw X=!1,Error(u+"crypto unavailable");if(!X)for(;$<K;)V=w(),V<9e15&&(M[$++]=V%1e14);for(K=M[--$],d%=f,K&&d&&(V=C[f-d],M[$]=c(K/V)*V);M[$]===0;M.pop(),$--);if($<0)M=[P=0];else{for(P=-1;M[0]===0;M.splice(0,1),P-=f);for($=1,V=M[0];V>=10;V/=10,$++);$<f&&(P-=f-$)}return G.e=P,G.c=M,G}}(),W.sum=function(){for(var x=1,w=arguments,d=new W(w[0]);x<w.length;)d=d.plus(w[x++]);return d},l=function(){var x="0123456789";function w(d,b,U,P){for(var K,V=[0],$,M=0,G=d.length;M<G;){for($=V.length;$--;V[$]*=b);for(V[0]+=P.indexOf(d.charAt(M++)),K=0;K<V.length;K++)V[K]>U-1&&(V[K+1]==null&&(V[K+1]=0),V[K+1]+=V[K]/U|0,V[K]%=U)}return V.reverse()}return function(d,b,U,P,K){var V,$,M,G,Y,ne,te,ue,pe=d.indexOf("."),ge=D,ce=q;for(pe>=0&&(G=se,se=0,d=d.replace(".",""),ue=new W(b),ne=ue.pow(d.length-pe),se=G,ue.c=w(B(S(ne.c),ne.e,"0"),10,U,x),ue.e=ue.c.length),te=w(d,b,U,K?(V=ye,x):(V=x,ye)),M=G=te.length;te[--G]==0;te.pop());if(!te[0])return V.charAt(0);if(pe<0?--M:(ne.c=te,ne.e=M,ne.s=P,ne=h(ne,ue,ge,ce,U),te=ne.c,Y=ne.r,M=ne.e),$=M+ge+1,pe=te[$],G=U/2,Y=Y||$<0||te[$+1]!=null,Y=ce<4?(pe!=null||Y)&&(ce==0||ce==(ne.s<0?3:2)):pe>G||pe==G&&(ce==4||Y||ce==6&&te[$-1]&1||ce==(ne.s<0?8:7)),$<1||!te[0])d=Y?B(V.charAt(1),-ge,V.charAt(0)):V.charAt(0);else{if(te.length=$,Y)for(--U;++te[--$]>U;)te[$]=0,$||(++M,te=[1].concat(te));for(G=te.length;!te[--G];);for(pe=0,d="";pe<=G;d+=V.charAt(te[pe++]));d=B(d,M,V.charAt(0))}return d}}(),h=function(){function x(b,U,P){var K,V,$,M,G=0,Y=b.length,ne=U%y,te=U/y|0;for(b=b.slice();Y--;)$=b[Y]%y,M=b[Y]/y|0,K=te*$+M*ne,V=ne*$+K%y*y+G,G=(V/P|0)+(K/y|0)+te*M,b[Y]=V%P;return G&&(b=[G].concat(b)),b}function w(b,U,P,K){var V,$;if(P!=K)$=P>K?1:-1;else for(V=$=0;V<P;V++)if(b[V]!=U[V]){$=b[V]>U[V]?1:-1;break}return $}function d(b,U,P,K){for(var V=0;P--;)b[P]-=V,V=b[P]<U[P]?1:0,b[P]=V*K+b[P]-U[P];for(;!b[0]&&b.length>1;b.splice(0,1));}return function(b,U,P,K,V){var $,M,G,Y,ne,te,ue,pe,ge,ce,le,ve,be,Ne,Pe,we,Oe,Ie=b.s==U.s?1:-1,Te=b.c,Ee=U.c;if(!Te||!Te[0]||!Ee||!Ee[0])return new W(!b.s||!U.s||(Te?Ee&&Te[0]==Ee[0]:!Ee)?NaN:Te&&Te[0]==0||!Ee?Ie*0:Ie/0);for(pe=new W(Ie),ge=pe.c=[],M=b.e-U.e,Ie=P+M+1,V||(V=p,M=g(b.e/f)-g(U.e/f),Ie=Ie/f|0),G=0;Ee[G]==(Te[G]||0);G++);if(Ee[G]>(Te[G]||0)&&M--,Ie<0)ge.push(1),Y=!0;else{for(Ne=Te.length,we=Ee.length,G=0,Ie+=2,ne=c(V/(Ee[0]+1)),ne>1&&(Ee=x(Ee,ne,V),Te=x(Te,ne,V),we=Ee.length,Ne=Te.length),be=we,ce=Te.slice(0,we),le=ce.length;le<we;ce[le++]=0);Oe=Ee.slice(),Oe=[0].concat(Oe),Pe=Ee[0],Ee[1]>=V/2&&Pe++;do{if(ne=0,$=w(Ee,ce,we,le),$<0){if(ve=ce[0],we!=le&&(ve=ve*V+(ce[1]||0)),ne=c(ve/Pe),ne>1)for(ne>=V&&(ne=V-1),te=x(Ee,ne,V),ue=te.length,le=ce.length;w(te,ce,ue,le)==1;)ne--,d(te,we<ue?Oe:Ee,ue,V),ue=te.length,$=1;else ne==0&&($=ne=1),te=Ee.slice(),ue=te.length;if(ue<le&&(te=[0].concat(te)),d(ce,te,le,V),le=ce.length,$==-1)for(;w(Ee,ce,we,le)<1;)ne++,d(ce,we<le?Oe:Ee,le,V),le=ce.length}else $===0&&(ne++,ce=[0]);ge[G++]=ne,ce[0]?ce[le++]=Te[be]||0:(ce=[Te[be]],le=1)}while((be++<Ne||ce[0]!=null)&&Ie--);Y=ce[0]!=null,ge[0]||ge.splice(0,1)}if(V==p){for(G=1,Ie=ge[0];Ie>=10;Ie/=10,G++);fe(pe,P+(pe.e=G+M*f-1)+1,K,Y)}else pe.e=M,pe.r=+Y;return pe}}();function he(x,w,d,b){var U,P,K,V,$;if(d==null?d=q:v(d,0,8),!x.c)return x.toString();if(U=x.c[0],K=x.e,w==null)$=S(x.c),$=b==1||b==2&&(K<=j||K>=H)?I($,K):B($,K,"0");else if(x=fe(new W(x),w,d),P=x.e,$=S(x.c),V=$.length,b==1||b==2&&(w<=P||P<=j)){for(;V<w;$+="0",V++);$=I($,P)}else if(w-=K,$=B($,P,"0"),P+1>V){if(--w>0)for($+=".";w--;$+="0");}else if(w+=P-V,w>0)for(P+1==V&&($+=".");w--;$+="0");return x.s<0&&U?"-"+$:$}function ae(x,w){for(var d,b=1,U=new W(x[0]);b<x.length;b++)if(d=new W(x[b]),d.s)w.call(U,d)&&(U=d);else{U=d;break}return U}function ke(x,w,d){for(var b=1,U=w.length;!w[--U];w.pop());for(U=w[0];U>=10;U/=10,b++);return(d=b+d*f-1)>J?x.c=x.e=null:d<Q?x.c=[x.e=0]:(x.e=d,x.c=w),x}R=function(){var x=/^(-?)0([xbo])(?=\w[\w.]*$)/i,w=/^([^.]+)\.$/,d=/^\.([^.]+)$/,b=/^-?(Infinity|NaN)$/,U=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(P,K,V,$){var M,G=V?K:K.replace(U,"");if(b.test(G))P.s=isNaN(G)?null:G<0?-1:1;else{if(!V&&(G=G.replace(x,function(Y,ne,te){return M=(te=te.toLowerCase())=="x"?16:te=="b"?2:8,!$||$==M?ne:Y}),$&&(M=$,G=G.replace(w,"$1").replace(d,"0.$1")),K!=G))return new W(G,M);if(W.DEBUG)throw Error(u+"Not a"+($?" base "+$:"")+" number: "+K);P.s=null}P.c=P.e=null}}();function fe(x,w,d,b){var U,P,K,V,$,M,G,Y=x.c,ne=C;if(Y){e:{for(U=1,V=Y[0];V>=10;V/=10,U++);if(P=w-U,P<0)P+=f,K=w,$=Y[M=0],G=$/ne[U-K-1]%10|0;else if(M=s((P+1)/f),M>=Y.length)if(b){for(;Y.length<=M;Y.push(0));$=G=0,U=1,P%=f,K=P-f+1}else break e;else{for($=V=Y[M],U=1;V>=10;V/=10,U++);P%=f,K=P-f+U,G=K<0?0:$/ne[U-K-1]%10|0}if(b=b||w<0||Y[M+1]!=null||(K<0?$:$%ne[U-K-1]),b=d<4?(G||b)&&(d==0||d==(x.s<0?3:2)):G>5||G==5&&(d==4||b||d==6&&(P>0?K>0?$/ne[U-K]:0:Y[M-1])%10&1||d==(x.s<0?8:7)),w<1||!Y[0])return Y.length=0,b?(w-=x.e+1,Y[0]=ne[(f-w%f)%f],x.e=-w||0):Y[0]=x.e=0,x;if(P==0?(Y.length=M,V=1,M--):(Y.length=M+1,V=ne[f-P],Y[M]=K>0?c($/ne[U-K]%ne[K])*V:0),b)for(;;)if(M==0){for(P=1,K=Y[0];K>=10;K/=10,P++);for(K=Y[0]+=V,V=1;K>=10;K/=10,V++);P!=V&&(x.e++,Y[0]==p&&(Y[0]=1));break}else{if(Y[M]+=V,Y[M]!=p)break;Y[M--]=0,V=1}for(P=Y.length;Y[--P]===0;Y.pop());}x.e>J?x.c=x.e=null:x.e<Q&&(x.c=[x.e=0])}return x}function _(x){var w,d=x.e;return d===null?x.toString():(w=S(x.c),w=d<=j||d>=H?I(w,d):B(w,d,"0"),x.s<0?"-"+w:w)}return N.absoluteValue=N.abs=function(){var x=new W(this);return x.s<0&&(x.s=1),x},N.comparedTo=function(x,w){return i(this,new W(x,w))},N.decimalPlaces=N.dp=function(x,w){var d,b,U,P=this;if(x!=null)return v(x,0,o),w==null?w=q:v(w,0,8),fe(new W(P),x+P.e+1,w);if(!(d=P.c))return null;if(b=((U=d.length-1)-g(this.e/f))*f,U=d[U])for(;U%10==0;U/=10,b--);return b<0&&(b=0),b},N.dividedBy=N.div=function(x,w){return h(this,new W(x,w),D,q)},N.dividedToIntegerBy=N.idiv=function(x,w){return h(this,new W(x,w),0,1)},N.exponentiatedBy=N.pow=function(x,w){var d,b,U,P,K,V,$,M,G,Y=this;if(x=new W(x),x.c&&!x.isInteger())throw Error(u+"Exponent not an integer: "+_(x));if(w!=null&&(w=new W(w)),V=x.e>14,!Y.c||!Y.c[0]||Y.c[0]==1&&!Y.e&&Y.c.length==1||!x.c||!x.c[0])return G=new W(Math.pow(+_(Y),V?x.s*(2-E(x)):+_(x))),w?G.mod(w):G;if($=x.s<0,w){if(w.c?!w.c[0]:!w.s)return new W(NaN);b=!$&&Y.isInteger()&&w.isInteger(),b&&(Y=Y.mod(w))}else{if(x.e>9&&(Y.e>0||Y.e<-1||(Y.e==0?Y.c[0]>1||V&&Y.c[1]>=24e7:Y.c[0]<8e13||V&&Y.c[0]<=9999975e7)))return P=Y.s<0&&E(x)?-0:0,Y.e>-1&&(P=1/P),new W($?1/P:P);se&&(P=s(se/f+2))}for(V?(d=new W(.5),$&&(x.s=1),M=E(x)):(U=Math.abs(+_(x)),M=U%2),G=new W(F);;){if(M){if(G=G.times(Y),!G.c)break;P?G.c.length>P&&(G.c.length=P):b&&(G=G.mod(w))}if(U){if(U=c(U/2),U===0)break;M=U%2}else if(x=x.times(d),fe(x,x.e+1,1),x.e>14)M=E(x);else{if(U=+_(x),U===0)break;M=U%2}Y=Y.times(Y),P?Y.c&&Y.c.length>P&&(Y.c.length=P):b&&(Y=Y.mod(w))}return b?G:($&&(G=F.div(G)),w?G.mod(w):P?fe(G,se,q,K):G)},N.integerValue=function(x){var w=new W(this);return x==null?x=q:v(x,0,8),fe(w,w.e+1,x)},N.isEqualTo=N.eq=function(x,w){return i(this,new W(x,w))===0},N.isFinite=function(){return!!this.c},N.isGreaterThan=N.gt=function(x,w){return i(this,new W(x,w))>0},N.isGreaterThanOrEqualTo=N.gte=function(x,w){return(w=i(this,new W(x,w)))===1||w===0},N.isInteger=function(){return!!this.c&&g(this.e/f)>this.c.length-2},N.isLessThan=N.lt=function(x,w){return i(this,new W(x,w))<0},N.isLessThanOrEqualTo=N.lte=function(x,w){return(w=i(this,new W(x,w)))===-1||w===0},N.isNaN=function(){return!this.s},N.isNegative=function(){return this.s<0},N.isPositive=function(){return this.s>0},N.isZero=function(){return!!this.c&&this.c[0]==0},N.minus=function(x,w){var d,b,U,P,K=this,V=K.s;if(x=new W(x,w),w=x.s,!V||!w)return new W(NaN);if(V!=w)return x.s=-w,K.plus(x);var $=K.e/f,M=x.e/f,G=K.c,Y=x.c;if(!$||!M){if(!G||!Y)return G?(x.s=-w,x):new W(Y?K:NaN);if(!G[0]||!Y[0])return Y[0]?(x.s=-w,x):new W(G[0]?K:q==3?-0:0)}if($=g($),M=g(M),G=G.slice(),V=$-M){for((P=V<0)?(V=-V,U=G):(M=$,U=Y),U.reverse(),w=V;w--;U.push(0));U.reverse()}else for(b=(P=(V=G.length)<(w=Y.length))?V:w,V=w=0;w<b;w++)if(G[w]!=Y[w]){P=G[w]<Y[w];break}if(P&&(U=G,G=Y,Y=U,x.s=-x.s),w=(b=Y.length)-(d=G.length),w>0)for(;w--;G[d++]=0);for(w=p-1;b>V;){if(G[--b]<Y[b]){for(d=b;d&&!G[--d];G[d]=w);--G[d],G[b]+=p}G[b]-=Y[b]}for(;G[0]==0;G.splice(0,1),--M);return G[0]?ke(x,G,M):(x.s=q==3?-1:1,x.c=[x.e=0],x)},N.modulo=N.mod=function(x,w){var d,b,U=this;return x=new W(x,w),!U.c||!x.s||x.c&&!x.c[0]?new W(NaN):!x.c||U.c&&!U.c[0]?new W(U):(re==9?(b=x.s,x.s=1,d=h(U,x,0,3),x.s=b,d.s*=b):d=h(U,x,0,re),x=U.minus(d.times(x)),!x.c[0]&&re==1&&(x.s=U.s),x)},N.multipliedBy=N.times=function(x,w){var d,b,U,P,K,V,$,M,G,Y,ne,te,ue,pe,ge,ce=this,le=ce.c,ve=(x=new W(x,w)).c;if(!le||!ve||!le[0]||!ve[0])return!ce.s||!x.s||le&&!le[0]&&!ve||ve&&!ve[0]&&!le?x.c=x.e=x.s=null:(x.s*=ce.s,!le||!ve?x.c=x.e=null:(x.c=[0],x.e=0)),x;for(b=g(ce.e/f)+g(x.e/f),x.s*=ce.s,$=le.length,Y=ve.length,$<Y&&(ue=le,le=ve,ve=ue,U=$,$=Y,Y=U),U=$+Y,ue=[];U--;ue.push(0));for(pe=p,ge=y,U=Y;--U>=0;){for(d=0,ne=ve[U]%ge,te=ve[U]/ge|0,K=$,P=U+K;P>U;)M=le[--K]%ge,G=le[K]/ge|0,V=te*M+G*ne,M=ne*M+V%ge*ge+ue[P]+d,d=(M/pe|0)+(V/ge|0)+te*G,ue[P--]=M%pe;ue[P]=d}return d?++b:ue.splice(0,1),ke(x,ue,b)},N.negated=function(){var x=new W(this);return x.s=-x.s||null,x},N.plus=function(x,w){var d,b=this,U=b.s;if(x=new W(x,w),w=x.s,!U||!w)return new W(NaN);if(U!=w)return x.s=-w,b.minus(x);var P=b.e/f,K=x.e/f,V=b.c,$=x.c;if(!P||!K){if(!V||!$)return new W(U/0);if(!V[0]||!$[0])return $[0]?x:new W(V[0]?b:U*0)}if(P=g(P),K=g(K),V=V.slice(),U=P-K){for(U>0?(K=P,d=$):(U=-U,d=V),d.reverse();U--;d.push(0));d.reverse()}for(U=V.length,w=$.length,U-w<0&&(d=$,$=V,V=d,w=U),U=0;w;)U=(V[--w]=V[w]+$[w]+U)/p|0,V[w]=p===V[w]?0:V[w]%p;return U&&(V=[U].concat(V),++K),ke(x,V,K)},N.precision=N.sd=function(x,w){var d,b,U,P=this;if(x!=null&&x!==!!x)return v(x,1,o),w==null?w=q:v(w,0,8),fe(new W(P),x,w);if(!(d=P.c))return null;if(U=d.length-1,b=U*f+1,U=d[U]){for(;U%10==0;U/=10,b--);for(U=d[0];U>=10;U/=10,b++);}return x&&P.e+1>b&&(b=P.e+1),b},N.shiftedBy=function(x){return v(x,-A,A),this.times("1e"+x)},N.squareRoot=N.sqrt=function(){var x,w,d,b,U,P=this,K=P.c,V=P.s,$=P.e,M=D+4,G=new W("0.5");if(V!==1||!K||!K[0])return new W(!V||V<0&&(!K||K[0])?NaN:K?P:1/0);if(V=Math.sqrt(+_(P)),V==0||V==1/0?(w=S(K),(w.length+$)%2==0&&(w+="0"),V=Math.sqrt(+w),$=g(($+1)/2)-($<0||$%2),V==1/0?w="5e"+$:(w=V.toExponential(),w=w.slice(0,w.indexOf("e")+1)+$),d=new W(w)):d=new W(V+""),d.c[0]){for($=d.e,V=$+M,V<3&&(V=0);;)if(U=d,d=G.times(U.plus(h(P,U,M,1))),S(U.c).slice(0,V)===(w=S(d.c)).slice(0,V))if(d.e<$&&--V,w=w.slice(V-3,V+1),w=="9999"||!b&&w=="4999"){if(!b&&(fe(U,U.e+D+2,0),U.times(U).eq(P))){d=U;break}M+=4,V+=4,b=1}else{(!+w||!+w.slice(1)&&w.charAt(0)=="5")&&(fe(d,d.e+D+2,1),x=!d.times(d).eq(P));break}}return fe(d,d.e+D+1,q,x)},N.toExponential=function(x,w){return x!=null&&(v(x,0,o),x++),he(this,x,w,1)},N.toFixed=function(x,w){return x!=null&&(v(x,0,o),x=x+this.e+1),he(this,x,w)},N.toFormat=function(x,w,d){var b,U=this;if(d==null)x!=null&&w&&typeof w=="object"?(d=w,w=null):x&&typeof x=="object"?(d=x,x=w=null):d=de;else if(typeof d!="object")throw Error(u+"Argument not an object: "+d);if(b=U.toFixed(x,w),U.c){var P,K=b.split("."),V=+d.groupSize,$=+d.secondaryGroupSize,M=d.groupSeparator||"",G=K[0],Y=K[1],ne=U.s<0,te=ne?G.slice(1):G,ue=te.length;if($&&(P=V,V=$,$=P,ue-=P),V>0&&ue>0){for(P=ue%V||V,G=te.substr(0,P);P<ue;P+=V)G+=M+te.substr(P,V);$>0&&(G+=M+te.slice(P)),ne&&(G="-"+G)}b=Y?G+(d.decimalSeparator||"")+(($=+d.fractionGroupSize)?Y.replace(new RegExp("\\d{"+$+"}\\B","g"),"$&"+(d.fractionGroupSeparator||"")):Y):G}return(d.prefix||"")+b+(d.suffix||"")},N.toFraction=function(x){var w,d,b,U,P,K,V,$,M,G,Y,ne,te=this,ue=te.c;if(x!=null&&(V=new W(x),!V.isInteger()&&(V.c||V.s!==1)||V.lt(F)))throw Error(u+"Argument "+(V.isInteger()?"out of range: ":"not an integer: ")+_(V));if(!ue)return new W(te);for(w=new W(F),M=d=new W(F),b=$=new W(F),ne=S(ue),P=w.e=ne.length-te.e-1,w.c[0]=C[(K=P%f)<0?f+K:K],x=!x||V.comparedTo(w)>0?P>0?w:M:V,K=J,J=1/0,V=new W(ne),$.c[0]=0;G=h(V,w,0,1),U=d.plus(G.times(b)),U.comparedTo(x)!=1;)d=b,b=U,M=$.plus(G.times(U=M)),$=U,w=V.minus(G.times(U=w)),V=U;return U=h(x.minus(d),b,0,1),$=$.plus(U.times(M)),d=d.plus(U.times(b)),$.s=M.s=te.s,P=P*2,Y=h(M,b,P,q).minus(te).abs().comparedTo(h($,d,P,q).minus(te).abs())<1?[M,b]:[$,d],J=K,Y},N.toNumber=function(){return+_(this)},N.toPrecision=function(x,w){return x!=null&&v(x,1,o),he(this,x,w,2)},N.toString=function(x){var w,d=this,b=d.s,U=d.e;return U===null?b?(w="Infinity",b<0&&(w="-"+w)):w="NaN":(x==null?w=U<=j||U>=H?I(S(d.c),U):B(S(d.c),U,"0"):x===10&&_e?(d=fe(new W(d),D+U+1,q),w=B(S(d.c),d.e,"0")):(v(x,2,ye.length,"Base"),w=l(B(S(d.c),U,"0"),10,x,b,!0)),b<0&&d.c[0]&&(w="-"+w)),w},N.valueOf=N.toJSON=function(){return _(this)},N._isBigNumber=!0,T!=null&&W.set(T),W}function g(T){var h=T|0;return T>0||T===h?h:h-1}function S(T){for(var h,l,R=1,N=T.length,F=T[0]+"";R<N;){for(h=T[R++]+"",l=f-h.length;l--;h="0"+h);F+=h}for(N=F.length;F.charCodeAt(--N)===48;);return F.slice(0,N+1||1)}function i(T,h){var l,R,N=T.c,F=h.c,D=T.s,q=h.s,j=T.e,H=h.e;if(!D||!q)return null;if(l=N&&!N[0],R=F&&!F[0],l||R)return l?R?0:-q:D;if(D!=q)return D;if(l=D<0,R=j==H,!N||!F)return R?0:!N^l?1:-1;if(!R)return j>H^l?1:-1;for(q=(j=N.length)<(H=F.length)?j:H,D=0;D<q;D++)if(N[D]!=F[D])return N[D]>F[D]^l?1:-1;return j==H?0:j>H^l?1:-1}function v(T,h,l,R){if(T<h||T>l||T!==c(T))throw Error(u+(R||"Argument")+(typeof T=="number"?T<h||T>l?" out of range: ":" not an integer: ":" not a primitive number: ")+String(T))}function E(T){var h=T.c.length-1;return g(T.e/f)==h&&T.c[h]%2!=0}function I(T,h){return(T.length>1?T.charAt(0)+"."+T.slice(1):T)+(h<0?"e":"e+")+h}function B(T,h,l){var R,N;if(h<0){for(N=l+".";++h;N+=l);T=N+T}else if(R=T.length,++h>R){for(N=l,h-=R;--h;N+=l);T+=N}else h<R&&(T=T.slice(0,h)+"."+T.slice(h));return T}r=m(),r.default=r.BigNumber=r,t.exports?t.exports=r:(e||(e=typeof self<"u"&&self?self:window),e.BigNumber=r)})(Be)})(zc);var Wc=zc.exports;(function(t){var e=Wc,r=t.exports;(function(){var n=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,s,c,u={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},a;function p(A){return n.lastIndex=0,n.test(A)?'"'+A.replace(n,function(C){var y=u[C];return typeof y=="string"?y:"\\u"+("0000"+C.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+A+'"'}function f(A,C){var y,o,m,g,S=s,i,v=C[A],E=v!=null&&(v instanceof e||e.isBigNumber(v));switch(v&&typeof v=="object"&&typeof v.toJSON=="function"&&(v=v.toJSON(A)),typeof a=="function"&&(v=a.call(C,A,v)),typeof v){case"string":return E?v:p(v);case"number":return isFinite(v)?String(v):"null";case"boolean":case"null":case"bigint":return String(v);case"object":if(!v)return"null";if(s+=c,i=[],Object.prototype.toString.apply(v)==="[object Array]"){for(g=v.length,y=0;y<g;y+=1)i[y]=f(y,v)||"null";return m=i.length===0?"[]":s?`[
`+s+i.join(`,
`+s)+`
`+S+"]":"["+i.join(",")+"]",s=S,m}if(a&&typeof a=="object")for(g=a.length,y=0;y<g;y+=1)typeof a[y]=="string"&&(o=a[y],m=f(o,v),m&&i.push(p(o)+(s?": ":":")+m));else Object.keys(v).forEach(function(I){var B=f(I,v);B&&i.push(p(I)+(s?": ":":")+B)});return m=i.length===0?"{}":s?`{
`+s+i.join(`,
`+s)+`
`+S+"}":"{"+i.join(",")+"}",s=S,m}}typeof r.stringify!="function"&&(r.stringify=function(A,C,y){var o;if(s="",c="",typeof y=="number")for(o=0;o<y;o+=1)c+=" ";else typeof y=="string"&&(c=y);if(a=C,C&&typeof C!="function"&&(typeof C!="object"||typeof C.length!="number"))throw new Error("JSON.stringify");return f("",{"":A})})})()})(Hc);var Cf=Hc.exports,Sn=null;const Sf=/(?:_|\\u005[Ff])(?:_|\\u005[Ff])(?:p|\\u0070)(?:r|\\u0072)(?:o|\\u006[Ff])(?:t|\\u0074)(?:o|\\u006[Ff])(?:_|\\u005[Ff])(?:_|\\u005[Ff])/,Af=/(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)/;var Tf=function(t){var e={strict:!1,storeAsString:!1,alwaysParseAsBig:!1,useNativeBigInt:!1,protoAction:"error",constructorAction:"error"};if(t!=null){if(t.strict===!0&&(e.strict=!0),t.storeAsString===!0&&(e.storeAsString=!0),e.alwaysParseAsBig=t.alwaysParseAsBig===!0?t.alwaysParseAsBig:!1,e.useNativeBigInt=t.useNativeBigInt===!0?t.useNativeBigInt:!1,typeof t.constructorAction<"u")if(t.constructorAction==="error"||t.constructorAction==="ignore"||t.constructorAction==="preserve")e.constructorAction=t.constructorAction;else throw new Error(`Incorrect value for constructorAction option, must be "error", "ignore" or undefined but passed ${t.constructorAction}`);if(typeof t.protoAction<"u")if(t.protoAction==="error"||t.protoAction==="ignore"||t.protoAction==="preserve")e.protoAction=t.protoAction;else throw new Error(`Incorrect value for protoAction option, must be "error", "ignore" or undefined but passed ${t.protoAction}`)}var r,n,s={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:`
`,r:"\r",t:"	"},c,u=function(g){throw{name:"SyntaxError",message:g,at:r,text:c}},a=function(g){return g&&g!==n&&u("Expected '"+g+"' instead of '"+n+"'"),n=c.charAt(r),r+=1,n},p=function(){var g,S="";for(n==="-"&&(S="-",a("-"));n>="0"&&n<="9";)S+=n,a();if(n===".")for(S+=".";a()&&n>="0"&&n<="9";)S+=n;if(n==="e"||n==="E")for(S+=n,a(),(n==="-"||n==="+")&&(S+=n,a());n>="0"&&n<="9";)S+=n,a();if(g=+S,!isFinite(g))u("Bad number");else return Sn==null&&(Sn=Wc),S.length>15?e.storeAsString?S:e.useNativeBigInt?BigInt(S):new Sn(S):e.alwaysParseAsBig?e.useNativeBigInt?BigInt(g):new Sn(g):g},f=function(){var g,S,i="",v;if(n==='"')for(var E=r;a();){if(n==='"')return r-1>E&&(i+=c.substring(E,r-1)),a(),i;if(n==="\\"){if(r-1>E&&(i+=c.substring(E,r-1)),a(),n==="u"){for(v=0,S=0;S<4&&(g=parseInt(a(),16),!!isFinite(g));S+=1)v=v*16+g;i+=String.fromCharCode(v)}else if(typeof s[n]=="string")i+=s[n];else break;E=r}}u("Bad string")},A=function(){for(;n&&n<=" ";)a()},C=function(){switch(n){case"t":return a("t"),a("r"),a("u"),a("e"),!0;case"f":return a("f"),a("a"),a("l"),a("s"),a("e"),!1;case"n":return a("n"),a("u"),a("l"),a("l"),null}u("Unexpected '"+n+"'")},y,o=function(){var g=[];if(n==="["){if(a("["),A(),n==="]")return a("]"),g;for(;n;){if(g.push(y()),A(),n==="]")return a("]"),g;a(","),A()}}u("Bad array")},m=function(){var g,S=Object.create(null);if(n==="{"){if(a("{"),A(),n==="}")return a("}"),S;for(;n;){if(g=f(),A(),a(":"),e.strict===!0&&Object.hasOwnProperty.call(S,g)&&u('Duplicate key "'+g+'"'),Sf.test(g)===!0?e.protoAction==="error"?u("Object contains forbidden prototype property"):e.protoAction==="ignore"?y():S[g]=y():Af.test(g)===!0?e.constructorAction==="error"?u("Object contains forbidden constructor property"):e.constructorAction==="ignore"?y():S[g]=y():S[g]=y(),A(),n==="}")return a("}"),S;a(","),A()}}u("Bad object")};return y=function(){switch(A(),n){case"{":return m();case"[":return o();case'"':return f();case"-":return p();default:return n>="0"&&n<="9"?p():C()}},function(g,S){var i;return c=g+"",r=0,n=" ",i=y(),A(),n&&u("Syntax error"),typeof S=="function"?function v(E,I){var B,T=E[I];return T&&typeof T=="object"&&Object.keys(T).forEach(function(h){B=v(T,h),B!==void 0?T[h]=B:delete T[h]}),S.call(E,I,T)}({"":i},""):i}},xf=Tf,Qc=Cf.stringify,Yc=xf;Xn.exports=function(t){return{parse:Yc(t),stringify:Qc}};Xn.exports.parse=Yc();Xn.exports.stringify=Qc;var _f=Xn.exports,Yi={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.detectGCPResidency=t.isGoogleComputeEngine=t.isGoogleComputeEngineMACAddress=t.isGoogleComputeEngineLinux=t.isGoogleCloudServerless=t.GCE_LINUX_BIOS_PATHS=void 0;const e=nr,r=Mc;t.GCE_LINUX_BIOS_PATHS={BIOS_DATE:"/sys/class/dmi/id/bios_date",BIOS_VENDOR:"/sys/class/dmi/id/bios_vendor"};const n=/^42:01/;function s(){return!!(process.env.CLOUD_RUN_JOB||process.env.FUNCTION_NAME||process.env.K_SERVICE)}t.isGoogleCloudServerless=s;function c(){if((0,r.platform)()!=="linux")return!1;try{(0,e.statSync)(t.GCE_LINUX_BIOS_PATHS.BIOS_DATE);const f=(0,e.readFileSync)(t.GCE_LINUX_BIOS_PATHS.BIOS_VENDOR,"utf8");return/Google/.test(f)}catch{return!1}}t.isGoogleComputeEngineLinux=c;function u(){const f=(0,r.networkInterfaces)();for(const A of Object.values(f))if(A){for(const{mac:C}of A)if(n.test(C))return!0}return!1}t.isGoogleComputeEngineMACAddress=u;function a(){return c()||u()}t.isGoogleComputeEngine=a;function p(){return s()||a()}t.detectGCPResidency=p})(Yi);(function(t){var e=Be&&Be.__createBinding||(Object.create?function(v,E,I,B){B===void 0&&(B=I);var T=Object.getOwnPropertyDescriptor(E,I);(!T||("get"in T?!E.__esModule:T.writable||T.configurable))&&(T={enumerable:!0,get:function(){return E[I]}}),Object.defineProperty(v,B,T)}:function(v,E,I,B){B===void 0&&(B=I),v[B]=E[I]}),r=Be&&Be.__exportStar||function(v,E){for(var I in v)I!=="default"&&!Object.prototype.hasOwnProperty.call(E,I)&&e(E,v,I)};Object.defineProperty(t,"__esModule",{value:!0}),t.requestTimeout=t.setGCPResidency=t.gcpResidencyCache=t.resetIsAvailableCache=t.isAvailable=t.project=t.instance=t.HEADERS=t.HEADER_VALUE=t.HEADER_NAME=t.SECONDARY_HOST_ADDRESS=t.HOST_ADDRESS=t.BASE_PATH=void 0;const n=At,s=_f,c=Yi;t.BASE_PATH="/computeMetadata/v1",t.HOST_ADDRESS="http://169.254.169.254",t.SECONDARY_HOST_ADDRESS="http://metadata.google.internal.",t.HEADER_NAME="Metadata-Flavor",t.HEADER_VALUE="Google",t.HEADERS=Object.freeze({[t.HEADER_NAME]:t.HEADER_VALUE});function u(v){return v||(v=process.env.GCE_METADATA_IP||process.env.GCE_METADATA_HOST||t.HOST_ADDRESS),/^https?:\/\//.test(v)||(v=`http://${v}`),new URL(t.BASE_PATH,v).href}function a(v){Object.keys(v).forEach(E=>{switch(E){case"params":case"property":case"headers":break;case"qs":throw new Error("'qs' is not a valid configuration option. Please use 'params' instead.");default:throw new Error(`'${E}' is not a valid configuration option.`)}})}async function p(v,E,I=3,B=!1){E=E||{},typeof E=="string"&&(E={property:E});let T="";typeof E=="object"&&E.property&&(T="/"+E.property),a(E);try{const l=await(B?f:n.request)({url:`${u()}/${v}${T}`,headers:Object.assign({},t.HEADERS,E.headers),retryConfig:{noResponseRetries:I},params:E.params,responseType:"text",timeout:i()});if(l.headers[t.HEADER_NAME.toLowerCase()]!==t.HEADER_VALUE)throw new Error(`Invalid response from metadata service: incorrect ${t.HEADER_NAME} header.`);if(!l.data)throw new Error("Invalid response from the metadata service");if(typeof l.data=="string")try{return s.parse(l.data)}catch{}return l.data}catch(h){const l=h;throw l.response&&l.response.status!==200&&(l.message=`Unsuccessful response status code. ${l.message}`),h}}async function f(v){const E={...v,url:v.url.replace(u(),u(t.SECONDARY_HOST_ADDRESS))};let I=!1;const B=(0,n.request)(v).then(h=>(I=!0,h)).catch(h=>{if(I)return T;throw I=!0,h}),T=(0,n.request)(E).then(h=>(I=!0,h)).catch(h=>{if(I)return B;throw I=!0,h});return Promise.race([B,T])}function A(v){return p("instance",v)}t.instance=A;function C(v){return p("project",v)}t.project=C;function y(){return process.env.DETECT_GCP_RETRIES?Number(process.env.DETECT_GCP_RETRIES):0}let o;async function m(){try{return o===void 0&&(o=p("instance",void 0,y(),!(process.env.GCE_METADATA_IP||process.env.GCE_METADATA_HOST))),await o,!0}catch(v){const E=v;if(process.env.DEBUG_AUTH&&console.info(E),E.type==="request-timeout"||E.response&&E.response.status===404)return!1;if(!(E.response&&E.response.status===404)&&(!E.code||!["EHOSTDOWN","EHOSTUNREACH","ENETUNREACH","ENOENT","ENOTFOUND","ECONNREFUSED"].includes(E.code))){let I="UNKNOWN";E.code&&(I=E.code),process.emitWarning(`received unexpected error = ${E.message} code = ${I}`,"MetadataLookupWarning")}return!1}}t.isAvailable=m;function g(){o=void 0}t.resetIsAvailableCache=g,t.gcpResidencyCache=null;function S(v=null){t.gcpResidencyCache=v!==null?v:(0,c.detectGCPResidency)()}t.setGCPResidency=S;function i(){return t.gcpResidencyCache===null&&(t.gcpResidencyCache=(0,c.detectGCPResidency)()),t.gcpResidencyCache?0:3e3}t.requestTimeout=i,r(Yi,t)})(Wn);var wt={},Or={},Zn={};Zn.byteLength=bf;Zn.toByteArray=Rf;Zn.fromByteArray=Of;var Et=[],ut=[],wf=typeof Uint8Array<"u"?Uint8Array:Array,Pa="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var fr=0,If=Pa.length;fr<If;++fr)Et[fr]=Pa[fr],ut[Pa.charCodeAt(fr)]=fr;ut["-".charCodeAt(0)]=62;ut["_".charCodeAt(0)]=63;function Jc(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=t.indexOf("=");r===-1&&(r=e);var n=r===e?0:4-r%4;return[r,n]}function bf(t){var e=Jc(t),r=e[0],n=e[1];return(r+n)*3/4-n}function Bf(t,e,r){return(e+r)*3/4-r}function Rf(t){var e,r=Jc(t),n=r[0],s=r[1],c=new wf(Bf(t,n,s)),u=0,a=s>0?n-4:n,p;for(p=0;p<a;p+=4)e=ut[t.charCodeAt(p)]<<18|ut[t.charCodeAt(p+1)]<<12|ut[t.charCodeAt(p+2)]<<6|ut[t.charCodeAt(p+3)],c[u++]=e>>16&255,c[u++]=e>>8&255,c[u++]=e&255;return s===2&&(e=ut[t.charCodeAt(p)]<<2|ut[t.charCodeAt(p+1)]>>4,c[u++]=e&255),s===1&&(e=ut[t.charCodeAt(p)]<<10|ut[t.charCodeAt(p+1)]<<4|ut[t.charCodeAt(p+2)]>>2,c[u++]=e>>8&255,c[u++]=e&255),c}function Nf(t){return Et[t>>18&63]+Et[t>>12&63]+Et[t>>6&63]+Et[t&63]}function Pf(t,e,r){for(var n,s=[],c=e;c<r;c+=3)n=(t[c]<<16&16711680)+(t[c+1]<<8&65280)+(t[c+2]&255),s.push(Nf(n));return s.join("")}function Of(t){for(var e,r=t.length,n=r%3,s=[],c=16383,u=0,a=r-n;u<a;u+=c)s.push(Pf(t,u,u+c>a?a:u+c));return n===1?(e=t[r-1],s.push(Et[e>>2]+Et[e<<4&63]+"==")):n===2&&(e=(t[r-2]<<8)+t[r-1],s.push(Et[e>>10]+Et[e>>4&63]+Et[e<<2&63]+"=")),s.join("")}var Ws={},Qs;function Uf(){return Qs||(Qs=1,function(t){function e(i,v){var E;return i instanceof Buffer?E=i:E=Buffer.from(i.buffer,i.byteOffset,i.byteLength),E.toString(v)}var r=function(i){return Buffer.from(i)};function n(i){for(var v=0,E=Math.min(256*256,i.length+1),I=new Uint16Array(E),B=[],T=0;;){var h=v<i.length;if(!h||T>=E-1){var l=I.subarray(0,T),R=l;if(B.push(String.fromCharCode.apply(null,R)),!h)return B.join("");i=i.subarray(v),v=0,T=0}var N=i[v++];if(!(N&128))I[T++]=N;else if((N&224)===192){var F=i[v++]&63;I[T++]=(N&31)<<6|F}else if((N&240)===224){var F=i[v++]&63,D=i[v++]&63;I[T++]=(N&31)<<12|F<<6|D}else if((N&248)===240){var F=i[v++]&63,D=i[v++]&63,q=i[v++]&63,j=(N&7)<<18|F<<12|D<<6|q;j>65535&&(j-=65536,I[T++]=j>>>10&1023|55296,j=56320|j&1023),I[T++]=j}}}function s(i){for(var v=0,E=i.length,I=0,B=Math.max(32,E+(E>>>1)+7),T=new Uint8Array(B>>>3<<3);v<E;){var h=i.charCodeAt(v++);if(h>=55296&&h<=56319){if(v<E){var l=i.charCodeAt(v);(l&64512)===56320&&(++v,h=((h&1023)<<10)+(l&1023)+65536)}if(h>=55296&&h<=56319)continue}if(I+4>T.length){B+=8,B*=1+v/i.length*2,B=B>>>3<<3;var R=new Uint8Array(B);R.set(T),T=R}if(h&4294967168)if(!(h&4294965248))T[I++]=h>>>6&31|192;else if(!(h&4294901760))T[I++]=h>>>12&15|224,T[I++]=h>>>6&63|128;else if(!(h&4292870144))T[I++]=h>>>18&7|240,T[I++]=h>>>12&63|128,T[I++]=h>>>6&63|128;else continue;else{T[I++]=h;continue}T[I++]=h&63|128}return T.slice?T.slice(0,I):T.subarray(0,I)}var c="Failed to ",u=function(i,v,E){if(i)throw new Error("".concat(c).concat(v,": the '").concat(E,"' option is unsupported."))},a=typeof Buffer=="function"&&Buffer.from,p=a?r:s;function f(){this.encoding="utf-8"}f.prototype.encode=function(i,v){return u(v&&v.stream,"encode","stream"),p(i)};function A(i){var v;try{var E=new Blob([i],{type:"text/plain;charset=UTF-8"});v=URL.createObjectURL(E);var I=new XMLHttpRequest;return I.open("GET",v,!1),I.send(),I.responseText}finally{v&&URL.revokeObjectURL(v)}}var C=!a&&typeof Blob=="function"&&typeof URL=="function"&&typeof URL.createObjectURL=="function",y=["utf-8","utf8","unicode-1-1-utf-8"],o=n;a?o=e:C&&(o=function(i){try{return A(i)}catch{return n(i)}});var m="construct 'TextDecoder'",g="".concat(c," ").concat(m,": the ");function S(i,v){u(v&&v.fatal,m,"fatal"),i=i||"utf-8";var E;if(a?E=Buffer.isEncoding(i):E=y.indexOf(i.toLowerCase())!==-1,!E)throw new RangeError("".concat(g," encoding label provided ('").concat(i,"') is invalid."));this.encoding=i,this.fatal=!1,this.ignoreBOM=!1}S.prototype.decode=function(i,v){u(v&&v.stream,"decode","stream");var E;return i instanceof Uint8Array?E=i:i.buffer instanceof ArrayBuffer?E=new Uint8Array(i.buffer):E=new Uint8Array(i),o(E,this.encoding)},t.TextEncoder=t.TextEncoder||f,t.TextDecoder=t.TextDecoder||S}(typeof window<"u"?window:Be)),Ws}var Ys;function kf(){if(Ys)return Or;Ys=1,Object.defineProperty(Or,"__esModule",{value:!0}),Or.BrowserCrypto=void 0;const t=Zn;typeof process>"u"&&typeof TextEncoder>"u"&&Uf();const e=Yr();class r{constructor(){if(typeof window>"u"||window.crypto===void 0||window.crypto.subtle===void 0)throw new Error("SubtleCrypto not found. Make sure it's an https:// website.")}async sha256DigestBase64(s){const c=new TextEncoder().encode(s),u=await window.crypto.subtle.digest("SHA-256",c);return t.fromByteArray(new Uint8Array(u))}randomBytesBase64(s){const c=new Uint8Array(s);return window.crypto.getRandomValues(c),t.fromByteArray(c)}static padBase64(s){for(;s.length%4!==0;)s+="=";return s}async verify(s,c,u){const a={name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},p=new TextEncoder().encode(c),f=t.toByteArray(r.padBase64(u)),A=await window.crypto.subtle.importKey("jwk",s,a,!0,["verify"]);return await window.crypto.subtle.verify(a,A,f,p)}async sign(s,c){const u={name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},a=new TextEncoder().encode(c),p=await window.crypto.subtle.importKey("jwk",s,u,!0,["sign"]),f=await window.crypto.subtle.sign(u,p,a);return t.fromByteArray(new Uint8Array(f))}decodeBase64StringUtf8(s){const c=t.toByteArray(r.padBase64(s));return new TextDecoder().decode(c)}encodeBase64StringUtf8(s){const c=new TextEncoder().encode(s);return t.fromByteArray(c)}async sha256DigestHex(s){const c=new TextEncoder().encode(s),u=await window.crypto.subtle.digest("SHA-256",c);return(0,e.fromArrayBufferToHex)(u)}async signWithHmacSha256(s,c){const u=typeof s=="string"?s:String.fromCharCode(...new Uint16Array(s)),a=new TextEncoder,p=await window.crypto.subtle.importKey("raw",a.encode(u),{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]);return window.crypto.subtle.sign("HMAC",p,a.encode(c))}}return Or.BrowserCrypto=r,Or}var ea={};Object.defineProperty(ea,"__esModule",{value:!0});ea.NodeCrypto=void 0;const dr=Wr;class Df{async sha256DigestBase64(e){return dr.createHash("sha256").update(e).digest("base64")}randomBytesBase64(e){return dr.randomBytes(e).toString("base64")}async verify(e,r,n){const s=dr.createVerify("sha256");return s.update(r),s.end(),s.verify(e,n,"base64")}async sign(e,r){const n=dr.createSign("RSA-SHA256");return n.update(r),n.end(),n.sign(e,"base64")}decodeBase64StringUtf8(e){return Buffer.from(e,"base64").toString("utf-8")}encodeBase64StringUtf8(e){return Buffer.from(e,"utf-8").toString("base64")}async sha256DigestHex(e){return dr.createHash("sha256").update(e).digest("hex")}async signWithHmacSha256(e,r){const n=typeof e=="string"?e:Ff(e);return Lf(dr.createHmac("sha256",n).update(r).digest())}}ea.NodeCrypto=Df;function Lf(t){return t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength)}function Ff(t){return Buffer.from(t)}var Js;function Yr(){if(Js)return wt;Js=1,Object.defineProperty(wt,"__esModule",{value:!0}),wt.fromArrayBufferToHex=wt.hasBrowserCrypto=wt.createCrypto=void 0;const t=kf(),e=ea;function r(){return n()?new t.BrowserCrypto:new e.NodeCrypto}wt.createCrypto=r;function n(){return typeof window<"u"&&typeof window.crypto<"u"&&typeof window.crypto.subtle<"u"}wt.hasBrowserCrypto=n;function s(c){return Array.from(new Uint8Array(c)).map(a=>a.toString(16).padStart(2,"0")).join("")}return wt.fromArrayBufferToHex=s,wt}var ar={},ta={};Object.defineProperty(ta,"__esModule",{value:!0});ta.validate=void 0;function Mf(t){const e=[{invalid:"uri",expected:"url"},{invalid:"json",expected:"data"},{invalid:"qs",expected:"params"}];for(const r of e)if(t[r.invalid]){const n=`'${r.invalid}' is not a valid configuration option. Please use '${r.expected}' instead. This library is using Axios for requests. Please see https://github.com/axios/axios to learn more about the valid request options.`;throw new Error(n)}}ta.validate=Mf;const qf="google-auth-library",Vf="8.8.0",Kf="Google Inc.",$f="Google APIs Authentication Client Library for Node.js",Gf={node:">=12"},jf="./build/src/index.js",Hf="./build/src/index.d.ts",zf="googleapis/google-auth-library-nodejs.git",Wf=["google","api","google apis","client","client library"],Qf={arrify:"^2.0.0","base64-js":"^1.3.0","ecdsa-sig-formatter":"^1.0.11","fast-text-encoding":"^1.0.0",gaxios:"^5.0.0","gcp-metadata":"^5.2.0",gtoken:"^6.1.0",jws:"^4.0.0","lru-cache":"^6.0.0"},Yf={"@compodoc/compodoc":"^1.1.7","@types/base64-js":"^1.2.5","@types/chai":"^4.1.7","@types/jws":"^3.1.0","@types/lru-cache":"^5.0.0","@types/mocha":"^9.0.0","@types/mv":"^2.1.0","@types/ncp":"^2.0.1","@types/node":"^16.0.0","@types/sinon":"^10.0.0","assert-rejects":"^1.0.0",c8:"^7.0.0",chai:"^4.2.0",codecov:"^3.0.2",execa:"^5.0.0",gts:"^3.1.0","is-docker":"^2.0.0",karma:"^6.0.0","karma-chrome-launcher":"^3.0.0","karma-coverage":"^2.0.0","karma-firefox-launcher":"^2.0.0","karma-mocha":"^2.0.0","karma-sourcemap-loader":"^0.4.0","karma-webpack":"^5.0.0",keypair:"^1.0.4",linkinator:"^4.0.0",mocha:"^9.2.2",mv:"^2.1.1",ncp:"^2.0.0",nock:"^13.0.0","null-loader":"^4.0.0",puppeteer:"^18.0.0",sinon:"^15.0.0","ts-loader":"^8.0.0",typescript:"^4.6.3",webpack:"^5.21.2","webpack-cli":"^4.0.0"},Jf=["build/src","!build/src/**/*.map"],Xf={test:"c8 mocha build/test",clean:"gts clean",prepare:"npm run compile",lint:"gts check",compile:"tsc -p .",fix:"gts fix",pretest:"npm run compile",docs:"compodoc src/","samples-setup":"cd samples/ && npm link ../ && npm run setup && cd ../","samples-test":"cd samples/ && npm link ../ && npm test && cd ../","system-test":"mocha build/system-test --timeout 60000","presystem-test":"npm run compile",webpack:"webpack","browser-test":"karma start","docs-test":"linkinator docs","predocs-test":"npm run docs",prelint:"cd samples; npm link ../; npm install",precompile:"gts clean"},Zf="Apache-2.0",e0={name:qf,version:Vf,author:Kf,description:$f,engines:Gf,main:jf,types:Hf,repository:zf,keywords:Wf,dependencies:Qf,devDependencies:Yf,files:Jf,scripts:Xf,license:Zf};Object.defineProperty(ar,"__esModule",{value:!0});ar.DefaultTransporter=void 0;const Xs=At,t0=ta,Xc=e0,Zc="google-api-nodejs-client";class Hr{configure(e={}){if(e.headers=e.headers||{},typeof window>"u"){const r=e.headers["User-Agent"];r?r.includes(`${Zc}/`)||(e.headers["User-Agent"]=`${r} ${Hr.USER_AGENT}`):e.headers["User-Agent"]=Hr.USER_AGENT;const n=`auth/${Xc.version}`;if(e.headers["x-goog-api-client"]&&!e.headers["x-goog-api-client"].includes(n))e.headers["x-goog-api-client"]=`${e.headers["x-goog-api-client"]} ${n}`;else if(!e.headers["x-goog-api-client"]){const s=process.version.replace(/^v/,"");e.headers["x-goog-api-client"]=`gl-node/${s} ${n}`}}return e}request(e,r){e=this.configure(e);try{(0,t0.validate)(e)}catch(n){if(r)return r(n);throw n}if(r)(0,Xs.request)(e).then(n=>{r(null,n)},n=>{r(this.processError(n))});else return(0,Xs.request)(e).catch(n=>{throw this.processError(n)})}processError(e){const r=e.response,n=e,s=r?r.data:null;return r&&s&&s.error&&r.status!==200?typeof s.error=="string"?(n.message=s.error,n.code=r.status.toString()):Array.isArray(s.error.errors)?(n.message=s.error.errors.map(c=>c.message).join(`
`),n.code=s.error.code,n.errors=s.error.errors):(n.message=s.error.message,n.code=s.error.code||r.status):r&&r.status>=400&&(n.message=s,n.code=r.status.toString()),n}}ar.DefaultTransporter=Hr;Hr.USER_AGENT=`${Zc}/${Xc.version}`;var Jr={};const r0=t=>t==null?[]:Array.isArray(t)?t:typeof t=="string"?[t]:typeof t[Symbol.iterator]=="function"?[...t]:[t];var n0=r0,ir={},Ji={exports:{}};/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */(function(t,e){var r=zn,n=r.Buffer;function s(u,a){for(var p in u)a[p]=u[p]}n.from&&n.alloc&&n.allocUnsafe&&n.allocUnsafeSlow?t.exports=r:(s(r,e),e.Buffer=c);function c(u,a,p){return n(u,a,p)}c.prototype=Object.create(n.prototype),s(n,c),c.from=function(u,a,p){if(typeof u=="number")throw new TypeError("Argument must not be a number");return n(u,a,p)},c.alloc=function(u,a,p){if(typeof u!="number")throw new TypeError("Argument must be a number");var f=n(u);return a!==void 0?typeof p=="string"?f.fill(a,p):f.fill(a):f.fill(0),f},c.allocUnsafe=function(u){if(typeof u!="number")throw new TypeError("Argument must be a number");return n(u)},c.allocUnsafeSlow=function(u){if(typeof u!="number")throw new TypeError("Argument must be a number");return r.SlowBuffer(u)}})(Ji,Ji.exports);var Xr=Ji.exports;function Oa(t){var e=(t/8|0)+(t%8===0?0:1);return e}var a0={ES256:Oa(256),ES384:Oa(384),ES512:Oa(521)};function i0(t){var e=a0[t];if(e)return e;throw new Error('Unknown algorithm "'+t+'"')}var s0=i0,kn=Xr.Buffer,eu=s0,Dn=128,tu=0,o0=32,c0=16,u0=2,ru=c0|o0|tu<<6,Ln=u0|tu<<6;function l0(t){return t.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function nu(t){if(kn.isBuffer(t))return t;if(typeof t=="string")return kn.from(t,"base64");throw new TypeError("ECDSA signature must be a Base64 string or a Buffer")}function f0(t,e){t=nu(t);var r=eu(e),n=r+1,s=t.length,c=0;if(t[c++]!==ru)throw new Error('Could not find expected "seq"');var u=t[c++];if(u===(Dn|1)&&(u=t[c++]),s-c<u)throw new Error('"seq" specified length of "'+u+'", only "'+(s-c)+'" remaining');if(t[c++]!==Ln)throw new Error('Could not find expected "int" for "r"');var a=t[c++];if(s-c-2<a)throw new Error('"r" specified length of "'+a+'", only "'+(s-c-2)+'" available');if(n<a)throw new Error('"r" specified length of "'+a+'", max of "'+n+'" is acceptable');var p=c;if(c+=a,t[c++]!==Ln)throw new Error('Could not find expected "int" for "s"');var f=t[c++];if(s-c!==f)throw new Error('"s" specified length of "'+f+'", expected "'+(s-c)+'"');if(n<f)throw new Error('"s" specified length of "'+f+'", max of "'+n+'" is acceptable');var A=c;if(c+=f,c!==s)throw new Error('Expected to consume entire buffer, but "'+(s-c)+'" bytes remain');var C=r-a,y=r-f,o=kn.allocUnsafe(C+a+y+f);for(c=0;c<C;++c)o[c]=0;t.copy(o,c,p+Math.max(-C,0),p+a),c=r;for(var m=c;c<m+y;++c)o[c]=0;return t.copy(o,c,A+Math.max(-y,0),A+f),o=o.toString("base64"),o=l0(o),o}function Zs(t,e,r){for(var n=0;e+n<r&&t[e+n]===0;)++n;var s=t[e+n]>=Dn;return s&&--n,n}function d0(t,e){t=nu(t);var r=eu(e),n=t.length;if(n!==r*2)throw new TypeError('"'+e+'" signatures must be "'+r*2+'" bytes, saw "'+n+'"');var s=Zs(t,0,r),c=Zs(t,r,t.length),u=r-s,a=r-c,p=1+1+u+1+1+a,f=p<Dn,A=kn.allocUnsafe((f?2:3)+p),C=0;return A[C++]=ru,f?A[C++]=p:(A[C++]=Dn|1,A[C++]=p&255),A[C++]=Ln,A[C++]=u,s<0?(A[C++]=0,C+=t.copy(A,C,0,r)):C+=t.copy(A,C,s,r),A[C++]=Ln,A[C++]=a,c<0?(A[C++]=0,t.copy(A,C,r)):t.copy(A,C,r+c),A}var au={derToJose:f0,joseToDer:d0},Kt={};Object.defineProperty(Kt,"__esModule",{value:!0});Kt.AuthClient=void 0;const h0=Fc,p0=ar;class y0 extends h0.EventEmitter{constructor(){super(...arguments),this.transporter=new p0.DefaultTransporter,this.credentials={},this.eagerRefreshThresholdMillis=5*60*1e3,this.forceRefreshOnFailure=!1}setCredentials(e){this.credentials=e}addSharedMetadataHeaders(e){return!e["x-goog-user-project"]&&this.quotaProjectId&&(e["x-goog-user-project"]=this.quotaProjectId),e}}Kt.AuthClient=y0;var Zr={};Object.defineProperty(Zr,"__esModule",{value:!0});Zr.LoginTicket=void 0;class g0{constructor(e,r){this.envelope=e,this.payload=r}getEnvelope(){return this.envelope}getPayload(){return this.payload}getUserId(){const e=this.getPayload();return e&&e.sub?e.sub:null}getAttributes(){return{envelope:this.getEnvelope(),payload:this.getPayload()}}}Zr.LoginTicket=g0;(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.OAuth2Client=t.CertificateFormat=t.CodeChallengeMethod=void 0;const e=At,r=jn,n=Nt,s=au,c=Yr(),u=Kt,a=Zr;(function(A){A.Plain="plain",A.S256="S256"})(t.CodeChallengeMethod||(t.CodeChallengeMethod={}));var p;(function(A){A.PEM="PEM",A.JWK="JWK"})(p=t.CertificateFormat||(t.CertificateFormat={}));class f extends u.AuthClient{constructor(C,y,o){super(),this.certificateCache={},this.certificateExpiry=null,this.certificateCacheFormat=p.PEM,this.refreshTokenPromises=new Map;const m=C&&typeof C=="object"?C:{clientId:C,clientSecret:y,redirectUri:o};this._clientId=m.clientId,this._clientSecret=m.clientSecret,this.redirectUri=m.redirectUri,this.eagerRefreshThresholdMillis=m.eagerRefreshThresholdMillis||5*60*1e3,this.forceRefreshOnFailure=!!m.forceRefreshOnFailure}generateAuthUrl(C={}){if(C.code_challenge_method&&!C.code_challenge)throw new Error("If a code_challenge_method is provided, code_challenge must be included.");return C.response_type=C.response_type||"code",C.client_id=C.client_id||this._clientId,C.redirect_uri=C.redirect_uri||this.redirectUri,Array.isArray(C.scope)&&(C.scope=C.scope.join(" ")),f.GOOGLE_OAUTH2_AUTH_BASE_URL_+"?"+r.stringify(C)}generateCodeVerifier(){throw new Error("generateCodeVerifier is removed, please use generateCodeVerifierAsync instead.")}async generateCodeVerifierAsync(){const C=(0,c.createCrypto)(),o=C.randomBytesBase64(96).replace(/\+/g,"~").replace(/=/g,"_").replace(/\//g,"-"),g=(await C.sha256DigestBase64(o)).split("=")[0].replace(/\+/g,"-").replace(/\//g,"_");return{codeVerifier:o,codeChallenge:g}}getToken(C,y){const o=typeof C=="string"?{code:C}:C;if(y)this.getTokenAsync(o).then(m=>y(null,m.tokens,m.res),m=>y(m,null,m.response));else return this.getTokenAsync(o)}async getTokenAsync(C){const y=f.GOOGLE_OAUTH2_TOKEN_URL_,o={code:C.code,client_id:C.client_id||this._clientId,client_secret:this._clientSecret,redirect_uri:C.redirect_uri||this.redirectUri,grant_type:"authorization_code",code_verifier:C.codeVerifier},m=await this.transporter.request({method:"POST",url:y,data:r.stringify(o),headers:{"Content-Type":"application/x-www-form-urlencoded"}}),g=m.data;return m.data&&m.data.expires_in&&(g.expiry_date=new Date().getTime()+m.data.expires_in*1e3,delete g.expires_in),this.emit("tokens",g),{tokens:g,res:m}}async refreshToken(C){if(!C)return this.refreshTokenNoCache(C);if(this.refreshTokenPromises.has(C))return this.refreshTokenPromises.get(C);const y=this.refreshTokenNoCache(C).then(o=>(this.refreshTokenPromises.delete(C),o),o=>{throw this.refreshTokenPromises.delete(C),o});return this.refreshTokenPromises.set(C,y),y}async refreshTokenNoCache(C){var y;if(!C)throw new Error("No refresh token is set.");const o=f.GOOGLE_OAUTH2_TOKEN_URL_,m={refresh_token:C,client_id:this._clientId,client_secret:this._clientSecret,grant_type:"refresh_token"};let g;try{g=await this.transporter.request({method:"POST",url:o,data:r.stringify(m),headers:{"Content-Type":"application/x-www-form-urlencoded"}})}catch(i){throw i instanceof e.GaxiosError&&i.message==="invalid_grant"&&(!((y=i.response)===null||y===void 0)&&y.data)&&/ReAuth/i.test(i.response.data.error_description)&&(i.message=JSON.stringify(i.response.data)),i}const S=g.data;return g.data&&g.data.expires_in&&(S.expiry_date=new Date().getTime()+g.data.expires_in*1e3,delete S.expires_in),this.emit("tokens",S),{tokens:S,res:g}}refreshAccessToken(C){if(C)this.refreshAccessTokenAsync().then(y=>C(null,y.credentials,y.res),C);else return this.refreshAccessTokenAsync()}async refreshAccessTokenAsync(){const C=await this.refreshToken(this.credentials.refresh_token),y=C.tokens;return y.refresh_token=this.credentials.refresh_token,this.credentials=y,{credentials:this.credentials,res:C.res}}getAccessToken(C){if(C)this.getAccessTokenAsync().then(y=>C(null,y.token,y.res),C);else return this.getAccessTokenAsync()}async getAccessTokenAsync(){if(!this.credentials.access_token||this.isTokenExpiring()){if(!this.credentials.refresh_token)if(this.refreshHandler){const o=await this.processAndValidateRefreshHandler();if(o!=null&&o.access_token)return this.setCredentials(o),{token:this.credentials.access_token}}else throw new Error("No refresh token or refresh handler callback is set.");const y=await this.refreshAccessTokenAsync();if(!y.credentials||y.credentials&&!y.credentials.access_token)throw new Error("Could not refresh access token.");return{token:y.credentials.access_token,res:y.res}}else return{token:this.credentials.access_token}}async getRequestHeaders(C){return(await this.getRequestMetadataAsync(C)).headers}async getRequestMetadataAsync(C){const y=this.credentials;if(!y.access_token&&!y.refresh_token&&!this.apiKey&&!this.refreshHandler)throw new Error("No access, refresh token, API key or refresh handler callback is set.");if(y.access_token&&!this.isTokenExpiring()){y.token_type=y.token_type||"Bearer";const i={Authorization:y.token_type+" "+y.access_token};return{headers:this.addSharedMetadataHeaders(i)}}if(this.refreshHandler){const i=await this.processAndValidateRefreshHandler();if(i!=null&&i.access_token){this.setCredentials(i);const v={Authorization:"Bearer "+this.credentials.access_token};return{headers:this.addSharedMetadataHeaders(v)}}}if(this.apiKey)return{headers:{"X-Goog-Api-Key":this.apiKey}};let o=null,m=null;try{o=await this.refreshToken(y.refresh_token),m=o.tokens}catch(i){const v=i;throw v.response&&(v.response.status===403||v.response.status===404)&&(v.message=`Could not refresh access token: ${v.message}`),v}const g=this.credentials;g.token_type=g.token_type||"Bearer",m.refresh_token=g.refresh_token,this.credentials=m;const S={Authorization:g.token_type+" "+m.access_token};return{headers:this.addSharedMetadataHeaders(S),res:o.res}}static getRevokeTokenUrl(C){const y=r.stringify({token:C});return`${f.GOOGLE_OAUTH2_REVOKE_URL_}?${y}`}revokeToken(C,y){const o={url:f.getRevokeTokenUrl(C),method:"POST"};if(y)this.transporter.request(o).then(m=>y(null,m),y);else return this.transporter.request(o)}revokeCredentials(C){if(C)this.revokeCredentialsAsync().then(y=>C(null,y),C);else return this.revokeCredentialsAsync()}async revokeCredentialsAsync(){const C=this.credentials.access_token;if(this.credentials={},C)return this.revokeToken(C);throw new Error("No access token to revoke.")}request(C,y){if(y)this.requestAsync(C).then(o=>y(null,o),o=>y(o,o.response));else return this.requestAsync(C)}async requestAsync(C,y=!1){let o;try{const m=await this.getRequestMetadataAsync(C.url);C.headers=C.headers||{},m.headers&&m.headers["x-goog-user-project"]&&(C.headers["x-goog-user-project"]=m.headers["x-goog-user-project"]),m.headers&&m.headers.Authorization&&(C.headers.Authorization=m.headers.Authorization),this.apiKey&&(C.headers["X-Goog-Api-Key"]=this.apiKey),o=await this.transporter.request(C)}catch(m){const g=m.response;if(g){const S=g.status,i=this.credentials&&this.credentials.access_token&&this.credentials.refresh_token&&(!this.credentials.expiry_date||this.forceRefreshOnFailure),v=this.credentials&&this.credentials.access_token&&!this.credentials.refresh_token&&(!this.credentials.expiry_date||this.forceRefreshOnFailure)&&this.refreshHandler,E=g.config.data instanceof n.Readable,I=S===401||S===403;if(!y&&I&&!E&&i)return await this.refreshAccessTokenAsync(),this.requestAsync(C,!0);if(!y&&I&&!E&&v){const B=await this.processAndValidateRefreshHandler();return B!=null&&B.access_token&&this.setCredentials(B),this.requestAsync(C,!0)}}throw m}return o}verifyIdToken(C,y){if(y&&typeof y!="function")throw new Error("This method accepts an options object as the first parameter, which includes the idToken, audience, and maxExpiry.");if(y)this.verifyIdTokenAsync(C).then(o=>y(null,o),y);else return this.verifyIdTokenAsync(C)}async verifyIdTokenAsync(C){if(!C.idToken)throw new Error("The verifyIdToken method requires an ID Token");const y=await this.getFederatedSignonCertsAsync();return await this.verifySignedJwtWithCertsAsync(C.idToken,y.certs,C.audience,f.ISSUERS_,C.maxExpiry)}async getTokenInfo(C){const{data:y}=await this.transporter.request({method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:`Bearer ${C}`},url:f.GOOGLE_TOKEN_INFO_URL}),o=Object.assign({expiry_date:new Date().getTime()+y.expires_in*1e3,scopes:y.scope.split(" ")},y);return delete o.expires_in,delete o.scope,o}getFederatedSignonCerts(C){if(C)this.getFederatedSignonCertsAsync().then(y=>C(null,y.certs,y.res),C);else return this.getFederatedSignonCertsAsync()}async getFederatedSignonCertsAsync(){const C=new Date().getTime(),y=(0,c.hasBrowserCrypto)()?p.JWK:p.PEM;if(this.certificateExpiry&&C<this.certificateExpiry.getTime()&&this.certificateCacheFormat===y)return{certs:this.certificateCache,format:y};let o,m;switch(y){case p.PEM:m=f.GOOGLE_OAUTH2_FEDERATED_SIGNON_PEM_CERTS_URL_;break;case p.JWK:m=f.GOOGLE_OAUTH2_FEDERATED_SIGNON_JWK_CERTS_URL_;break;default:throw new Error(`Unsupported certificate format ${y}`)}try{o=await this.transporter.request({url:m})}catch(E){throw E instanceof Error&&(E.message=`Failed to retrieve verification certificates: ${E.message}`),E}const g=o?o.headers["cache-control"]:void 0;let S=-1;if(g){const I=new RegExp("max-age=([0-9]*)").exec(g);I&&I.length===2&&(S=Number(I[1])*1e3)}let i={};switch(y){case p.PEM:i=o.data;break;case p.JWK:for(const E of o.data.keys)i[E.kid]=E;break;default:throw new Error(`Unsupported certificate format ${y}`)}const v=new Date;return this.certificateExpiry=S===-1?null:new Date(v.getTime()+S),this.certificateCache=i,this.certificateCacheFormat=y,{certs:i,format:y,res:o}}getIapPublicKeys(C){if(C)this.getIapPublicKeysAsync().then(y=>C(null,y.pubkeys,y.res),C);else return this.getIapPublicKeysAsync()}async getIapPublicKeysAsync(){let C;const y=f.GOOGLE_OAUTH2_IAP_PUBLIC_KEY_URL_;try{C=await this.transporter.request({url:y})}catch(o){throw o instanceof Error&&(o.message=`Failed to retrieve verification certificates: ${o.message}`),o}return{pubkeys:C.data,res:C}}verifySignedJwtWithCerts(){throw new Error("verifySignedJwtWithCerts is removed, please use verifySignedJwtWithCertsAsync instead.")}async verifySignedJwtWithCertsAsync(C,y,o,m,g){const S=(0,c.createCrypto)();g||(g=f.MAX_TOKEN_LIFETIME_SECS_);const i=C.split(".");if(i.length!==3)throw new Error("Wrong number of segments in token: "+C);const v=i[0]+"."+i[1];let E=i[2],I,B;try{I=JSON.parse(S.decodeBase64StringUtf8(i[0]))}catch(q){throw q instanceof Error&&(q.message=`Can't parse token envelope: ${i[0]}': ${q.message}`),q}if(!I)throw new Error("Can't parse token envelope: "+i[0]);try{B=JSON.parse(S.decodeBase64StringUtf8(i[1]))}catch(q){throw q instanceof Error&&(q.message=`Can't parse token payload '${i[0]}`),q}if(!B)throw new Error("Can't parse token payload: "+i[1]);if(!Object.prototype.hasOwnProperty.call(y,I.kid))throw new Error("No pem found for envelope: "+JSON.stringify(I));const T=y[I.kid];if(I.alg==="ES256"&&(E=s.joseToDer(E,"ES256").toString("base64")),!await S.verify(T,v,E))throw new Error("Invalid token signature: "+C);if(!B.iat)throw new Error("No issue time in token: "+JSON.stringify(B));if(!B.exp)throw new Error("No expiration time in token: "+JSON.stringify(B));const l=Number(B.iat);if(isNaN(l))throw new Error("iat field using invalid format");const R=Number(B.exp);if(isNaN(R))throw new Error("exp field using invalid format");const N=new Date().getTime()/1e3;if(R>=N+g)throw new Error("Expiration time too far in future: "+JSON.stringify(B));const F=l-f.CLOCK_SKEW_SECS_,D=R+f.CLOCK_SKEW_SECS_;if(N<F)throw new Error("Token used too early, "+N+" < "+F+": "+JSON.stringify(B));if(N>D)throw new Error("Token used too late, "+N+" > "+D+": "+JSON.stringify(B));if(m&&m.indexOf(B.iss)<0)throw new Error("Invalid issuer, expected one of ["+m+"], but got "+B.iss);if(typeof o<"u"&&o!==null){const q=B.aud;let j=!1;if(o.constructor===Array?j=o.indexOf(q)>-1:j=q===o,!j)throw new Error("Wrong recipient, payload audience != requiredAudience")}return new a.LoginTicket(I,B)}async processAndValidateRefreshHandler(){if(this.refreshHandler){const C=await this.refreshHandler();if(!C.access_token)throw new Error("No access token is returned by the refreshHandler callback.");return C}}isTokenExpiring(){const C=this.credentials.expiry_date;return C?C<=new Date().getTime()+this.eagerRefreshThresholdMillis:!1}}t.OAuth2Client=f,f.GOOGLE_TOKEN_INFO_URL="https://oauth2.googleapis.com/tokeninfo",f.GOOGLE_OAUTH2_AUTH_BASE_URL_="https://accounts.google.com/o/oauth2/v2/auth",f.GOOGLE_OAUTH2_TOKEN_URL_="https://oauth2.googleapis.com/token",f.GOOGLE_OAUTH2_REVOKE_URL_="https://oauth2.googleapis.com/revoke",f.GOOGLE_OAUTH2_FEDERATED_SIGNON_PEM_CERTS_URL_="https://www.googleapis.com/oauth2/v1/certs",f.GOOGLE_OAUTH2_FEDERATED_SIGNON_JWK_CERTS_URL_="https://www.googleapis.com/oauth2/v3/certs",f.GOOGLE_OAUTH2_IAP_PUBLIC_KEY_URL_="https://www.gstatic.com/iap/verify/public_key",f.CLOCK_SKEW_SECS_=300,f.MAX_TOKEN_LIFETIME_SECS_=86400,f.ISSUERS_=["accounts.google.com","https://accounts.google.com"]})(ir);Object.defineProperty(Jr,"__esModule",{value:!0});Jr.Compute=void 0;const v0=n0,m0=At,eo=Wn,E0=ir;class C0 extends E0.OAuth2Client{constructor(e={}){super(e),this.credentials={expiry_date:1,refresh_token:"compute-placeholder"},this.serviceAccountEmail=e.serviceAccountEmail||"default",this.scopes=v0(e.scopes)}async refreshTokenNoCache(e){const r=`service-accounts/${this.serviceAccountEmail}/token`;let n;try{const c={property:r};this.scopes.length>0&&(c.params={scopes:this.scopes.join(",")}),n=await eo.instance(c)}catch(c){throw c instanceof m0.GaxiosError&&(c.message=`Could not refresh access token: ${c.message}`,this.wrapError(c)),c}const s=n;return n&&n.expires_in&&(s.expiry_date=new Date().getTime()+n.expires_in*1e3,delete s.expires_in),this.emit("tokens",s),{tokens:s,res:null}}async fetchIdToken(e){const r=`service-accounts/${this.serviceAccountEmail}/identity?format=full&audience=${e}`;let n;try{const s={property:r};n=await eo.instance(s)}catch(s){throw s instanceof Error&&(s.message=`Could not fetch ID token: ${s.message}`),s}return n}wrapError(e){const r=e.response;r&&r.status&&(e.code=r.status.toString(),r.status===403?e.message="A Forbidden error was returned while attempting to retrieve an access token for the Compute Engine built-in service account. This may be because the Compute Engine instance does not have the correct permission scopes specified: "+e.message:r.status===404&&(e.message="A Not Found error was returned while attempting to retrieve an accesstoken for the Compute Engine built-in service account. This may be because the Compute Engine instance does not have any permission scopes specified: "+e.message))}}Jr.Compute=C0;var en={};Object.defineProperty(en,"__esModule",{value:!0});en.IdTokenClient=void 0;const S0=ir;class A0 extends S0.OAuth2Client{constructor(e){super(),this.targetAudience=e.targetAudience,this.idTokenProvider=e.idTokenProvider}async getRequestMetadataAsync(e){if(!this.credentials.id_token||(this.credentials.expiry_date||0)<Date.now()){const n=await this.idTokenProvider.fetchIdToken(this.targetAudience);this.credentials={id_token:n,expiry_date:this.getIdTokenExpiryDate(n)}}return{headers:{Authorization:"Bearer "+this.credentials.id_token}}}getIdTokenExpiryDate(e){const r=e.split(".")[1];if(r)return JSON.parse(Buffer.from(r,"base64").toString("ascii")).exp*1e3}}en.IdTokenClient=A0;var us={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.getEnv=t.clear=t.GCPEnv=void 0;const e=Wn;var r;(function(y){y.APP_ENGINE="APP_ENGINE",y.KUBERNETES_ENGINE="KUBERNETES_ENGINE",y.CLOUD_FUNCTIONS="CLOUD_FUNCTIONS",y.COMPUTE_ENGINE="COMPUTE_ENGINE",y.CLOUD_RUN="CLOUD_RUN",y.NONE="NONE"})(r=t.GCPEnv||(t.GCPEnv={}));let n;function s(){n=void 0}t.clear=s;async function c(){return n||(n=u(),n)}t.getEnv=c;async function u(){let y=r.NONE;return a()?y=r.APP_ENGINE:p()?y=r.CLOUD_FUNCTIONS:await C()?await A()?y=r.KUBERNETES_ENGINE:f()?y=r.CLOUD_RUN:y=r.COMPUTE_ENGINE:y=r.NONE,y}function a(){return!!(process.env.GAE_SERVICE||process.env.GAE_MODULE_NAME)}function p(){return!!(process.env.FUNCTION_NAME||process.env.FUNCTION_TARGET)}function f(){return!!process.env.K_CONFIGURATION}async function A(){try{return await e.instance("attributes/cluster-name"),!0}catch{return!1}}async function C(){return e.isAvailable()}})(us);var tn={},ra={},Ot={},Fn=Xr.Buffer,T0=Nt,x0=Pt;function na(t){if(this.buffer=null,this.writable=!0,this.readable=!0,!t)return this.buffer=Fn.alloc(0),this;if(typeof t.pipe=="function")return this.buffer=Fn.alloc(0),t.pipe(this),this;if(t.length||typeof t=="object")return this.buffer=t,this.writable=!1,process.nextTick(function(){this.emit("end",t),this.readable=!1,this.emit("close")}.bind(this)),this;throw new TypeError("Unexpected data type ("+typeof t+")")}x0.inherits(na,T0);na.prototype.write=function(e){this.buffer=Fn.concat([this.buffer,Fn.from(e)]),this.emit("data",e)};na.prototype.end=function(e){e&&this.write(e),this.emit("end",e),this.emit("close"),this.writable=!1,this.readable=!1};var iu=na,zr=zn.Buffer,ls=zn.SlowBuffer,_0=Mn;function Mn(t,e){if(!zr.isBuffer(t)||!zr.isBuffer(e)||t.length!==e.length)return!1;for(var r=0,n=0;n<t.length;n++)r|=t[n]^e[n];return r===0}Mn.install=function(){zr.prototype.equal=ls.prototype.equal=function(e){return Mn(this,e)}};var w0=zr.prototype.equal,I0=ls.prototype.equal;Mn.restore=function(){zr.prototype.equal=w0,ls.prototype.equal=I0};var b0=_0,Ar=Xr.Buffer,St=Wr,su=au,to=Pt,B0=`"%s" is not a valid algorithm.
  Supported algorithms are:
  "HS256", "HS384", "HS512", "RS256", "RS384", "RS512", "PS256", "PS384", "PS512", "ES256", "ES384", "ES512" and "none".`,qr="secret must be a string or buffer",gr="key must be a string or a buffer",R0="key must be a string, a buffer or an object",fs=typeof St.createPublicKey=="function";fs&&(gr+=" or a KeyObject",qr+="or a KeyObject");function ou(t){if(!Ar.isBuffer(t)&&typeof t!="string"&&(!fs||typeof t!="object"||typeof t.type!="string"||typeof t.asymmetricKeyType!="string"||typeof t.export!="function"))throw pt(gr)}function cu(t){if(!Ar.isBuffer(t)&&typeof t!="string"&&typeof t!="object")throw pt(R0)}function N0(t){if(!Ar.isBuffer(t)){if(typeof t=="string")return t;if(!fs||typeof t!="object"||t.type!=="secret"||typeof t.export!="function")throw pt(qr)}}function ds(t){return t.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function uu(t){t=t.toString();var e=4-t.length%4;if(e!==4)for(var r=0;r<e;++r)t+="=";return t.replace(/\-/g,"+").replace(/_/g,"/")}function pt(t){var e=[].slice.call(arguments,1),r=to.format.bind(to,t).apply(null,e);return new TypeError(r)}function P0(t){return Ar.isBuffer(t)||typeof t=="string"}function rn(t){return P0(t)||(t=JSON.stringify(t)),t}function lu(t){return function(r,n){N0(n),r=rn(r);var s=St.createHmac("sha"+t,n),c=(s.update(r),s.digest("base64"));return ds(c)}}function O0(t){return function(r,n,s){var c=lu(t)(r,s);return b0(Ar.from(n),Ar.from(c))}}function fu(t){return function(r,n){cu(n),r=rn(r);var s=St.createSign("RSA-SHA"+t),c=(s.update(r),s.sign(n,"base64"));return ds(c)}}function du(t){return function(r,n,s){ou(s),r=rn(r),n=uu(n);var c=St.createVerify("RSA-SHA"+t);return c.update(r),c.verify(s,n,"base64")}}function U0(t){return function(r,n){cu(n),r=rn(r);var s=St.createSign("RSA-SHA"+t),c=(s.update(r),s.sign({key:n,padding:St.constants.RSA_PKCS1_PSS_PADDING,saltLength:St.constants.RSA_PSS_SALTLEN_DIGEST},"base64"));return ds(c)}}function k0(t){return function(r,n,s){ou(s),r=rn(r),n=uu(n);var c=St.createVerify("RSA-SHA"+t);return c.update(r),c.verify({key:s,padding:St.constants.RSA_PKCS1_PSS_PADDING,saltLength:St.constants.RSA_PSS_SALTLEN_DIGEST},n,"base64")}}function D0(t){var e=fu(t);return function(){var n=e.apply(null,arguments);return n=su.derToJose(n,"ES"+t),n}}function L0(t){var e=du(t);return function(n,s,c){s=su.joseToDer(s,"ES"+t).toString("base64");var u=e(n,s,c);return u}}function F0(){return function(){return""}}function M0(){return function(e,r){return r===""}}var hu=function(e){var r={hs:lu,rs:fu,ps:U0,es:D0,none:F0},n={hs:O0,rs:du,ps:k0,es:L0,none:M0},s=e.match(/^(RS|PS|ES|HS)(256|384|512)$|^(none)$/);if(!s)throw pt(B0,e);var c=(s[1]||s[3]).toLowerCase(),u=s[2];return{sign:r[c](u),verify:n[c](u)}},q0=zn.Buffer,pu=function(e){return typeof e=="string"?e:typeof e=="number"||q0.isBuffer(e)?e.toString():JSON.stringify(e)},V0=Xr.Buffer,ro=iu,K0=hu,$0=Nt,no=pu,hs=Pt;function ao(t,e){return V0.from(t,e).toString("base64").replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function G0(t,e,r){r=r||"utf8";var n=ao(no(t),"binary"),s=ao(no(e),r);return hs.format("%s.%s",n,s)}function yu(t){var e=t.header,r=t.payload,n=t.secret||t.privateKey,s=t.encoding,c=K0(e.alg),u=G0(e,r,s),a=c.sign(u,n);return hs.format("%s.%s",u,a)}function aa(t){var e=t.secret||t.privateKey||t.key,r=new ro(e);this.readable=!0,this.header=t.header,this.encoding=t.encoding,this.secret=this.privateKey=this.key=r,this.payload=new ro(t.payload),this.secret.once("close",function(){!this.payload.writable&&this.readable&&this.sign()}.bind(this)),this.payload.once("close",function(){!this.secret.writable&&this.readable&&this.sign()}.bind(this))}hs.inherits(aa,$0);aa.prototype.sign=function(){try{var e=yu({header:this.header,payload:this.payload.buffer,secret:this.secret.buffer,encoding:this.encoding});return this.emit("done",e),this.emit("data",e),this.emit("end"),this.readable=!1,e}catch(r){this.readable=!1,this.emit("error",r),this.emit("close")}};aa.sign=yu;var j0=aa,gu=Xr.Buffer,io=iu,H0=hu,z0=Nt,vu=pu,W0=Pt,Q0=/^[a-zA-Z0-9\-_]+?\.[a-zA-Z0-9\-_]+?\.([a-zA-Z0-9\-_]+)?$/;function Y0(t){return Object.prototype.toString.call(t)==="[object Object]"}function J0(t){if(Y0(t))return t;try{return JSON.parse(t)}catch{return}}function mu(t){var e=t.split(".",1)[0];return J0(gu.from(e,"base64").toString("binary"))}function X0(t){return t.split(".",2).join(".")}function Eu(t){return t.split(".")[2]}function Z0(t,e){e=e||"utf8";var r=t.split(".")[1];return gu.from(r,"base64").toString(e)}function Cu(t){return Q0.test(t)&&!!mu(t)}function Su(t,e,r){if(!e){var n=new Error("Missing algorithm parameter for jws.verify");throw n.code="MISSING_ALGORITHM",n}t=vu(t);var s=Eu(t),c=X0(t),u=H0(e);return u.verify(c,s,r)}function Au(t,e){if(e=e||{},t=vu(t),!Cu(t))return null;var r=mu(t);if(!r)return null;var n=Z0(t);return(r.typ==="JWT"||e.json)&&(n=JSON.parse(n,e.encoding)),{header:r,payload:n,signature:Eu(t)}}function br(t){t=t||{};var e=t.secret||t.publicKey||t.key,r=new io(e);this.readable=!0,this.algorithm=t.algorithm,this.encoding=t.encoding,this.secret=this.publicKey=this.key=r,this.signature=new io(t.signature),this.secret.once("close",function(){!this.signature.writable&&this.readable&&this.verify()}.bind(this)),this.signature.once("close",function(){!this.secret.writable&&this.readable&&this.verify()}.bind(this))}W0.inherits(br,z0);br.prototype.verify=function(){try{var e=Su(this.signature.buffer,this.algorithm,this.key.buffer),r=Au(this.signature.buffer,this.encoding);return this.emit("done",e,r),this.emit("data",e),this.emit("end"),this.readable=!1,e}catch(n){this.readable=!1,this.emit("error",n),this.emit("close")}};br.decode=Au;br.isValid=Cu;br.verify=Su;var ed=br,Tu=j0,ia=ed,td=["HS256","HS384","HS512","RS256","RS384","RS512","PS256","PS384","PS512","ES256","ES384","ES512"];Ot.ALGORITHMS=td;Ot.sign=Tu.sign;Ot.verify=ia.verify;Ot.decode=ia.decode;Ot.isValid=ia.isValid;Ot.createSign=function(e){return new Tu(e)};Ot.createVerify=function(e){return new ia(e)};var Ur={},Ua,so;function me(){return so||(so=1,Ua={options:{usePureJavaScript:!1}}),Ua}var ka={exports:{}},Da,oo;function rd(){if(oo)return Da;oo=1;var t={};Da=t;var e={};t.encode=function(n,s,c){if(typeof s!="string")throw new TypeError('"alphabet" must be a string.');if(c!==void 0&&typeof c!="number")throw new TypeError('"maxline" must be a number.');var u="";if(!(n instanceof Uint8Array))u=r(n,s);else{var a=0,p=s.length,f=s.charAt(0),A=[0];for(a=0;a<n.length;++a){for(var C=0,y=n[a];C<A.length;++C)y+=A[C]<<8,A[C]=y%p,y=y/p|0;for(;y>0;)A.push(y%p),y=y/p|0}for(a=0;n[a]===0&&a<n.length-1;++a)u+=f;for(a=A.length-1;a>=0;--a)u+=s[A[a]]}if(c){var o=new RegExp(".{1,"+c+"}","g");u=u.match(o).join(`\r
`)}return u},t.decode=function(n,s){if(typeof n!="string")throw new TypeError('"input" must be a string.');if(typeof s!="string")throw new TypeError('"alphabet" must be a string.');var c=e[s];if(!c){c=e[s]=[];for(var u=0;u<s.length;++u)c[s.charCodeAt(u)]=u}n=n.replace(/\s/g,"");for(var a=s.length,p=s.charAt(0),f=[0],u=0;u<n.length;u++){var A=c[n.charCodeAt(u)];if(A===void 0)return;for(var C=0,y=A;C<f.length;++C)y+=f[C]*a,f[C]=y&255,y>>=8;for(;y>0;)f.push(y&255),y>>=8}for(var o=0;n[o]===p&&o<n.length-1;++o)f.push(0);return typeof Buffer<"u"?Buffer.from(f.reverse()):new Uint8Array(f.reverse())};function r(n,s){var c=0,u=s.length,a=s.charAt(0),p=[0];for(c=0;c<n.length();++c){for(var f=0,A=n.at(c);f<p.length;++f)A+=p[f]<<8,p[f]=A%u,A=A/u|0;for(;A>0;)p.push(A%u),A=A/u|0}var C="";for(c=0;n.at(c)===0&&c<n.length()-1;++c)C+=a;for(c=p.length-1;c>=0;--c)C+=s[p[c]];return C}return Da}var co;function Ae(){if(co)return ka.exports;co=1;var t=me(),e=rd(),r=ka.exports=t.util=t.util||{};(function(){if(typeof process<"u"&&process.nextTick&&!process.browser){r.nextTick=process.nextTick,typeof setImmediate=="function"?r.setImmediate=setImmediate:r.setImmediate=r.nextTick;return}if(typeof setImmediate=="function"){r.setImmediate=function(){return setImmediate.apply(void 0,arguments)},r.nextTick=function(h){return setImmediate(h)};return}if(r.setImmediate=function(h){setTimeout(h,0)},typeof window<"u"&&typeof window.postMessage=="function"){let h=function(l){if(l.source===window&&l.data===i){l.stopPropagation();var R=v.slice();v.length=0,R.forEach(function(N){N()})}};var i="forge.setImmediate",v=[];r.setImmediate=function(l){v.push(l),v.length===1&&window.postMessage(i,"*")},window.addEventListener("message",h,!0)}if(typeof MutationObserver<"u"){var E=Date.now(),I=!0,B=document.createElement("div"),v=[];new MutationObserver(function(){var l=v.slice();v.length=0,l.forEach(function(R){R()})}).observe(B,{attributes:!0});var T=r.setImmediate;r.setImmediate=function(l){Date.now()-E>15?(E=Date.now(),T(l)):(v.push(l),v.length===1&&B.setAttribute("a",I=!I))}}r.nextTick=r.setImmediate})(),r.isNodejs=typeof process<"u"&&process.versions&&process.versions.node,r.globalScope=function(){return r.isNodejs?Be:typeof self>"u"?window:self}(),r.isArray=Array.isArray||function(i){return Object.prototype.toString.call(i)==="[object Array]"},r.isArrayBuffer=function(i){return typeof ArrayBuffer<"u"&&i instanceof ArrayBuffer},r.isArrayBufferView=function(i){return i&&r.isArrayBuffer(i.buffer)&&i.byteLength!==void 0};function n(i){if(!(i===8||i===16||i===24||i===32))throw new Error("Only 8, 16, 24, or 32 bits supported: "+i)}r.ByteBuffer=s;function s(i){if(this.data="",this.read=0,typeof i=="string")this.data=i;else if(r.isArrayBuffer(i)||r.isArrayBufferView(i))if(typeof Buffer<"u"&&i instanceof Buffer)this.data=i.toString("binary");else{var v=new Uint8Array(i);try{this.data=String.fromCharCode.apply(null,v)}catch{for(var E=0;E<v.length;++E)this.putByte(v[E])}}else(i instanceof s||typeof i=="object"&&typeof i.data=="string"&&typeof i.read=="number")&&(this.data=i.data,this.read=i.read);this._constructedStringLength=0}r.ByteStringBuffer=s;var c=4096;r.ByteStringBuffer.prototype._optimizeConstructedString=function(i){this._constructedStringLength+=i,this._constructedStringLength>c&&(this.data.substr(0,1),this._constructedStringLength=0)},r.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read},r.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0},r.ByteStringBuffer.prototype.putByte=function(i){return this.putBytes(String.fromCharCode(i))},r.ByteStringBuffer.prototype.fillWithByte=function(i,v){i=String.fromCharCode(i);for(var E=this.data;v>0;)v&1&&(E+=i),v>>>=1,v>0&&(i+=i);return this.data=E,this._optimizeConstructedString(v),this},r.ByteStringBuffer.prototype.putBytes=function(i){return this.data+=i,this._optimizeConstructedString(i.length),this},r.ByteStringBuffer.prototype.putString=function(i){return this.putBytes(r.encodeUtf8(i))},r.ByteStringBuffer.prototype.putInt16=function(i){return this.putBytes(String.fromCharCode(i>>8&255)+String.fromCharCode(i&255))},r.ByteStringBuffer.prototype.putInt24=function(i){return this.putBytes(String.fromCharCode(i>>16&255)+String.fromCharCode(i>>8&255)+String.fromCharCode(i&255))},r.ByteStringBuffer.prototype.putInt32=function(i){return this.putBytes(String.fromCharCode(i>>24&255)+String.fromCharCode(i>>16&255)+String.fromCharCode(i>>8&255)+String.fromCharCode(i&255))},r.ByteStringBuffer.prototype.putInt16Le=function(i){return this.putBytes(String.fromCharCode(i&255)+String.fromCharCode(i>>8&255))},r.ByteStringBuffer.prototype.putInt24Le=function(i){return this.putBytes(String.fromCharCode(i&255)+String.fromCharCode(i>>8&255)+String.fromCharCode(i>>16&255))},r.ByteStringBuffer.prototype.putInt32Le=function(i){return this.putBytes(String.fromCharCode(i&255)+String.fromCharCode(i>>8&255)+String.fromCharCode(i>>16&255)+String.fromCharCode(i>>24&255))},r.ByteStringBuffer.prototype.putInt=function(i,v){n(v);var E="";do v-=8,E+=String.fromCharCode(i>>v&255);while(v>0);return this.putBytes(E)},r.ByteStringBuffer.prototype.putSignedInt=function(i,v){return i<0&&(i+=2<<v-1),this.putInt(i,v)},r.ByteStringBuffer.prototype.putBuffer=function(i){return this.putBytes(i.getBytes())},r.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)},r.ByteStringBuffer.prototype.getInt16=function(){var i=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,i},r.ByteStringBuffer.prototype.getInt24=function(){var i=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,i},r.ByteStringBuffer.prototype.getInt32=function(){var i=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,i},r.ByteStringBuffer.prototype.getInt16Le=function(){var i=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,i},r.ByteStringBuffer.prototype.getInt24Le=function(){var i=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,i},r.ByteStringBuffer.prototype.getInt32Le=function(){var i=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,i},r.ByteStringBuffer.prototype.getInt=function(i){n(i);var v=0;do v=(v<<8)+this.data.charCodeAt(this.read++),i-=8;while(i>0);return v},r.ByteStringBuffer.prototype.getSignedInt=function(i){var v=this.getInt(i),E=2<<i-2;return v>=E&&(v-=E<<1),v},r.ByteStringBuffer.prototype.getBytes=function(i){var v;return i?(i=Math.min(this.length(),i),v=this.data.slice(this.read,this.read+i),this.read+=i):i===0?v="":(v=this.read===0?this.data:this.data.slice(this.read),this.clear()),v},r.ByteStringBuffer.prototype.bytes=function(i){return typeof i>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+i)},r.ByteStringBuffer.prototype.at=function(i){return this.data.charCodeAt(this.read+i)},r.ByteStringBuffer.prototype.setAt=function(i,v){return this.data=this.data.substr(0,this.read+i)+String.fromCharCode(v)+this.data.substr(this.read+i+1),this},r.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)},r.ByteStringBuffer.prototype.copy=function(){var i=r.createBuffer(this.data);return i.read=this.read,i},r.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this},r.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this},r.ByteStringBuffer.prototype.truncate=function(i){var v=Math.max(0,this.length()-i);return this.data=this.data.substr(this.read,v),this.read=0,this},r.ByteStringBuffer.prototype.toHex=function(){for(var i="",v=this.read;v<this.data.length;++v){var E=this.data.charCodeAt(v);E<16&&(i+="0"),i+=E.toString(16)}return i},r.ByteStringBuffer.prototype.toString=function(){return r.decodeUtf8(this.bytes())};function u(i,v){v=v||{},this.read=v.readOffset||0,this.growSize=v.growSize||1024;var E=r.isArrayBuffer(i),I=r.isArrayBufferView(i);if(E||I){E?this.data=new DataView(i):this.data=new DataView(i.buffer,i.byteOffset,i.byteLength),this.write="writeOffset"in v?v.writeOffset:this.data.byteLength;return}this.data=new DataView(new ArrayBuffer(0)),this.write=0,i!=null&&this.putBytes(i),"writeOffset"in v&&(this.write=v.writeOffset)}r.DataBuffer=u,r.DataBuffer.prototype.length=function(){return this.write-this.read},r.DataBuffer.prototype.isEmpty=function(){return this.length()<=0},r.DataBuffer.prototype.accommodate=function(i,v){if(this.length()>=i)return this;v=Math.max(v||this.growSize,i);var E=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),I=new Uint8Array(this.length()+v);return I.set(E),this.data=new DataView(I.buffer),this},r.DataBuffer.prototype.putByte=function(i){return this.accommodate(1),this.data.setUint8(this.write++,i),this},r.DataBuffer.prototype.fillWithByte=function(i,v){this.accommodate(v);for(var E=0;E<v;++E)this.data.setUint8(i);return this},r.DataBuffer.prototype.putBytes=function(i,v){if(r.isArrayBufferView(i)){var E=new Uint8Array(i.buffer,i.byteOffset,i.byteLength),I=E.byteLength-E.byteOffset;this.accommodate(I);var B=new Uint8Array(this.data.buffer,this.write);return B.set(E),this.write+=I,this}if(r.isArrayBuffer(i)){var E=new Uint8Array(i);this.accommodate(E.byteLength);var B=new Uint8Array(this.data.buffer);return B.set(E,this.write),this.write+=E.byteLength,this}if(i instanceof r.DataBuffer||typeof i=="object"&&typeof i.read=="number"&&typeof i.write=="number"&&r.isArrayBufferView(i.data)){var E=new Uint8Array(i.data.byteLength,i.read,i.length());this.accommodate(E.byteLength);var B=new Uint8Array(i.data.byteLength,this.write);return B.set(E),this.write+=E.byteLength,this}if(i instanceof r.ByteStringBuffer&&(i=i.data,v="binary"),v=v||"binary",typeof i=="string"){var T;if(v==="hex")return this.accommodate(Math.ceil(i.length/2)),T=new Uint8Array(this.data.buffer,this.write),this.write+=r.binary.hex.decode(i,T,this.write),this;if(v==="base64")return this.accommodate(Math.ceil(i.length/4)*3),T=new Uint8Array(this.data.buffer,this.write),this.write+=r.binary.base64.decode(i,T,this.write),this;if(v==="utf8"&&(i=r.encodeUtf8(i),v="binary"),v==="binary"||v==="raw")return this.accommodate(i.length),T=new Uint8Array(this.data.buffer,this.write),this.write+=r.binary.raw.decode(T),this;if(v==="utf16")return this.accommodate(i.length*2),T=new Uint16Array(this.data.buffer,this.write),this.write+=r.text.utf16.encode(T),this;throw new Error("Invalid encoding: "+v)}throw Error("Invalid parameter: "+i)},r.DataBuffer.prototype.putBuffer=function(i){return this.putBytes(i),i.clear(),this},r.DataBuffer.prototype.putString=function(i){return this.putBytes(i,"utf16")},r.DataBuffer.prototype.putInt16=function(i){return this.accommodate(2),this.data.setInt16(this.write,i),this.write+=2,this},r.DataBuffer.prototype.putInt24=function(i){return this.accommodate(3),this.data.setInt16(this.write,i>>8&65535),this.data.setInt8(this.write,i>>16&255),this.write+=3,this},r.DataBuffer.prototype.putInt32=function(i){return this.accommodate(4),this.data.setInt32(this.write,i),this.write+=4,this},r.DataBuffer.prototype.putInt16Le=function(i){return this.accommodate(2),this.data.setInt16(this.write,i,!0),this.write+=2,this},r.DataBuffer.prototype.putInt24Le=function(i){return this.accommodate(3),this.data.setInt8(this.write,i>>16&255),this.data.setInt16(this.write,i>>8&65535,!0),this.write+=3,this},r.DataBuffer.prototype.putInt32Le=function(i){return this.accommodate(4),this.data.setInt32(this.write,i,!0),this.write+=4,this},r.DataBuffer.prototype.putInt=function(i,v){n(v),this.accommodate(v/8);do v-=8,this.data.setInt8(this.write++,i>>v&255);while(v>0);return this},r.DataBuffer.prototype.putSignedInt=function(i,v){return n(v),this.accommodate(v/8),i<0&&(i+=2<<v-1),this.putInt(i,v)},r.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)},r.DataBuffer.prototype.getInt16=function(){var i=this.data.getInt16(this.read);return this.read+=2,i},r.DataBuffer.prototype.getInt24=function(){var i=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,i},r.DataBuffer.prototype.getInt32=function(){var i=this.data.getInt32(this.read);return this.read+=4,i},r.DataBuffer.prototype.getInt16Le=function(){var i=this.data.getInt16(this.read,!0);return this.read+=2,i},r.DataBuffer.prototype.getInt24Le=function(){var i=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,i},r.DataBuffer.prototype.getInt32Le=function(){var i=this.data.getInt32(this.read,!0);return this.read+=4,i},r.DataBuffer.prototype.getInt=function(i){n(i);var v=0;do v=(v<<8)+this.data.getInt8(this.read++),i-=8;while(i>0);return v},r.DataBuffer.prototype.getSignedInt=function(i){var v=this.getInt(i),E=2<<i-2;return v>=E&&(v-=E<<1),v},r.DataBuffer.prototype.getBytes=function(i){var v;return i?(i=Math.min(this.length(),i),v=this.data.slice(this.read,this.read+i),this.read+=i):i===0?v="":(v=this.read===0?this.data:this.data.slice(this.read),this.clear()),v},r.DataBuffer.prototype.bytes=function(i){return typeof i>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+i)},r.DataBuffer.prototype.at=function(i){return this.data.getUint8(this.read+i)},r.DataBuffer.prototype.setAt=function(i,v){return this.data.setUint8(i,v),this},r.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)},r.DataBuffer.prototype.copy=function(){return new r.DataBuffer(this)},r.DataBuffer.prototype.compact=function(){if(this.read>0){var i=new Uint8Array(this.data.buffer,this.read),v=new Uint8Array(i.byteLength);v.set(i),this.data=new DataView(v),this.write-=this.read,this.read=0}return this},r.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this},r.DataBuffer.prototype.truncate=function(i){return this.write=Math.max(0,this.length()-i),this.read=Math.min(this.read,this.write),this},r.DataBuffer.prototype.toHex=function(){for(var i="",v=this.read;v<this.data.byteLength;++v){var E=this.data.getUint8(v);E<16&&(i+="0"),i+=E.toString(16)}return i},r.DataBuffer.prototype.toString=function(i){var v=new Uint8Array(this.data,this.read,this.length());if(i=i||"utf8",i==="binary"||i==="raw")return r.binary.raw.encode(v);if(i==="hex")return r.binary.hex.encode(v);if(i==="base64")return r.binary.base64.encode(v);if(i==="utf8")return r.text.utf8.decode(v);if(i==="utf16")return r.text.utf16.decode(v);throw new Error("Invalid encoding: "+i)},r.createBuffer=function(i,v){return v=v||"raw",i!==void 0&&v==="utf8"&&(i=r.encodeUtf8(i)),new r.ByteBuffer(i)},r.fillString=function(i,v){for(var E="";v>0;)v&1&&(E+=i),v>>>=1,v>0&&(i+=i);return E},r.xorBytes=function(i,v,E){for(var I="",B="",T="",h=0,l=0;E>0;--E,++h)B=i.charCodeAt(h)^v.charCodeAt(h),l>=10&&(I+=T,T="",l=0),T+=String.fromCharCode(B),++l;return I+=T,I},r.hexToBytes=function(i){var v="",E=0;for(i.length&!0&&(E=1,v+=String.fromCharCode(parseInt(i[0],16)));E<i.length;E+=2)v+=String.fromCharCode(parseInt(i.substr(E,2),16));return v},r.bytesToHex=function(i){return r.createBuffer(i).toHex()},r.int32ToBytes=function(i){return String.fromCharCode(i>>24&255)+String.fromCharCode(i>>16&255)+String.fromCharCode(i>>8&255)+String.fromCharCode(i&255)};var a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",p=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],f="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";r.encode64=function(i,v){for(var E="",I="",B,T,h,l=0;l<i.length;)B=i.charCodeAt(l++),T=i.charCodeAt(l++),h=i.charCodeAt(l++),E+=a.charAt(B>>2),E+=a.charAt((B&3)<<4|T>>4),isNaN(T)?E+="==":(E+=a.charAt((T&15)<<2|h>>6),E+=isNaN(h)?"=":a.charAt(h&63)),v&&E.length>v&&(I+=E.substr(0,v)+`\r
`,E=E.substr(v));return I+=E,I},r.decode64=function(i){i=i.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var v="",E,I,B,T,h=0;h<i.length;)E=p[i.charCodeAt(h++)-43],I=p[i.charCodeAt(h++)-43],B=p[i.charCodeAt(h++)-43],T=p[i.charCodeAt(h++)-43],v+=String.fromCharCode(E<<2|I>>4),B!==64&&(v+=String.fromCharCode((I&15)<<4|B>>2),T!==64&&(v+=String.fromCharCode((B&3)<<6|T)));return v},r.encodeUtf8=function(i){return unescape(encodeURIComponent(i))},r.decodeUtf8=function(i){return decodeURIComponent(escape(i))},r.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:e.encode,decode:e.decode}},r.binary.raw.encode=function(i){return String.fromCharCode.apply(null,i)},r.binary.raw.decode=function(i,v,E){var I=v;I||(I=new Uint8Array(i.length)),E=E||0;for(var B=E,T=0;T<i.length;++T)I[B++]=i.charCodeAt(T);return v?B-E:I},r.binary.hex.encode=r.bytesToHex,r.binary.hex.decode=function(i,v,E){var I=v;I||(I=new Uint8Array(Math.ceil(i.length/2))),E=E||0;var B=0,T=E;for(i.length&1&&(B=1,I[T++]=parseInt(i[0],16));B<i.length;B+=2)I[T++]=parseInt(i.substr(B,2),16);return v?T-E:I},r.binary.base64.encode=function(i,v){for(var E="",I="",B,T,h,l=0;l<i.byteLength;)B=i[l++],T=i[l++],h=i[l++],E+=a.charAt(B>>2),E+=a.charAt((B&3)<<4|T>>4),isNaN(T)?E+="==":(E+=a.charAt((T&15)<<2|h>>6),E+=isNaN(h)?"=":a.charAt(h&63)),v&&E.length>v&&(I+=E.substr(0,v)+`\r
`,E=E.substr(v));return I+=E,I},r.binary.base64.decode=function(i,v,E){var I=v;I||(I=new Uint8Array(Math.ceil(i.length/4)*3)),i=i.replace(/[^A-Za-z0-9\+\/\=]/g,""),E=E||0;for(var B,T,h,l,R=0,N=E;R<i.length;)B=p[i.charCodeAt(R++)-43],T=p[i.charCodeAt(R++)-43],h=p[i.charCodeAt(R++)-43],l=p[i.charCodeAt(R++)-43],I[N++]=B<<2|T>>4,h!==64&&(I[N++]=(T&15)<<4|h>>2,l!==64&&(I[N++]=(h&3)<<6|l));return v?N-E:I.subarray(0,N)},r.binary.base58.encode=function(i,v){return r.binary.baseN.encode(i,f,v)},r.binary.base58.decode=function(i,v){return r.binary.baseN.decode(i,f,v)},r.text={utf8:{},utf16:{}},r.text.utf8.encode=function(i,v,E){i=r.encodeUtf8(i);var I=v;I||(I=new Uint8Array(i.length)),E=E||0;for(var B=E,T=0;T<i.length;++T)I[B++]=i.charCodeAt(T);return v?B-E:I},r.text.utf8.decode=function(i){return r.decodeUtf8(String.fromCharCode.apply(null,i))},r.text.utf16.encode=function(i,v,E){var I=v;I||(I=new Uint8Array(i.length*2));var B=new Uint16Array(I.buffer);E=E||0;for(var T=E,h=E,l=0;l<i.length;++l)B[h++]=i.charCodeAt(l),T+=2;return v?T-E:I},r.text.utf16.decode=function(i){return String.fromCharCode.apply(null,new Uint16Array(i.buffer))},r.deflate=function(i,v,E){if(v=r.decode64(i.deflate(r.encode64(v)).rval),E){var I=2,B=v.charCodeAt(1);B&32&&(I=6),v=v.substring(I,v.length-4)}return v},r.inflate=function(i,v,E){var I=i.inflate(r.encode64(v)).rval;return I===null?null:r.decode64(I)};var A=function(i,v,E){if(!i)throw new Error("WebStorage not available.");var I;if(E===null?I=i.removeItem(v):(E=r.encode64(JSON.stringify(E)),I=i.setItem(v,E)),typeof I<"u"&&I.rval!==!0){var B=new Error(I.error.message);throw B.id=I.error.id,B.name=I.error.name,B}},C=function(i,v){if(!i)throw new Error("WebStorage not available.");var E=i.getItem(v);if(i.init)if(E.rval===null){if(E.error){var I=new Error(E.error.message);throw I.id=E.error.id,I.name=E.error.name,I}E=null}else E=E.rval;return E!==null&&(E=JSON.parse(r.decode64(E))),E},y=function(i,v,E,I){var B=C(i,v);B===null&&(B={}),B[E]=I,A(i,v,B)},o=function(i,v,E){var I=C(i,v);return I!==null&&(I=E in I?I[E]:null),I},m=function(i,v,E){var I=C(i,v);if(I!==null&&E in I){delete I[E];var B=!0;for(var T in I){B=!1;break}B&&(I=null),A(i,v,I)}},g=function(i,v){A(i,v,null)},S=function(i,v,E){var I=null;typeof E>"u"&&(E=["web","flash"]);var B,T=!1,h=null;for(var l in E){B=E[l];try{if(B==="flash"||B==="both"){if(v[0]===null)throw new Error("Flash local storage not available.");I=i.apply(this,v),T=B==="flash"}(B==="web"||B==="both")&&(v[0]=localStorage,I=i.apply(this,v),T=!0)}catch(R){h=R}if(T)break}if(!T)throw h;return I};return r.setItem=function(i,v,E,I,B){S(y,arguments,B)},r.getItem=function(i,v,E,I){return S(o,arguments,I)},r.removeItem=function(i,v,E,I){S(m,arguments,I)},r.clearItems=function(i,v,E){S(g,arguments,E)},r.isEmpty=function(i){for(var v in i)if(i.hasOwnProperty(v))return!1;return!0},r.format=function(i){for(var v=/%./g,E,I,B=0,T=[],h=0;E=v.exec(i);){I=i.substring(h,v.lastIndex-2),I.length>0&&T.push(I),h=v.lastIndex;var l=E[0][1];switch(l){case"s":case"o":B<arguments.length?T.push(arguments[B+++1]):T.push("<?>");break;case"%":T.push("%");break;default:T.push("<%"+l+"?>")}}return T.push(i.substring(h)),T.join("")},r.formatNumber=function(i,v,E,I){var B=i,T=isNaN(v=Math.abs(v))?2:v,h=E===void 0?",":E,l=I===void 0?".":I,R=B<0?"-":"",N=parseInt(B=Math.abs(+B||0).toFixed(T),10)+"",F=N.length>3?N.length%3:0;return R+(F?N.substr(0,F)+l:"")+N.substr(F).replace(/(\d{3})(?=\d)/g,"$1"+l)+(T?h+Math.abs(B-N).toFixed(T).slice(2):"")},r.formatSize=function(i){return i>=1073741824?i=r.formatNumber(i/1073741824,2,".","")+" GiB":i>=1048576?i=r.formatNumber(i/1048576,2,".","")+" MiB":i>=1024?i=r.formatNumber(i/1024,0)+" KiB":i=r.formatNumber(i,0)+" bytes",i},r.bytesFromIP=function(i){return i.indexOf(".")!==-1?r.bytesFromIPv4(i):i.indexOf(":")!==-1?r.bytesFromIPv6(i):null},r.bytesFromIPv4=function(i){if(i=i.split("."),i.length!==4)return null;for(var v=r.createBuffer(),E=0;E<i.length;++E){var I=parseInt(i[E],10);if(isNaN(I))return null;v.putByte(I)}return v.getBytes()},r.bytesFromIPv6=function(i){var v=0;i=i.split(":").filter(function(h){return h.length===0&&++v,!0});for(var E=(8-i.length+v)*2,I=r.createBuffer(),B=0;B<8;++B){if(!i[B]||i[B].length===0){I.fillWithByte(0,E),E=0;continue}var T=r.hexToBytes(i[B]);T.length<2&&I.putByte(0),I.putBytes(T)}return I.getBytes()},r.bytesToIP=function(i){return i.length===4?r.bytesToIPv4(i):i.length===16?r.bytesToIPv6(i):null},r.bytesToIPv4=function(i){if(i.length!==4)return null;for(var v=[],E=0;E<i.length;++E)v.push(i.charCodeAt(E));return v.join(".")},r.bytesToIPv6=function(i){if(i.length!==16)return null;for(var v=[],E=[],I=0,B=0;B<i.length;B+=2){for(var T=r.bytesToHex(i[B]+i[B+1]);T[0]==="0"&&T!=="0";)T=T.substr(1);if(T==="0"){var h=E[E.length-1],l=v.length;!h||l!==h.end+1?E.push({start:l,end:l}):(h.end=l,h.end-h.start>E[I].end-E[I].start&&(I=E.length-1))}v.push(T)}if(E.length>0){var R=E[I];R.end-R.start>0&&(v.splice(R.start,R.end-R.start+1,""),R.start===0&&v.unshift(""),R.end===7&&v.push(""))}return v.join(":")},r.estimateCores=function(i,v){if(typeof i=="function"&&(v=i,i={}),i=i||{},"cores"in r&&!i.update)return v(null,r.cores);if(typeof navigator<"u"&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return r.cores=navigator.hardwareConcurrency,v(null,r.cores);if(typeof Worker>"u")return r.cores=1,v(null,r.cores);if(typeof Blob>"u")return r.cores=2,v(null,r.cores);var E=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(h){var l=Date.now(),R=l+4;self.postMessage({st:l,et:R})})}.toString(),")()"],{type:"application/javascript"}));I([],5,16);function I(h,l,R){if(l===0){var N=Math.floor(h.reduce(function(F,D){return F+D},0)/h.length);return r.cores=Math.max(1,N),URL.revokeObjectURL(E),v(null,r.cores)}B(R,function(F,D){h.push(T(R,D)),I(h,l-1,R)})}function B(h,l){for(var R=[],N=[],F=0;F<h;++F){var D=new Worker(E);D.addEventListener("message",function(q){if(N.push(q.data),N.length===h){for(var j=0;j<h;++j)R[j].terminate();l(null,N)}}),R.push(D)}for(var F=0;F<h;++F)R[F].postMessage(F)}function T(h,l){for(var R=[],N=0;N<h;++N)for(var F=l[N],D=R[N]=[],q=0;q<h;++q)if(N!==q){var j=l[q];(F.st>j.st&&F.st<j.et||j.st>F.st&&j.st<F.et)&&D.push(q)}return R.reduce(function(H,Q){return Math.max(H,Q.length)},0)}},ka.exports}var La,uo;function ps(){if(uo)return La;uo=1;var t=me();Ae(),La=t.cipher=t.cipher||{},t.cipher.algorithms=t.cipher.algorithms||{},t.cipher.createCipher=function(r,n){var s=r;if(typeof s=="string"&&(s=t.cipher.getAlgorithm(s),s&&(s=s())),!s)throw new Error("Unsupported algorithm: "+r);return new t.cipher.BlockCipher({algorithm:s,key:n,decrypt:!1})},t.cipher.createDecipher=function(r,n){var s=r;if(typeof s=="string"&&(s=t.cipher.getAlgorithm(s),s&&(s=s())),!s)throw new Error("Unsupported algorithm: "+r);return new t.cipher.BlockCipher({algorithm:s,key:n,decrypt:!0})},t.cipher.registerAlgorithm=function(r,n){r=r.toUpperCase(),t.cipher.algorithms[r]=n},t.cipher.getAlgorithm=function(r){return r=r.toUpperCase(),r in t.cipher.algorithms?t.cipher.algorithms[r]:null};var e=t.cipher.BlockCipher=function(r){this.algorithm=r.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=r.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=r.decrypt,this.algorithm.initialize(r)};return e.prototype.start=function(r){r=r||{};var n={};for(var s in r)n[s]=r[s];n.decrypt=this._decrypt,this._finish=!1,this._input=t.util.createBuffer(),this.output=r.output||t.util.createBuffer(),this.mode.start(n)},e.prototype.update=function(r){for(r&&this._input.putBuffer(r);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()},e.prototype.finish=function(r){r&&(this.mode.name==="ECB"||this.mode.name==="CBC")&&(this.mode.pad=function(s){return r(this.blockSize,s,!1)},this.mode.unpad=function(s){return r(this.blockSize,s,!0)});var n={};return n.decrypt=this._decrypt,n.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,n)||(this._finish=!0,this.update(),this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,n))||this.mode.afterFinish&&!this.mode.afterFinish(this.output,n))},La}var Fa={exports:{}},lo;function xu(){if(lo)return Fa.exports;lo=1;var t=me();Ae(),t.cipher=t.cipher||{};var e=Fa.exports=t.cipher.modes=t.cipher.modes||{};e.ecb=function(c){c=c||{},this.name="ECB",this.cipher=c.cipher,this.blockSize=c.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)},e.ecb.prototype.start=function(c){},e.ecb.prototype.encrypt=function(c,u,a){if(c.length()<this.blockSize&&!(a&&c.length()>0))return!0;for(var p=0;p<this._ints;++p)this._inBlock[p]=c.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var p=0;p<this._ints;++p)u.putInt32(this._outBlock[p])},e.ecb.prototype.decrypt=function(c,u,a){if(c.length()<this.blockSize&&!(a&&c.length()>0))return!0;for(var p=0;p<this._ints;++p)this._inBlock[p]=c.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var p=0;p<this._ints;++p)u.putInt32(this._outBlock[p])},e.ecb.prototype.pad=function(c,u){var a=c.length()===this.blockSize?this.blockSize:this.blockSize-c.length();return c.fillWithByte(a,a),!0},e.ecb.prototype.unpad=function(c,u){if(u.overflow>0)return!1;var a=c.length(),p=c.at(a-1);return p>this.blockSize<<2?!1:(c.truncate(p),!0)},e.cbc=function(c){c=c||{},this.name="CBC",this.cipher=c.cipher,this.blockSize=c.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)},e.cbc.prototype.start=function(c){if(c.iv===null){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else if("iv"in c)this._iv=r(c.iv,this.blockSize),this._prev=this._iv.slice(0);else throw new Error("Invalid IV parameter.")},e.cbc.prototype.encrypt=function(c,u,a){if(c.length()<this.blockSize&&!(a&&c.length()>0))return!0;for(var p=0;p<this._ints;++p)this._inBlock[p]=this._prev[p]^c.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var p=0;p<this._ints;++p)u.putInt32(this._outBlock[p]);this._prev=this._outBlock},e.cbc.prototype.decrypt=function(c,u,a){if(c.length()<this.blockSize&&!(a&&c.length()>0))return!0;for(var p=0;p<this._ints;++p)this._inBlock[p]=c.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var p=0;p<this._ints;++p)u.putInt32(this._prev[p]^this._outBlock[p]);this._prev=this._inBlock.slice(0)},e.cbc.prototype.pad=function(c,u){var a=c.length()===this.blockSize?this.blockSize:this.blockSize-c.length();return c.fillWithByte(a,a),!0},e.cbc.prototype.unpad=function(c,u){if(u.overflow>0)return!1;var a=c.length(),p=c.at(a-1);return p>this.blockSize<<2?!1:(c.truncate(p),!0)},e.cfb=function(c){c=c||{},this.name="CFB",this.cipher=c.cipher,this.blockSize=c.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=t.util.createBuffer(),this._partialBytes=0},e.cfb.prototype.start=function(c){if(!("iv"in c))throw new Error("Invalid IV parameter.");this._iv=r(c.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},e.cfb.prototype.encrypt=function(c,u,a){var p=c.length();if(p===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&p>=this.blockSize){for(var f=0;f<this._ints;++f)this._inBlock[f]=c.getInt32()^this._outBlock[f],u.putInt32(this._inBlock[f]);return}var A=(this.blockSize-p)%this.blockSize;A>0&&(A=this.blockSize-A),this._partialOutput.clear();for(var f=0;f<this._ints;++f)this._partialBlock[f]=c.getInt32()^this._outBlock[f],this._partialOutput.putInt32(this._partialBlock[f]);if(A>0)c.read-=this.blockSize;else for(var f=0;f<this._ints;++f)this._inBlock[f]=this._partialBlock[f];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),A>0&&!a)return u.putBytes(this._partialOutput.getBytes(A-this._partialBytes)),this._partialBytes=A,!0;u.putBytes(this._partialOutput.getBytes(p-this._partialBytes)),this._partialBytes=0},e.cfb.prototype.decrypt=function(c,u,a){var p=c.length();if(p===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&p>=this.blockSize){for(var f=0;f<this._ints;++f)this._inBlock[f]=c.getInt32(),u.putInt32(this._inBlock[f]^this._outBlock[f]);return}var A=(this.blockSize-p)%this.blockSize;A>0&&(A=this.blockSize-A),this._partialOutput.clear();for(var f=0;f<this._ints;++f)this._partialBlock[f]=c.getInt32(),this._partialOutput.putInt32(this._partialBlock[f]^this._outBlock[f]);if(A>0)c.read-=this.blockSize;else for(var f=0;f<this._ints;++f)this._inBlock[f]=this._partialBlock[f];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),A>0&&!a)return u.putBytes(this._partialOutput.getBytes(A-this._partialBytes)),this._partialBytes=A,!0;u.putBytes(this._partialOutput.getBytes(p-this._partialBytes)),this._partialBytes=0},e.ofb=function(c){c=c||{},this.name="OFB",this.cipher=c.cipher,this.blockSize=c.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=t.util.createBuffer(),this._partialBytes=0},e.ofb.prototype.start=function(c){if(!("iv"in c))throw new Error("Invalid IV parameter.");this._iv=r(c.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},e.ofb.prototype.encrypt=function(c,u,a){var p=c.length();if(c.length()===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&p>=this.blockSize){for(var f=0;f<this._ints;++f)u.putInt32(c.getInt32()^this._outBlock[f]),this._inBlock[f]=this._outBlock[f];return}var A=(this.blockSize-p)%this.blockSize;A>0&&(A=this.blockSize-A),this._partialOutput.clear();for(var f=0;f<this._ints;++f)this._partialOutput.putInt32(c.getInt32()^this._outBlock[f]);if(A>0)c.read-=this.blockSize;else for(var f=0;f<this._ints;++f)this._inBlock[f]=this._outBlock[f];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),A>0&&!a)return u.putBytes(this._partialOutput.getBytes(A-this._partialBytes)),this._partialBytes=A,!0;u.putBytes(this._partialOutput.getBytes(p-this._partialBytes)),this._partialBytes=0},e.ofb.prototype.decrypt=e.ofb.prototype.encrypt,e.ctr=function(c){c=c||{},this.name="CTR",this.cipher=c.cipher,this.blockSize=c.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=t.util.createBuffer(),this._partialBytes=0},e.ctr.prototype.start=function(c){if(!("iv"in c))throw new Error("Invalid IV parameter.");this._iv=r(c.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},e.ctr.prototype.encrypt=function(c,u,a){var p=c.length();if(p===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&p>=this.blockSize)for(var f=0;f<this._ints;++f)u.putInt32(c.getInt32()^this._outBlock[f]);else{var A=(this.blockSize-p)%this.blockSize;A>0&&(A=this.blockSize-A),this._partialOutput.clear();for(var f=0;f<this._ints;++f)this._partialOutput.putInt32(c.getInt32()^this._outBlock[f]);if(A>0&&(c.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),A>0&&!a)return u.putBytes(this._partialOutput.getBytes(A-this._partialBytes)),this._partialBytes=A,!0;u.putBytes(this._partialOutput.getBytes(p-this._partialBytes)),this._partialBytes=0}n(this._inBlock)},e.ctr.prototype.decrypt=e.ctr.prototype.encrypt,e.gcm=function(c){c=c||{},this.name="GCM",this.cipher=c.cipher,this.blockSize=c.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=t.util.createBuffer(),this._partialBytes=0,this._R=3774873600},e.gcm.prototype.start=function(c){if(!("iv"in c))throw new Error("Invalid IV parameter.");var u=t.util.createBuffer(c.iv);this._cipherLength=0;var a;if("additionalData"in c?a=t.util.createBuffer(c.additionalData):a=t.util.createBuffer(),"tagLength"in c?this._tagLength=c.tagLength:this._tagLength=128,this._tag=null,c.decrypt&&(this._tag=t.util.createBuffer(c.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var p=u.length();if(p===12)this._j0=[u.getInt32(),u.getInt32(),u.getInt32(),1];else{for(this._j0=[0,0,0,0];u.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[u.getInt32(),u.getInt32(),u.getInt32(),u.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(s(p*8)))}this._inBlock=this._j0.slice(0),n(this._inBlock),this._partialBytes=0,a=t.util.createBuffer(a),this._aDataLength=s(a.length()*8);var f=a.length()%this.blockSize;for(f&&a.fillWithByte(0,this.blockSize-f),this._s=[0,0,0,0];a.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[a.getInt32(),a.getInt32(),a.getInt32(),a.getInt32()])},e.gcm.prototype.encrypt=function(c,u,a){var p=c.length();if(p===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&p>=this.blockSize){for(var f=0;f<this._ints;++f)u.putInt32(this._outBlock[f]^=c.getInt32());this._cipherLength+=this.blockSize}else{var A=(this.blockSize-p)%this.blockSize;A>0&&(A=this.blockSize-A),this._partialOutput.clear();for(var f=0;f<this._ints;++f)this._partialOutput.putInt32(c.getInt32()^this._outBlock[f]);if(A<=0||a){if(a){var C=p%this.blockSize;this._cipherLength+=C,this._partialOutput.truncate(this.blockSize-C)}else this._cipherLength+=this.blockSize;for(var f=0;f<this._ints;++f)this._outBlock[f]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),A>0&&!a)return c.read-=this.blockSize,u.putBytes(this._partialOutput.getBytes(A-this._partialBytes)),this._partialBytes=A,!0;u.putBytes(this._partialOutput.getBytes(p-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),n(this._inBlock)},e.gcm.prototype.decrypt=function(c,u,a){var p=c.length();if(p<this.blockSize&&!(a&&p>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),n(this._inBlock),this._hashBlock[0]=c.getInt32(),this._hashBlock[1]=c.getInt32(),this._hashBlock[2]=c.getInt32(),this._hashBlock[3]=c.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var f=0;f<this._ints;++f)u.putInt32(this._outBlock[f]^this._hashBlock[f]);p<this.blockSize?this._cipherLength+=p%this.blockSize:this._cipherLength+=this.blockSize},e.gcm.prototype.afterFinish=function(c,u){var a=!0;u.decrypt&&u.overflow&&c.truncate(this.blockSize-u.overflow),this.tag=t.util.createBuffer();var p=this._aDataLength.concat(s(this._cipherLength*8));this._s=this.ghash(this._hashSubkey,this._s,p);var f=[];this.cipher.encrypt(this._j0,f);for(var A=0;A<this._ints;++A)this.tag.putInt32(this._s[A]^f[A]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),u.decrypt&&this.tag.bytes()!==this._tag&&(a=!1),a},e.gcm.prototype.multiply=function(c,u){for(var a=[0,0,0,0],p=u.slice(0),f=0;f<128;++f){var A=c[f/32|0]&1<<31-f%32;A&&(a[0]^=p[0],a[1]^=p[1],a[2]^=p[2],a[3]^=p[3]),this.pow(p,p)}return a},e.gcm.prototype.pow=function(c,u){for(var a=c[3]&1,p=3;p>0;--p)u[p]=c[p]>>>1|(c[p-1]&1)<<31;u[0]=c[0]>>>1,a&&(u[0]^=this._R)},e.gcm.prototype.tableMultiply=function(c){for(var u=[0,0,0,0],a=0;a<32;++a){var p=a/8|0,f=c[p]>>>(7-a%8)*4&15,A=this._m[a][f];u[0]^=A[0],u[1]^=A[1],u[2]^=A[2],u[3]^=A[3]}return u},e.gcm.prototype.ghash=function(c,u,a){return u[0]^=a[0],u[1]^=a[1],u[2]^=a[2],u[3]^=a[3],this.tableMultiply(u)},e.gcm.prototype.generateHashTable=function(c,u){for(var a=8/u,p=4*a,f=16*a,A=new Array(f),C=0;C<f;++C){var y=[0,0,0,0],o=C/p|0,m=(p-1-C%p)*u;y[o]=1<<u-1<<m,A[C]=this.generateSubHashTable(this.multiply(y,c),u)}return A},e.gcm.prototype.generateSubHashTable=function(c,u){var a=1<<u,p=a>>>1,f=new Array(a);f[p]=c.slice(0);for(var A=p>>>1;A>0;)this.pow(f[2*A],f[A]=[]),A>>=1;for(A=2;A<p;){for(var C=1;C<A;++C){var y=f[A],o=f[C];f[A+C]=[y[0]^o[0],y[1]^o[1],y[2]^o[2],y[3]^o[3]]}A*=2}for(f[0]=[0,0,0,0],A=p+1;A<a;++A){var m=f[A^p];f[A]=[c[0]^m[0],c[1]^m[1],c[2]^m[2],c[3]^m[3]]}return f};function r(c,u){if(typeof c=="string"&&(c=t.util.createBuffer(c)),t.util.isArray(c)&&c.length>4){var a=c;c=t.util.createBuffer();for(var p=0;p<a.length;++p)c.putByte(a[p])}if(c.length()<u)throw new Error("Invalid IV length; got "+c.length()+" bytes and expected "+u+" bytes.");if(!t.util.isArray(c)){for(var f=[],A=u/4,p=0;p<A;++p)f.push(c.getInt32());c=f}return c}function n(c){c[c.length-1]=c[c.length-1]+1&4294967295}function s(c){return[c/4294967296|0,c&4294967295]}return Fa.exports}var Ma,fo;function sr(){if(fo)return Ma;fo=1;var t=me();ps(),xu(),Ae(),Ma=t.aes=t.aes||{},t.aes.startEncrypting=function(o,m,g,S){var i=y({key:o,output:g,decrypt:!1,mode:S});return i.start(m),i},t.aes.createEncryptionCipher=function(o,m){return y({key:o,output:null,decrypt:!1,mode:m})},t.aes.startDecrypting=function(o,m,g,S){var i=y({key:o,output:g,decrypt:!0,mode:S});return i.start(m),i},t.aes.createDecryptionCipher=function(o,m){return y({key:o,output:null,decrypt:!0,mode:m})},t.aes.Algorithm=function(o,m){r||f();var g=this;g.name=o,g.mode=new m({blockSize:16,cipher:{encrypt:function(S,i){return C(g._w,S,i,!1)},decrypt:function(S,i){return C(g._w,S,i,!0)}}}),g._init=!1},t.aes.Algorithm.prototype.initialize=function(o){if(!this._init){var m=o.key,g;if(typeof m=="string"&&(m.length===16||m.length===24||m.length===32))m=t.util.createBuffer(m);else if(t.util.isArray(m)&&(m.length===16||m.length===24||m.length===32)){g=m,m=t.util.createBuffer();for(var S=0;S<g.length;++S)m.putByte(g[S])}if(!t.util.isArray(m)){g=m,m=[];var i=g.length();if(i===16||i===24||i===32){i=i>>>2;for(var S=0;S<i;++S)m.push(g.getInt32())}}if(!t.util.isArray(m)||!(m.length===4||m.length===6||m.length===8))throw new Error("Invalid key parameter.");var v=this.mode.name,E=["CFB","OFB","CTR","GCM"].indexOf(v)!==-1;this._w=A(m,o.decrypt&&!E),this._init=!0}},t.aes._expandKey=function(o,m){return r||f(),A(o,m)},t.aes._updateBlock=C,e("AES-ECB",t.cipher.modes.ecb),e("AES-CBC",t.cipher.modes.cbc),e("AES-CFB",t.cipher.modes.cfb),e("AES-OFB",t.cipher.modes.ofb),e("AES-CTR",t.cipher.modes.ctr),e("AES-GCM",t.cipher.modes.gcm);function e(o,m){var g=function(){return new t.aes.Algorithm(o,m)};t.cipher.registerAlgorithm(o,g)}var r=!1,n=4,s,c,u,a,p;function f(){r=!0,u=[0,1,2,4,8,16,32,64,128,27,54];for(var o=new Array(256),m=0;m<128;++m)o[m]=m<<1,o[m+128]=m+128<<1^283;s=new Array(256),c=new Array(256),a=new Array(4),p=new Array(4);for(var m=0;m<4;++m)a[m]=new Array(256),p[m]=new Array(256);for(var g=0,S=0,i,v,E,I,B,T,h,m=0;m<256;++m){I=S^S<<1^S<<2^S<<3^S<<4,I=I>>8^I&255^99,s[g]=I,c[I]=g,B=o[I],i=o[g],v=o[i],E=o[v],T=B<<24^I<<16^I<<8^(I^B),h=(i^v^E)<<24^(g^E)<<16^(g^v^E)<<8^(g^i^E);for(var l=0;l<4;++l)a[l][g]=T,p[l][I]=h,T=T<<24|T>>>8,h=h<<24|h>>>8;g===0?g=S=1:(g=i^o[o[o[i^E]]],S^=o[o[S]])}}function A(o,m){for(var g=o.slice(0),S,i=1,v=g.length,E=v+6+1,I=n*E,B=v;B<I;++B)S=g[B-1],B%v===0?(S=s[S>>>16&255]<<24^s[S>>>8&255]<<16^s[S&255]<<8^s[S>>>24]^u[i]<<24,i++):v>6&&B%v===4&&(S=s[S>>>24]<<24^s[S>>>16&255]<<16^s[S>>>8&255]<<8^s[S&255]),g[B]=g[B-v]^S;if(m){var T,h=p[0],l=p[1],R=p[2],N=p[3],F=g.slice(0);I=g.length;for(var B=0,D=I-n;B<I;B+=n,D-=n)if(B===0||B===I-n)F[B]=g[D],F[B+1]=g[D+3],F[B+2]=g[D+2],F[B+3]=g[D+1];else for(var q=0;q<n;++q)T=g[D+q],F[B+(3&-q)]=h[s[T>>>24]]^l[s[T>>>16&255]]^R[s[T>>>8&255]]^N[s[T&255]];g=F}return g}function C(o,m,g,S){var i=o.length/4-1,v,E,I,B,T;S?(v=p[0],E=p[1],I=p[2],B=p[3],T=c):(v=a[0],E=a[1],I=a[2],B=a[3],T=s);var h,l,R,N,F,D,q;h=m[0]^o[0],l=m[S?3:1]^o[1],R=m[2]^o[2],N=m[S?1:3]^o[3];for(var j=3,H=1;H<i;++H)F=v[h>>>24]^E[l>>>16&255]^I[R>>>8&255]^B[N&255]^o[++j],D=v[l>>>24]^E[R>>>16&255]^I[N>>>8&255]^B[h&255]^o[++j],q=v[R>>>24]^E[N>>>16&255]^I[h>>>8&255]^B[l&255]^o[++j],N=v[N>>>24]^E[h>>>16&255]^I[l>>>8&255]^B[R&255]^o[++j],h=F,l=D,R=q;g[0]=T[h>>>24]<<24^T[l>>>16&255]<<16^T[R>>>8&255]<<8^T[N&255]^o[++j],g[S?3:1]=T[l>>>24]<<24^T[R>>>16&255]<<16^T[N>>>8&255]<<8^T[h&255]^o[++j],g[2]=T[R>>>24]<<24^T[N>>>16&255]<<16^T[h>>>8&255]<<8^T[l&255]^o[++j],g[S?1:3]=T[N>>>24]<<24^T[h>>>16&255]<<16^T[l>>>8&255]<<8^T[R&255]^o[++j]}function y(o){o=o||{};var m=(o.mode||"CBC").toUpperCase(),g="AES-"+m,S;o.decrypt?S=t.cipher.createDecipher(g,o.key):S=t.cipher.createCipher(g,o.key);var i=S.start;return S.start=function(v,E){var I=null;E instanceof t.util.ByteBuffer&&(I=E,E={}),E=E||{},E.output=I,E.iv=v,i.call(S,E)},S}return Ma}var qa={exports:{}},Va={exports:{}},Ka={exports:{}},ho;function or(){if(ho)return Ka.exports;ho=1;var t=me();t.pki=t.pki||{};var e=Ka.exports=t.pki.oids=t.oids=t.oids||{};function r(s,c){e[s]=c,e[c]=s}function n(s,c){e[s]=c}return r("1.2.840.113549.1.1.1","rsaEncryption"),r("1.2.840.113549.1.1.4","md5WithRSAEncryption"),r("1.2.840.113549.1.1.5","sha1WithRSAEncryption"),r("1.2.840.113549.1.1.7","RSAES-OAEP"),r("1.2.840.113549.1.1.8","mgf1"),r("1.2.840.113549.1.1.9","pSpecified"),r("1.2.840.113549.1.1.10","RSASSA-PSS"),r("1.2.840.113549.1.1.11","sha256WithRSAEncryption"),r("1.2.840.113549.1.1.12","sha384WithRSAEncryption"),r("1.2.840.113549.1.1.13","sha512WithRSAEncryption"),r("1.3.101.112","EdDSA25519"),r("1.2.840.10040.4.3","dsa-with-sha1"),r("1.3.14.3.2.7","desCBC"),r("1.3.14.3.2.26","sha1"),r("1.3.14.3.2.29","sha1WithRSASignature"),r("2.16.840.1.101.3.4.2.1","sha256"),r("2.16.840.1.101.3.4.2.2","sha384"),r("2.16.840.1.101.3.4.2.3","sha512"),r("2.16.840.1.101.3.4.2.4","sha224"),r("2.16.840.1.101.3.4.2.5","sha512-224"),r("2.16.840.1.101.3.4.2.6","sha512-256"),r("1.2.840.113549.2.2","md2"),r("1.2.840.113549.2.5","md5"),r("1.2.840.113549.1.7.1","data"),r("1.2.840.113549.1.7.2","signedData"),r("1.2.840.113549.1.7.3","envelopedData"),r("1.2.840.113549.1.7.4","signedAndEnvelopedData"),r("1.2.840.113549.1.7.5","digestedData"),r("1.2.840.113549.1.7.6","encryptedData"),r("1.2.840.113549.1.9.1","emailAddress"),r("1.2.840.113549.1.9.2","unstructuredName"),r("1.2.840.113549.1.9.3","contentType"),r("1.2.840.113549.1.9.4","messageDigest"),r("1.2.840.113549.1.9.5","signingTime"),r("1.2.840.113549.1.9.6","counterSignature"),r("1.2.840.113549.1.9.7","challengePassword"),r("1.2.840.113549.1.9.8","unstructuredAddress"),r("1.2.840.113549.1.9.14","extensionRequest"),r("1.2.840.113549.1.9.20","friendlyName"),r("1.2.840.113549.1.9.21","localKeyId"),r("1.2.840.113549.1.9.22.1","x509Certificate"),r("1.2.840.113549.1.12.10.1.1","keyBag"),r("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag"),r("1.2.840.113549.1.12.10.1.3","certBag"),r("1.2.840.113549.1.12.10.1.4","crlBag"),r("1.2.840.113549.1.12.10.1.5","secretBag"),r("1.2.840.113549.1.12.10.1.6","safeContentsBag"),r("1.2.840.113549.1.5.13","pkcs5PBES2"),r("1.2.840.113549.1.5.12","pkcs5PBKDF2"),r("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4"),r("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4"),r("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC"),r("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC"),r("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC"),r("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC"),r("1.2.840.113549.2.7","hmacWithSHA1"),r("1.2.840.113549.2.8","hmacWithSHA224"),r("1.2.840.113549.2.9","hmacWithSHA256"),r("1.2.840.113549.2.10","hmacWithSHA384"),r("1.2.840.113549.2.11","hmacWithSHA512"),r("1.2.840.113549.3.7","des-EDE3-CBC"),r("2.16.840.1.101.3.4.1.2","aes128-CBC"),r("2.16.840.1.101.3.4.1.22","aes192-CBC"),r("2.16.840.1.101.3.4.1.42","aes256-CBC"),r("2.5.4.3","commonName"),r("2.5.4.4","surname"),r("2.5.4.5","serialNumber"),r("2.5.4.6","countryName"),r("2.5.4.7","localityName"),r("2.5.4.8","stateOrProvinceName"),r("2.5.4.9","streetAddress"),r("2.5.4.10","organizationName"),r("2.5.4.11","organizationalUnitName"),r("2.5.4.12","title"),r("2.5.4.13","description"),r("2.5.4.15","businessCategory"),r("2.5.4.17","postalCode"),r("2.5.4.42","givenName"),r("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName"),r("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName"),r("2.16.840.1.113730.1.1","nsCertType"),r("2.16.840.1.113730.1.13","nsComment"),n("2.5.29.1","authorityKeyIdentifier"),n("2.5.29.2","keyAttributes"),n("2.5.29.3","certificatePolicies"),n("2.5.29.4","keyUsageRestriction"),n("2.5.29.5","policyMapping"),n("2.5.29.6","subtreesConstraint"),n("2.5.29.7","subjectAltName"),n("2.5.29.8","issuerAltName"),n("2.5.29.9","subjectDirectoryAttributes"),n("2.5.29.10","basicConstraints"),n("2.5.29.11","nameConstraints"),n("2.5.29.12","policyConstraints"),n("2.5.29.13","basicConstraints"),r("2.5.29.14","subjectKeyIdentifier"),r("2.5.29.15","keyUsage"),n("2.5.29.16","privateKeyUsagePeriod"),r("2.5.29.17","subjectAltName"),r("2.5.29.18","issuerAltName"),r("2.5.29.19","basicConstraints"),n("2.5.29.20","cRLNumber"),n("2.5.29.21","cRLReason"),n("2.5.29.22","expirationDate"),n("2.5.29.23","instructionCode"),n("2.5.29.24","invalidityDate"),n("2.5.29.25","cRLDistributionPoints"),n("2.5.29.26","issuingDistributionPoint"),n("2.5.29.27","deltaCRLIndicator"),n("2.5.29.28","issuingDistributionPoint"),n("2.5.29.29","certificateIssuer"),n("2.5.29.30","nameConstraints"),r("2.5.29.31","cRLDistributionPoints"),r("2.5.29.32","certificatePolicies"),n("2.5.29.33","policyMappings"),n("2.5.29.34","policyConstraints"),r("2.5.29.35","authorityKeyIdentifier"),n("2.5.29.36","policyConstraints"),r("2.5.29.37","extKeyUsage"),n("2.5.29.46","freshestCRL"),n("2.5.29.54","inhibitAnyPolicy"),r("1.3.6.1.4.1.11129.2.4.2","timestampList"),r("1.3.6.1.5.5.7.1.1","authorityInfoAccess"),r("1.3.6.1.5.5.7.3.1","serverAuth"),r("1.3.6.1.5.5.7.3.2","clientAuth"),r("1.3.6.1.5.5.7.3.3","codeSigning"),r("1.3.6.1.5.5.7.3.4","emailProtection"),r("1.3.6.1.5.5.7.3.8","timeStamping"),Ka.exports}var po;function Tt(){if(po)return Va.exports;po=1;var t=me();Ae(),or();var e=Va.exports=t.asn1=t.asn1||{};e.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192},e.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30},e.create=function(u,a,p,f,A){if(t.util.isArray(f)){for(var C=[],y=0;y<f.length;++y)f[y]!==void 0&&C.push(f[y]);f=C}var o={tagClass:u,type:a,constructed:p,composed:p||t.util.isArray(f),value:f};return A&&"bitStringContents"in A&&(o.bitStringContents=A.bitStringContents,o.original=e.copy(o)),o},e.copy=function(u,a){var p;if(t.util.isArray(u)){p=[];for(var f=0;f<u.length;++f)p.push(e.copy(u[f],a));return p}return typeof u=="string"?u:(p={tagClass:u.tagClass,type:u.type,constructed:u.constructed,composed:u.composed,value:e.copy(u.value,a)},a&&!a.excludeBitStringContents&&(p.bitStringContents=u.bitStringContents),p)},e.equals=function(u,a,p){if(t.util.isArray(u)){if(!t.util.isArray(a)||u.length!==a.length)return!1;for(var f=0;f<u.length;++f)if(!e.equals(u[f],a[f]))return!1;return!0}if(typeof u!=typeof a)return!1;if(typeof u=="string")return u===a;var A=u.tagClass===a.tagClass&&u.type===a.type&&u.constructed===a.constructed&&u.composed===a.composed&&e.equals(u.value,a.value);return p&&p.includeBitStringContents&&(A=A&&u.bitStringContents===a.bitStringContents),A},e.getBerValueLength=function(u){var a=u.getByte();if(a!==128){var p,f=a&128;return f?p=u.getInt((a&127)<<3):p=a,p}};function r(u,a,p){if(p>a){var f=new Error("Too few bytes to parse DER.");throw f.available=u.length(),f.remaining=a,f.requested=p,f}}var n=function(u,a){var p=u.getByte();if(a--,p!==128){var f,A=p&128;if(!A)f=p;else{var C=p&127;r(u,a,C),f=u.getInt(C<<3)}if(f<0)throw new Error("Negative length: "+f);return f}};e.fromDer=function(u,a){a===void 0&&(a={strict:!0,parseAllBytes:!0,decodeBitStrings:!0}),typeof a=="boolean"&&(a={strict:a,parseAllBytes:!0,decodeBitStrings:!0}),"strict"in a||(a.strict=!0),"parseAllBytes"in a||(a.parseAllBytes=!0),"decodeBitStrings"in a||(a.decodeBitStrings=!0),typeof u=="string"&&(u=t.util.createBuffer(u));var p=u.length(),f=s(u,u.length(),0,a);if(a.parseAllBytes&&u.length()!==0){var A=new Error("Unparsed DER bytes remain after ASN.1 parsing.");throw A.byteCount=p,A.remaining=u.length(),A}return f};function s(u,a,p,f){var A;r(u,a,2);var C=u.getByte();a--;var y=C&192,o=C&31;A=u.length();var m=n(u,a);if(a-=A-u.length(),m!==void 0&&m>a){if(f.strict){var g=new Error("Too few bytes to read ASN.1 value.");throw g.available=u.length(),g.remaining=a,g.requested=m,g}m=a}var S,i,v=(C&32)===32;if(v)if(S=[],m===void 0)for(;;){if(r(u,a,2),u.bytes(2)===String.fromCharCode(0,0)){u.getBytes(2),a-=2;break}A=u.length(),S.push(s(u,a,p+1,f)),a-=A-u.length()}else for(;m>0;)A=u.length(),S.push(s(u,m,p+1,f)),a-=A-u.length(),m-=A-u.length();if(S===void 0&&y===e.Class.UNIVERSAL&&o===e.Type.BITSTRING&&(i=u.bytes(m)),S===void 0&&f.decodeBitStrings&&y===e.Class.UNIVERSAL&&o===e.Type.BITSTRING&&m>1){var E=u.read,I=a,B=0;if(o===e.Type.BITSTRING&&(r(u,a,1),B=u.getByte(),a--),B===0)try{A=u.length();var T={strict:!0,decodeBitStrings:!0},h=s(u,a,p+1,T),l=A-u.length();a-=l,o==e.Type.BITSTRING&&l++;var R=h.tagClass;l===m&&(R===e.Class.UNIVERSAL||R===e.Class.CONTEXT_SPECIFIC)&&(S=[h])}catch{}S===void 0&&(u.read=E,a=I)}if(S===void 0){if(m===void 0){if(f.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");m=a}if(o===e.Type.BMPSTRING)for(S="";m>0;m-=2)r(u,a,2),S+=String.fromCharCode(u.getInt16()),a-=2;else S=u.getBytes(m),a-=m}var N=i===void 0?null:{bitStringContents:i};return e.create(y,o,v,S,N)}e.toDer=function(u){var a=t.util.createBuffer(),p=u.tagClass|u.type,f=t.util.createBuffer(),A=!1;if("bitStringContents"in u&&(A=!0,u.original&&(A=e.equals(u,u.original))),A)f.putBytes(u.bitStringContents);else if(u.composed){u.constructed?p|=32:f.putByte(0);for(var C=0;C<u.value.length;++C)u.value[C]!==void 0&&f.putBuffer(e.toDer(u.value[C]))}else if(u.type===e.Type.BMPSTRING)for(var C=0;C<u.value.length;++C)f.putInt16(u.value.charCodeAt(C));else u.type===e.Type.INTEGER&&u.value.length>1&&(u.value.charCodeAt(0)===0&&!(u.value.charCodeAt(1)&128)||u.value.charCodeAt(0)===255&&(u.value.charCodeAt(1)&128)===128)?f.putBytes(u.value.substr(1)):f.putBytes(u.value);if(a.putByte(p),f.length()<=127)a.putByte(f.length()&127);else{var y=f.length(),o="";do o+=String.fromCharCode(y&255),y=y>>>8;while(y>0);a.putByte(o.length|128);for(var C=o.length-1;C>=0;--C)a.putByte(o.charCodeAt(C))}return a.putBuffer(f),a},e.oidToDer=function(u){var a=u.split("."),p=t.util.createBuffer();p.putByte(40*parseInt(a[0],10)+parseInt(a[1],10));for(var f,A,C,y,o=2;o<a.length;++o){f=!0,A=[],C=parseInt(a[o],10);do y=C&127,C=C>>>7,f||(y|=128),A.push(y),f=!1;while(C>0);for(var m=A.length-1;m>=0;--m)p.putByte(A[m])}return p},e.derToOid=function(u){var a;typeof u=="string"&&(u=t.util.createBuffer(u));var p=u.getByte();a=Math.floor(p/40)+"."+p%40;for(var f=0;u.length()>0;)p=u.getByte(),f=f<<7,p&128?f+=p&127:(a+="."+(f+p),f=0);return a},e.utcTimeToDate=function(u){var a=new Date,p=parseInt(u.substr(0,2),10);p=p>=50?1900+p:2e3+p;var f=parseInt(u.substr(2,2),10)-1,A=parseInt(u.substr(4,2),10),C=parseInt(u.substr(6,2),10),y=parseInt(u.substr(8,2),10),o=0;if(u.length>11){var m=u.charAt(10),g=10;m!=="+"&&m!=="-"&&(o=parseInt(u.substr(10,2),10),g+=2)}if(a.setUTCFullYear(p,f,A),a.setUTCHours(C,y,o,0),g&&(m=u.charAt(g),m==="+"||m==="-")){var S=parseInt(u.substr(g+1,2),10),i=parseInt(u.substr(g+4,2),10),v=S*60+i;v*=6e4,m==="+"?a.setTime(+a-v):a.setTime(+a+v)}return a},e.generalizedTimeToDate=function(u){var a=new Date,p=parseInt(u.substr(0,4),10),f=parseInt(u.substr(4,2),10)-1,A=parseInt(u.substr(6,2),10),C=parseInt(u.substr(8,2),10),y=parseInt(u.substr(10,2),10),o=parseInt(u.substr(12,2),10),m=0,g=0,S=!1;u.charAt(u.length-1)==="Z"&&(S=!0);var i=u.length-5,v=u.charAt(i);if(v==="+"||v==="-"){var E=parseInt(u.substr(i+1,2),10),I=parseInt(u.substr(i+4,2),10);g=E*60+I,g*=6e4,v==="+"&&(g*=-1),S=!0}return u.charAt(14)==="."&&(m=parseFloat(u.substr(14),10)*1e3),S?(a.setUTCFullYear(p,f,A),a.setUTCHours(C,y,o,m),a.setTime(+a+g)):(a.setFullYear(p,f,A),a.setHours(C,y,o,m)),a},e.dateToUtcTime=function(u){if(typeof u=="string")return u;var a="",p=[];p.push((""+u.getUTCFullYear()).substr(2)),p.push(""+(u.getUTCMonth()+1)),p.push(""+u.getUTCDate()),p.push(""+u.getUTCHours()),p.push(""+u.getUTCMinutes()),p.push(""+u.getUTCSeconds());for(var f=0;f<p.length;++f)p[f].length<2&&(a+="0"),a+=p[f];return a+="Z",a},e.dateToGeneralizedTime=function(u){if(typeof u=="string")return u;var a="",p=[];p.push(""+u.getUTCFullYear()),p.push(""+(u.getUTCMonth()+1)),p.push(""+u.getUTCDate()),p.push(""+u.getUTCHours()),p.push(""+u.getUTCMinutes()),p.push(""+u.getUTCSeconds());for(var f=0;f<p.length;++f)p[f].length<2&&(a+="0"),a+=p[f];return a+="Z",a},e.integerToDer=function(u){var a=t.util.createBuffer();if(u>=-128&&u<128)return a.putSignedInt(u,8);if(u>=-32768&&u<32768)return a.putSignedInt(u,16);if(u>=-8388608&&u<8388608)return a.putSignedInt(u,24);if(u>=-2147483648&&u<2147483648)return a.putSignedInt(u,32);var p=new Error("Integer too large; max is 32-bits.");throw p.integer=u,p},e.derToInteger=function(u){typeof u=="string"&&(u=t.util.createBuffer(u));var a=u.length()*8;if(a>32)throw new Error("Integer too large; max is 32-bits.");return u.getSignedInt(a)},e.validate=function(u,a,p,f){var A=!1;if((u.tagClass===a.tagClass||typeof a.tagClass>"u")&&(u.type===a.type||typeof a.type>"u"))if(u.constructed===a.constructed||typeof a.constructed>"u"){if(A=!0,a.value&&t.util.isArray(a.value))for(var C=0,y=0;A&&y<a.value.length;++y)A=a.value[y].optional||!1,u.value[C]&&(A=e.validate(u.value[C],a.value[y],p,f),A?++C:a.value[y].optional&&(A=!0)),!A&&f&&f.push("["+a.name+'] Tag class "'+a.tagClass+'", type "'+a.type+'" expected value length "'+a.value.length+'", got "'+u.value.length+'"');if(A&&p&&(a.capture&&(p[a.capture]=u.value),a.captureAsn1&&(p[a.captureAsn1]=u),a.captureBitStringContents&&"bitStringContents"in u&&(p[a.captureBitStringContents]=u.bitStringContents),a.captureBitStringValue&&"bitStringContents"in u))if(u.bitStringContents.length<2)p[a.captureBitStringValue]="";else{var o=u.bitStringContents.charCodeAt(0);if(o!==0)throw new Error("captureBitStringValue only supported for zero unused bits");p[a.captureBitStringValue]=u.bitStringContents.slice(1)}}else f&&f.push("["+a.name+'] Expected constructed "'+a.constructed+'", got "'+u.constructed+'"');else f&&(u.tagClass!==a.tagClass&&f.push("["+a.name+'] Expected tag class "'+a.tagClass+'", got "'+u.tagClass+'"'),u.type!==a.type&&f.push("["+a.name+'] Expected type "'+a.type+'", got "'+u.type+'"'));return A};var c=/[^\\u0000-\\u00ff]/;return e.prettyPrint=function(u,a,p){var f="";a=a||0,p=p||2,a>0&&(f+=`
`);for(var A="",C=0;C<a*p;++C)A+=" ";switch(f+=A+"Tag: ",u.tagClass){case e.Class.UNIVERSAL:f+="Universal:";break;case e.Class.APPLICATION:f+="Application:";break;case e.Class.CONTEXT_SPECIFIC:f+="Context-Specific:";break;case e.Class.PRIVATE:f+="Private:";break}if(u.tagClass===e.Class.UNIVERSAL)switch(f+=u.type,u.type){case e.Type.NONE:f+=" (None)";break;case e.Type.BOOLEAN:f+=" (Boolean)";break;case e.Type.INTEGER:f+=" (Integer)";break;case e.Type.BITSTRING:f+=" (Bit string)";break;case e.Type.OCTETSTRING:f+=" (Octet string)";break;case e.Type.NULL:f+=" (Null)";break;case e.Type.OID:f+=" (Object Identifier)";break;case e.Type.ODESC:f+=" (Object Descriptor)";break;case e.Type.EXTERNAL:f+=" (External or Instance of)";break;case e.Type.REAL:f+=" (Real)";break;case e.Type.ENUMERATED:f+=" (Enumerated)";break;case e.Type.EMBEDDED:f+=" (Embedded PDV)";break;case e.Type.UTF8:f+=" (UTF8)";break;case e.Type.ROID:f+=" (Relative Object Identifier)";break;case e.Type.SEQUENCE:f+=" (Sequence)";break;case e.Type.SET:f+=" (Set)";break;case e.Type.PRINTABLESTRING:f+=" (Printable String)";break;case e.Type.IA5String:f+=" (IA5String (ASCII))";break;case e.Type.UTCTIME:f+=" (UTC time)";break;case e.Type.GENERALIZEDTIME:f+=" (Generalized time)";break;case e.Type.BMPSTRING:f+=" (BMP String)";break}else f+=u.type;if(f+=`
`,f+=A+"Constructed: "+u.constructed+`
`,u.composed){for(var y=0,o="",C=0;C<u.value.length;++C)u.value[C]!==void 0&&(y+=1,o+=e.prettyPrint(u.value[C],a+1,p),C+1<u.value.length&&(o+=","));f+=A+"Sub values: "+y+o}else{if(f+=A+"Value: ",u.type===e.Type.OID){var m=e.derToOid(u.value);f+=m,t.pki&&t.pki.oids&&m in t.pki.oids&&(f+=" ("+t.pki.oids[m]+") ")}if(u.type===e.Type.INTEGER)try{f+=e.derToInteger(u.value)}catch{f+="0x"+t.util.bytesToHex(u.value)}else if(u.type===e.Type.BITSTRING){if(u.value.length>1?f+="0x"+t.util.bytesToHex(u.value.slice(1)):f+="(none)",u.value.length>0){var g=u.value.charCodeAt(0);g==1?f+=" (1 unused bit shown)":g>1&&(f+=" ("+g+" unused bits shown)")}}else if(u.type===e.Type.OCTETSTRING)c.test(u.value)||(f+="("+u.value+") "),f+="0x"+t.util.bytesToHex(u.value);else if(u.type===e.Type.UTF8)try{f+=t.util.decodeUtf8(u.value)}catch(S){if(S.message==="URI malformed")f+="0x"+t.util.bytesToHex(u.value)+" (malformed UTF8)";else throw S}else u.type===e.Type.PRINTABLESTRING||u.type===e.Type.IA5String?f+=u.value:c.test(u.value)?f+="0x"+t.util.bytesToHex(u.value):u.value.length===0?f+="[null]":f+=u.value}return f},Va.exports}var $a={exports:{}},Ga,yo;function Ut(){if(yo)return Ga;yo=1;var t=me();return Ga=t.md=t.md||{},t.md.algorithms=t.md.algorithms||{},Ga}var go;function nn(){if(go)return $a.exports;go=1;var t=me();Ut(),Ae();var e=$a.exports=t.hmac=t.hmac||{};return e.create=function(){var r=null,n=null,s=null,c=null,u={};return u.start=function(a,p){if(a!==null)if(typeof a=="string")if(a=a.toLowerCase(),a in t.md.algorithms)n=t.md.algorithms[a].create();else throw new Error('Unknown hash algorithm "'+a+'"');else n=a;if(p===null)p=r;else{if(typeof p=="string")p=t.util.createBuffer(p);else if(t.util.isArray(p)){var f=p;p=t.util.createBuffer();for(var A=0;A<f.length;++A)p.putByte(f[A])}var C=p.length();C>n.blockLength&&(n.start(),n.update(p.bytes()),p=n.digest()),s=t.util.createBuffer(),c=t.util.createBuffer(),C=p.length();for(var A=0;A<C;++A){var f=p.at(A);s.putByte(54^f),c.putByte(92^f)}if(C<n.blockLength)for(var f=n.blockLength-C,A=0;A<f;++A)s.putByte(54),c.putByte(92);r=p,s=s.bytes(),c=c.bytes()}n.start(),n.update(s)},u.update=function(a){n.update(a)},u.getMac=function(){var a=n.digest().bytes();return n.start(),n.update(c),n.update(a),n.digest()},u.digest=u.getMac,u},$a.exports}var ja={exports:{}},vo;function ys(){if(vo)return ja.exports;vo=1;var t=me();Ut(),Ae();var e=ja.exports=t.md5=t.md5||{};t.md.md5=t.md.algorithms.md5=e,e.create=function(){u||a();var f=null,A=t.util.createBuffer(),C=new Array(16),y={algorithm:"md5",blockLength:64,digestLength:16,messageLength:0,fullMessageLength:null,messageLengthSize:8};return y.start=function(){y.messageLength=0,y.fullMessageLength=y.messageLength64=[];for(var o=y.messageLengthSize/4,m=0;m<o;++m)y.fullMessageLength.push(0);return A=t.util.createBuffer(),f={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878},y},y.start(),y.update=function(o,m){m==="utf8"&&(o=t.util.encodeUtf8(o));var g=o.length;y.messageLength+=g,g=[g/4294967296>>>0,g>>>0];for(var S=y.fullMessageLength.length-1;S>=0;--S)y.fullMessageLength[S]+=g[1],g[1]=g[0]+(y.fullMessageLength[S]/4294967296>>>0),y.fullMessageLength[S]=y.fullMessageLength[S]>>>0,g[0]=g[1]/4294967296>>>0;return A.putBytes(o),p(f,C,A),(A.read>2048||A.length()===0)&&A.compact(),y},y.digest=function(){var o=t.util.createBuffer();o.putBytes(A.bytes());var m=y.fullMessageLength[y.fullMessageLength.length-1]+y.messageLengthSize,g=m&y.blockLength-1;o.putBytes(r.substr(0,y.blockLength-g));for(var S,i=0,v=y.fullMessageLength.length-1;v>=0;--v)S=y.fullMessageLength[v]*8+i,i=S/4294967296>>>0,o.putInt32Le(S>>>0);var E={h0:f.h0,h1:f.h1,h2:f.h2,h3:f.h3};p(E,C,o);var I=t.util.createBuffer();return I.putInt32Le(E.h0),I.putInt32Le(E.h1),I.putInt32Le(E.h2),I.putInt32Le(E.h3),I},y};var r=null,n=null,s=null,c=null,u=!1;function a(){r=String.fromCharCode(128),r+=t.util.fillString(String.fromCharCode(0),64),n=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,1,6,11,0,5,10,15,4,9,14,3,8,13,2,7,12,5,8,11,14,1,4,7,10,13,0,3,6,9,12,15,2,0,7,14,5,12,3,10,1,8,15,6,13,4,11,2,9],s=[7,12,17,22,7,12,17,22,7,12,17,22,7,12,17,22,5,9,14,20,5,9,14,20,5,9,14,20,5,9,14,20,4,11,16,23,4,11,16,23,4,11,16,23,4,11,16,23,6,10,15,21,6,10,15,21,6,10,15,21,6,10,15,21],c=new Array(64);for(var f=0;f<64;++f)c[f]=Math.floor(Math.abs(Math.sin(f+1))*4294967296);u=!0}function p(f,A,C){for(var y,o,m,g,S,i,v,E,I=C.length();I>=64;){for(o=f.h0,m=f.h1,g=f.h2,S=f.h3,E=0;E<16;++E)A[E]=C.getInt32Le(),i=S^m&(g^S),y=o+i+c[E]+A[E],v=s[E],o=S,S=g,g=m,m+=y<<v|y>>>32-v;for(;E<32;++E)i=g^S&(m^g),y=o+i+c[E]+A[n[E]],v=s[E],o=S,S=g,g=m,m+=y<<v|y>>>32-v;for(;E<48;++E)i=m^g^S,y=o+i+c[E]+A[n[E]],v=s[E],o=S,S=g,g=m,m+=y<<v|y>>>32-v;for(;E<64;++E)i=g^(m|~S),y=o+i+c[E]+A[n[E]],v=s[E],o=S,S=g,g=m,m+=y<<v|y>>>32-v;f.h0=f.h0+o|0,f.h1=f.h1+m|0,f.h2=f.h2+g|0,f.h3=f.h3+S|0,I-=64}}return ja.exports}var Ha={exports:{}},mo;function Br(){if(mo)return Ha.exports;mo=1;var t=me();Ae();var e=Ha.exports=t.pem=t.pem||{};e.encode=function(s,c){c=c||{};var u="-----BEGIN "+s.type+`-----\r
`,a;if(s.procType&&(a={name:"Proc-Type",values:[String(s.procType.version),s.procType.type]},u+=r(a)),s.contentDomain&&(a={name:"Content-Domain",values:[s.contentDomain]},u+=r(a)),s.dekInfo&&(a={name:"DEK-Info",values:[s.dekInfo.algorithm]},s.dekInfo.parameters&&a.values.push(s.dekInfo.parameters),u+=r(a)),s.headers)for(var p=0;p<s.headers.length;++p)u+=r(s.headers[p]);return s.procType&&(u+=`\r
`),u+=t.util.encode64(s.body,c.maxline||64)+`\r
`,u+="-----END "+s.type+`-----\r
`,u},e.decode=function(s){for(var c=[],u=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,a=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,p=/\r?\n/,f;f=u.exec(s),!!f;){var A=f[1];A==="NEW CERTIFICATE REQUEST"&&(A="CERTIFICATE REQUEST");var C={type:A,procType:null,contentDomain:null,dekInfo:null,headers:[],body:t.util.decode64(f[3])};if(c.push(C),!!f[2]){for(var y=f[2].split(p),o=0;f&&o<y.length;){for(var m=y[o].replace(/\s+$/,""),g=o+1;g<y.length;++g){var S=y[g];if(!/\s/.test(S[0]))break;m+=S,o=g}if(f=m.match(a),f){for(var i={name:f[1],values:[]},v=f[2].split(","),E=0;E<v.length;++E)i.values.push(n(v[E]));if(C.procType)if(!C.contentDomain&&i.name==="Content-Domain")C.contentDomain=v[0]||"";else if(!C.dekInfo&&i.name==="DEK-Info"){if(i.values.length===0)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');C.dekInfo={algorithm:v[0],parameters:v[1]||null}}else C.headers.push(i);else{if(i.name!=="Proc-Type")throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(i.values.length!==2)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');C.procType={version:v[0],type:v[1]}}}++o}if(C.procType==="ENCRYPTED"&&!C.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(c.length===0)throw new Error("Invalid PEM formatted message.");return c};function r(s){for(var c=s.name+": ",u=[],a=function(y,o){return" "+o},p=0;p<s.values.length;++p)u.push(s.values[p].replace(/^(\S+\r\n)/,a));c+=u.join(",")+`\r
`;for(var f=0,A=-1,p=0;p<c.length;++p,++f)if(f>65&&A!==-1){var C=c[A];C===","?(++A,c=c.substr(0,A)+`\r
 `+c.substr(A)):c=c.substr(0,A)+`\r
`+C+c.substr(A+1),f=p-A-1,A=-1,++p}else(c[p]===" "||c[p]==="	"||c[p]===",")&&(A=p);return c}function n(s){return s.replace(/^\s+/,"")}return Ha.exports}var za={exports:{}},Wa,Eo;function sa(){if(Eo)return Wa;Eo=1;var t=me();ps(),xu(),Ae(),Wa=t.des=t.des||{},t.des.startEncrypting=function(o,m,g,S){var i=y({key:o,output:g,decrypt:!1,mode:S||(m===null?"ECB":"CBC")});return i.start(m),i},t.des.createEncryptionCipher=function(o,m){return y({key:o,output:null,decrypt:!1,mode:m})},t.des.startDecrypting=function(o,m,g,S){var i=y({key:o,output:g,decrypt:!0,mode:S||(m===null?"ECB":"CBC")});return i.start(m),i},t.des.createDecryptionCipher=function(o,m){return y({key:o,output:null,decrypt:!0,mode:m})},t.des.Algorithm=function(o,m){var g=this;g.name=o,g.mode=new m({blockSize:8,cipher:{encrypt:function(S,i){return C(g._keys,S,i,!1)},decrypt:function(S,i){return C(g._keys,S,i,!0)}}}),g._init=!1},t.des.Algorithm.prototype.initialize=function(o){if(!this._init){var m=t.util.createBuffer(o.key);if(this.name.indexOf("3DES")===0&&m.length()!==24)throw new Error("Invalid Triple-DES key size: "+m.length()*8);this._keys=A(m),this._init=!0}},e("DES-ECB",t.cipher.modes.ecb),e("DES-CBC",t.cipher.modes.cbc),e("DES-CFB",t.cipher.modes.cfb),e("DES-OFB",t.cipher.modes.ofb),e("DES-CTR",t.cipher.modes.ctr),e("3DES-ECB",t.cipher.modes.ecb),e("3DES-CBC",t.cipher.modes.cbc),e("3DES-CFB",t.cipher.modes.cfb),e("3DES-OFB",t.cipher.modes.ofb),e("3DES-CTR",t.cipher.modes.ctr);function e(o,m){var g=function(){return new t.des.Algorithm(o,m)};t.cipher.registerAlgorithm(o,g)}var r=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],n=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],s=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],c=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],u=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],a=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],p=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],f=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function A(o){for(var m=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],g=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],S=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],i=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],v=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],E=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],I=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],B=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],T=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],h=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],l=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],R=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],N=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],F=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],D=o.length()>8?3:1,q=[],j=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],H=0,Q,J=0;J<D;J++){var X=o.getInt32(),re=o.getInt32();Q=(X>>>4^re)&252645135,re^=Q,X^=Q<<4,Q=(re>>>-16^X)&65535,X^=Q,re^=Q<<-16,Q=(X>>>2^re)&858993459,re^=Q,X^=Q<<2,Q=(re>>>-16^X)&65535,X^=Q,re^=Q<<-16,Q=(X>>>1^re)&1431655765,re^=Q,X^=Q<<1,Q=(re>>>8^X)&16711935,X^=Q,re^=Q<<8,Q=(X>>>1^re)&1431655765,re^=Q,X^=Q<<1,Q=X<<8|re>>>20&240,X=re<<24|re<<8&16711680|re>>>8&65280|re>>>24&240,re=Q;for(var se=0;se<j.length;++se){j[se]?(X=X<<2|X>>>26,re=re<<2|re>>>26):(X=X<<1|X>>>27,re=re<<1|re>>>27),X&=-15,re&=-15;var de=m[X>>>28]|g[X>>>24&15]|S[X>>>20&15]|i[X>>>16&15]|v[X>>>12&15]|E[X>>>8&15]|I[X>>>4&15],ye=B[re>>>28]|T[re>>>24&15]|h[re>>>20&15]|l[re>>>16&15]|R[re>>>12&15]|N[re>>>8&15]|F[re>>>4&15];Q=(ye>>>16^de)&65535,q[H++]=de^Q,q[H++]=ye^Q<<16}}return q}function C(o,m,g,S){var i=o.length===32?3:9,v;i===3?v=S?[30,-2,-2]:[0,32,2]:v=S?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var E,I=m[0],B=m[1];E=(I>>>4^B)&252645135,B^=E,I^=E<<4,E=(I>>>16^B)&65535,B^=E,I^=E<<16,E=(B>>>2^I)&858993459,I^=E,B^=E<<2,E=(B>>>8^I)&16711935,I^=E,B^=E<<8,E=(I>>>1^B)&1431655765,B^=E,I^=E<<1,I=I<<1|I>>>31,B=B<<1|B>>>31;for(var T=0;T<i;T+=3){for(var h=v[T+1],l=v[T+2],R=v[T];R!=h;R+=l){var N=B^o[R],F=(B>>>4|B<<28)^o[R+1];E=I,I=B,B=E^(n[N>>>24&63]|c[N>>>16&63]|a[N>>>8&63]|f[N&63]|r[F>>>24&63]|s[F>>>16&63]|u[F>>>8&63]|p[F&63])}E=I,I=B,B=E}I=I>>>1|I<<31,B=B>>>1|B<<31,E=(I>>>1^B)&1431655765,B^=E,I^=E<<1,E=(B>>>8^I)&16711935,I^=E,B^=E<<8,E=(B>>>2^I)&858993459,I^=E,B^=E<<2,E=(I>>>16^B)&65535,B^=E,I^=E<<16,E=(I>>>4^B)&252645135,B^=E,I^=E<<4,g[0]=I,g[1]=B}function y(o){o=o||{};var m=(o.mode||"CBC").toUpperCase(),g="DES-"+m,S;o.decrypt?S=t.cipher.createDecipher(g,o.key):S=t.cipher.createCipher(g,o.key);var i=S.start;return S.start=function(v,E){var I=null;E instanceof t.util.ByteBuffer&&(I=E,E={}),E=E||{},E.output=I,E.iv=v,i.call(S,E)},S}return Wa}var Qa,Co;function gs(){if(Co)return Qa;Co=1;var t=me();nn(),Ut(),Ae();var e=t.pkcs5=t.pkcs5||{},r;return t.util.isNodejs&&!t.options.usePureJavaScript&&(r=Wr),Qa=t.pbkdf2=e.pbkdf2=function(n,s,c,u,a,p){if(typeof a=="function"&&(p=a,a=null),t.util.isNodejs&&!t.options.usePureJavaScript&&r.pbkdf2&&(a===null||typeof a!="object")&&(r.pbkdf2Sync.length>4||!a||a==="sha1"))return typeof a!="string"&&(a="sha1"),n=Buffer.from(n,"binary"),s=Buffer.from(s,"binary"),p?r.pbkdf2Sync.length===4?r.pbkdf2(n,s,c,u,function(T,h){if(T)return p(T);p(null,h.toString("binary"))}):r.pbkdf2(n,s,c,u,a,function(T,h){if(T)return p(T);p(null,h.toString("binary"))}):r.pbkdf2Sync.length===4?r.pbkdf2Sync(n,s,c,u).toString("binary"):r.pbkdf2Sync(n,s,c,u,a).toString("binary");if((typeof a>"u"||a===null)&&(a="sha1"),typeof a=="string"){if(!(a in t.md.algorithms))throw new Error("Unknown hash algorithm: "+a);a=t.md[a].create()}var f=a.digestLength;if(u>4294967295*f){var A=new Error("Derived key is too long.");if(p)return p(A);throw A}var C=Math.ceil(u/f),y=u-(C-1)*f,o=t.hmac.create();o.start(a,n);var m="",g,S,i;if(!p){for(var v=1;v<=C;++v){o.start(null,null),o.update(s),o.update(t.util.int32ToBytes(v)),g=i=o.digest().getBytes();for(var E=2;E<=c;++E)o.start(null,null),o.update(i),S=o.digest().getBytes(),g=t.util.xorBytes(g,S,f),i=S;m+=v<C?g:g.substr(0,y)}return m}var v=1,E;function I(){if(v>C)return p(null,m);o.start(null,null),o.update(s),o.update(t.util.int32ToBytes(v)),g=i=o.digest().getBytes(),E=2,B()}function B(){if(E<=c)return o.start(null,null),o.update(i),S=o.digest().getBytes(),g=t.util.xorBytes(g,S,f),i=S,++E,t.util.setImmediate(B);m+=v<C?g:g.substr(0,y),++v,I()}I()},Qa}var An={exports:{}},Ya={exports:{}},So;function _u(){if(So)return Ya.exports;So=1;var t=me();Ut(),Ae();var e=Ya.exports=t.sha256=t.sha256||{};t.md.sha256=t.md.algorithms.sha256=e,e.create=function(){n||c();var a=null,p=t.util.createBuffer(),f=new Array(64),A={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8};return A.start=function(){A.messageLength=0,A.fullMessageLength=A.messageLength64=[];for(var C=A.messageLengthSize/4,y=0;y<C;++y)A.fullMessageLength.push(0);return p=t.util.createBuffer(),a={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},A},A.start(),A.update=function(C,y){y==="utf8"&&(C=t.util.encodeUtf8(C));var o=C.length;A.messageLength+=o,o=[o/4294967296>>>0,o>>>0];for(var m=A.fullMessageLength.length-1;m>=0;--m)A.fullMessageLength[m]+=o[1],o[1]=o[0]+(A.fullMessageLength[m]/4294967296>>>0),A.fullMessageLength[m]=A.fullMessageLength[m]>>>0,o[0]=o[1]/4294967296>>>0;return p.putBytes(C),u(a,f,p),(p.read>2048||p.length()===0)&&p.compact(),A},A.digest=function(){var C=t.util.createBuffer();C.putBytes(p.bytes());var y=A.fullMessageLength[A.fullMessageLength.length-1]+A.messageLengthSize,o=y&A.blockLength-1;C.putBytes(r.substr(0,A.blockLength-o));for(var m,g,S=A.fullMessageLength[0]*8,i=0;i<A.fullMessageLength.length-1;++i)m=A.fullMessageLength[i+1]*8,g=m/4294967296>>>0,S+=g,C.putInt32(S>>>0),S=m>>>0;C.putInt32(S);var v={h0:a.h0,h1:a.h1,h2:a.h2,h3:a.h3,h4:a.h4,h5:a.h5,h6:a.h6,h7:a.h7};u(v,f,C);var E=t.util.createBuffer();return E.putInt32(v.h0),E.putInt32(v.h1),E.putInt32(v.h2),E.putInt32(v.h3),E.putInt32(v.h4),E.putInt32(v.h5),E.putInt32(v.h6),E.putInt32(v.h7),E},A};var r=null,n=!1,s=null;function c(){r=String.fromCharCode(128),r+=t.util.fillString(String.fromCharCode(0),64),s=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],n=!0}function u(a,p,f){for(var A,C,y,o,m,g,S,i,v,E,I,B,T,h,l,R=f.length();R>=64;){for(S=0;S<16;++S)p[S]=f.getInt32();for(;S<64;++S)A=p[S-2],A=(A>>>17|A<<15)^(A>>>19|A<<13)^A>>>10,C=p[S-15],C=(C>>>7|C<<25)^(C>>>18|C<<14)^C>>>3,p[S]=A+p[S-7]+C+p[S-16]|0;for(i=a.h0,v=a.h1,E=a.h2,I=a.h3,B=a.h4,T=a.h5,h=a.h6,l=a.h7,S=0;S<64;++S)o=(B>>>6|B<<26)^(B>>>11|B<<21)^(B>>>25|B<<7),m=h^B&(T^h),y=(i>>>2|i<<30)^(i>>>13|i<<19)^(i>>>22|i<<10),g=i&v|E&(i^v),A=l+o+m+s[S]+p[S],C=y+g,l=h,h=T,T=B,B=I+A>>>0,I=E,E=v,v=i,i=A+C>>>0;a.h0=a.h0+i|0,a.h1=a.h1+v|0,a.h2=a.h2+E|0,a.h3=a.h3+I|0,a.h4=a.h4+B|0,a.h5=a.h5+T|0,a.h6=a.h6+h|0,a.h7=a.h7+l|0,R-=64}}return Ya.exports}var Ja={exports:{}},Ao;function wu(){if(Ao)return Ja.exports;Ao=1;var t=me();Ae();var e=null;t.util.isNodejs&&!t.options.usePureJavaScript&&!process.versions["node-webkit"]&&(e=Wr);var r=Ja.exports=t.prng=t.prng||{};return r.create=function(n){for(var s={plugin:n,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},c=n.md,u=new Array(32),a=0;a<32;++a)u[a]=c.create();s.pools=u,s.pool=0,s.generate=function(y,o){if(!o)return s.generateSync(y);var m=s.plugin.cipher,g=s.plugin.increment,S=s.plugin.formatKey,i=s.plugin.formatSeed,v=t.util.createBuffer();s.key=null,E();function E(I){if(I)return o(I);if(v.length()>=y)return o(null,v.getBytes(y));if(s.generated>1048575&&(s.key=null),s.key===null)return t.util.nextTick(function(){p(E)});var B=m(s.key,s.seed);s.generated+=B.length,v.putBytes(B),s.key=S(m(s.key,g(s.seed))),s.seed=i(m(s.key,s.seed)),t.util.setImmediate(E)}},s.generateSync=function(y){var o=s.plugin.cipher,m=s.plugin.increment,g=s.plugin.formatKey,S=s.plugin.formatSeed;s.key=null;for(var i=t.util.createBuffer();i.length()<y;){s.generated>1048575&&(s.key=null),s.key===null&&f();var v=o(s.key,s.seed);s.generated+=v.length,i.putBytes(v),s.key=g(o(s.key,m(s.seed))),s.seed=S(o(s.key,s.seed))}return i.getBytes(y)};function p(y){if(s.pools[0].messageLength>=32)return A(),y();var o=32-s.pools[0].messageLength<<5;s.seedFile(o,function(m,g){if(m)return y(m);s.collect(g),A(),y()})}function f(){if(s.pools[0].messageLength>=32)return A();var y=32-s.pools[0].messageLength<<5;s.collect(s.seedFileSync(y)),A()}function A(){s.reseeds=s.reseeds===4294967295?0:s.reseeds+1;var y=s.plugin.md.create();y.update(s.keyBytes);for(var o=1,m=0;m<32;++m)s.reseeds%o===0&&(y.update(s.pools[m].digest().getBytes()),s.pools[m].start()),o=o<<1;s.keyBytes=y.digest().getBytes(),y.start(),y.update(s.keyBytes);var g=y.digest().getBytes();s.key=s.plugin.formatKey(s.keyBytes),s.seed=s.plugin.formatSeed(g),s.generated=0}function C(y){var o=null,m=t.util.globalScope,g=m.crypto||m.msCrypto;g&&g.getRandomValues&&(o=function(l){return g.getRandomValues(l)});var S=t.util.createBuffer();if(o)for(;S.length()<y;){var i=Math.max(1,Math.min(y-S.length(),65536)/4),v=new Uint32Array(Math.floor(i));try{o(v);for(var E=0;E<v.length;++E)S.putInt32(v[E])}catch(l){if(!(typeof QuotaExceededError<"u"&&l instanceof QuotaExceededError))throw l}}if(S.length()<y)for(var I,B,T,h=Math.floor(Math.random()*65536);S.length()<y;){B=16807*(h&65535),I=16807*(h>>16),B+=(I&32767)<<16,B+=I>>15,B=(B&2147483647)+(B>>31),h=B&4294967295;for(var E=0;E<3;++E)T=h>>>(E<<3),T^=Math.floor(Math.random()*256),S.putByte(T&255)}return S.getBytes(y)}return e?(s.seedFile=function(y,o){e.randomBytes(y,function(m,g){if(m)return o(m);o(null,g.toString())})},s.seedFileSync=function(y){return e.randomBytes(y).toString()}):(s.seedFile=function(y,o){try{o(null,C(y))}catch(m){o(m)}},s.seedFileSync=C),s.collect=function(y){for(var o=y.length,m=0;m<o;++m)s.pools[s.pool].update(y.substr(m,1)),s.pool=s.pool===31?0:s.pool+1},s.collectInt=function(y,o){for(var m="",g=0;g<o;g+=8)m+=String.fromCharCode(y>>g&255);s.collect(m)},s.registerWorker=function(y){if(y===self)s.seedFile=function(m,g){function S(i){var v=i.data;v.forge&&v.forge.prng&&(self.removeEventListener("message",S),g(v.forge.prng.err,v.forge.prng.bytes))}self.addEventListener("message",S),self.postMessage({forge:{prng:{needed:m}}})};else{var o=function(m){var g=m.data;g.forge&&g.forge.prng&&s.seedFile(g.forge.prng.needed,function(S,i){y.postMessage({forge:{prng:{err:S,bytes:i}}})})};y.addEventListener("message",o)}},s},Ja.exports}var To;function yt(){if(To)return An.exports;To=1;var t=me();return sr(),_u(),wu(),Ae(),function(){if(t.random&&t.random.getBytes){An.exports=t.random;return}(function(e){var r={},n=new Array(4),s=t.util.createBuffer();r.formatKey=function(y){var o=t.util.createBuffer(y);return y=new Array(4),y[0]=o.getInt32(),y[1]=o.getInt32(),y[2]=o.getInt32(),y[3]=o.getInt32(),t.aes._expandKey(y,!1)},r.formatSeed=function(y){var o=t.util.createBuffer(y);return y=new Array(4),y[0]=o.getInt32(),y[1]=o.getInt32(),y[2]=o.getInt32(),y[3]=o.getInt32(),y},r.cipher=function(y,o){return t.aes._updateBlock(y,o,n,!1),s.putInt32(n[0]),s.putInt32(n[1]),s.putInt32(n[2]),s.putInt32(n[3]),s.getBytes()},r.increment=function(y){return++y[3],y},r.md=t.md.sha256;function c(){var y=t.prng.create(r);return y.getBytes=function(o,m){return y.generate(o,m)},y.getBytesSync=function(o){return y.generate(o)},y}var u=c(),a=null,p=t.util.globalScope,f=p.crypto||p.msCrypto;if(f&&f.getRandomValues&&(a=function(y){return f.getRandomValues(y)}),t.options.usePureJavaScript||!t.util.isNodejs&&!a){if(u.collectInt(+new Date,32),typeof navigator<"u"){var A="";for(var C in navigator)try{typeof navigator[C]=="string"&&(A+=navigator[C])}catch{}u.collect(A),A=null}e&&(e().mousemove(function(y){u.collectInt(y.clientX,16),u.collectInt(y.clientY,16)}),e().keypress(function(y){u.collectInt(y.charCode,8)}))}if(!t.random)t.random=u;else for(var C in u)t.random[C]=u[C];t.random.createInstance=c,An.exports=t.random})(typeof jQuery<"u"?jQuery:null)}(),An.exports}var Xa,xo;function Iu(){if(xo)return Xa;xo=1;var t=me();Ae();var e=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],r=[1,2,3,5],n=function(u,a){return u<<a&65535|(u&65535)>>16-a},s=function(u,a){return(u&65535)>>a|u<<16-a&65535};Xa=t.rc2=t.rc2||{},t.rc2.expandKey=function(u,a){typeof u=="string"&&(u=t.util.createBuffer(u)),a=a||128;var p=u,f=u.length(),A=a,C=Math.ceil(A/8),y=255>>(A&7),o;for(o=f;o<128;o++)p.putByte(e[p.at(o-1)+p.at(o-f)&255]);for(p.setAt(128-C,e[p.at(128-C)&y]),o=127-C;o>=0;o--)p.setAt(o,e[p.at(o+1)^p.at(o+C)]);return p};var c=function(u,a,p){var f=!1,A=null,C=null,y=null,o,m,g,S,i=[];for(u=t.rc2.expandKey(u,a),g=0;g<64;g++)i.push(u.getInt16Le());p?(o=function(I){for(g=0;g<4;g++)I[g]+=i[S]+(I[(g+3)%4]&I[(g+2)%4])+(~I[(g+3)%4]&I[(g+1)%4]),I[g]=n(I[g],r[g]),S++},m=function(I){for(g=0;g<4;g++)I[g]+=i[I[(g+3)%4]&63]}):(o=function(I){for(g=3;g>=0;g--)I[g]=s(I[g],r[g]),I[g]-=i[S]+(I[(g+3)%4]&I[(g+2)%4])+(~I[(g+3)%4]&I[(g+1)%4]),S--},m=function(I){for(g=3;g>=0;g--)I[g]-=i[I[(g+3)%4]&63]});var v=function(I){var B=[];for(g=0;g<4;g++){var T=A.getInt16Le();y!==null&&(p?T^=y.getInt16Le():y.putInt16Le(T)),B.push(T&65535)}S=p?0:63;for(var h=0;h<I.length;h++)for(var l=0;l<I[h][0];l++)I[h][1](B);for(g=0;g<4;g++)y!==null&&(p?y.putInt16Le(B[g]):B[g]^=y.getInt16Le()),C.putInt16Le(B[g])},E=null;return E={start:function(I,B){I&&typeof I=="string"&&(I=t.util.createBuffer(I)),f=!1,A=t.util.createBuffer(),C=B||new t.util.createBuffer,y=I,E.output=C},update:function(I){for(f||A.putBuffer(I);A.length()>=8;)v([[5,o],[1,m],[6,o],[1,m],[5,o]])},finish:function(I){var B=!0;if(p)if(I)B=I(8,A,!p);else{var T=A.length()===8?8:8-A.length();A.fillWithByte(T,T)}if(B&&(f=!0,E.update()),!p&&(B=A.length()===0,B))if(I)B=I(8,C,!p);else{var h=C.length(),l=C.at(h-1);l>h?B=!1:C.truncate(l)}return B}},E};return t.rc2.startEncrypting=function(u,a,p){var f=t.rc2.createEncryptionCipher(u,128);return f.start(a,p),f},t.rc2.createEncryptionCipher=function(u,a){return c(u,a,!0)},t.rc2.startDecrypting=function(u,a,p){var f=t.rc2.createDecryptionCipher(u,128);return f.start(a,p),f},t.rc2.createDecryptionCipher=function(u,a){return c(u,a,!1)},Xa}var Za,_o;function oa(){if(_o)return Za;_o=1;var t=me();Za=t.jsbn=t.jsbn||{};var e;function r(O,k,L){this.data=[],O!=null&&(typeof O=="number"?this.fromNumber(O,k,L):k==null&&typeof O!="string"?this.fromString(O,256):this.fromString(O,k))}t.jsbn.BigInteger=r;function n(){return new r(null)}function s(O,k,L,z,Z,ee){for(;--ee>=0;){var oe=k*this.data[O++]+L.data[z]+Z;Z=Math.floor(oe/67108864),L.data[z++]=oe&67108863}return Z}function c(O,k,L,z,Z,ee){for(var oe=k&32767,ie=k>>15;--ee>=0;){var xe=this.data[O]&32767,Je=this.data[O++]>>15,ct=ie*xe+Je*oe;xe=oe*xe+((ct&32767)<<15)+L.data[z]+(Z&1073741823),Z=(xe>>>30)+(ct>>>15)+ie*Je+(Z>>>30),L.data[z++]=xe&1073741823}return Z}function u(O,k,L,z,Z,ee){for(var oe=k&16383,ie=k>>14;--ee>=0;){var xe=this.data[O]&16383,Je=this.data[O++]>>14,ct=ie*xe+Je*oe;xe=oe*xe+((ct&16383)<<14)+L.data[z]+Z,Z=(xe>>28)+(ct>>14)+ie*Je,L.data[z++]=xe&268435455}return Z}typeof navigator>"u"?(r.prototype.am=u,e=28):navigator.appName=="Microsoft Internet Explorer"?(r.prototype.am=c,e=30):navigator.appName!="Netscape"?(r.prototype.am=s,e=26):(r.prototype.am=u,e=28),r.prototype.DB=e,r.prototype.DM=(1<<e)-1,r.prototype.DV=1<<e;var a=52;r.prototype.FV=Math.pow(2,a),r.prototype.F1=a-e,r.prototype.F2=2*e-a;var p="0123456789abcdefghijklmnopqrstuvwxyz",f=new Array,A,C;for(A="0".charCodeAt(0),C=0;C<=9;++C)f[A++]=C;for(A="a".charCodeAt(0),C=10;C<36;++C)f[A++]=C;for(A="A".charCodeAt(0),C=10;C<36;++C)f[A++]=C;function y(O){return p.charAt(O)}function o(O,k){var L=f[O.charCodeAt(k)];return L??-1}function m(O){for(var k=this.t-1;k>=0;--k)O.data[k]=this.data[k];O.t=this.t,O.s=this.s}function g(O){this.t=1,this.s=O<0?-1:0,O>0?this.data[0]=O:O<-1?this.data[0]=O+this.DV:this.t=0}function S(O){var k=n();return k.fromInt(O),k}function i(O,k){var L;if(k==16)L=4;else if(k==8)L=3;else if(k==256)L=8;else if(k==2)L=1;else if(k==32)L=5;else if(k==4)L=2;else{this.fromRadix(O,k);return}this.t=0,this.s=0;for(var z=O.length,Z=!1,ee=0;--z>=0;){var oe=L==8?O[z]&255:o(O,z);if(oe<0){O.charAt(z)=="-"&&(Z=!0);continue}Z=!1,ee==0?this.data[this.t++]=oe:ee+L>this.DB?(this.data[this.t-1]|=(oe&(1<<this.DB-ee)-1)<<ee,this.data[this.t++]=oe>>this.DB-ee):this.data[this.t-1]|=oe<<ee,ee+=L,ee>=this.DB&&(ee-=this.DB)}L==8&&O[0]&128&&(this.s=-1,ee>0&&(this.data[this.t-1]|=(1<<this.DB-ee)-1<<ee)),this.clamp(),Z&&r.ZERO.subTo(this,this)}function v(){for(var O=this.s&this.DM;this.t>0&&this.data[this.t-1]==O;)--this.t}function E(O){if(this.s<0)return"-"+this.negate().toString(O);var k;if(O==16)k=4;else if(O==8)k=3;else if(O==2)k=1;else if(O==32)k=5;else if(O==4)k=2;else return this.toRadix(O);var L=(1<<k)-1,z,Z=!1,ee="",oe=this.t,ie=this.DB-oe*this.DB%k;if(oe-- >0)for(ie<this.DB&&(z=this.data[oe]>>ie)>0&&(Z=!0,ee=y(z));oe>=0;)ie<k?(z=(this.data[oe]&(1<<ie)-1)<<k-ie,z|=this.data[--oe]>>(ie+=this.DB-k)):(z=this.data[oe]>>(ie-=k)&L,ie<=0&&(ie+=this.DB,--oe)),z>0&&(Z=!0),Z&&(ee+=y(z));return Z?ee:"0"}function I(){var O=n();return r.ZERO.subTo(this,O),O}function B(){return this.s<0?this.negate():this}function T(O){var k=this.s-O.s;if(k!=0)return k;var L=this.t;if(k=L-O.t,k!=0)return this.s<0?-k:k;for(;--L>=0;)if((k=this.data[L]-O.data[L])!=0)return k;return 0}function h(O){var k=1,L;return(L=O>>>16)!=0&&(O=L,k+=16),(L=O>>8)!=0&&(O=L,k+=8),(L=O>>4)!=0&&(O=L,k+=4),(L=O>>2)!=0&&(O=L,k+=2),(L=O>>1)!=0&&(O=L,k+=1),k}function l(){return this.t<=0?0:this.DB*(this.t-1)+h(this.data[this.t-1]^this.s&this.DM)}function R(O,k){var L;for(L=this.t-1;L>=0;--L)k.data[L+O]=this.data[L];for(L=O-1;L>=0;--L)k.data[L]=0;k.t=this.t+O,k.s=this.s}function N(O,k){for(var L=O;L<this.t;++L)k.data[L-O]=this.data[L];k.t=Math.max(this.t-O,0),k.s=this.s}function F(O,k){var L=O%this.DB,z=this.DB-L,Z=(1<<z)-1,ee=Math.floor(O/this.DB),oe=this.s<<L&this.DM,ie;for(ie=this.t-1;ie>=0;--ie)k.data[ie+ee+1]=this.data[ie]>>z|oe,oe=(this.data[ie]&Z)<<L;for(ie=ee-1;ie>=0;--ie)k.data[ie]=0;k.data[ee]=oe,k.t=this.t+ee+1,k.s=this.s,k.clamp()}function D(O,k){k.s=this.s;var L=Math.floor(O/this.DB);if(L>=this.t){k.t=0;return}var z=O%this.DB,Z=this.DB-z,ee=(1<<z)-1;k.data[0]=this.data[L]>>z;for(var oe=L+1;oe<this.t;++oe)k.data[oe-L-1]|=(this.data[oe]&ee)<<Z,k.data[oe-L]=this.data[oe]>>z;z>0&&(k.data[this.t-L-1]|=(this.s&ee)<<Z),k.t=this.t-L,k.clamp()}function q(O,k){for(var L=0,z=0,Z=Math.min(O.t,this.t);L<Z;)z+=this.data[L]-O.data[L],k.data[L++]=z&this.DM,z>>=this.DB;if(O.t<this.t){for(z-=O.s;L<this.t;)z+=this.data[L],k.data[L++]=z&this.DM,z>>=this.DB;z+=this.s}else{for(z+=this.s;L<O.t;)z-=O.data[L],k.data[L++]=z&this.DM,z>>=this.DB;z-=O.s}k.s=z<0?-1:0,z<-1?k.data[L++]=this.DV+z:z>0&&(k.data[L++]=z),k.t=L,k.clamp()}function j(O,k){var L=this.abs(),z=O.abs(),Z=L.t;for(k.t=Z+z.t;--Z>=0;)k.data[Z]=0;for(Z=0;Z<z.t;++Z)k.data[Z+L.t]=L.am(0,z.data[Z],k,Z,0,L.t);k.s=0,k.clamp(),this.s!=O.s&&r.ZERO.subTo(k,k)}function H(O){for(var k=this.abs(),L=O.t=2*k.t;--L>=0;)O.data[L]=0;for(L=0;L<k.t-1;++L){var z=k.am(L,k.data[L],O,2*L,0,1);(O.data[L+k.t]+=k.am(L+1,2*k.data[L],O,2*L+1,z,k.t-L-1))>=k.DV&&(O.data[L+k.t]-=k.DV,O.data[L+k.t+1]=1)}O.t>0&&(O.data[O.t-1]+=k.am(L,k.data[L],O,2*L,0,1)),O.s=0,O.clamp()}function Q(O,k,L){var z=O.abs();if(!(z.t<=0)){var Z=this.abs();if(Z.t<z.t){k!=null&&k.fromInt(0),L!=null&&this.copyTo(L);return}L==null&&(L=n());var ee=n(),oe=this.s,ie=O.s,xe=this.DB-h(z.data[z.t-1]);xe>0?(z.lShiftTo(xe,ee),Z.lShiftTo(xe,L)):(z.copyTo(ee),Z.copyTo(L));var Je=ee.t,ct=ee.data[Je-1];if(ct!=0){var ot=ct*(1<<this.F1)+(Je>1?ee.data[Je-2]>>this.F2:0),_t=this.FV/ot,yn=(1<<this.F1)/ot,ft=1<<this.F2,dt=L.t,gn=dt-Je,Dt=k??n();for(ee.dlShiftTo(gn,Dt),L.compareTo(Dt)>=0&&(L.data[L.t++]=1,L.subTo(Dt,L)),r.ONE.dlShiftTo(Je,Dt),Dt.subTo(ee,ee);ee.t<Je;)ee.data[ee.t++]=0;for(;--gn>=0;){var Ia=L.data[--dt]==ct?this.DM:Math.floor(L.data[dt]*_t+(L.data[dt-1]+ft)*yn);if((L.data[dt]+=ee.am(0,Ia,L,gn,0,Je))<Ia)for(ee.dlShiftTo(gn,Dt),L.subTo(Dt,L);L.data[dt]<--Ia;)L.subTo(Dt,L)}k!=null&&(L.drShiftTo(Je,k),oe!=ie&&r.ZERO.subTo(k,k)),L.t=Je,L.clamp(),xe>0&&L.rShiftTo(xe,L),oe<0&&r.ZERO.subTo(L,L)}}}function J(O){var k=n();return this.abs().divRemTo(O,null,k),this.s<0&&k.compareTo(r.ZERO)>0&&O.subTo(k,k),k}function X(O){this.m=O}function re(O){return O.s<0||O.compareTo(this.m)>=0?O.mod(this.m):O}function se(O){return O}function de(O){O.divRemTo(this.m,null,O)}function ye(O,k,L){O.multiplyTo(k,L),this.reduce(L)}function _e(O,k){O.squareTo(k),this.reduce(k)}X.prototype.convert=re,X.prototype.revert=se,X.prototype.reduce=de,X.prototype.mulTo=ye,X.prototype.sqrTo=_e;function W(){if(this.t<1)return 0;var O=this.data[0];if(!(O&1))return 0;var k=O&3;return k=k*(2-(O&15)*k)&15,k=k*(2-(O&255)*k)&255,k=k*(2-((O&65535)*k&65535))&65535,k=k*(2-O*k%this.DV)%this.DV,k>0?this.DV-k:-k}function he(O){this.m=O,this.mp=O.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<O.DB-15)-1,this.mt2=2*O.t}function ae(O){var k=n();return O.abs().dlShiftTo(this.m.t,k),k.divRemTo(this.m,null,k),O.s<0&&k.compareTo(r.ZERO)>0&&this.m.subTo(k,k),k}function ke(O){var k=n();return O.copyTo(k),this.reduce(k),k}function fe(O){for(;O.t<=this.mt2;)O.data[O.t++]=0;for(var k=0;k<this.m.t;++k){var L=O.data[k]&32767,z=L*this.mpl+((L*this.mph+(O.data[k]>>15)*this.mpl&this.um)<<15)&O.DM;for(L=k+this.m.t,O.data[L]+=this.m.am(0,z,O,k,0,this.m.t);O.data[L]>=O.DV;)O.data[L]-=O.DV,O.data[++L]++}O.clamp(),O.drShiftTo(this.m.t,O),O.compareTo(this.m)>=0&&O.subTo(this.m,O)}function _(O,k){O.squareTo(k),this.reduce(k)}function x(O,k,L){O.multiplyTo(k,L),this.reduce(L)}he.prototype.convert=ae,he.prototype.revert=ke,he.prototype.reduce=fe,he.prototype.mulTo=x,he.prototype.sqrTo=_;function w(){return(this.t>0?this.data[0]&1:this.s)==0}function d(O,k){if(O>4294967295||O<1)return r.ONE;var L=n(),z=n(),Z=k.convert(this),ee=h(O)-1;for(Z.copyTo(L);--ee>=0;)if(k.sqrTo(L,z),(O&1<<ee)>0)k.mulTo(z,Z,L);else{var oe=L;L=z,z=oe}return k.revert(L)}function b(O,k){var L;return O<256||k.isEven()?L=new X(k):L=new he(k),this.exp(O,L)}r.prototype.copyTo=m,r.prototype.fromInt=g,r.prototype.fromString=i,r.prototype.clamp=v,r.prototype.dlShiftTo=R,r.prototype.drShiftTo=N,r.prototype.lShiftTo=F,r.prototype.rShiftTo=D,r.prototype.subTo=q,r.prototype.multiplyTo=j,r.prototype.squareTo=H,r.prototype.divRemTo=Q,r.prototype.invDigit=W,r.prototype.isEven=w,r.prototype.exp=d,r.prototype.toString=E,r.prototype.negate=I,r.prototype.abs=B,r.prototype.compareTo=T,r.prototype.bitLength=l,r.prototype.mod=J,r.prototype.modPowInt=b,r.ZERO=S(0),r.ONE=S(1);function U(){var O=n();return this.copyTo(O),O}function P(){if(this.s<0){if(this.t==1)return this.data[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this.data[0];if(this.t==0)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function K(){return this.t==0?this.s:this.data[0]<<24>>24}function V(){return this.t==0?this.s:this.data[0]<<16>>16}function $(O){return Math.floor(Math.LN2*this.DB/Math.log(O))}function M(){return this.s<0?-1:this.t<=0||this.t==1&&this.data[0]<=0?0:1}function G(O){if(O==null&&(O=10),this.signum()==0||O<2||O>36)return"0";var k=this.chunkSize(O),L=Math.pow(O,k),z=S(L),Z=n(),ee=n(),oe="";for(this.divRemTo(z,Z,ee);Z.signum()>0;)oe=(L+ee.intValue()).toString(O).substr(1)+oe,Z.divRemTo(z,Z,ee);return ee.intValue().toString(O)+oe}function Y(O,k){this.fromInt(0),k==null&&(k=10);for(var L=this.chunkSize(k),z=Math.pow(k,L),Z=!1,ee=0,oe=0,ie=0;ie<O.length;++ie){var xe=o(O,ie);if(xe<0){O.charAt(ie)=="-"&&this.signum()==0&&(Z=!0);continue}oe=k*oe+xe,++ee>=L&&(this.dMultiply(z),this.dAddOffset(oe,0),ee=0,oe=0)}ee>0&&(this.dMultiply(Math.pow(k,ee)),this.dAddOffset(oe,0)),Z&&r.ZERO.subTo(this,this)}function ne(O,k,L){if(typeof k=="number")if(O<2)this.fromInt(1);else for(this.fromNumber(O,L),this.testBit(O-1)||this.bitwiseTo(r.ONE.shiftLeft(O-1),be,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(k);)this.dAddOffset(2,0),this.bitLength()>O&&this.subTo(r.ONE.shiftLeft(O-1),this);else{var z=new Array,Z=O&7;z.length=(O>>3)+1,k.nextBytes(z),Z>0?z[0]&=(1<<Z)-1:z[0]=0,this.fromString(z,256)}}function te(){var O=this.t,k=new Array;k[0]=this.s;var L=this.DB-O*this.DB%8,z,Z=0;if(O-- >0)for(L<this.DB&&(z=this.data[O]>>L)!=(this.s&this.DM)>>L&&(k[Z++]=z|this.s<<this.DB-L);O>=0;)L<8?(z=(this.data[O]&(1<<L)-1)<<8-L,z|=this.data[--O]>>(L+=this.DB-8)):(z=this.data[O]>>(L-=8)&255,L<=0&&(L+=this.DB,--O)),z&128&&(z|=-256),Z==0&&(this.s&128)!=(z&128)&&++Z,(Z>0||z!=this.s)&&(k[Z++]=z);return k}function ue(O){return this.compareTo(O)==0}function pe(O){return this.compareTo(O)<0?this:O}function ge(O){return this.compareTo(O)>0?this:O}function ce(O,k,L){var z,Z,ee=Math.min(O.t,this.t);for(z=0;z<ee;++z)L.data[z]=k(this.data[z],O.data[z]);if(O.t<this.t){for(Z=O.s&this.DM,z=ee;z<this.t;++z)L.data[z]=k(this.data[z],Z);L.t=this.t}else{for(Z=this.s&this.DM,z=ee;z<O.t;++z)L.data[z]=k(Z,O.data[z]);L.t=O.t}L.s=k(this.s,O.s),L.clamp()}function le(O,k){return O&k}function ve(O){var k=n();return this.bitwiseTo(O,le,k),k}function be(O,k){return O|k}function Ne(O){var k=n();return this.bitwiseTo(O,be,k),k}function Pe(O,k){return O^k}function we(O){var k=n();return this.bitwiseTo(O,Pe,k),k}function Oe(O,k){return O&~k}function Ie(O){var k=n();return this.bitwiseTo(O,Oe,k),k}function Te(){for(var O=n(),k=0;k<this.t;++k)O.data[k]=this.DM&~this.data[k];return O.t=this.t,O.s=~this.s,O}function Ee(O){var k=n();return O<0?this.rShiftTo(-O,k):this.lShiftTo(O,k),k}function gt(O){var k=n();return O<0?this.lShiftTo(-O,k):this.rShiftTo(O,k),k}function xt(O){if(O==0)return-1;var k=0;return O&65535||(O>>=16,k+=16),O&255||(O>>=8,k+=8),O&15||(O>>=4,k+=4),O&3||(O>>=2,k+=2),O&1||++k,k}function kt(){for(var O=0;O<this.t;++O)if(this.data[O]!=0)return O*this.DB+xt(this.data[O]);return this.s<0?this.t*this.DB:-1}function zt(O){for(var k=0;O!=0;)O&=O-1,++k;return k}function ur(){for(var O=0,k=this.s&this.DM,L=0;L<this.t;++L)O+=zt(this.data[L]^k);return O}function Pr(O){var k=Math.floor(O/this.DB);return k>=this.t?this.s!=0:(this.data[k]&1<<O%this.DB)!=0}function pn(O,k){var L=r.ONE.shiftLeft(O);return this.bitwiseTo(L,k,L),L}function Le(O){return this.changeBit(O,be)}function Fe(O){return this.changeBit(O,Oe)}function Me(O){return this.changeBit(O,Pe)}function qe(O,k){for(var L=0,z=0,Z=Math.min(O.t,this.t);L<Z;)z+=this.data[L]+O.data[L],k.data[L++]=z&this.DM,z>>=this.DB;if(O.t<this.t){for(z+=O.s;L<this.t;)z+=this.data[L],k.data[L++]=z&this.DM,z>>=this.DB;z+=this.s}else{for(z+=this.s;L<O.t;)z+=O.data[L],k.data[L++]=z&this.DM,z>>=this.DB;z+=O.s}k.s=z<0?-1:0,z>0?k.data[L++]=z:z<-1&&(k.data[L++]=this.DV+z),k.t=L,k.clamp()}function Ve(O){var k=n();return this.addTo(O,k),k}function Ke(O){var k=n();return this.subTo(O,k),k}function $e(O){var k=n();return this.multiplyTo(O,k),k}function Ge(O){var k=n();return this.divRemTo(O,k,null),k}function je(O){var k=n();return this.divRemTo(O,null,k),k}function He(O){var k=n(),L=n();return this.divRemTo(O,k,L),new Array(k,L)}function ze(O){this.data[this.t]=this.am(0,O-1,this,0,0,this.t),++this.t,this.clamp()}function We(O,k){if(O!=0){for(;this.t<=k;)this.data[this.t++]=0;for(this.data[k]+=O;this.data[k]>=this.DV;)this.data[k]-=this.DV,++k>=this.t&&(this.data[this.t++]=0),++this.data[k]}}function Re(){}function De(O){return O}function Qe(O,k,L){O.multiplyTo(k,L)}function Ye(O,k){O.squareTo(k)}Re.prototype.convert=De,Re.prototype.revert=De,Re.prototype.mulTo=Qe,Re.prototype.sqrTo=Ye;function Al(O){return this.exp(O,new Re)}function Tl(O,k,L){var z=Math.min(this.t+O.t,k);for(L.s=0,L.t=z;z>0;)L.data[--z]=0;var Z;for(Z=L.t-this.t;z<Z;++z)L.data[z+this.t]=this.am(0,O.data[z],L,z,0,this.t);for(Z=Math.min(O.t,k);z<Z;++z)this.am(0,O.data[z],L,z,0,k-z);L.clamp()}function xl(O,k,L){--k;var z=L.t=this.t+O.t-k;for(L.s=0;--z>=0;)L.data[z]=0;for(z=Math.max(k-this.t,0);z<O.t;++z)L.data[this.t+z-k]=this.am(k-z,O.data[z],L,0,0,this.t+z-k);L.clamp(),L.drShiftTo(1,L)}function lr(O){this.r2=n(),this.q3=n(),r.ONE.dlShiftTo(2*O.t,this.r2),this.mu=this.r2.divide(O),this.m=O}function _l(O){if(O.s<0||O.t>2*this.m.t)return O.mod(this.m);if(O.compareTo(this.m)<0)return O;var k=n();return O.copyTo(k),this.reduce(k),k}function wl(O){return O}function Il(O){for(O.drShiftTo(this.m.t-1,this.r2),O.t>this.m.t+1&&(O.t=this.m.t+1,O.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);O.compareTo(this.r2)<0;)O.dAddOffset(1,this.m.t+1);for(O.subTo(this.r2,O);O.compareTo(this.m)>=0;)O.subTo(this.m,O)}function bl(O,k){O.squareTo(k),this.reduce(k)}function Bl(O,k,L){O.multiplyTo(k,L),this.reduce(L)}lr.prototype.convert=_l,lr.prototype.revert=wl,lr.prototype.reduce=Il,lr.prototype.mulTo=Bl,lr.prototype.sqrTo=bl;function Rl(O,k){var L=O.bitLength(),z,Z=S(1),ee;if(L<=0)return Z;L<18?z=1:L<48?z=3:L<144?z=4:L<768?z=5:z=6,L<8?ee=new X(k):k.isEven()?ee=new lr(k):ee=new he(k);var oe=new Array,ie=3,xe=z-1,Je=(1<<z)-1;if(oe[1]=ee.convert(this),z>1){var ct=n();for(ee.sqrTo(oe[1],ct);ie<=Je;)oe[ie]=n(),ee.mulTo(ct,oe[ie-2],oe[ie]),ie+=2}var ot=O.t-1,_t,yn=!0,ft=n(),dt;for(L=h(O.data[ot])-1;ot>=0;){for(L>=xe?_t=O.data[ot]>>L-xe&Je:(_t=(O.data[ot]&(1<<L+1)-1)<<xe-L,ot>0&&(_t|=O.data[ot-1]>>this.DB+L-xe)),ie=z;!(_t&1);)_t>>=1,--ie;if((L-=ie)<0&&(L+=this.DB,--ot),yn)oe[_t].copyTo(Z),yn=!1;else{for(;ie>1;)ee.sqrTo(Z,ft),ee.sqrTo(ft,Z),ie-=2;ie>0?ee.sqrTo(Z,ft):(dt=Z,Z=ft,ft=dt),ee.mulTo(ft,oe[_t],Z)}for(;ot>=0&&!(O.data[ot]&1<<L);)ee.sqrTo(Z,ft),dt=Z,Z=ft,ft=dt,--L<0&&(L=this.DB-1,--ot)}return ee.revert(Z)}function Nl(O){var k=this.s<0?this.negate():this.clone(),L=O.s<0?O.negate():O.clone();if(k.compareTo(L)<0){var z=k;k=L,L=z}var Z=k.getLowestSetBit(),ee=L.getLowestSetBit();if(ee<0)return k;for(Z<ee&&(ee=Z),ee>0&&(k.rShiftTo(ee,k),L.rShiftTo(ee,L));k.signum()>0;)(Z=k.getLowestSetBit())>0&&k.rShiftTo(Z,k),(Z=L.getLowestSetBit())>0&&L.rShiftTo(Z,L),k.compareTo(L)>=0?(k.subTo(L,k),k.rShiftTo(1,k)):(L.subTo(k,L),L.rShiftTo(1,L));return ee>0&&L.lShiftTo(ee,L),L}function Pl(O){if(O<=0)return 0;var k=this.DV%O,L=this.s<0?O-1:0;if(this.t>0)if(k==0)L=this.data[0]%O;else for(var z=this.t-1;z>=0;--z)L=(k*L+this.data[z])%O;return L}function Ol(O){var k=O.isEven();if(this.isEven()&&k||O.signum()==0)return r.ZERO;for(var L=O.clone(),z=this.clone(),Z=S(1),ee=S(0),oe=S(0),ie=S(1);L.signum()!=0;){for(;L.isEven();)L.rShiftTo(1,L),k?((!Z.isEven()||!ee.isEven())&&(Z.addTo(this,Z),ee.subTo(O,ee)),Z.rShiftTo(1,Z)):ee.isEven()||ee.subTo(O,ee),ee.rShiftTo(1,ee);for(;z.isEven();)z.rShiftTo(1,z),k?((!oe.isEven()||!ie.isEven())&&(oe.addTo(this,oe),ie.subTo(O,ie)),oe.rShiftTo(1,oe)):ie.isEven()||ie.subTo(O,ie),ie.rShiftTo(1,ie);L.compareTo(z)>=0?(L.subTo(z,L),k&&Z.subTo(oe,Z),ee.subTo(ie,ee)):(z.subTo(L,z),k&&oe.subTo(Z,oe),ie.subTo(ee,ie))}if(z.compareTo(r.ONE)!=0)return r.ZERO;if(ie.compareTo(O)>=0)return ie.subtract(O);if(ie.signum()<0)ie.addTo(O,ie);else return ie;return ie.signum()<0?ie.add(O):ie}var lt=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],Ul=(1<<26)/lt[lt.length-1];function kl(O){var k,L=this.abs();if(L.t==1&&L.data[0]<=lt[lt.length-1]){for(k=0;k<lt.length;++k)if(L.data[0]==lt[k])return!0;return!1}if(L.isEven())return!1;for(k=1;k<lt.length;){for(var z=lt[k],Z=k+1;Z<lt.length&&z<Ul;)z*=lt[Z++];for(z=L.modInt(z);k<Z;)if(z%lt[k++]==0)return!1}return L.millerRabin(O)}function Dl(O){var k=this.subtract(r.ONE),L=k.getLowestSetBit();if(L<=0)return!1;for(var z=k.shiftRight(L),Z=Ll(),ee,oe=0;oe<O;++oe){do ee=new r(this.bitLength(),Z);while(ee.compareTo(r.ONE)<=0||ee.compareTo(k)>=0);var ie=ee.modPow(z,this);if(ie.compareTo(r.ONE)!=0&&ie.compareTo(k)!=0){for(var xe=1;xe++<L&&ie.compareTo(k)!=0;)if(ie=ie.modPowInt(2,this),ie.compareTo(r.ONE)==0)return!1;if(ie.compareTo(k)!=0)return!1}}return!0}function Ll(){return{nextBytes:function(O){for(var k=0;k<O.length;++k)O[k]=Math.floor(Math.random()*256)}}}return r.prototype.chunkSize=$,r.prototype.toRadix=G,r.prototype.fromRadix=Y,r.prototype.fromNumber=ne,r.prototype.bitwiseTo=ce,r.prototype.changeBit=pn,r.prototype.addTo=qe,r.prototype.dMultiply=ze,r.prototype.dAddOffset=We,r.prototype.multiplyLowerTo=Tl,r.prototype.multiplyUpperTo=xl,r.prototype.modInt=Pl,r.prototype.millerRabin=Dl,r.prototype.clone=U,r.prototype.intValue=P,r.prototype.byteValue=K,r.prototype.shortValue=V,r.prototype.signum=M,r.prototype.toByteArray=te,r.prototype.equals=ue,r.prototype.min=pe,r.prototype.max=ge,r.prototype.and=ve,r.prototype.or=Ne,r.prototype.xor=we,r.prototype.andNot=Ie,r.prototype.not=Te,r.prototype.shiftLeft=Ee,r.prototype.shiftRight=gt,r.prototype.getLowestSetBit=kt,r.prototype.bitCount=ur,r.prototype.testBit=Pr,r.prototype.setBit=Le,r.prototype.clearBit=Fe,r.prototype.flipBit=Me,r.prototype.add=Ve,r.prototype.subtract=Ke,r.prototype.multiply=$e,r.prototype.divide=Ge,r.prototype.remainder=je,r.prototype.divideAndRemainder=He,r.prototype.modPow=Rl,r.prototype.modInverse=Ol,r.prototype.pow=Al,r.prototype.gcd=Nl,r.prototype.isProbablePrime=kl,Za}var ei={exports:{}},ti={exports:{}},wo;function an(){if(wo)return ti.exports;wo=1;var t=me();Ut(),Ae();var e=ti.exports=t.sha1=t.sha1||{};t.md.sha1=t.md.algorithms.sha1=e,e.create=function(){n||s();var u=null,a=t.util.createBuffer(),p=new Array(80),f={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8};return f.start=function(){f.messageLength=0,f.fullMessageLength=f.messageLength64=[];for(var A=f.messageLengthSize/4,C=0;C<A;++C)f.fullMessageLength.push(0);return a=t.util.createBuffer(),u={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},f},f.start(),f.update=function(A,C){C==="utf8"&&(A=t.util.encodeUtf8(A));var y=A.length;f.messageLength+=y,y=[y/4294967296>>>0,y>>>0];for(var o=f.fullMessageLength.length-1;o>=0;--o)f.fullMessageLength[o]+=y[1],y[1]=y[0]+(f.fullMessageLength[o]/4294967296>>>0),f.fullMessageLength[o]=f.fullMessageLength[o]>>>0,y[0]=y[1]/4294967296>>>0;return a.putBytes(A),c(u,p,a),(a.read>2048||a.length()===0)&&a.compact(),f},f.digest=function(){var A=t.util.createBuffer();A.putBytes(a.bytes());var C=f.fullMessageLength[f.fullMessageLength.length-1]+f.messageLengthSize,y=C&f.blockLength-1;A.putBytes(r.substr(0,f.blockLength-y));for(var o,m,g=f.fullMessageLength[0]*8,S=0;S<f.fullMessageLength.length-1;++S)o=f.fullMessageLength[S+1]*8,m=o/4294967296>>>0,g+=m,A.putInt32(g>>>0),g=o>>>0;A.putInt32(g);var i={h0:u.h0,h1:u.h1,h2:u.h2,h3:u.h3,h4:u.h4};c(i,p,A);var v=t.util.createBuffer();return v.putInt32(i.h0),v.putInt32(i.h1),v.putInt32(i.h2),v.putInt32(i.h3),v.putInt32(i.h4),v},f};var r=null,n=!1;function s(){r=String.fromCharCode(128),r+=t.util.fillString(String.fromCharCode(0),64),n=!0}function c(u,a,p){for(var f,A,C,y,o,m,g,S,i=p.length();i>=64;){for(A=u.h0,C=u.h1,y=u.h2,o=u.h3,m=u.h4,S=0;S<16;++S)f=p.getInt32(),a[S]=f,g=o^C&(y^o),f=(A<<5|A>>>27)+g+m+1518500249+f,m=o,o=y,y=(C<<30|C>>>2)>>>0,C=A,A=f;for(;S<20;++S)f=a[S-3]^a[S-8]^a[S-14]^a[S-16],f=f<<1|f>>>31,a[S]=f,g=o^C&(y^o),f=(A<<5|A>>>27)+g+m+1518500249+f,m=o,o=y,y=(C<<30|C>>>2)>>>0,C=A,A=f;for(;S<32;++S)f=a[S-3]^a[S-8]^a[S-14]^a[S-16],f=f<<1|f>>>31,a[S]=f,g=C^y^o,f=(A<<5|A>>>27)+g+m+1859775393+f,m=o,o=y,y=(C<<30|C>>>2)>>>0,C=A,A=f;for(;S<40;++S)f=a[S-6]^a[S-16]^a[S-28]^a[S-32],f=f<<2|f>>>30,a[S]=f,g=C^y^o,f=(A<<5|A>>>27)+g+m+1859775393+f,m=o,o=y,y=(C<<30|C>>>2)>>>0,C=A,A=f;for(;S<60;++S)f=a[S-6]^a[S-16]^a[S-28]^a[S-32],f=f<<2|f>>>30,a[S]=f,g=C&y|o&(C^y),f=(A<<5|A>>>27)+g+m+2400959708+f,m=o,o=y,y=(C<<30|C>>>2)>>>0,C=A,A=f;for(;S<80;++S)f=a[S-6]^a[S-16]^a[S-28]^a[S-32],f=f<<2|f>>>30,a[S]=f,g=C^y^o,f=(A<<5|A>>>27)+g+m+3395469782+f,m=o,o=y,y=(C<<30|C>>>2)>>>0,C=A,A=f;u.h0=u.h0+A|0,u.h1=u.h1+C|0,u.h2=u.h2+y|0,u.h3=u.h3+o|0,u.h4=u.h4+m|0,i-=64}}return ti.exports}var Io;function bu(){if(Io)return ei.exports;Io=1;var t=me();Ae(),yt(),an();var e=ei.exports=t.pkcs1=t.pkcs1||{};e.encode_rsa_oaep=function(n,s,c){var u,a,p,f;typeof c=="string"?(u=c,a=arguments[3]||void 0,p=arguments[4]||void 0):c&&(u=c.label||void 0,a=c.seed||void 0,p=c.md||void 0,c.mgf1&&c.mgf1.md&&(f=c.mgf1.md)),p?p.start():p=t.md.sha1.create(),f||(f=p);var A=Math.ceil(n.n.bitLength()/8),C=A-2*p.digestLength-2;if(s.length>C){var y=new Error("RSAES-OAEP input message length is too long.");throw y.length=s.length,y.maxLength=C,y}u||(u=""),p.update(u,"raw");for(var o=p.digest(),m="",g=C-s.length,S=0;S<g;S++)m+="\0";var i=o.getBytes()+m+""+s;if(!a)a=t.random.getBytes(p.digestLength);else if(a.length!==p.digestLength){var y=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw y.seedLength=a.length,y.digestLength=p.digestLength,y}var v=r(a,A-p.digestLength-1,f),E=t.util.xorBytes(i,v,i.length),I=r(E,p.digestLength,f),B=t.util.xorBytes(a,I,a.length);return"\0"+B+E},e.decode_rsa_oaep=function(n,s,c){var u,a,p;typeof c=="string"?(u=c,a=arguments[3]||void 0):c&&(u=c.label||void 0,a=c.md||void 0,c.mgf1&&c.mgf1.md&&(p=c.mgf1.md));var f=Math.ceil(n.n.bitLength()/8);if(s.length!==f){var E=new Error("RSAES-OAEP encoded message length is invalid.");throw E.length=s.length,E.expectedLength=f,E}if(a===void 0?a=t.md.sha1.create():a.start(),p||(p=a),f<2*a.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");u||(u=""),a.update(u,"raw");for(var A=a.digest().getBytes(),C=s.charAt(0),y=s.substring(1,a.digestLength+1),o=s.substring(1+a.digestLength),m=r(o,a.digestLength,p),g=t.util.xorBytes(y,m,y.length),S=r(g,f-a.digestLength-1,p),i=t.util.xorBytes(o,S,o.length),v=i.substring(0,a.digestLength),E=C!=="\0",I=0;I<a.digestLength;++I)E|=A.charAt(I)!==v.charAt(I);for(var B=1,T=a.digestLength,h=a.digestLength;h<i.length;h++){var l=i.charCodeAt(h),R=l&1^1,N=B?65534:0;E|=l&N,B=B&R,T+=B}if(E||i.charCodeAt(T)!==1)throw new Error("Invalid RSAES-OAEP padding.");return i.substring(T+1)};function r(n,s,c){c||(c=t.md.sha1.create());for(var u="",a=Math.ceil(s/c.digestLength),p=0;p<a;++p){var f=String.fromCharCode(p>>24&255,p>>16&255,p>>8&255,p&255);c.start(),c.update(n+f),u+=c.digest().getBytes()}return u.substring(0,s)}return ei.exports}var Tn={exports:{}},bo;function Bu(){if(bo)return Tn.exports;bo=1;var t=me();return Ae(),oa(),yt(),function(){if(t.prime){Tn.exports=t.prime;return}var e=Tn.exports=t.prime=t.prime||{},r=t.jsbn.BigInteger,n=[6,4,2,4,2,4,6,2],s=new r(null);s.fromInt(30);var c=function(y,o){return y|o};e.generateProbablePrime=function(y,o,m){typeof o=="function"&&(m=o,o={}),o=o||{};var g=o.algorithm||"PRIMEINC";typeof g=="string"&&(g={name:g}),g.options=g.options||{};var S=o.prng||t.random,i={nextBytes:function(v){for(var E=S.getBytesSync(v.length),I=0;I<v.length;++I)v[I]=E.charCodeAt(I)}};if(g.name==="PRIMEINC")return u(y,i,g.options,m);throw new Error("Invalid prime generation algorithm: "+g.name)};function u(y,o,m,g){return"workers"in m?f(y,o,m,g):a(y,o,m,g)}function a(y,o,m,g){var S=A(y,o),i=0,v=C(S.bitLength());"millerRabinTests"in m&&(v=m.millerRabinTests);var E=10;"maxBlockTime"in m&&(E=m.maxBlockTime),p(S,y,o,i,v,E,g)}function p(y,o,m,g,S,i,v){var E=+new Date;do{if(y.bitLength()>o&&(y=A(o,m)),y.isProbablePrime(S))return v(null,y);y.dAddOffset(n[g++%8],0)}while(i<0||+new Date-E<i);t.util.setImmediate(function(){p(y,o,m,g,S,i,v)})}function f(y,o,m,g){if(typeof Worker>"u")return a(y,o,m,g);var S=A(y,o),i=m.workers,v=m.workLoad||100,E=v*30/8,I=m.workerScript||"forge/prime.worker.js";if(i===-1)return t.util.estimateCores(function(T,h){T&&(h=2),i=h-1,B()});B();function B(){i=Math.max(1,i);for(var T=[],h=0;h<i;++h)T[h]=new Worker(I);for(var h=0;h<i;++h)T[h].addEventListener("message",R);var l=!1;function R(N){if(!l){var F=N.data;if(F.found){for(var D=0;D<T.length;++D)T[D].terminate();return l=!0,g(null,new r(F.prime,16))}S.bitLength()>y&&(S=A(y,o));var q=S.toString(16);N.target.postMessage({hex:q,workLoad:v}),S.dAddOffset(E,0)}}}}function A(y,o){var m=new r(y,o),g=y-1;return m.testBit(g)||m.bitwiseTo(r.ONE.shiftLeft(g),c,m),m.dAddOffset(31-m.mod(s).byteValue(),0),m}function C(y){return y<=100?27:y<=150?18:y<=200?15:y<=250?12:y<=300?9:y<=350?8:y<=400?7:y<=500?6:y<=600?5:y<=800?4:y<=1250?3:2}}(),Tn.exports}var ri,Bo;function ca(){if(Bo)return ri;Bo=1;var t=me();if(Tt(),oa(),or(),bu(),Bu(),yt(),Ae(),typeof e>"u")var e=t.jsbn.BigInteger;var r=t.util.isNodejs?Wr:null,n=t.asn1,s=t.util;t.pki=t.pki||{},ri=t.pki.rsa=t.rsa=t.rsa||{};var c=t.pki,u=[6,4,2,4,2,4,6,2],a={name:"PrivateKeyInfo",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:n.Class.UNIVERSAL,type:n.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:n.Class.UNIVERSAL,type:n.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:n.Class.UNIVERSAL,type:n.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},p={name:"RSAPrivateKey",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:n.Class.UNIVERSAL,type:n.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:n.Class.UNIVERSAL,type:n.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:n.Class.UNIVERSAL,type:n.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:n.Class.UNIVERSAL,type:n.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:n.Class.UNIVERSAL,type:n.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:n.Class.UNIVERSAL,type:n.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:n.Class.UNIVERSAL,type:n.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:n.Class.UNIVERSAL,type:n.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:n.Class.UNIVERSAL,type:n.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},f={name:"RSAPublicKey",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:n.Class.UNIVERSAL,type:n.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:n.Class.UNIVERSAL,type:n.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},A=t.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:n.Class.UNIVERSAL,type:n.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:n.Class.UNIVERSAL,type:n.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},C={name:"DigestInfo",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm.algorithmIdentifier",tagClass:n.Class.UNIVERSAL,type:n.Type.OID,constructed:!1,capture:"algorithmIdentifier"},{name:"DigestInfo.DigestAlgorithm.parameters",tagClass:n.Class.UNIVERSAL,type:n.Type.NULL,capture:"parameters",optional:!0,constructed:!1}]},{name:"DigestInfo.digest",tagClass:n.Class.UNIVERSAL,type:n.Type.OCTETSTRING,constructed:!1,capture:"digest"}]},y=function(h){var l;if(h.algorithm in c.oids)l=c.oids[h.algorithm];else{var R=new Error("Unknown message digest algorithm.");throw R.algorithm=h.algorithm,R}var N=n.oidToDer(l).getBytes(),F=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[]),D=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[]);D.value.push(n.create(n.Class.UNIVERSAL,n.Type.OID,!1,N)),D.value.push(n.create(n.Class.UNIVERSAL,n.Type.NULL,!1,""));var q=n.create(n.Class.UNIVERSAL,n.Type.OCTETSTRING,!1,h.digest().getBytes());return F.value.push(D),F.value.push(q),n.toDer(F).getBytes()},o=function(h,l,R){if(R)return h.modPow(l.e,l.n);if(!l.p||!l.q)return h.modPow(l.d,l.n);l.dP||(l.dP=l.d.mod(l.p.subtract(e.ONE))),l.dQ||(l.dQ=l.d.mod(l.q.subtract(e.ONE))),l.qInv||(l.qInv=l.q.modInverse(l.p));var N;do N=new e(t.util.bytesToHex(t.random.getBytes(l.n.bitLength()/8)),16);while(N.compareTo(l.n)>=0||!N.gcd(l.n).equals(e.ONE));h=h.multiply(N.modPow(l.e,l.n)).mod(l.n);for(var F=h.mod(l.p).modPow(l.dP,l.p),D=h.mod(l.q).modPow(l.dQ,l.q);F.compareTo(D)<0;)F=F.add(l.p);var q=F.subtract(D).multiply(l.qInv).mod(l.p).multiply(l.q).add(D);return q=q.multiply(N.modInverse(l.n)).mod(l.n),q};c.rsa.encrypt=function(h,l,R){var N=R,F,D=Math.ceil(l.n.bitLength()/8);R!==!1&&R!==!0?(N=R===2,F=m(h,l,R)):(F=t.util.createBuffer(),F.putBytes(h));for(var q=new e(F.toHex(),16),j=o(q,l,N),H=j.toString(16),Q=t.util.createBuffer(),J=D-Math.ceil(H.length/2);J>0;)Q.putByte(0),--J;return Q.putBytes(t.util.hexToBytes(H)),Q.getBytes()},c.rsa.decrypt=function(h,l,R,N){var F=Math.ceil(l.n.bitLength()/8);if(h.length!==F){var D=new Error("Encrypted message length is invalid.");throw D.length=h.length,D.expected=F,D}var q=new e(t.util.createBuffer(h).toHex(),16);if(q.compareTo(l.n)>=0)throw new Error("Encrypted message is invalid.");for(var j=o(q,l,R),H=j.toString(16),Q=t.util.createBuffer(),J=F-Math.ceil(H.length/2);J>0;)Q.putByte(0),--J;return Q.putBytes(t.util.hexToBytes(H)),N!==!1?g(Q.getBytes(),l,R):Q.getBytes()},c.rsa.createKeyPairGenerationState=function(h,l,R){typeof h=="string"&&(h=parseInt(h,10)),h=h||2048,R=R||{};var N=R.prng||t.random,F={nextBytes:function(j){for(var H=N.getBytesSync(j.length),Q=0;Q<j.length;++Q)j[Q]=H.charCodeAt(Q)}},D=R.algorithm||"PRIMEINC",q;if(D==="PRIMEINC")q={algorithm:D,state:0,bits:h,rng:F,eInt:l||65537,e:new e(null),p:null,q:null,qBits:h>>1,pBits:h-(h>>1),pqState:0,num:null,keys:null},q.e.fromInt(q.eInt);else throw new Error("Invalid key generation algorithm: "+D);return q},c.rsa.stepKeyPairGenerationState=function(h,l){"algorithm"in h||(h.algorithm="PRIMEINC");var R=new e(null);R.fromInt(30);for(var N=0,F=function(X,re){return X|re},D=+new Date,q,j=0;h.keys===null&&(l<=0||j<l);){if(h.state===0){var H=h.p===null?h.pBits:h.qBits,Q=H-1;h.pqState===0?(h.num=new e(H,h.rng),h.num.testBit(Q)||h.num.bitwiseTo(e.ONE.shiftLeft(Q),F,h.num),h.num.dAddOffset(31-h.num.mod(R).byteValue(),0),N=0,++h.pqState):h.pqState===1?h.num.bitLength()>H?h.pqState=0:h.num.isProbablePrime(v(h.num.bitLength()))?++h.pqState:h.num.dAddOffset(u[N++%8],0):h.pqState===2?h.pqState=h.num.subtract(e.ONE).gcd(h.e).compareTo(e.ONE)===0?3:0:h.pqState===3&&(h.pqState=0,h.p===null?h.p=h.num:h.q=h.num,h.p!==null&&h.q!==null&&++h.state,h.num=null)}else if(h.state===1)h.p.compareTo(h.q)<0&&(h.num=h.p,h.p=h.q,h.q=h.num),++h.state;else if(h.state===2)h.p1=h.p.subtract(e.ONE),h.q1=h.q.subtract(e.ONE),h.phi=h.p1.multiply(h.q1),++h.state;else if(h.state===3)h.phi.gcd(h.e).compareTo(e.ONE)===0?++h.state:(h.p=null,h.q=null,h.state=0);else if(h.state===4)h.n=h.p.multiply(h.q),h.n.bitLength()===h.bits?++h.state:(h.q=null,h.state=0);else if(h.state===5){var J=h.e.modInverse(h.phi);h.keys={privateKey:c.rsa.setPrivateKey(h.n,h.e,J,h.p,h.q,J.mod(h.p1),J.mod(h.q1),h.q.modInverse(h.p)),publicKey:c.rsa.setPublicKey(h.n,h.e)}}q=+new Date,j+=q-D,D=q}return h.keys!==null},c.rsa.generateKeyPair=function(h,l,R,N){if(arguments.length===1?typeof h=="object"?(R=h,h=void 0):typeof h=="function"&&(N=h,h=void 0):arguments.length===2?typeof h=="number"?typeof l=="function"?(N=l,l=void 0):typeof l!="number"&&(R=l,l=void 0):(R=h,N=l,h=void 0,l=void 0):arguments.length===3&&(typeof l=="number"?typeof R=="function"&&(N=R,R=void 0):(N=R,R=l,l=void 0)),R=R||{},h===void 0&&(h=R.bits||2048),l===void 0&&(l=R.e||65537),!t.options.usePureJavaScript&&!R.prng&&h>=256&&h<=16384&&(l===65537||l===3)){if(N){if(E("generateKeyPair"))return r.generateKeyPair("rsa",{modulusLength:h,publicExponent:l,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},function(j,H,Q){if(j)return N(j);N(null,{privateKey:c.privateKeyFromPem(Q),publicKey:c.publicKeyFromPem(H)})});if(I("generateKey")&&I("exportKey"))return s.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:h,publicExponent:T(l),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(function(j){return s.globalScope.crypto.subtle.exportKey("pkcs8",j.privateKey)}).then(void 0,function(j){N(j)}).then(function(j){if(j){var H=c.privateKeyFromAsn1(n.fromDer(t.util.createBuffer(j)));N(null,{privateKey:H,publicKey:c.setRsaPublicKey(H.n,H.e)})}});if(B("generateKey")&&B("exportKey")){var F=s.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:h,publicExponent:T(l),hash:{name:"SHA-256"}},!0,["sign","verify"]);F.oncomplete=function(j){var H=j.target.result,Q=s.globalScope.msCrypto.subtle.exportKey("pkcs8",H.privateKey);Q.oncomplete=function(J){var X=J.target.result,re=c.privateKeyFromAsn1(n.fromDer(t.util.createBuffer(X)));N(null,{privateKey:re,publicKey:c.setRsaPublicKey(re.n,re.e)})},Q.onerror=function(J){N(J)}},F.onerror=function(j){N(j)};return}}else if(E("generateKeyPairSync")){var D=r.generateKeyPairSync("rsa",{modulusLength:h,publicExponent:l,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:c.privateKeyFromPem(D.privateKey),publicKey:c.publicKeyFromPem(D.publicKey)}}}var q=c.rsa.createKeyPairGenerationState(h,l,R);if(!N)return c.rsa.stepKeyPairGenerationState(q,0),q.keys;S(q,R,N)},c.setRsaPublicKey=c.rsa.setPublicKey=function(h,l){var R={n:h,e:l};return R.encrypt=function(N,F,D){if(typeof F=="string"?F=F.toUpperCase():F===void 0&&(F="RSAES-PKCS1-V1_5"),F==="RSAES-PKCS1-V1_5")F={encode:function(j,H,Q){return m(j,H,2).getBytes()}};else if(F==="RSA-OAEP"||F==="RSAES-OAEP")F={encode:function(j,H){return t.pkcs1.encode_rsa_oaep(H,j,D)}};else if(["RAW","NONE","NULL",null].indexOf(F)!==-1)F={encode:function(j){return j}};else if(typeof F=="string")throw new Error('Unsupported encryption scheme: "'+F+'".');var q=F.encode(N,R,!0);return c.rsa.encrypt(q,R,!0)},R.verify=function(N,F,D,q){typeof D=="string"?D=D.toUpperCase():D===void 0&&(D="RSASSA-PKCS1-V1_5"),q===void 0&&(q={_parseAllDigestBytes:!0}),"_parseAllDigestBytes"in q||(q._parseAllDigestBytes=!0),D==="RSASSA-PKCS1-V1_5"?D={verify:function(H,Q){Q=g(Q,R,!0);var J=n.fromDer(Q,{parseAllBytes:q._parseAllDigestBytes}),X={},re=[];if(!n.validate(J,C,X,re)){var se=new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value.");throw se.errors=re,se}var de=n.derToOid(X.algorithmIdentifier);if(!(de===t.oids.md2||de===t.oids.md5||de===t.oids.sha1||de===t.oids.sha224||de===t.oids.sha256||de===t.oids.sha384||de===t.oids.sha512||de===t.oids["sha512-224"]||de===t.oids["sha512-256"])){var se=new Error("Unknown RSASSA-PKCS1-v1_5 DigestAlgorithm identifier.");throw se.oid=de,se}if((de===t.oids.md2||de===t.oids.md5)&&!("parameters"in X))throw new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value. Missing algorithm identifer NULL parameters.");return H===X.digest}}:(D==="NONE"||D==="NULL"||D===null)&&(D={verify:function(H,Q){return Q=g(Q,R,!0),H===Q}});var j=c.rsa.decrypt(F,R,!0,!1);return D.verify(N,j,R.n.bitLength())},R},c.setRsaPrivateKey=c.rsa.setPrivateKey=function(h,l,R,N,F,D,q,j){var H={n:h,e:l,d:R,p:N,q:F,dP:D,dQ:q,qInv:j};return H.decrypt=function(Q,J,X){typeof J=="string"?J=J.toUpperCase():J===void 0&&(J="RSAES-PKCS1-V1_5");var re=c.rsa.decrypt(Q,H,!1,!1);if(J==="RSAES-PKCS1-V1_5")J={decode:g};else if(J==="RSA-OAEP"||J==="RSAES-OAEP")J={decode:function(se,de){return t.pkcs1.decode_rsa_oaep(de,se,X)}};else if(["RAW","NONE","NULL",null].indexOf(J)!==-1)J={decode:function(se){return se}};else throw new Error('Unsupported encryption scheme: "'+J+'".');return J.decode(re,H,!1)},H.sign=function(Q,J){var X=!1;typeof J=="string"&&(J=J.toUpperCase()),J===void 0||J==="RSASSA-PKCS1-V1_5"?(J={encode:y},X=1):(J==="NONE"||J==="NULL"||J===null)&&(J={encode:function(){return Q}},X=1);var re=J.encode(Q,H.n.bitLength());return c.rsa.encrypt(re,H,X)},H},c.wrapRsaPrivateKey=function(h){return n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.INTEGER,!1,n.integerToDer(0).getBytes()),n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.OID,!1,n.oidToDer(c.oids.rsaEncryption).getBytes()),n.create(n.Class.UNIVERSAL,n.Type.NULL,!1,"")]),n.create(n.Class.UNIVERSAL,n.Type.OCTETSTRING,!1,n.toDer(h).getBytes())])},c.privateKeyFromAsn1=function(h){var l={},R=[];if(n.validate(h,a,l,R)&&(h=n.fromDer(t.util.createBuffer(l.privateKey))),l={},R=[],!n.validate(h,p,l,R)){var N=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw N.errors=R,N}var F,D,q,j,H,Q,J,X;return F=t.util.createBuffer(l.privateKeyModulus).toHex(),D=t.util.createBuffer(l.privateKeyPublicExponent).toHex(),q=t.util.createBuffer(l.privateKeyPrivateExponent).toHex(),j=t.util.createBuffer(l.privateKeyPrime1).toHex(),H=t.util.createBuffer(l.privateKeyPrime2).toHex(),Q=t.util.createBuffer(l.privateKeyExponent1).toHex(),J=t.util.createBuffer(l.privateKeyExponent2).toHex(),X=t.util.createBuffer(l.privateKeyCoefficient).toHex(),c.setRsaPrivateKey(new e(F,16),new e(D,16),new e(q,16),new e(j,16),new e(H,16),new e(Q,16),new e(J,16),new e(X,16))},c.privateKeyToAsn1=c.privateKeyToRSAPrivateKey=function(h){return n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.INTEGER,!1,n.integerToDer(0).getBytes()),n.create(n.Class.UNIVERSAL,n.Type.INTEGER,!1,i(h.n)),n.create(n.Class.UNIVERSAL,n.Type.INTEGER,!1,i(h.e)),n.create(n.Class.UNIVERSAL,n.Type.INTEGER,!1,i(h.d)),n.create(n.Class.UNIVERSAL,n.Type.INTEGER,!1,i(h.p)),n.create(n.Class.UNIVERSAL,n.Type.INTEGER,!1,i(h.q)),n.create(n.Class.UNIVERSAL,n.Type.INTEGER,!1,i(h.dP)),n.create(n.Class.UNIVERSAL,n.Type.INTEGER,!1,i(h.dQ)),n.create(n.Class.UNIVERSAL,n.Type.INTEGER,!1,i(h.qInv))])},c.publicKeyFromAsn1=function(h){var l={},R=[];if(n.validate(h,A,l,R)){var N=n.derToOid(l.publicKeyOid);if(N!==c.oids.rsaEncryption){var F=new Error("Cannot read public key. Unknown OID.");throw F.oid=N,F}h=l.rsaPublicKey}if(R=[],!n.validate(h,f,l,R)){var F=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw F.errors=R,F}var D=t.util.createBuffer(l.publicKeyModulus).toHex(),q=t.util.createBuffer(l.publicKeyExponent).toHex();return c.setRsaPublicKey(new e(D,16),new e(q,16))},c.publicKeyToAsn1=c.publicKeyToSubjectPublicKeyInfo=function(h){return n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.OID,!1,n.oidToDer(c.oids.rsaEncryption).getBytes()),n.create(n.Class.UNIVERSAL,n.Type.NULL,!1,"")]),n.create(n.Class.UNIVERSAL,n.Type.BITSTRING,!1,[c.publicKeyToRSAPublicKey(h)])])},c.publicKeyToRSAPublicKey=function(h){return n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.INTEGER,!1,i(h.n)),n.create(n.Class.UNIVERSAL,n.Type.INTEGER,!1,i(h.e))])};function m(h,l,R){var N=t.util.createBuffer(),F=Math.ceil(l.n.bitLength()/8);if(h.length>F-11){var D=new Error("Message is too long for PKCS#1 v1.5 padding.");throw D.length=h.length,D.max=F-11,D}N.putByte(0),N.putByte(R);var q=F-3-h.length,j;if(R===0||R===1){j=R===0?0:255;for(var H=0;H<q;++H)N.putByte(j)}else for(;q>0;){for(var Q=0,J=t.random.getBytes(q),H=0;H<q;++H)j=J.charCodeAt(H),j===0?++Q:N.putByte(j);q=Q}return N.putByte(0),N.putBytes(h),N}function g(h,l,R,N){var F=Math.ceil(l.n.bitLength()/8),D=t.util.createBuffer(h),q=D.getByte(),j=D.getByte();if(q!==0||R&&j!==0&&j!==1||!R&&j!=2||R&&j===0&&typeof N>"u")throw new Error("Encryption block is invalid.");var H=0;if(j===0){H=F-3-N;for(var Q=0;Q<H;++Q)if(D.getByte()!==0)throw new Error("Encryption block is invalid.")}else if(j===1)for(H=0;D.length()>1;){if(D.getByte()!==255){--D.read;break}++H}else if(j===2)for(H=0;D.length()>1;){if(D.getByte()===0){--D.read;break}++H}var J=D.getByte();if(J!==0||H!==F-3-D.length())throw new Error("Encryption block is invalid.");return D.getBytes()}function S(h,l,R){typeof l=="function"&&(R=l,l={}),l=l||{};var N={algorithm:{name:l.algorithm||"PRIMEINC",options:{workers:l.workers||2,workLoad:l.workLoad||100,workerScript:l.workerScript}}};"prng"in l&&(N.prng=l.prng),F();function F(){D(h.pBits,function(j,H){if(j)return R(j);if(h.p=H,h.q!==null)return q(j,h.q);D(h.qBits,q)})}function D(j,H){t.prime.generateProbablePrime(j,N,H)}function q(j,H){if(j)return R(j);if(h.q=H,h.p.compareTo(h.q)<0){var Q=h.p;h.p=h.q,h.q=Q}if(h.p.subtract(e.ONE).gcd(h.e).compareTo(e.ONE)!==0){h.p=null,F();return}if(h.q.subtract(e.ONE).gcd(h.e).compareTo(e.ONE)!==0){h.q=null,D(h.qBits,q);return}if(h.p1=h.p.subtract(e.ONE),h.q1=h.q.subtract(e.ONE),h.phi=h.p1.multiply(h.q1),h.phi.gcd(h.e).compareTo(e.ONE)!==0){h.p=h.q=null,F();return}if(h.n=h.p.multiply(h.q),h.n.bitLength()!==h.bits){h.q=null,D(h.qBits,q);return}var J=h.e.modInverse(h.phi);h.keys={privateKey:c.rsa.setPrivateKey(h.n,h.e,J,h.p,h.q,J.mod(h.p1),J.mod(h.q1),h.q.modInverse(h.p)),publicKey:c.rsa.setPublicKey(h.n,h.e)},R(null,h.keys)}}function i(h){var l=h.toString(16);l[0]>="8"&&(l="00"+l);var R=t.util.hexToBytes(l);return R.length>1&&(R.charCodeAt(0)===0&&!(R.charCodeAt(1)&128)||R.charCodeAt(0)===255&&(R.charCodeAt(1)&128)===128)?R.substr(1):R}function v(h){return h<=100?27:h<=150?18:h<=200?15:h<=250?12:h<=300?9:h<=350?8:h<=400?7:h<=500?6:h<=600?5:h<=800?4:h<=1250?3:2}function E(h){return t.util.isNodejs&&typeof r[h]=="function"}function I(h){return typeof s.globalScope<"u"&&typeof s.globalScope.crypto=="object"&&typeof s.globalScope.crypto.subtle=="object"&&typeof s.globalScope.crypto.subtle[h]=="function"}function B(h){return typeof s.globalScope<"u"&&typeof s.globalScope.msCrypto=="object"&&typeof s.globalScope.msCrypto.subtle=="object"&&typeof s.globalScope.msCrypto.subtle[h]=="function"}function T(h){for(var l=t.util.hexToBytes(h.toString(16)),R=new Uint8Array(l.length),N=0;N<l.length;++N)R[N]=l.charCodeAt(N);return R}return ri}var ni,Ro;function Ru(){if(Ro)return ni;Ro=1;var t=me();if(sr(),Tt(),sa(),Ut(),or(),gs(),Br(),yt(),Iu(),ca(),Ae(),typeof e>"u")var e=t.jsbn.BigInteger;var r=t.asn1,n=t.pki=t.pki||{};ni=n.pbe=t.pbe=t.pbe||{};var s=n.oids,c={name:"EncryptedPrivateKeyInfo",tagClass:r.Class.UNIVERSAL,type:r.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:r.Class.UNIVERSAL,type:r.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:r.Class.UNIVERSAL,type:r.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:r.Class.UNIVERSAL,type:r.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:r.Class.UNIVERSAL,type:r.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},u={name:"PBES2Algorithms",tagClass:r.Class.UNIVERSAL,type:r.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:r.Class.UNIVERSAL,type:r.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:r.Class.UNIVERSAL,type:r.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:r.Class.UNIVERSAL,type:r.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:r.Class.UNIVERSAL,type:r.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:r.Class.UNIVERSAL,type:r.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:r.Class.UNIVERSAL,type:r.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:r.Class.UNIVERSAL,type:r.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:r.Class.UNIVERSAL,type:r.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:r.Class.UNIVERSAL,type:r.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:r.Class.UNIVERSAL,type:r.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:r.Class.UNIVERSAL,type:r.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},a={name:"pkcs-12PbeParams",tagClass:r.Class.UNIVERSAL,type:r.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:r.Class.UNIVERSAL,type:r.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:r.Class.UNIVERSAL,type:r.Type.INTEGER,constructed:!1,capture:"iterations"}]};n.encryptPrivateKeyInfo=function(y,o,m){m=m||{},m.saltSize=m.saltSize||8,m.count=m.count||2048,m.algorithm=m.algorithm||"aes128",m.prfAlgorithm=m.prfAlgorithm||"sha1";var g=t.random.getBytesSync(m.saltSize),S=m.count,i=r.integerToDer(S),v,E,I;if(m.algorithm.indexOf("aes")===0||m.algorithm==="des"){var B,T,h;switch(m.algorithm){case"aes128":v=16,B=16,T=s["aes128-CBC"],h=t.aes.createEncryptionCipher;break;case"aes192":v=24,B=16,T=s["aes192-CBC"],h=t.aes.createEncryptionCipher;break;case"aes256":v=32,B=16,T=s["aes256-CBC"],h=t.aes.createEncryptionCipher;break;case"des":v=8,B=8,T=s.desCBC,h=t.des.createEncryptionCipher;break;default:var l=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw l.algorithm=m.algorithm,l}var R="hmacWith"+m.prfAlgorithm.toUpperCase(),N=A(R),F=t.pkcs5.pbkdf2(o,g,S,v,N),D=t.random.getBytesSync(B),q=h(F);q.start(D),q.update(r.toDer(y)),q.finish(),I=q.output.getBytes();var j=C(g,i,v,R);E=r.create(r.Class.UNIVERSAL,r.Type.SEQUENCE,!0,[r.create(r.Class.UNIVERSAL,r.Type.OID,!1,r.oidToDer(s.pkcs5PBES2).getBytes()),r.create(r.Class.UNIVERSAL,r.Type.SEQUENCE,!0,[r.create(r.Class.UNIVERSAL,r.Type.SEQUENCE,!0,[r.create(r.Class.UNIVERSAL,r.Type.OID,!1,r.oidToDer(s.pkcs5PBKDF2).getBytes()),j]),r.create(r.Class.UNIVERSAL,r.Type.SEQUENCE,!0,[r.create(r.Class.UNIVERSAL,r.Type.OID,!1,r.oidToDer(T).getBytes()),r.create(r.Class.UNIVERSAL,r.Type.OCTETSTRING,!1,D)])])])}else if(m.algorithm==="3des"){v=24;var H=new t.util.ByteBuffer(g),F=n.pbe.generatePkcs12Key(o,H,1,S,v),D=n.pbe.generatePkcs12Key(o,H,2,S,v),q=t.des.createEncryptionCipher(F);q.start(D),q.update(r.toDer(y)),q.finish(),I=q.output.getBytes(),E=r.create(r.Class.UNIVERSAL,r.Type.SEQUENCE,!0,[r.create(r.Class.UNIVERSAL,r.Type.OID,!1,r.oidToDer(s["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),r.create(r.Class.UNIVERSAL,r.Type.SEQUENCE,!0,[r.create(r.Class.UNIVERSAL,r.Type.OCTETSTRING,!1,g),r.create(r.Class.UNIVERSAL,r.Type.INTEGER,!1,i.getBytes())])])}else{var l=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw l.algorithm=m.algorithm,l}var Q=r.create(r.Class.UNIVERSAL,r.Type.SEQUENCE,!0,[E,r.create(r.Class.UNIVERSAL,r.Type.OCTETSTRING,!1,I)]);return Q},n.decryptPrivateKeyInfo=function(y,o){var m=null,g={},S=[];if(!r.validate(y,c,g,S)){var i=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw i.errors=S,i}var v=r.derToOid(g.encryptionOid),E=n.pbe.getCipher(v,g.encryptionParams,o),I=t.util.createBuffer(g.encryptedData);return E.update(I),E.finish()&&(m=r.fromDer(E.output)),m},n.encryptedPrivateKeyToPem=function(y,o){var m={type:"ENCRYPTED PRIVATE KEY",body:r.toDer(y).getBytes()};return t.pem.encode(m,{maxline:o})},n.encryptedPrivateKeyFromPem=function(y){var o=t.pem.decode(y)[0];if(o.type!=="ENCRYPTED PRIVATE KEY"){var m=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw m.headerType=o.type,m}if(o.procType&&o.procType.type==="ENCRYPTED")throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return r.fromDer(o.body)},n.encryptRsaPrivateKey=function(y,o,m){if(m=m||{},!m.legacy){var g=n.wrapRsaPrivateKey(n.privateKeyToAsn1(y));return g=n.encryptPrivateKeyInfo(g,o,m),n.encryptedPrivateKeyToPem(g)}var S,i,v,E;switch(m.algorithm){case"aes128":S="AES-128-CBC",v=16,i=t.random.getBytesSync(16),E=t.aes.createEncryptionCipher;break;case"aes192":S="AES-192-CBC",v=24,i=t.random.getBytesSync(16),E=t.aes.createEncryptionCipher;break;case"aes256":S="AES-256-CBC",v=32,i=t.random.getBytesSync(16),E=t.aes.createEncryptionCipher;break;case"3des":S="DES-EDE3-CBC",v=24,i=t.random.getBytesSync(8),E=t.des.createEncryptionCipher;break;case"des":S="DES-CBC",v=8,i=t.random.getBytesSync(8),E=t.des.createEncryptionCipher;break;default:var I=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+m.algorithm+'".');throw I.algorithm=m.algorithm,I}var B=t.pbe.opensslDeriveBytes(o,i.substr(0,8),v),T=E(B);T.start(i),T.update(r.toDer(n.privateKeyToAsn1(y))),T.finish();var h={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:S,parameters:t.util.bytesToHex(i).toUpperCase()},body:T.output.getBytes()};return t.pem.encode(h)},n.decryptRsaPrivateKey=function(y,o){var m=null,g=t.pem.decode(y)[0];if(g.type!=="ENCRYPTED PRIVATE KEY"&&g.type!=="PRIVATE KEY"&&g.type!=="RSA PRIVATE KEY"){var S=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');throw S.headerType=S,S}if(g.procType&&g.procType.type==="ENCRYPTED"){var i,v;switch(g.dekInfo.algorithm){case"DES-CBC":i=8,v=t.des.createDecryptionCipher;break;case"DES-EDE3-CBC":i=24,v=t.des.createDecryptionCipher;break;case"AES-128-CBC":i=16,v=t.aes.createDecryptionCipher;break;case"AES-192-CBC":i=24,v=t.aes.createDecryptionCipher;break;case"AES-256-CBC":i=32,v=t.aes.createDecryptionCipher;break;case"RC2-40-CBC":i=5,v=function(h){return t.rc2.createDecryptionCipher(h,40)};break;case"RC2-64-CBC":i=8,v=function(h){return t.rc2.createDecryptionCipher(h,64)};break;case"RC2-128-CBC":i=16,v=function(h){return t.rc2.createDecryptionCipher(h,128)};break;default:var S=new Error('Could not decrypt private key; unsupported encryption algorithm "'+g.dekInfo.algorithm+'".');throw S.algorithm=g.dekInfo.algorithm,S}var E=t.util.hexToBytes(g.dekInfo.parameters),I=t.pbe.opensslDeriveBytes(o,E.substr(0,8),i),B=v(I);if(B.start(E),B.update(t.util.createBuffer(g.body)),B.finish())m=B.output.getBytes();else return m}else m=g.body;return g.type==="ENCRYPTED PRIVATE KEY"?m=n.decryptPrivateKeyInfo(r.fromDer(m),o):m=r.fromDer(m),m!==null&&(m=n.privateKeyFromAsn1(m)),m},n.pbe.generatePkcs12Key=function(y,o,m,g,S,i){var v,E;if(typeof i>"u"||i===null){if(!("sha1"in t.md))throw new Error('"sha1" hash algorithm unavailable.');i=t.md.sha1.create()}var I=i.digestLength,B=i.blockLength,T=new t.util.ByteBuffer,h=new t.util.ByteBuffer;if(y!=null){for(E=0;E<y.length;E++)h.putInt16(y.charCodeAt(E));h.putInt16(0)}var l=h.length(),R=o.length(),N=new t.util.ByteBuffer;N.fillWithByte(m,B);var F=B*Math.ceil(R/B),D=new t.util.ByteBuffer;for(E=0;E<F;E++)D.putByte(o.at(E%R));var q=B*Math.ceil(l/B),j=new t.util.ByteBuffer;for(E=0;E<q;E++)j.putByte(h.at(E%l));var H=D;H.putBuffer(j);for(var Q=Math.ceil(S/I),J=1;J<=Q;J++){var X=new t.util.ByteBuffer;X.putBytes(N.bytes()),X.putBytes(H.bytes());for(var re=0;re<g;re++)i.start(),i.update(X.getBytes()),X=i.digest();var se=new t.util.ByteBuffer;for(E=0;E<B;E++)se.putByte(X.at(E%I));var de=Math.ceil(R/B)+Math.ceil(l/B),ye=new t.util.ByteBuffer;for(v=0;v<de;v++){var _e=new t.util.ByteBuffer(H.getBytes(B)),W=511;for(E=se.length()-1;E>=0;E--)W=W>>8,W+=se.at(E)+_e.at(E),_e.setAt(E,W&255);ye.putBuffer(_e)}H=ye,T.putBuffer(X)}return T.truncate(T.length()-S),T},n.pbe.getCipher=function(y,o,m){switch(y){case n.oids.pkcs5PBES2:return n.pbe.getCipherForPBES2(y,o,m);case n.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case n.oids["pbewithSHAAnd40BitRC2-CBC"]:return n.pbe.getCipherForPKCS12PBE(y,o,m);default:var g=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw g.oid=y,g.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],g}},n.pbe.getCipherForPBES2=function(y,o,m){var g={},S=[];if(!r.validate(o,u,g,S)){var i=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw i.errors=S,i}if(y=r.derToOid(g.kdfOid),y!==n.oids.pkcs5PBKDF2){var i=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw i.oid=y,i.supportedOids=["pkcs5PBKDF2"],i}if(y=r.derToOid(g.encOid),y!==n.oids["aes128-CBC"]&&y!==n.oids["aes192-CBC"]&&y!==n.oids["aes256-CBC"]&&y!==n.oids["des-EDE3-CBC"]&&y!==n.oids.desCBC){var i=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw i.oid=y,i.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],i}var v=g.kdfSalt,E=t.util.createBuffer(g.kdfIterationCount);E=E.getInt(E.length()<<3);var I,B;switch(n.oids[y]){case"aes128-CBC":I=16,B=t.aes.createDecryptionCipher;break;case"aes192-CBC":I=24,B=t.aes.createDecryptionCipher;break;case"aes256-CBC":I=32,B=t.aes.createDecryptionCipher;break;case"des-EDE3-CBC":I=24,B=t.des.createDecryptionCipher;break;case"desCBC":I=8,B=t.des.createDecryptionCipher;break}var T=f(g.prfOid),h=t.pkcs5.pbkdf2(m,v,E,I,T),l=g.encIv,R=B(h);return R.start(l),R},n.pbe.getCipherForPKCS12PBE=function(y,o,m){var g={},S=[];if(!r.validate(o,a,g,S)){var i=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw i.errors=S,i}var v=t.util.createBuffer(g.salt),E=t.util.createBuffer(g.iterations);E=E.getInt(E.length()<<3);var I,B,T;switch(y){case n.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:I=24,B=8,T=t.des.startDecrypting;break;case n.oids["pbewithSHAAnd40BitRC2-CBC"]:I=5,B=8,T=function(F,D){var q=t.rc2.createDecryptionCipher(F,40);return q.start(D,null),q};break;default:var i=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw i.oid=y,i}var h=f(g.prfOid),l=n.pbe.generatePkcs12Key(m,v,1,E,I,h);h.start();var R=n.pbe.generatePkcs12Key(m,v,2,E,B,h);return T(l,R)},n.pbe.opensslDeriveBytes=function(y,o,m,g){if(typeof g>"u"||g===null){if(!("md5"in t.md))throw new Error('"md5" hash algorithm unavailable.');g=t.md.md5.create()}o===null&&(o="");for(var S=[p(g,y+o)],i=16,v=1;i<m;++v,i+=16)S.push(p(g,S[v-1]+y+o));return S.join("").substr(0,m)};function p(y,o){return y.start().update(o).digest().getBytes()}function f(y){var o;if(!y)o="hmacWithSHA1";else if(o=n.oids[r.derToOid(y)],!o){var m=new Error("Unsupported PRF OID.");throw m.oid=y,m.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],m}return A(o)}function A(y){var o=t.md;switch(y){case"hmacWithSHA224":o=t.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":y=y.substr(8).toLowerCase();break;default:var m=new Error("Unsupported PRF algorithm.");throw m.algorithm=y,m.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],m}if(!o||!(y in o))throw new Error("Unknown hash algorithm: "+y);return o[y].create()}function C(y,o,m,g){var S=r.create(r.Class.UNIVERSAL,r.Type.SEQUENCE,!0,[r.create(r.Class.UNIVERSAL,r.Type.OCTETSTRING,!1,y),r.create(r.Class.UNIVERSAL,r.Type.INTEGER,!1,o.getBytes())]);return g!=="hmacWithSHA1"&&S.value.push(r.create(r.Class.UNIVERSAL,r.Type.INTEGER,!1,t.util.hexToBytes(m.toString(16))),r.create(r.Class.UNIVERSAL,r.Type.SEQUENCE,!0,[r.create(r.Class.UNIVERSAL,r.Type.OID,!1,r.oidToDer(n.oids[g]).getBytes()),r.create(r.Class.UNIVERSAL,r.Type.NULL,!1,"")])),S}return ni}var ai={exports:{}},ii={exports:{}},No;function Nu(){if(No)return ii.exports;No=1;var t=me();Tt(),Ae();var e=t.asn1,r=ii.exports=t.pkcs7asn1=t.pkcs7asn1||{};t.pkcs7=t.pkcs7||{},t.pkcs7.asn1=r;var n={name:"ContentInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.ContentType",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,captureAsn1:"content"}]};r.contentInfoValidator=n;var s={name:"EncryptedContentInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentType",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"contentType"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentEncryptionAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm.parameter",tagClass:e.Class.UNIVERSAL,captureAsn1:"encParameter"}]},{name:"EncryptedContentInfo.encryptedContent",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,capture:"encryptedContent",captureAsn1:"encryptedContentAsn1"}]};r.envelopedDataValidator={name:"EnvelopedData",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"EnvelopedData.Version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"version"},{name:"EnvelopedData.RecipientInfos",tagClass:e.Class.UNIVERSAL,type:e.Type.SET,constructed:!0,captureAsn1:"recipientInfos"}].concat(s)},r.encryptedDataValidator={name:"EncryptedData",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedData.Version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"version"}].concat(s)};var c={name:"SignerInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1},{name:"SignerInfo.issuerAndSerialNumber",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.issuerAndSerialNumber.issuer",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"SignerInfo.issuerAndSerialNumber.serialNumber",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"SignerInfo.digestAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.digestAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"digestAlgorithm"},{name:"SignerInfo.digestAlgorithm.parameter",tagClass:e.Class.UNIVERSAL,constructed:!1,captureAsn1:"digestParameter",optional:!0}]},{name:"SignerInfo.authenticatedAttributes",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"authenticatedAttributes"},{name:"SignerInfo.digestEncryptionAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,capture:"signatureAlgorithm"},{name:"SignerInfo.encryptedDigest",tagClass:e.Class.UNIVERSAL,type:e.Type.OCTETSTRING,constructed:!1,capture:"signature"},{name:"SignerInfo.unauthenticatedAttributes",tagClass:e.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,capture:"unauthenticatedAttributes"}]};return r.signedDataValidator={name:"SignedData",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"SignedData.Version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"version"},{name:"SignedData.DigestAlgorithms",tagClass:e.Class.UNIVERSAL,type:e.Type.SET,constructed:!0,captureAsn1:"digestAlgorithms"},n,{name:"SignedData.Certificates",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,optional:!0,captureAsn1:"certificates"},{name:"SignedData.CertificateRevocationLists",tagClass:e.Class.CONTEXT_SPECIFIC,type:1,optional:!0,captureAsn1:"crls"},{name:"SignedData.SignerInfos",tagClass:e.Class.UNIVERSAL,type:e.Type.SET,capture:"signerInfos",optional:!0,value:[c]}]},r.recipientInfoValidator={name:"RecipientInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"version"},{name:"RecipientInfo.issuerAndSerial",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.issuerAndSerial.issuer",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"RecipientInfo.issuerAndSerial.serialNumber",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"RecipientInfo.keyEncryptionAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.keyEncryptionAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"RecipientInfo.keyEncryptionAlgorithm.parameter",tagClass:e.Class.UNIVERSAL,constructed:!1,captureAsn1:"encParameter",optional:!0}]},{name:"RecipientInfo.encryptedKey",tagClass:e.Class.UNIVERSAL,type:e.Type.OCTETSTRING,constructed:!1,capture:"encKey"}]},ii.exports}var si={exports:{}},oi={exports:{}},Po;function Pu(){if(Po)return oi.exports;Po=1;var t=me();Ae(),t.mgf=t.mgf||{};var e=oi.exports=t.mgf.mgf1=t.mgf1=t.mgf1||{};return e.create=function(r){var n={generate:function(s,c){for(var u=new t.util.ByteBuffer,a=Math.ceil(c/r.digestLength),p=0;p<a;p++){var f=new t.util.ByteBuffer;f.putInt32(p),r.start(),r.update(s+f.getBytes()),u.putBuffer(r.digest())}return u.truncate(u.length()-c),u.getBytes()}};return n},oi.exports}var ci,Oo;function nd(){if(Oo)return ci;Oo=1;var t=me();return Pu(),ci=t.mgf=t.mgf||{},t.mgf.mgf1=t.mgf1,ci}var ui={exports:{}},Uo;function vs(){if(Uo)return ui.exports;Uo=1;var t=me();yt(),Ae();var e=ui.exports=t.pss=t.pss||{};return e.create=function(r){arguments.length===3&&(r={md:arguments[0],mgf:arguments[1],saltLength:arguments[2]});var n=r.md,s=r.mgf,c=n.digestLength,u=r.salt||null;typeof u=="string"&&(u=t.util.createBuffer(u));var a;if("saltLength"in r)a=r.saltLength;else if(u!==null)a=u.length();else throw new Error("Salt length not specified or specific salt not given.");if(u!==null&&u.length()!==a)throw new Error("Given salt length does not match length of given salt.");var p=r.prng||t.random,f={};return f.encode=function(A,C){var y,o=C-1,m=Math.ceil(o/8),g=A.digest().getBytes();if(m<c+a+2)throw new Error("Message is too long to encrypt.");var S;u===null?S=p.getBytesSync(a):S=u.bytes();var i=new t.util.ByteBuffer;i.fillWithByte(0,8),i.putBytes(g),i.putBytes(S),n.start(),n.update(i.getBytes());var v=n.digest().getBytes(),E=new t.util.ByteBuffer;E.fillWithByte(0,m-a-c-2),E.putByte(1),E.putBytes(S);var I=E.getBytes(),B=m-c-1,T=s.generate(v,B),h="";for(y=0;y<B;y++)h+=String.fromCharCode(I.charCodeAt(y)^T.charCodeAt(y));var l=65280>>8*m-o&255;return h=String.fromCharCode(h.charCodeAt(0)&~l)+h.substr(1),h+v+String.fromCharCode(188)},f.verify=function(A,C,y){var o,m=y-1,g=Math.ceil(m/8);if(C=C.substr(-g),g<c+a+2)throw new Error("Inconsistent parameters to PSS signature verification.");if(C.charCodeAt(g-1)!==188)throw new Error("Encoded message does not end in 0xBC.");var S=g-c-1,i=C.substr(0,S),v=C.substr(S,c),E=65280>>8*g-m&255;if(i.charCodeAt(0)&E)throw new Error("Bits beyond keysize not zero as expected.");var I=s.generate(v,S),B="";for(o=0;o<S;o++)B+=String.fromCharCode(i.charCodeAt(o)^I.charCodeAt(o));B=String.fromCharCode(B.charCodeAt(0)&~E)+B.substr(1);var T=g-c-a-2;for(o=0;o<T;o++)if(B.charCodeAt(o)!==0)throw new Error("Leftmost octets not zero as expected");if(B.charCodeAt(T)!==1)throw new Error("Inconsistent PSS signature, 0x01 marker not found");var h=B.substr(-a),l=new t.util.ByteBuffer;l.fillWithByte(0,8),l.putBytes(A),l.putBytes(h),n.start(),n.update(l.getBytes());var R=n.digest().getBytes();return v===R},f},ui.exports}var ko;function ms(){if(ko)return si.exports;ko=1;var t=me();sr(),Tt(),sa(),Ut(),nd(),or(),Br(),vs(),ca(),Ae();var e=t.asn1,r=si.exports=t.pki=t.pki||{},n=r.oids,s={};s.CN=n.commonName,s.commonName="CN",s.C=n.countryName,s.countryName="C",s.L=n.localityName,s.localityName="L",s.ST=n.stateOrProvinceName,s.stateOrProvinceName="ST",s.O=n.organizationName,s.organizationName="O",s.OU=n.organizationalUnitName,s.organizationalUnitName="OU",s.E=n.emailAddress,s.emailAddress="E";var c=t.pki.rsa.publicKeyValidator,u={name:"Certificate",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"tbsCertificate",value:[{name:"Certificate.TBSCertificate.version",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.version.integer",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"certVersion"}]},{name:"Certificate.TBSCertificate.serialNumber",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"certSerialNumber"},{name:"Certificate.TBSCertificate.signature",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.signature.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"certinfoSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:e.Class.UNIVERSAL,optional:!0,captureAsn1:"certinfoSignatureParams"}]},{name:"Certificate.TBSCertificate.issuer",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"certIssuer"},{name:"Certificate.TBSCertificate.validity",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.validity.notBefore (utc)",tagClass:e.Class.UNIVERSAL,type:e.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity1UTCTime"},{name:"Certificate.TBSCertificate.validity.notBefore (generalized)",tagClass:e.Class.UNIVERSAL,type:e.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity2GeneralizedTime"},{name:"Certificate.TBSCertificate.validity.notAfter (utc)",tagClass:e.Class.UNIVERSAL,type:e.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity3UTCTime"},{name:"Certificate.TBSCertificate.validity.notAfter (generalized)",tagClass:e.Class.UNIVERSAL,type:e.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity4GeneralizedTime"}]},{name:"Certificate.TBSCertificate.subject",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"certSubject"},c,{name:"Certificate.TBSCertificate.issuerUniqueID",tagClass:e.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.issuerUniqueID.id",tagClass:e.Class.UNIVERSAL,type:e.Type.BITSTRING,constructed:!1,captureBitStringValue:"certIssuerUniqueId"}]},{name:"Certificate.TBSCertificate.subjectUniqueID",tagClass:e.Class.CONTEXT_SPECIFIC,type:2,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.subjectUniqueID.id",tagClass:e.Class.UNIVERSAL,type:e.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSubjectUniqueId"}]},{name:"Certificate.TBSCertificate.extensions",tagClass:e.Class.CONTEXT_SPECIFIC,type:3,constructed:!0,captureAsn1:"certExtensions",optional:!0}]},{name:"Certificate.signatureAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.signatureAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"certSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:e.Class.UNIVERSAL,optional:!0,captureAsn1:"certSignatureParams"}]},{name:"Certificate.signatureValue",tagClass:e.Class.UNIVERSAL,type:e.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSignature"}]},a={name:"rsapss",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.hashAlgorithm",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier",tagClass:e.Class.UNIVERSAL,type:e.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"hashOid"}]}]},{name:"rsapss.maskGenAlgorithm",tagClass:e.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier",tagClass:e.Class.UNIVERSAL,type:e.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"maskGenOid"},{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"maskGenHashOid"}]}]}]},{name:"rsapss.saltLength",tagClass:e.Class.CONTEXT_SPECIFIC,type:2,optional:!0,value:[{name:"rsapss.saltLength.saltLength",tagClass:e.Class.UNIVERSAL,type:e.Class.INTEGER,constructed:!1,capture:"saltLength"}]},{name:"rsapss.trailerField",tagClass:e.Class.CONTEXT_SPECIFIC,type:3,optional:!0,value:[{name:"rsapss.trailer.trailer",tagClass:e.Class.UNIVERSAL,type:e.Class.INTEGER,constructed:!1,capture:"trailer"}]}]},p={name:"CertificationRequestInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfo",value:[{name:"CertificationRequestInfo.integer",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"certificationRequestInfoVersion"},{name:"CertificationRequestInfo.subject",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfoSubject"},c,{name:"CertificationRequestInfo.attributes",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"certificationRequestInfoAttributes",value:[{name:"CertificationRequestInfo.attributes",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequestInfo.attributes.type",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1},{name:"CertificationRequestInfo.attributes.value",tagClass:e.Class.UNIVERSAL,type:e.Type.SET,constructed:!0}]}]}]},f={name:"CertificationRequest",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"csr",value:[p,{name:"CertificationRequest.signatureAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequest.signatureAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"csrSignatureOid"},{name:"CertificationRequest.signatureAlgorithm.parameters",tagClass:e.Class.UNIVERSAL,optional:!0,captureAsn1:"csrSignatureParams"}]},{name:"CertificationRequest.signature",tagClass:e.Class.UNIVERSAL,type:e.Type.BITSTRING,constructed:!1,captureBitStringValue:"csrSignature"}]};r.RDNAttributesAsArray=function(T,h){for(var l=[],R,N,F,D=0;D<T.value.length;++D){R=T.value[D];for(var q=0;q<R.value.length;++q)F={},N=R.value[q],F.type=e.derToOid(N.value[0].value),F.value=N.value[1].value,F.valueTagClass=N.value[1].type,F.type in n&&(F.name=n[F.type],F.name in s&&(F.shortName=s[F.name])),h&&(h.update(F.type),h.update(F.value)),l.push(F)}return l},r.CRIAttributesAsArray=function(T){for(var h=[],l=0;l<T.length;++l)for(var R=T[l],N=e.derToOid(R.value[0].value),F=R.value[1].value,D=0;D<F.length;++D){var q={};if(q.type=N,q.value=F[D].value,q.valueTagClass=F[D].type,q.type in n&&(q.name=n[q.type],q.name in s&&(q.shortName=s[q.name])),q.type===n.extensionRequest){q.extensions=[];for(var j=0;j<q.value.length;++j)q.extensions.push(r.certificateExtensionFromAsn1(q.value[j]))}h.push(q)}return h};function A(T,h){typeof h=="string"&&(h={shortName:h});for(var l=null,R,N=0;l===null&&N<T.attributes.length;++N)R=T.attributes[N],(h.type&&h.type===R.type||h.name&&h.name===R.name||h.shortName&&h.shortName===R.shortName)&&(l=R);return l}var C=function(T,h,l){var R={};if(T!==n["RSASSA-PSS"])return R;l&&(R={hash:{algorithmOid:n.sha1},mgf:{algorithmOid:n.mgf1,hash:{algorithmOid:n.sha1}},saltLength:20});var N={},F=[];if(!e.validate(h,a,N,F)){var D=new Error("Cannot read RSASSA-PSS parameter block.");throw D.errors=F,D}return N.hashOid!==void 0&&(R.hash=R.hash||{},R.hash.algorithmOid=e.derToOid(N.hashOid)),N.maskGenOid!==void 0&&(R.mgf=R.mgf||{},R.mgf.algorithmOid=e.derToOid(N.maskGenOid),R.mgf.hash=R.mgf.hash||{},R.mgf.hash.algorithmOid=e.derToOid(N.maskGenHashOid)),N.saltLength!==void 0&&(R.saltLength=N.saltLength.charCodeAt(0)),R},y=function(T){switch(n[T.signatureOid]){case"sha1WithRSAEncryption":case"sha1WithRSASignature":return t.md.sha1.create();case"md5WithRSAEncryption":return t.md.md5.create();case"sha256WithRSAEncryption":return t.md.sha256.create();case"sha384WithRSAEncryption":return t.md.sha384.create();case"sha512WithRSAEncryption":return t.md.sha512.create();case"RSASSA-PSS":return t.md.sha256.create();default:var h=new Error("Could not compute "+T.type+" digest. Unknown signature OID.");throw h.signatureOid=T.signatureOid,h}},o=function(T){var h=T.certificate,l;switch(h.signatureOid){case n.sha1WithRSAEncryption:case n.sha1WithRSASignature:break;case n["RSASSA-PSS"]:var R,N;if(R=n[h.signatureParameters.mgf.hash.algorithmOid],R===void 0||t.md[R]===void 0){var F=new Error("Unsupported MGF hash function.");throw F.oid=h.signatureParameters.mgf.hash.algorithmOid,F.name=R,F}if(N=n[h.signatureParameters.mgf.algorithmOid],N===void 0||t.mgf[N]===void 0){var F=new Error("Unsupported MGF function.");throw F.oid=h.signatureParameters.mgf.algorithmOid,F.name=N,F}if(N=t.mgf[N].create(t.md[R].create()),R=n[h.signatureParameters.hash.algorithmOid],R===void 0||t.md[R]===void 0){var F=new Error("Unsupported RSASSA-PSS hash function.");throw F.oid=h.signatureParameters.hash.algorithmOid,F.name=R,F}l=t.pss.create(t.md[R].create(),N,h.signatureParameters.saltLength);break}return h.publicKey.verify(T.md.digest().getBytes(),T.signature,l)};r.certificateFromPem=function(T,h,l){var R=t.pem.decode(T)[0];if(R.type!=="CERTIFICATE"&&R.type!=="X509 CERTIFICATE"&&R.type!=="TRUSTED CERTIFICATE"){var N=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw N.headerType=R.type,N}if(R.procType&&R.procType.type==="ENCRYPTED")throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var F=e.fromDer(R.body,l);return r.certificateFromAsn1(F,h)},r.certificateToPem=function(T,h){var l={type:"CERTIFICATE",body:e.toDer(r.certificateToAsn1(T)).getBytes()};return t.pem.encode(l,{maxline:h})},r.publicKeyFromPem=function(T){var h=t.pem.decode(T)[0];if(h.type!=="PUBLIC KEY"&&h.type!=="RSA PUBLIC KEY"){var l=new Error('Could not convert public key from PEM; PEM header type is not "PUBLIC KEY" or "RSA PUBLIC KEY".');throw l.headerType=h.type,l}if(h.procType&&h.procType.type==="ENCRYPTED")throw new Error("Could not convert public key from PEM; PEM is encrypted.");var R=e.fromDer(h.body);return r.publicKeyFromAsn1(R)},r.publicKeyToPem=function(T,h){var l={type:"PUBLIC KEY",body:e.toDer(r.publicKeyToAsn1(T)).getBytes()};return t.pem.encode(l,{maxline:h})},r.publicKeyToRSAPublicKeyPem=function(T,h){var l={type:"RSA PUBLIC KEY",body:e.toDer(r.publicKeyToRSAPublicKey(T)).getBytes()};return t.pem.encode(l,{maxline:h})},r.getPublicKeyFingerprint=function(T,h){h=h||{};var l=h.md||t.md.sha1.create(),R=h.type||"RSAPublicKey",N;switch(R){case"RSAPublicKey":N=e.toDer(r.publicKeyToRSAPublicKey(T)).getBytes();break;case"SubjectPublicKeyInfo":N=e.toDer(r.publicKeyToAsn1(T)).getBytes();break;default:throw new Error('Unknown fingerprint type "'+h.type+'".')}l.start(),l.update(N);var F=l.digest();if(h.encoding==="hex"){var D=F.toHex();return h.delimiter?D.match(/.{2}/g).join(h.delimiter):D}else{if(h.encoding==="binary")return F.getBytes();if(h.encoding)throw new Error('Unknown encoding "'+h.encoding+'".')}return F},r.certificationRequestFromPem=function(T,h,l){var R=t.pem.decode(T)[0];if(R.type!=="CERTIFICATE REQUEST"){var N=new Error('Could not convert certification request from PEM; PEM header type is not "CERTIFICATE REQUEST".');throw N.headerType=R.type,N}if(R.procType&&R.procType.type==="ENCRYPTED")throw new Error("Could not convert certification request from PEM; PEM is encrypted.");var F=e.fromDer(R.body,l);return r.certificationRequestFromAsn1(F,h)},r.certificationRequestToPem=function(T,h){var l={type:"CERTIFICATE REQUEST",body:e.toDer(r.certificationRequestToAsn1(T)).getBytes()};return t.pem.encode(l,{maxline:h})},r.createCertificate=function(){var T={};return T.version=2,T.serialNumber="00",T.signatureOid=null,T.signature=null,T.siginfo={},T.siginfo.algorithmOid=null,T.validity={},T.validity.notBefore=new Date,T.validity.notAfter=new Date,T.issuer={},T.issuer.getField=function(h){return A(T.issuer,h)},T.issuer.addField=function(h){g([h]),T.issuer.attributes.push(h)},T.issuer.attributes=[],T.issuer.hash=null,T.subject={},T.subject.getField=function(h){return A(T.subject,h)},T.subject.addField=function(h){g([h]),T.subject.attributes.push(h)},T.subject.attributes=[],T.subject.hash=null,T.extensions=[],T.publicKey=null,T.md=null,T.setSubject=function(h,l){g(h),T.subject.attributes=h,delete T.subject.uniqueId,l&&(T.subject.uniqueId=l),T.subject.hash=null},T.setIssuer=function(h,l){g(h),T.issuer.attributes=h,delete T.issuer.uniqueId,l&&(T.issuer.uniqueId=l),T.issuer.hash=null},T.setExtensions=function(h){for(var l=0;l<h.length;++l)S(h[l],{cert:T});T.extensions=h},T.getExtension=function(h){typeof h=="string"&&(h={name:h});for(var l=null,R,N=0;l===null&&N<T.extensions.length;++N)R=T.extensions[N],(h.id&&R.id===h.id||h.name&&R.name===h.name)&&(l=R);return l},T.sign=function(h,l){T.md=l||t.md.sha1.create();var R=n[T.md.algorithm+"WithRSAEncryption"];if(!R){var N=new Error("Could not compute certificate digest. Unknown message digest algorithm OID.");throw N.algorithm=T.md.algorithm,N}T.signatureOid=T.siginfo.algorithmOid=R,T.tbsCertificate=r.getTBSCertificate(T);var F=e.toDer(T.tbsCertificate);T.md.update(F.getBytes()),T.signature=h.sign(T.md)},T.verify=function(h){var l=!1;if(!T.issued(h)){var R=h.issuer,N=T.subject,F=new Error("The parent certificate did not issue the given child certificate; the child certificate's issuer does not match the parent's subject.");throw F.expectedIssuer=N.attributes,F.actualIssuer=R.attributes,F}var D=h.md;if(D===null){D=y({signatureOid:h.signatureOid,type:"certificate"});var q=h.tbsCertificate||r.getTBSCertificate(h),j=e.toDer(q);D.update(j.getBytes())}return D!==null&&(l=o({certificate:T,md:D,signature:h.signature})),l},T.isIssuer=function(h){var l=!1,R=T.issuer,N=h.subject;if(R.hash&&N.hash)l=R.hash===N.hash;else if(R.attributes.length===N.attributes.length){l=!0;for(var F,D,q=0;l&&q<R.attributes.length;++q)F=R.attributes[q],D=N.attributes[q],(F.type!==D.type||F.value!==D.value)&&(l=!1)}return l},T.issued=function(h){return h.isIssuer(T)},T.generateSubjectKeyIdentifier=function(){return r.getPublicKeyFingerprint(T.publicKey,{type:"RSAPublicKey"})},T.verifySubjectKeyIdentifier=function(){for(var h=n.subjectKeyIdentifier,l=0;l<T.extensions.length;++l){var R=T.extensions[l];if(R.id===h){var N=T.generateSubjectKeyIdentifier().getBytes();return t.util.hexToBytes(R.subjectKeyIdentifier)===N}}return!1},T},r.certificateFromAsn1=function(T,h){var l={},R=[];if(!e.validate(T,u,l,R)){var N=new Error("Cannot read X.509 certificate. ASN.1 object is not an X509v3 Certificate.");throw N.errors=R,N}var F=e.derToOid(l.publicKeyOid);if(F!==r.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var D=r.createCertificate();D.version=l.certVersion?l.certVersion.charCodeAt(0):0;var q=t.util.createBuffer(l.certSerialNumber);D.serialNumber=q.toHex(),D.signatureOid=t.asn1.derToOid(l.certSignatureOid),D.signatureParameters=C(D.signatureOid,l.certSignatureParams,!0),D.siginfo.algorithmOid=t.asn1.derToOid(l.certinfoSignatureOid),D.siginfo.parameters=C(D.siginfo.algorithmOid,l.certinfoSignatureParams,!1),D.signature=l.certSignature;var j=[];if(l.certValidity1UTCTime!==void 0&&j.push(e.utcTimeToDate(l.certValidity1UTCTime)),l.certValidity2GeneralizedTime!==void 0&&j.push(e.generalizedTimeToDate(l.certValidity2GeneralizedTime)),l.certValidity3UTCTime!==void 0&&j.push(e.utcTimeToDate(l.certValidity3UTCTime)),l.certValidity4GeneralizedTime!==void 0&&j.push(e.generalizedTimeToDate(l.certValidity4GeneralizedTime)),j.length>2)throw new Error("Cannot read notBefore/notAfter validity times; more than two times were provided in the certificate.");if(j.length<2)throw new Error("Cannot read notBefore/notAfter validity times; they were not provided as either UTCTime or GeneralizedTime.");if(D.validity.notBefore=j[0],D.validity.notAfter=j[1],D.tbsCertificate=l.tbsCertificate,h){D.md=y({signatureOid:D.signatureOid,type:"certificate"});var H=e.toDer(D.tbsCertificate);D.md.update(H.getBytes())}var Q=t.md.sha1.create(),J=e.toDer(l.certIssuer);Q.update(J.getBytes()),D.issuer.getField=function(se){return A(D.issuer,se)},D.issuer.addField=function(se){g([se]),D.issuer.attributes.push(se)},D.issuer.attributes=r.RDNAttributesAsArray(l.certIssuer),l.certIssuerUniqueId&&(D.issuer.uniqueId=l.certIssuerUniqueId),D.issuer.hash=Q.digest().toHex();var X=t.md.sha1.create(),re=e.toDer(l.certSubject);return X.update(re.getBytes()),D.subject.getField=function(se){return A(D.subject,se)},D.subject.addField=function(se){g([se]),D.subject.attributes.push(se)},D.subject.attributes=r.RDNAttributesAsArray(l.certSubject),l.certSubjectUniqueId&&(D.subject.uniqueId=l.certSubjectUniqueId),D.subject.hash=X.digest().toHex(),l.certExtensions?D.extensions=r.certificateExtensionsFromAsn1(l.certExtensions):D.extensions=[],D.publicKey=r.publicKeyFromAsn1(l.subjectPublicKeyInfo),D},r.certificateExtensionsFromAsn1=function(T){for(var h=[],l=0;l<T.value.length;++l)for(var R=T.value[l],N=0;N<R.value.length;++N)h.push(r.certificateExtensionFromAsn1(R.value[N]));return h},r.certificateExtensionFromAsn1=function(T){var h={};if(h.id=e.derToOid(T.value[0].value),h.critical=!1,T.value[1].type===e.Type.BOOLEAN?(h.critical=T.value[1].value.charCodeAt(0)!==0,h.value=T.value[2].value):h.value=T.value[1].value,h.id in n){if(h.name=n[h.id],h.name==="keyUsage"){var l=e.fromDer(h.value),R=0,N=0;l.value.length>1&&(R=l.value.charCodeAt(1),N=l.value.length>2?l.value.charCodeAt(2):0),h.digitalSignature=(R&128)===128,h.nonRepudiation=(R&64)===64,h.keyEncipherment=(R&32)===32,h.dataEncipherment=(R&16)===16,h.keyAgreement=(R&8)===8,h.keyCertSign=(R&4)===4,h.cRLSign=(R&2)===2,h.encipherOnly=(R&1)===1,h.decipherOnly=(N&128)===128}else if(h.name==="basicConstraints"){var l=e.fromDer(h.value);l.value.length>0&&l.value[0].type===e.Type.BOOLEAN?h.cA=l.value[0].value.charCodeAt(0)!==0:h.cA=!1;var F=null;l.value.length>0&&l.value[0].type===e.Type.INTEGER?F=l.value[0].value:l.value.length>1&&(F=l.value[1].value),F!==null&&(h.pathLenConstraint=e.derToInteger(F))}else if(h.name==="extKeyUsage")for(var l=e.fromDer(h.value),D=0;D<l.value.length;++D){var q=e.derToOid(l.value[D].value);q in n?h[n[q]]=!0:h[q]=!0}else if(h.name==="nsCertType"){var l=e.fromDer(h.value),R=0;l.value.length>1&&(R=l.value.charCodeAt(1)),h.client=(R&128)===128,h.server=(R&64)===64,h.email=(R&32)===32,h.objsign=(R&16)===16,h.reserved=(R&8)===8,h.sslCA=(R&4)===4,h.emailCA=(R&2)===2,h.objCA=(R&1)===1}else if(h.name==="subjectAltName"||h.name==="issuerAltName"){h.altNames=[];for(var j,l=e.fromDer(h.value),H=0;H<l.value.length;++H){j=l.value[H];var Q={type:j.type,value:j.value};switch(h.altNames.push(Q),j.type){case 1:case 2:case 6:break;case 7:Q.ip=t.util.bytesToIP(j.value);break;case 8:Q.oid=e.derToOid(j.value);break}}}else if(h.name==="subjectKeyIdentifier"){var l=e.fromDer(h.value);h.subjectKeyIdentifier=t.util.bytesToHex(l.value)}}return h},r.certificationRequestFromAsn1=function(T,h){var l={},R=[];if(!e.validate(T,f,l,R)){var N=new Error("Cannot read PKCS#10 certificate request. ASN.1 object is not a PKCS#10 CertificationRequest.");throw N.errors=R,N}var F=e.derToOid(l.publicKeyOid);if(F!==r.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var D=r.createCertificationRequest();if(D.version=l.csrVersion?l.csrVersion.charCodeAt(0):0,D.signatureOid=t.asn1.derToOid(l.csrSignatureOid),D.signatureParameters=C(D.signatureOid,l.csrSignatureParams,!0),D.siginfo.algorithmOid=t.asn1.derToOid(l.csrSignatureOid),D.siginfo.parameters=C(D.siginfo.algorithmOid,l.csrSignatureParams,!1),D.signature=l.csrSignature,D.certificationRequestInfo=l.certificationRequestInfo,h){D.md=y({signatureOid:D.signatureOid,type:"certification request"});var q=e.toDer(D.certificationRequestInfo);D.md.update(q.getBytes())}var j=t.md.sha1.create();return D.subject.getField=function(H){return A(D.subject,H)},D.subject.addField=function(H){g([H]),D.subject.attributes.push(H)},D.subject.attributes=r.RDNAttributesAsArray(l.certificationRequestInfoSubject,j),D.subject.hash=j.digest().toHex(),D.publicKey=r.publicKeyFromAsn1(l.subjectPublicKeyInfo),D.getAttribute=function(H){return A(D,H)},D.addAttribute=function(H){g([H]),D.attributes.push(H)},D.attributes=r.CRIAttributesAsArray(l.certificationRequestInfoAttributes||[]),D},r.createCertificationRequest=function(){var T={};return T.version=0,T.signatureOid=null,T.signature=null,T.siginfo={},T.siginfo.algorithmOid=null,T.subject={},T.subject.getField=function(h){return A(T.subject,h)},T.subject.addField=function(h){g([h]),T.subject.attributes.push(h)},T.subject.attributes=[],T.subject.hash=null,T.publicKey=null,T.attributes=[],T.getAttribute=function(h){return A(T,h)},T.addAttribute=function(h){g([h]),T.attributes.push(h)},T.md=null,T.setSubject=function(h){g(h),T.subject.attributes=h,T.subject.hash=null},T.setAttributes=function(h){g(h),T.attributes=h},T.sign=function(h,l){T.md=l||t.md.sha1.create();var R=n[T.md.algorithm+"WithRSAEncryption"];if(!R){var N=new Error("Could not compute certification request digest. Unknown message digest algorithm OID.");throw N.algorithm=T.md.algorithm,N}T.signatureOid=T.siginfo.algorithmOid=R,T.certificationRequestInfo=r.getCertificationRequestInfo(T);var F=e.toDer(T.certificationRequestInfo);T.md.update(F.getBytes()),T.signature=h.sign(T.md)},T.verify=function(){var h=!1,l=T.md;if(l===null){l=y({signatureOid:T.signatureOid,type:"certification request"});var R=T.certificationRequestInfo||r.getCertificationRequestInfo(T),N=e.toDer(R);l.update(N.getBytes())}return l!==null&&(h=o({certificate:T,md:l,signature:T.signature})),h},T};function m(T){for(var h=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]),l,R,N=T.attributes,F=0;F<N.length;++F){l=N[F];var D=l.value,q=e.Type.PRINTABLESTRING;"valueTagClass"in l&&(q=l.valueTagClass,q===e.Type.UTF8&&(D=t.util.encodeUtf8(D))),R=e.create(e.Class.UNIVERSAL,e.Type.SET,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(l.type).getBytes()),e.create(e.Class.UNIVERSAL,q,!1,D)])]),h.value.push(R)}return h}function g(T){for(var h,l=0;l<T.length;++l){if(h=T[l],typeof h.name>"u"&&(h.type&&h.type in r.oids?h.name=r.oids[h.type]:h.shortName&&h.shortName in s&&(h.name=r.oids[s[h.shortName]])),typeof h.type>"u")if(h.name&&h.name in r.oids)h.type=r.oids[h.name];else{var R=new Error("Attribute type not specified.");throw R.attribute=h,R}if(typeof h.shortName>"u"&&h.name&&h.name in s&&(h.shortName=s[h.name]),h.type===n.extensionRequest&&(h.valueConstructed=!0,h.valueTagClass=e.Type.SEQUENCE,!h.value&&h.extensions)){h.value=[];for(var N=0;N<h.extensions.length;++N)h.value.push(r.certificateExtensionToAsn1(S(h.extensions[N])))}if(typeof h.value>"u"){var R=new Error("Attribute value not specified.");throw R.attribute=h,R}}}function S(T,h){if(h=h||{},typeof T.name>"u"&&T.id&&T.id in r.oids&&(T.name=r.oids[T.id]),typeof T.id>"u")if(T.name&&T.name in r.oids)T.id=r.oids[T.name];else{var l=new Error("Extension ID not specified.");throw l.extension=T,l}if(typeof T.value<"u")return T;if(T.name==="keyUsage"){var R=0,N=0,F=0;T.digitalSignature&&(N|=128,R=7),T.nonRepudiation&&(N|=64,R=6),T.keyEncipherment&&(N|=32,R=5),T.dataEncipherment&&(N|=16,R=4),T.keyAgreement&&(N|=8,R=3),T.keyCertSign&&(N|=4,R=2),T.cRLSign&&(N|=2,R=1),T.encipherOnly&&(N|=1,R=0),T.decipherOnly&&(F|=128,R=7);var D=String.fromCharCode(R);F!==0?D+=String.fromCharCode(N)+String.fromCharCode(F):N!==0&&(D+=String.fromCharCode(N)),T.value=e.create(e.Class.UNIVERSAL,e.Type.BITSTRING,!1,D)}else if(T.name==="basicConstraints")T.value=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]),T.cA&&T.value.value.push(e.create(e.Class.UNIVERSAL,e.Type.BOOLEAN,!1,String.fromCharCode(255))),"pathLenConstraint"in T&&T.value.value.push(e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(T.pathLenConstraint).getBytes()));else if(T.name==="extKeyUsage"){T.value=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]);var q=T.value.value;for(var j in T)T[j]===!0&&(j in n?q.push(e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(n[j]).getBytes())):j.indexOf(".")!==-1&&q.push(e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(j).getBytes())))}else if(T.name==="nsCertType"){var R=0,N=0;T.client&&(N|=128,R=7),T.server&&(N|=64,R=6),T.email&&(N|=32,R=5),T.objsign&&(N|=16,R=4),T.reserved&&(N|=8,R=3),T.sslCA&&(N|=4,R=2),T.emailCA&&(N|=2,R=1),T.objCA&&(N|=1,R=0);var D=String.fromCharCode(R);N!==0&&(D+=String.fromCharCode(N)),T.value=e.create(e.Class.UNIVERSAL,e.Type.BITSTRING,!1,D)}else if(T.name==="subjectAltName"||T.name==="issuerAltName"){T.value=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]);for(var H,Q=0;Q<T.altNames.length;++Q){H=T.altNames[Q];var D=H.value;if(H.type===7&&H.ip){if(D=t.util.bytesFromIP(H.ip),D===null){var l=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw l.extension=T,l}}else H.type===8&&(H.oid?D=e.oidToDer(e.oidToDer(H.oid)):D=e.oidToDer(D));T.value.value.push(e.create(e.Class.CONTEXT_SPECIFIC,H.type,!1,D))}}else if(T.name==="nsComment"&&h.cert){if(!/^[\x00-\x7F]*$/.test(T.comment)||T.comment.length<1||T.comment.length>128)throw new Error('Invalid "nsComment" content.');T.value=e.create(e.Class.UNIVERSAL,e.Type.IA5STRING,!1,T.comment)}else if(T.name==="subjectKeyIdentifier"&&h.cert){var J=h.cert.generateSubjectKeyIdentifier();T.subjectKeyIdentifier=J.toHex(),T.value=e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,J.getBytes())}else if(T.name==="authorityKeyIdentifier"&&h.cert){T.value=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]);var q=T.value.value;if(T.keyIdentifier){var X=T.keyIdentifier===!0?h.cert.generateSubjectKeyIdentifier().getBytes():T.keyIdentifier;q.push(e.create(e.Class.CONTEXT_SPECIFIC,0,!1,X))}if(T.authorityCertIssuer){var re=[e.create(e.Class.CONTEXT_SPECIFIC,4,!0,[m(T.authorityCertIssuer===!0?h.cert.issuer:T.authorityCertIssuer)])];q.push(e.create(e.Class.CONTEXT_SPECIFIC,1,!0,re))}if(T.serialNumber){var se=t.util.hexToBytes(T.serialNumber===!0?h.cert.serialNumber:T.serialNumber);q.push(e.create(e.Class.CONTEXT_SPECIFIC,2,!1,se))}}else if(T.name==="cRLDistributionPoints"){T.value=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]);for(var q=T.value.value,de=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]),ye=e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[]),H,Q=0;Q<T.altNames.length;++Q){H=T.altNames[Q];var D=H.value;if(H.type===7&&H.ip){if(D=t.util.bytesFromIP(H.ip),D===null){var l=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw l.extension=T,l}}else H.type===8&&(H.oid?D=e.oidToDer(e.oidToDer(H.oid)):D=e.oidToDer(D));ye.value.push(e.create(e.Class.CONTEXT_SPECIFIC,H.type,!1,D))}de.value.push(e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[ye])),q.push(de)}if(typeof T.value>"u"){var l=new Error("Extension value not specified.");throw l.extension=T,l}return T}function i(T,h){switch(T){case n["RSASSA-PSS"]:var l=[];return h.hash.algorithmOid!==void 0&&l.push(e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(h.hash.algorithmOid).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")])])),h.mgf.algorithmOid!==void 0&&l.push(e.create(e.Class.CONTEXT_SPECIFIC,1,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(h.mgf.algorithmOid).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(h.mgf.hash.algorithmOid).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")])])])),h.saltLength!==void 0&&l.push(e.create(e.Class.CONTEXT_SPECIFIC,2,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(h.saltLength).getBytes())])),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,l);default:return e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")}}function v(T){var h=e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[]);if(T.attributes.length===0)return h;for(var l=T.attributes,R=0;R<l.length;++R){var N=l[R],F=N.value,D=e.Type.UTF8;"valueTagClass"in N&&(D=N.valueTagClass),D===e.Type.UTF8&&(F=t.util.encodeUtf8(F));var q=!1;"valueConstructed"in N&&(q=N.valueConstructed);var j=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(N.type).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SET,!0,[e.create(e.Class.UNIVERSAL,D,q,F)])]);h.value.push(j)}return h}var E=new Date("1950-01-01T00:00:00Z"),I=new Date("2050-01-01T00:00:00Z");function B(T){return T>=E&&T<I?e.create(e.Class.UNIVERSAL,e.Type.UTCTIME,!1,e.dateToUtcTime(T)):e.create(e.Class.UNIVERSAL,e.Type.GENERALIZEDTIME,!1,e.dateToGeneralizedTime(T))}return r.getTBSCertificate=function(T){var h=B(T.validity.notBefore),l=B(T.validity.notAfter),R=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(T.version).getBytes())]),e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,t.util.hexToBytes(T.serialNumber)),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(T.siginfo.algorithmOid).getBytes()),i(T.siginfo.algorithmOid,T.siginfo.parameters)]),m(T.issuer),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[h,l]),m(T.subject),r.publicKeyToAsn1(T.publicKey)]);return T.issuer.uniqueId&&R.value.push(e.create(e.Class.CONTEXT_SPECIFIC,1,!0,[e.create(e.Class.UNIVERSAL,e.Type.BITSTRING,!1,String.fromCharCode(0)+T.issuer.uniqueId)])),T.subject.uniqueId&&R.value.push(e.create(e.Class.CONTEXT_SPECIFIC,2,!0,[e.create(e.Class.UNIVERSAL,e.Type.BITSTRING,!1,String.fromCharCode(0)+T.subject.uniqueId)])),T.extensions.length>0&&R.value.push(r.certificateExtensionsToAsn1(T.extensions)),R},r.getCertificationRequestInfo=function(T){var h=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(T.version).getBytes()),m(T.subject),r.publicKeyToAsn1(T.publicKey),v(T)]);return h},r.distinguishedNameToAsn1=function(T){return m(T)},r.certificateToAsn1=function(T){var h=T.tbsCertificate||r.getTBSCertificate(T);return e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[h,e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(T.signatureOid).getBytes()),i(T.signatureOid,T.signatureParameters)]),e.create(e.Class.UNIVERSAL,e.Type.BITSTRING,!1,String.fromCharCode(0)+T.signature)])},r.certificateExtensionsToAsn1=function(T){var h=e.create(e.Class.CONTEXT_SPECIFIC,3,!0,[]),l=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]);h.value.push(l);for(var R=0;R<T.length;++R)l.value.push(r.certificateExtensionToAsn1(T[R]));return h},r.certificateExtensionToAsn1=function(T){var h=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]);h.value.push(e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(T.id).getBytes())),T.critical&&h.value.push(e.create(e.Class.UNIVERSAL,e.Type.BOOLEAN,!1,String.fromCharCode(255)));var l=T.value;return typeof T.value!="string"&&(l=e.toDer(l).getBytes()),h.value.push(e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,l)),h},r.certificationRequestToAsn1=function(T){var h=T.certificationRequestInfo||r.getCertificationRequestInfo(T);return e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[h,e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(T.signatureOid).getBytes()),i(T.signatureOid,T.signatureParameters)]),e.create(e.Class.UNIVERSAL,e.Type.BITSTRING,!1,String.fromCharCode(0)+T.signature)])},r.createCaStore=function(T){var h={certs:{}};h.getIssuer=function(D){var q=l(D.issuer);return q},h.addCertificate=function(D){if(typeof D=="string"&&(D=t.pki.certificateFromPem(D)),R(D.subject),!h.hasCertificate(D))if(D.subject.hash in h.certs){var q=h.certs[D.subject.hash];t.util.isArray(q)||(q=[q]),q.push(D),h.certs[D.subject.hash]=q}else h.certs[D.subject.hash]=D},h.hasCertificate=function(D){typeof D=="string"&&(D=t.pki.certificateFromPem(D));var q=l(D.subject);if(!q)return!1;t.util.isArray(q)||(q=[q]);for(var j=e.toDer(r.certificateToAsn1(D)).getBytes(),H=0;H<q.length;++H){var Q=e.toDer(r.certificateToAsn1(q[H])).getBytes();if(j===Q)return!0}return!1},h.listAllCertificates=function(){var D=[];for(var q in h.certs)if(h.certs.hasOwnProperty(q)){var j=h.certs[q];if(!t.util.isArray(j))D.push(j);else for(var H=0;H<j.length;++H)D.push(j[H])}return D},h.removeCertificate=function(D){var q;if(typeof D=="string"&&(D=t.pki.certificateFromPem(D)),R(D.subject),!h.hasCertificate(D))return null;var j=l(D.subject);if(!t.util.isArray(j))return q=h.certs[D.subject.hash],delete h.certs[D.subject.hash],q;for(var H=e.toDer(r.certificateToAsn1(D)).getBytes(),Q=0;Q<j.length;++Q){var J=e.toDer(r.certificateToAsn1(j[Q])).getBytes();H===J&&(q=j[Q],j.splice(Q,1))}return j.length===0&&delete h.certs[D.subject.hash],q};function l(D){return R(D),h.certs[D.hash]||null}function R(D){if(!D.hash){var q=t.md.sha1.create();D.attributes=r.RDNAttributesAsArray(m(D),q),D.hash=q.digest().toHex()}}if(T)for(var N=0;N<T.length;++N){var F=T[N];h.addCertificate(F)}return h},r.certificateError={bad_certificate:"forge.pki.BadCertificate",unsupported_certificate:"forge.pki.UnsupportedCertificate",certificate_revoked:"forge.pki.CertificateRevoked",certificate_expired:"forge.pki.CertificateExpired",certificate_unknown:"forge.pki.CertificateUnknown",unknown_ca:"forge.pki.UnknownCertificateAuthority"},r.verifyCertificateChain=function(T,h,l){typeof l=="function"&&(l={verify:l}),l=l||{},h=h.slice(0);var R=h.slice(0),N=l.validityCheckDate;typeof N>"u"&&(N=new Date);var F=!0,D=null,q=0;do{var j=h.shift(),H=null,Q=!1;if(N&&(N<j.validity.notBefore||N>j.validity.notAfter)&&(D={message:"Certificate is not valid yet or has expired.",error:r.certificateError.certificate_expired,notBefore:j.validity.notBefore,notAfter:j.validity.notAfter,now:N}),D===null){if(H=h[0]||T.getIssuer(j),H===null&&j.isIssuer(j)&&(Q=!0,H=j),H){var J=H;t.util.isArray(J)||(J=[J]);for(var X=!1;!X&&J.length>0;){H=J.shift();try{X=H.verify(j)}catch{}}X||(D={message:"Certificate signature is invalid.",error:r.certificateError.bad_certificate})}D===null&&(!H||Q)&&!T.hasCertificate(j)&&(D={message:"Certificate is not trusted.",error:r.certificateError.unknown_ca})}if(D===null&&H&&!j.isIssuer(H)&&(D={message:"Certificate issuer is invalid.",error:r.certificateError.bad_certificate}),D===null)for(var re={keyUsage:!0,basicConstraints:!0},se=0;D===null&&se<j.extensions.length;++se){var de=j.extensions[se];de.critical&&!(de.name in re)&&(D={message:"Certificate has an unsupported critical extension.",error:r.certificateError.unsupported_certificate})}if(D===null&&(!F||h.length===0&&(!H||Q))){var ye=j.getExtension("basicConstraints"),_e=j.getExtension("keyUsage");if(_e!==null&&(!_e.keyCertSign||ye===null)&&(D={message:"Certificate keyUsage or basicConstraints conflict or indicate that the certificate is not a CA. If the certificate is the only one in the chain or isn't the first then the certificate must be a valid CA.",error:r.certificateError.bad_certificate}),D===null&&ye!==null&&!ye.cA&&(D={message:"Certificate basicConstraints indicates the certificate is not a CA.",error:r.certificateError.bad_certificate}),D===null&&_e!==null&&"pathLenConstraint"in ye){var W=q-1;W>ye.pathLenConstraint&&(D={message:"Certificate basicConstraints pathLenConstraint violated.",error:r.certificateError.bad_certificate})}}var he=D===null?!0:D.error,ae=l.verify?l.verify(he,q,R):he;if(ae===!0)D=null;else throw he===!0&&(D={message:"The application rejected the certificate.",error:r.certificateError.bad_certificate}),(ae||ae===0)&&(typeof ae=="object"&&!t.util.isArray(ae)?(ae.message&&(D.message=ae.message),ae.error&&(D.error=ae.error)):typeof ae=="string"&&(D.error=ae)),D;F=!1,++q}while(h.length>0);return!0},si.exports}var Do;function Ou(){if(Do)return ai.exports;Do=1;var t=me();Tt(),nn(),or(),Nu(),Ru(),yt(),ca(),an(),Ae(),ms();var e=t.asn1,r=t.pki,n=ai.exports=t.pkcs12=t.pkcs12||{},s={name:"ContentInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.contentType",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:e.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"content"}]},c={name:"PFX",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"version"},s,{name:"PFX.macData",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"mac",value:[{name:"PFX.macData.mac",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"macAlgorithm"},{name:"PFX.macData.mac.digestAlgorithm.parameters",tagClass:e.Class.UNIVERSAL,captureAsn1:"macAlgorithmParameters"}]},{name:"PFX.macData.mac.digest",tagClass:e.Class.UNIVERSAL,type:e.Type.OCTETSTRING,constructed:!1,capture:"macDigest"}]},{name:"PFX.macData.macSalt",tagClass:e.Class.UNIVERSAL,type:e.Type.OCTETSTRING,constructed:!1,capture:"macSalt"},{name:"PFX.macData.iterations",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,optional:!0,capture:"macIterations"}]}]},u={name:"SafeBag",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"SafeBag.bagId",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"bagId"},{name:"SafeBag.bagValue",tagClass:e.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"bagValue"},{name:"SafeBag.bagAttributes",tagClass:e.Class.UNIVERSAL,type:e.Type.SET,constructed:!0,optional:!0,capture:"bagAttributes"}]},a={name:"Attribute",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"Attribute.attrId",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"oid"},{name:"Attribute.attrValues",tagClass:e.Class.UNIVERSAL,type:e.Type.SET,constructed:!0,capture:"values"}]},p={name:"CertBag",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"CertBag.certId",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"certId"},{name:"CertBag.certValue",tagClass:e.Class.CONTEXT_SPECIFIC,constructed:!0,value:[{name:"CertBag.certValue[0]",tagClass:e.Class.UNIVERSAL,type:e.Class.OCTETSTRING,constructed:!1,capture:"cert"}]}]};function f(g,S,i,v){for(var E=[],I=0;I<g.length;I++)for(var B=0;B<g[I].safeBags.length;B++){var T=g[I].safeBags[B];if(!(v!==void 0&&T.type!==v)){if(S===null){E.push(T);continue}T.attributes[S]!==void 0&&T.attributes[S].indexOf(i)>=0&&E.push(T)}}return E}n.pkcs12FromAsn1=function(g,S,i){typeof S=="string"?(i=S,S=!0):S===void 0&&(S=!0);var v={},E=[];if(!e.validate(g,c,v,E)){var I=new Error("Cannot read PKCS#12 PFX. ASN.1 object is not an PKCS#12 PFX.");throw I.errors=I,I}var B={version:v.version.charCodeAt(0),safeContents:[],getBags:function(H){var Q={},J;return"localKeyId"in H?J=H.localKeyId:"localKeyIdHex"in H&&(J=t.util.hexToBytes(H.localKeyIdHex)),J===void 0&&!("friendlyName"in H)&&"bagType"in H&&(Q[H.bagType]=f(B.safeContents,null,null,H.bagType)),J!==void 0&&(Q.localKeyId=f(B.safeContents,"localKeyId",J,H.bagType)),"friendlyName"in H&&(Q.friendlyName=f(B.safeContents,"friendlyName",H.friendlyName,H.bagType)),Q},getBagsByFriendlyName:function(H,Q){return f(B.safeContents,"friendlyName",H,Q)},getBagsByLocalKeyId:function(H,Q){return f(B.safeContents,"localKeyId",H,Q)}};if(v.version.charCodeAt(0)!==3){var I=new Error("PKCS#12 PFX of version other than 3 not supported.");throw I.version=v.version.charCodeAt(0),I}if(e.derToOid(v.contentType)!==r.oids.data){var I=new Error("Only PKCS#12 PFX in password integrity mode supported.");throw I.oid=e.derToOid(v.contentType),I}var T=v.content.value[0];if(T.tagClass!==e.Class.UNIVERSAL||T.type!==e.Type.OCTETSTRING)throw new Error("PKCS#12 authSafe content data is not an OCTET STRING.");if(T=A(T),v.mac){var h=null,l=0,R=e.derToOid(v.macAlgorithm);switch(R){case r.oids.sha1:h=t.md.sha1.create(),l=20;break;case r.oids.sha256:h=t.md.sha256.create(),l=32;break;case r.oids.sha384:h=t.md.sha384.create(),l=48;break;case r.oids.sha512:h=t.md.sha512.create(),l=64;break;case r.oids.md5:h=t.md.md5.create(),l=16;break}if(h===null)throw new Error("PKCS#12 uses unsupported MAC algorithm: "+R);var N=new t.util.ByteBuffer(v.macSalt),F="macIterations"in v?parseInt(t.util.bytesToHex(v.macIterations),16):1,D=n.generateKey(i,N,3,F,l,h),q=t.hmac.create();q.start(h,D),q.update(T.value);var j=q.getMac();if(j.getBytes()!==v.macDigest)throw new Error("PKCS#12 MAC could not be verified. Invalid password?")}return C(B,T.value,S,i),B};function A(g){if(g.composed||g.constructed){for(var S=t.util.createBuffer(),i=0;i<g.value.length;++i)S.putBytes(g.value[i].value);g.composed=g.constructed=!1,g.value=S.getBytes()}return g}function C(g,S,i,v){if(S=e.fromDer(S,i),S.tagClass!==e.Class.UNIVERSAL||S.type!==e.Type.SEQUENCE||S.constructed!==!0)throw new Error("PKCS#12 AuthenticatedSafe expected to be a SEQUENCE OF ContentInfo");for(var E=0;E<S.value.length;E++){var I=S.value[E],B={},T=[];if(!e.validate(I,s,B,T)){var h=new Error("Cannot read ContentInfo.");throw h.errors=T,h}var l={encrypted:!1},R=null,N=B.content.value[0];switch(e.derToOid(B.contentType)){case r.oids.data:if(N.tagClass!==e.Class.UNIVERSAL||N.type!==e.Type.OCTETSTRING)throw new Error("PKCS#12 SafeContents Data is not an OCTET STRING.");R=A(N).value;break;case r.oids.encryptedData:R=y(N,v),l.encrypted=!0;break;default:var h=new Error("Unsupported PKCS#12 contentType.");throw h.contentType=e.derToOid(B.contentType),h}l.safeBags=o(R,i,v),g.safeContents.push(l)}}function y(g,S){var i={},v=[];if(!e.validate(g,t.pkcs7.asn1.encryptedDataValidator,i,v)){var E=new Error("Cannot read EncryptedContentInfo.");throw E.errors=v,E}var I=e.derToOid(i.contentType);if(I!==r.oids.data){var E=new Error("PKCS#12 EncryptedContentInfo ContentType is not Data.");throw E.oid=I,E}I=e.derToOid(i.encAlgorithm);var B=r.pbe.getCipher(I,i.encParameter,S),T=A(i.encryptedContentAsn1),h=t.util.createBuffer(T.value);if(B.update(h),!B.finish())throw new Error("Failed to decrypt PKCS#12 SafeContents.");return B.output.getBytes()}function o(g,S,i){if(!S&&g.length===0)return[];if(g=e.fromDer(g,S),g.tagClass!==e.Class.UNIVERSAL||g.type!==e.Type.SEQUENCE||g.constructed!==!0)throw new Error("PKCS#12 SafeContents expected to be a SEQUENCE OF SafeBag.");for(var v=[],E=0;E<g.value.length;E++){var I=g.value[E],B={},T=[];if(!e.validate(I,u,B,T)){var h=new Error("Cannot read SafeBag.");throw h.errors=T,h}var l={type:e.derToOid(B.bagId),attributes:m(B.bagAttributes)};v.push(l);var R,N,F=B.bagValue.value[0];switch(l.type){case r.oids.pkcs8ShroudedKeyBag:if(F=r.decryptPrivateKeyInfo(F,i),F===null)throw new Error("Unable to decrypt PKCS#8 ShroudedKeyBag, wrong password?");case r.oids.keyBag:try{l.key=r.privateKeyFromAsn1(F)}catch{l.key=null,l.asn1=F}continue;case r.oids.certBag:R=p,N=function(){if(e.derToOid(B.certId)!==r.oids.x509Certificate){var q=new Error("Unsupported certificate type, only X.509 supported.");throw q.oid=e.derToOid(B.certId),q}var j=e.fromDer(B.cert,S);try{l.cert=r.certificateFromAsn1(j,!0)}catch{l.cert=null,l.asn1=j}};break;default:var h=new Error("Unsupported PKCS#12 SafeBag type.");throw h.oid=l.type,h}if(R!==void 0&&!e.validate(F,R,B,T)){var h=new Error("Cannot read PKCS#12 "+R.name);throw h.errors=T,h}N()}return v}function m(g){var S={};if(g!==void 0)for(var i=0;i<g.length;++i){var v={},E=[];if(!e.validate(g[i],a,v,E)){var I=new Error("Cannot read PKCS#12 BagAttribute.");throw I.errors=E,I}var B=e.derToOid(v.oid);if(r.oids[B]!==void 0){S[r.oids[B]]=[];for(var T=0;T<v.values.length;++T)S[r.oids[B]].push(v.values[T].value)}}return S}return n.toPkcs12Asn1=function(g,S,i,v){v=v||{},v.saltSize=v.saltSize||8,v.count=v.count||2048,v.algorithm=v.algorithm||v.encAlgorithm||"aes128","useMac"in v||(v.useMac=!0),"localKeyId"in v||(v.localKeyId=null),"generateLocalKeyId"in v||(v.generateLocalKeyId=!0);var E=v.localKeyId,I;if(E!==null)E=t.util.hexToBytes(E);else if(v.generateLocalKeyId)if(S){var B=t.util.isArray(S)?S[0]:S;typeof B=="string"&&(B=r.certificateFromPem(B));var T=t.md.sha1.create();T.update(e.toDer(r.certificateToAsn1(B)).getBytes()),E=T.digest().getBytes()}else E=t.random.getBytes(20);var h=[];E!==null&&h.push(e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(r.oids.localKeyId).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SET,!0,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,E)])])),"friendlyName"in v&&h.push(e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(r.oids.friendlyName).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SET,!0,[e.create(e.Class.UNIVERSAL,e.Type.BMPSTRING,!1,v.friendlyName)])])),h.length>0&&(I=e.create(e.Class.UNIVERSAL,e.Type.SET,!0,h));var l=[],R=[];S!==null&&(t.util.isArray(S)?R=S:R=[S]);for(var N=[],F=0;F<R.length;++F){S=R[F],typeof S=="string"&&(S=r.certificateFromPem(S));var D=F===0?I:void 0,q=r.certificateToAsn1(S),j=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(r.oids.certBag).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(r.oids.x509Certificate).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,e.toDer(q).getBytes())])])]),D]);N.push(j)}if(N.length>0){var H=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,N),Q=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(r.oids.data).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,e.toDer(H).getBytes())])]);l.push(Q)}var J=null;if(g!==null){var X=r.wrapRsaPrivateKey(r.privateKeyToAsn1(g));i===null?J=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(r.oids.keyBag).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[X]),I]):J=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(r.oids.pkcs8ShroudedKeyBag).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[r.encryptPrivateKeyInfo(X,i,v)]),I]);var re=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[J]),se=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(r.oids.data).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,e.toDer(re).getBytes())])]);l.push(se)}var de=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,l),ye;if(v.useMac){var T=t.md.sha1.create(),_e=new t.util.ByteBuffer(t.random.getBytes(v.saltSize)),W=v.count,g=n.generateKey(i,_e,3,W,20),he=t.hmac.create();he.start(T,g),he.update(e.toDer(de).getBytes());var ae=he.getMac();ye=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(r.oids.sha1).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")]),e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,ae.getBytes())]),e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,_e.getBytes()),e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(W).getBytes())])}return e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(3).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(r.oids.data).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,e.toDer(de).getBytes())])]),ye])},n.generateKey=t.pbe.generatePkcs12Key,ai.exports}var Lo;function Uu(){if(Lo)return za.exports;Lo=1;var t=me();Tt(),or(),Ru(),Br(),gs(),Ou(),vs(),ca(),Ae(),ms();var e=t.asn1,r=za.exports=t.pki=t.pki||{};return r.pemToDer=function(n){var s=t.pem.decode(n)[0];if(s.procType&&s.procType.type==="ENCRYPTED")throw new Error("Could not convert PEM to DER; PEM is encrypted.");return t.util.createBuffer(s.body)},r.privateKeyFromPem=function(n){var s=t.pem.decode(n)[0];if(s.type!=="PRIVATE KEY"&&s.type!=="RSA PRIVATE KEY"){var c=new Error('Could not convert private key from PEM; PEM header type is not "PRIVATE KEY" or "RSA PRIVATE KEY".');throw c.headerType=s.type,c}if(s.procType&&s.procType.type==="ENCRYPTED")throw new Error("Could not convert private key from PEM; PEM is encrypted.");var u=e.fromDer(s.body);return r.privateKeyFromAsn1(u)},r.privateKeyToPem=function(n,s){var c={type:"RSA PRIVATE KEY",body:e.toDer(r.privateKeyToAsn1(n)).getBytes()};return t.pem.encode(c,{maxline:s})},r.privateKeyInfoToPem=function(n,s){var c={type:"PRIVATE KEY",body:e.toDer(n).getBytes()};return t.pem.encode(c,{maxline:s})},za.exports}var li,Fo;function ku(){if(Fo)return li;Fo=1;var t=me();Tt(),nn(),ys(),Br(),Uu(),yt(),an(),Ae();var e=function(_,x,w,d){var b=t.util.createBuffer(),U=_.length>>1,P=U+(_.length&1),K=_.substr(0,P),V=_.substr(U,P),$=t.util.createBuffer(),M=t.hmac.create();w=x+w;var G=Math.ceil(d/16),Y=Math.ceil(d/20);M.start("MD5",K);var ne=t.util.createBuffer();$.putBytes(w);for(var te=0;te<G;++te)M.start(null,null),M.update($.getBytes()),$.putBuffer(M.digest()),M.start(null,null),M.update($.bytes()+w),ne.putBuffer(M.digest());M.start("SHA1",V);var ue=t.util.createBuffer();$.clear(),$.putBytes(w);for(var te=0;te<Y;++te)M.start(null,null),M.update($.getBytes()),$.putBuffer(M.digest()),M.start(null,null),M.update($.bytes()+w),ue.putBuffer(M.digest());return b.putBytes(t.util.xorBytes(ne.getBytes(),ue.getBytes(),d)),b},r=function(_,x,w){var d=t.hmac.create();d.start("SHA1",_);var b=t.util.createBuffer();return b.putInt32(x[0]),b.putInt32(x[1]),b.putByte(w.type),b.putByte(w.version.major),b.putByte(w.version.minor),b.putInt16(w.length),b.putBytes(w.fragment.bytes()),d.update(b.getBytes()),d.digest().getBytes()},n=function(_,x,w){var d=!1;try{var b=_.deflate(x.fragment.getBytes());x.fragment=t.util.createBuffer(b),x.length=b.length,d=!0}catch{}return d},s=function(_,x,w){var d=!1;try{var b=_.inflate(x.fragment.getBytes());x.fragment=t.util.createBuffer(b),x.length=b.length,d=!0}catch{}return d},c=function(_,x){var w=0;switch(x){case 1:w=_.getByte();break;case 2:w=_.getInt16();break;case 3:w=_.getInt24();break;case 4:w=_.getInt32();break}return t.util.createBuffer(_.getBytes(w))},u=function(_,x,w){_.putInt(w.length(),x<<3),_.putBuffer(w)},a={};a.Versions={TLS_1_0:{major:3,minor:1},TLS_1_1:{major:3,minor:2},TLS_1_2:{major:3,minor:3}},a.SupportedVersions=[a.Versions.TLS_1_1,a.Versions.TLS_1_0],a.Version=a.SupportedVersions[0],a.MaxFragment=16384-1024,a.ConnectionEnd={server:0,client:1},a.PRFAlgorithm={tls_prf_sha256:0},a.BulkCipherAlgorithm={none:null,rc4:0,des3:1,aes:2},a.CipherType={stream:0,block:1,aead:2},a.MACAlgorithm={none:null,hmac_md5:0,hmac_sha1:1,hmac_sha256:2,hmac_sha384:3,hmac_sha512:4},a.CompressionMethod={none:0,deflate:1},a.ContentType={change_cipher_spec:20,alert:21,handshake:22,application_data:23,heartbeat:24},a.HandshakeType={hello_request:0,client_hello:1,server_hello:2,certificate:11,server_key_exchange:12,certificate_request:13,server_hello_done:14,certificate_verify:15,client_key_exchange:16,finished:20},a.Alert={},a.Alert.Level={warning:1,fatal:2},a.Alert.Description={close_notify:0,unexpected_message:10,bad_record_mac:20,decryption_failed:21,record_overflow:22,decompression_failure:30,handshake_failure:40,bad_certificate:42,unsupported_certificate:43,certificate_revoked:44,certificate_expired:45,certificate_unknown:46,illegal_parameter:47,unknown_ca:48,access_denied:49,decode_error:50,decrypt_error:51,export_restriction:60,protocol_version:70,insufficient_security:71,internal_error:80,user_canceled:90,no_renegotiation:100},a.HeartbeatMessageType={heartbeat_request:1,heartbeat_response:2},a.CipherSuites={},a.getCipherSuite=function(_){var x=null;for(var w in a.CipherSuites){var d=a.CipherSuites[w];if(d.id[0]===_.charCodeAt(0)&&d.id[1]===_.charCodeAt(1)){x=d;break}}return x},a.handleUnexpected=function(_,x){var w=!_.open&&_.entity===a.ConnectionEnd.client;w||_.error(_,{message:"Unexpected message. Received TLS record out of order.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.unexpected_message}})},a.handleHelloRequest=function(_,x,w){!_.handshaking&&_.handshakes>0&&(a.queue(_,a.createAlert(_,{level:a.Alert.Level.warning,description:a.Alert.Description.no_renegotiation})),a.flush(_)),_.process()},a.parseHelloMessage=function(_,x,w){var d=null,b=_.entity===a.ConnectionEnd.client;if(w<38)_.error(_,{message:b?"Invalid ServerHello message. Message too short.":"Invalid ClientHello message. Message too short.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.illegal_parameter}});else{var U=x.fragment,P=U.length();if(d={version:{major:U.getByte(),minor:U.getByte()},random:t.util.createBuffer(U.getBytes(32)),session_id:c(U,1),extensions:[]},b?(d.cipher_suite=U.getBytes(2),d.compression_method=U.getByte()):(d.cipher_suites=c(U,2),d.compression_methods=c(U,1)),P=w-(P-U.length()),P>0){for(var K=c(U,2);K.length()>0;)d.extensions.push({type:[K.getByte(),K.getByte()],data:c(K,2)});if(!b)for(var V=0;V<d.extensions.length;++V){var $=d.extensions[V];if($.type[0]===0&&$.type[1]===0)for(var M=c($.data,2);M.length()>0;){var G=M.getByte();if(G!==0)break;_.session.extensions.server_name.serverNameList.push(c(M,2).getBytes())}}}if(_.session.version&&(d.version.major!==_.session.version.major||d.version.minor!==_.session.version.minor))return _.error(_,{message:"TLS version change is disallowed during renegotiation.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.protocol_version}});if(b)_.session.cipherSuite=a.getCipherSuite(d.cipher_suite);else for(var Y=t.util.createBuffer(d.cipher_suites.bytes());Y.length()>0&&(_.session.cipherSuite=a.getCipherSuite(Y.getBytes(2)),_.session.cipherSuite===null););if(_.session.cipherSuite===null)return _.error(_,{message:"No cipher suites in common.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.handshake_failure},cipherSuite:t.util.bytesToHex(d.cipher_suite)});b?_.session.compressionMethod=d.compression_method:_.session.compressionMethod=a.CompressionMethod.none}return d},a.createSecurityParameters=function(_,x){var w=_.entity===a.ConnectionEnd.client,d=x.random.bytes(),b=w?_.session.sp.client_random:d,U=w?d:a.createRandom().getBytes();_.session.sp={entity:_.entity,prf_algorithm:a.PRFAlgorithm.tls_prf_sha256,bulk_cipher_algorithm:null,cipher_type:null,enc_key_length:null,block_length:null,fixed_iv_length:null,record_iv_length:null,mac_algorithm:null,mac_length:null,mac_key_length:null,compression_algorithm:_.session.compressionMethod,pre_master_secret:null,master_secret:null,client_random:b,server_random:U}},a.handleServerHello=function(_,x,w){var d=a.parseHelloMessage(_,x,w);if(!_.fail){if(d.version.minor<=_.version.minor)_.version.minor=d.version.minor;else return _.error(_,{message:"Incompatible TLS version.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.protocol_version}});_.session.version=_.version;var b=d.session_id.bytes();b.length>0&&b===_.session.id?(_.expect=o,_.session.resuming=!0,_.session.sp.server_random=d.random.bytes()):(_.expect=f,_.session.resuming=!1,a.createSecurityParameters(_,d)),_.session.id=b,_.process()}},a.handleClientHello=function(_,x,w){var d=a.parseHelloMessage(_,x,w);if(!_.fail){var b=d.session_id.bytes(),U=null;if(_.sessionCache&&(U=_.sessionCache.getSession(b),U===null?b="":(U.version.major!==d.version.major||U.version.minor>d.version.minor)&&(U=null,b="")),b.length===0&&(b=t.random.getBytes(32)),_.session.id=b,_.session.clientHelloVersion=d.version,_.session.sp={},U)_.version=_.session.version=U.version,_.session.sp=U.sp;else{for(var P,K=1;K<a.SupportedVersions.length&&(P=a.SupportedVersions[K],!(P.minor<=d.version.minor));++K);_.version={major:P.major,minor:P.minor},_.session.version=_.version}U!==null?(_.expect=B,_.session.resuming=!0,_.session.sp.client_random=d.random.bytes()):(_.expect=_.verifyClient!==!1?v:E,_.session.resuming=!1,a.createSecurityParameters(_,d)),_.open=!0,a.queue(_,a.createRecord(_,{type:a.ContentType.handshake,data:a.createServerHello(_)})),_.session.resuming?(a.queue(_,a.createRecord(_,{type:a.ContentType.change_cipher_spec,data:a.createChangeCipherSpec()})),_.state.pending=a.createConnectionState(_),_.state.current.write=_.state.pending.write,a.queue(_,a.createRecord(_,{type:a.ContentType.handshake,data:a.createFinished(_)}))):(a.queue(_,a.createRecord(_,{type:a.ContentType.handshake,data:a.createCertificate(_)})),_.fail||(a.queue(_,a.createRecord(_,{type:a.ContentType.handshake,data:a.createServerKeyExchange(_)})),_.verifyClient!==!1&&a.queue(_,a.createRecord(_,{type:a.ContentType.handshake,data:a.createCertificateRequest(_)})),a.queue(_,a.createRecord(_,{type:a.ContentType.handshake,data:a.createServerHelloDone(_)})))),a.flush(_),_.process()}},a.handleCertificate=function(_,x,w){if(w<3)return _.error(_,{message:"Invalid Certificate message. Message too short.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.illegal_parameter}});var d=x.fragment,b={certificate_list:c(d,3)},U,P,K=[];try{for(;b.certificate_list.length()>0;)U=c(b.certificate_list,3),P=t.asn1.fromDer(U),U=t.pki.certificateFromAsn1(P,!0),K.push(U)}catch($){return _.error(_,{message:"Could not parse certificate list.",cause:$,send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.bad_certificate}})}var V=_.entity===a.ConnectionEnd.client;(V||_.verifyClient===!0)&&K.length===0?_.error(_,{message:V?"No server certificate provided.":"No client certificate provided.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.illegal_parameter}}):K.length===0?_.expect=V?A:E:(V?_.session.serverCertificate=K[0]:_.session.clientCertificate=K[0],a.verifyCertificateChain(_,K)&&(_.expect=V?A:E)),_.process()},a.handleServerKeyExchange=function(_,x,w){if(w>0)return _.error(_,{message:"Invalid key parameters. Only RSA is supported.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.unsupported_certificate}});_.expect=C,_.process()},a.handleClientKeyExchange=function(_,x,w){if(w<48)return _.error(_,{message:"Invalid key parameters. Only RSA is supported.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.unsupported_certificate}});var d=x.fragment,b={enc_pre_master_secret:c(d,2).getBytes()},U=null;if(_.getPrivateKey)try{U=_.getPrivateKey(_,_.session.serverCertificate),U=t.pki.privateKeyFromPem(U)}catch(V){_.error(_,{message:"Could not get private key.",cause:V,send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.internal_error}})}if(U===null)return _.error(_,{message:"No private key set.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.internal_error}});try{var P=_.session.sp;P.pre_master_secret=U.decrypt(b.enc_pre_master_secret);var K=_.session.clientHelloVersion;if(K.major!==P.pre_master_secret.charCodeAt(0)||K.minor!==P.pre_master_secret.charCodeAt(1))throw new Error("TLS version rollback attack detected.")}catch{P.pre_master_secret=t.random.getBytes(48)}_.expect=B,_.session.clientCertificate!==null&&(_.expect=I),_.process()},a.handleCertificateRequest=function(_,x,w){if(w<3)return _.error(_,{message:"Invalid CertificateRequest. Message too short.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.illegal_parameter}});var d=x.fragment,b={certificate_types:c(d,1),certificate_authorities:c(d,2)};_.session.certificateRequest=b,_.expect=y,_.process()},a.handleCertificateVerify=function(_,x,w){if(w<2)return _.error(_,{message:"Invalid CertificateVerify. Message too short.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.illegal_parameter}});var d=x.fragment;d.read-=4;var b=d.bytes();d.read+=4;var U={signature:c(d,2).getBytes()},P=t.util.createBuffer();P.putBuffer(_.session.md5.digest()),P.putBuffer(_.session.sha1.digest()),P=P.getBytes();try{var K=_.session.clientCertificate;if(!K.publicKey.verify(P,U.signature,"NONE"))throw new Error("CertificateVerify signature does not match.");_.session.md5.update(b),_.session.sha1.update(b)}catch{return _.error(_,{message:"Bad signature in CertificateVerify.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.handshake_failure}})}_.expect=B,_.process()},a.handleServerHelloDone=function(_,x,w){if(w>0)return _.error(_,{message:"Invalid ServerHelloDone message. Invalid length.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.record_overflow}});if(_.serverCertificate===null){var d={message:"No server certificate provided. Not enough security.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.insufficient_security}},b=0,U=_.verify(_,d.alert.description,b,[]);if(U!==!0)return(U||U===0)&&(typeof U=="object"&&!t.util.isArray(U)?(U.message&&(d.message=U.message),U.alert&&(d.alert.description=U.alert)):typeof U=="number"&&(d.alert.description=U)),_.error(_,d)}_.session.certificateRequest!==null&&(x=a.createRecord(_,{type:a.ContentType.handshake,data:a.createCertificate(_)}),a.queue(_,x)),x=a.createRecord(_,{type:a.ContentType.handshake,data:a.createClientKeyExchange(_)}),a.queue(_,x),_.expect=S;var P=function(K,V){K.session.certificateRequest!==null&&K.session.clientCertificate!==null&&a.queue(K,a.createRecord(K,{type:a.ContentType.handshake,data:a.createCertificateVerify(K,V)})),a.queue(K,a.createRecord(K,{type:a.ContentType.change_cipher_spec,data:a.createChangeCipherSpec()})),K.state.pending=a.createConnectionState(K),K.state.current.write=K.state.pending.write,a.queue(K,a.createRecord(K,{type:a.ContentType.handshake,data:a.createFinished(K)})),K.expect=o,a.flush(K),K.process()};if(_.session.certificateRequest===null||_.session.clientCertificate===null)return P(_,null);a.getClientSignature(_,P)},a.handleChangeCipherSpec=function(_,x){if(x.fragment.getByte()!==1)return _.error(_,{message:"Invalid ChangeCipherSpec message received.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.illegal_parameter}});var w=_.entity===a.ConnectionEnd.client;(_.session.resuming&&w||!_.session.resuming&&!w)&&(_.state.pending=a.createConnectionState(_)),_.state.current.read=_.state.pending.read,(!_.session.resuming&&w||_.session.resuming&&!w)&&(_.state.pending=null),_.expect=w?m:T,_.process()},a.handleFinished=function(_,x,w){var d=x.fragment;d.read-=4;var b=d.bytes();d.read+=4;var U=x.fragment.getBytes();d=t.util.createBuffer(),d.putBuffer(_.session.md5.digest()),d.putBuffer(_.session.sha1.digest());var P=_.entity===a.ConnectionEnd.client,K=P?"server finished":"client finished",V=_.session.sp,$=12,M=e;if(d=M(V.master_secret,K,d.getBytes(),$),d.getBytes()!==U)return _.error(_,{message:"Invalid verify_data in Finished message.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.decrypt_error}});_.session.md5.update(b),_.session.sha1.update(b),(_.session.resuming&&P||!_.session.resuming&&!P)&&(a.queue(_,a.createRecord(_,{type:a.ContentType.change_cipher_spec,data:a.createChangeCipherSpec()})),_.state.current.write=_.state.pending.write,_.state.pending=null,a.queue(_,a.createRecord(_,{type:a.ContentType.handshake,data:a.createFinished(_)}))),_.expect=P?g:h,_.handshaking=!1,++_.handshakes,_.peerCertificate=P?_.session.serverCertificate:_.session.clientCertificate,a.flush(_),_.isConnected=!0,_.connected(_),_.process()},a.handleAlert=function(_,x){var w=x.fragment,d={level:w.getByte(),description:w.getByte()},b;switch(d.description){case a.Alert.Description.close_notify:b="Connection closed.";break;case a.Alert.Description.unexpected_message:b="Unexpected message.";break;case a.Alert.Description.bad_record_mac:b="Bad record MAC.";break;case a.Alert.Description.decryption_failed:b="Decryption failed.";break;case a.Alert.Description.record_overflow:b="Record overflow.";break;case a.Alert.Description.decompression_failure:b="Decompression failed.";break;case a.Alert.Description.handshake_failure:b="Handshake failure.";break;case a.Alert.Description.bad_certificate:b="Bad certificate.";break;case a.Alert.Description.unsupported_certificate:b="Unsupported certificate.";break;case a.Alert.Description.certificate_revoked:b="Certificate revoked.";break;case a.Alert.Description.certificate_expired:b="Certificate expired.";break;case a.Alert.Description.certificate_unknown:b="Certificate unknown.";break;case a.Alert.Description.illegal_parameter:b="Illegal parameter.";break;case a.Alert.Description.unknown_ca:b="Unknown certificate authority.";break;case a.Alert.Description.access_denied:b="Access denied.";break;case a.Alert.Description.decode_error:b="Decode error.";break;case a.Alert.Description.decrypt_error:b="Decrypt error.";break;case a.Alert.Description.export_restriction:b="Export restriction.";break;case a.Alert.Description.protocol_version:b="Unsupported protocol version.";break;case a.Alert.Description.insufficient_security:b="Insufficient security.";break;case a.Alert.Description.internal_error:b="Internal error.";break;case a.Alert.Description.user_canceled:b="User canceled.";break;case a.Alert.Description.no_renegotiation:b="Renegotiation not supported.";break;default:b="Unknown error.";break}if(d.description===a.Alert.Description.close_notify)return _.close();_.error(_,{message:b,send:!1,origin:_.entity===a.ConnectionEnd.client?"server":"client",alert:d}),_.process()},a.handleHandshake=function(_,x){var w=x.fragment,d=w.getByte(),b=w.getInt24();if(b>w.length())return _.fragmented=x,x.fragment=t.util.createBuffer(),w.read-=4,_.process();_.fragmented=null,w.read-=4;var U=w.bytes(b+4);w.read+=4,d in ye[_.entity][_.expect]?(_.entity===a.ConnectionEnd.server&&!_.open&&!_.fail&&(_.handshaking=!0,_.session={version:null,extensions:{server_name:{serverNameList:[]}},cipherSuite:null,compressionMethod:null,serverCertificate:null,clientCertificate:null,md5:t.md.md5.create(),sha1:t.md.sha1.create()}),d!==a.HandshakeType.hello_request&&d!==a.HandshakeType.certificate_verify&&d!==a.HandshakeType.finished&&(_.session.md5.update(U),_.session.sha1.update(U)),ye[_.entity][_.expect][d](_,x,b)):a.handleUnexpected(_,x)},a.handleApplicationData=function(_,x){_.data.putBuffer(x.fragment),_.dataReady(_),_.process()},a.handleHeartbeat=function(_,x){var w=x.fragment,d=w.getByte(),b=w.getInt16(),U=w.getBytes(b);if(d===a.HeartbeatMessageType.heartbeat_request){if(_.handshaking||b>U.length)return _.process();a.queue(_,a.createRecord(_,{type:a.ContentType.heartbeat,data:a.createHeartbeat(a.HeartbeatMessageType.heartbeat_response,U)})),a.flush(_)}else if(d===a.HeartbeatMessageType.heartbeat_response){if(U!==_.expectedHeartbeatPayload)return _.process();_.heartbeatReceived&&_.heartbeatReceived(_,t.util.createBuffer(U))}_.process()};var p=0,f=1,A=2,C=3,y=4,o=5,m=6,g=7,S=8,i=0,v=1,E=2,I=3,B=4,T=5,h=6,l=a.handleUnexpected,R=a.handleChangeCipherSpec,N=a.handleAlert,F=a.handleHandshake,D=a.handleApplicationData,q=a.handleHeartbeat,j=[];j[a.ConnectionEnd.client]=[[l,N,F,l,q],[l,N,F,l,q],[l,N,F,l,q],[l,N,F,l,q],[l,N,F,l,q],[R,N,l,l,q],[l,N,F,l,q],[l,N,F,D,q],[l,N,F,l,q]],j[a.ConnectionEnd.server]=[[l,N,F,l,q],[l,N,F,l,q],[l,N,F,l,q],[l,N,F,l,q],[R,N,l,l,q],[l,N,F,l,q],[l,N,F,D,q],[l,N,F,l,q]];var H=a.handleHelloRequest,Q=a.handleServerHello,J=a.handleCertificate,X=a.handleServerKeyExchange,re=a.handleCertificateRequest,se=a.handleServerHelloDone,de=a.handleFinished,ye=[];ye[a.ConnectionEnd.client]=[[l,l,Q,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l],[H,l,l,l,l,l,l,l,l,l,l,J,X,re,se,l,l,l,l,l,l],[H,l,l,l,l,l,l,l,l,l,l,l,X,re,se,l,l,l,l,l,l],[H,l,l,l,l,l,l,l,l,l,l,l,l,re,se,l,l,l,l,l,l],[H,l,l,l,l,l,l,l,l,l,l,l,l,l,se,l,l,l,l,l,l],[H,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l],[H,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,de],[H,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l],[H,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l]];var _e=a.handleClientHello,W=a.handleClientKeyExchange,he=a.handleCertificateVerify;ye[a.ConnectionEnd.server]=[[l,_e,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l],[l,l,l,l,l,l,l,l,l,l,l,J,l,l,l,l,l,l,l,l,l],[l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,W,l,l,l,l],[l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,he,l,l,l,l,l],[l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l],[l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,de],[l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l],[l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l]],a.generateKeys=function(_,x){var w=e,d=x.client_random+x.server_random;_.session.resuming||(x.master_secret=w(x.pre_master_secret,"master secret",d,48).bytes(),x.pre_master_secret=null),d=x.server_random+x.client_random;var b=2*x.mac_key_length+2*x.enc_key_length,U=_.version.major===a.Versions.TLS_1_0.major&&_.version.minor===a.Versions.TLS_1_0.minor;U&&(b+=2*x.fixed_iv_length);var P=w(x.master_secret,"key expansion",d,b),K={client_write_MAC_key:P.getBytes(x.mac_key_length),server_write_MAC_key:P.getBytes(x.mac_key_length),client_write_key:P.getBytes(x.enc_key_length),server_write_key:P.getBytes(x.enc_key_length)};return U&&(K.client_write_IV=P.getBytes(x.fixed_iv_length),K.server_write_IV=P.getBytes(x.fixed_iv_length)),K},a.createConnectionState=function(_){var x=_.entity===a.ConnectionEnd.client,w=function(){var U={sequenceNumber:[0,0],macKey:null,macLength:0,macFunction:null,cipherState:null,cipherFunction:function(P){return!0},compressionState:null,compressFunction:function(P){return!0},updateSequenceNumber:function(){U.sequenceNumber[1]===4294967295?(U.sequenceNumber[1]=0,++U.sequenceNumber[0]):++U.sequenceNumber[1]}};return U},d={read:w(),write:w()};if(d.read.update=function(U,P){return d.read.cipherFunction(P,d.read)?d.read.compressFunction(U,P,d.read)||U.error(U,{message:"Could not decompress record.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.decompression_failure}}):U.error(U,{message:"Could not decrypt record or bad MAC.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.bad_record_mac}}),!U.fail},d.write.update=function(U,P){return d.write.compressFunction(U,P,d.write)?d.write.cipherFunction(P,d.write)||U.error(U,{message:"Could not encrypt record.",send:!1,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.internal_error}}):U.error(U,{message:"Could not compress record.",send:!1,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.internal_error}}),!U.fail},_.session){var b=_.session.sp;switch(_.session.cipherSuite.initSecurityParameters(b),b.keys=a.generateKeys(_,b),d.read.macKey=x?b.keys.server_write_MAC_key:b.keys.client_write_MAC_key,d.write.macKey=x?b.keys.client_write_MAC_key:b.keys.server_write_MAC_key,_.session.cipherSuite.initConnectionState(d,_,b),b.compression_algorithm){case a.CompressionMethod.none:break;case a.CompressionMethod.deflate:d.read.compressFunction=s,d.write.compressFunction=n;break;default:throw new Error("Unsupported compression algorithm.")}}return d},a.createRandom=function(){var _=new Date,x=+_+_.getTimezoneOffset()*6e4,w=t.util.createBuffer();return w.putInt32(x),w.putBytes(t.random.getBytes(28)),w},a.createRecord=function(_,x){if(!x.data)return null;var w={type:x.type,version:{major:_.version.major,minor:_.version.minor},length:x.data.length(),fragment:x.data};return w},a.createAlert=function(_,x){var w=t.util.createBuffer();return w.putByte(x.level),w.putByte(x.description),a.createRecord(_,{type:a.ContentType.alert,data:w})},a.createClientHello=function(_){_.session.clientHelloVersion={major:_.version.major,minor:_.version.minor};for(var x=t.util.createBuffer(),w=0;w<_.cipherSuites.length;++w){var d=_.cipherSuites[w];x.putByte(d.id[0]),x.putByte(d.id[1])}var b=x.length(),U=t.util.createBuffer();U.putByte(a.CompressionMethod.none);var P=U.length(),K=t.util.createBuffer();if(_.virtualHost){var V=t.util.createBuffer();V.putByte(0),V.putByte(0);var $=t.util.createBuffer();$.putByte(0),u($,2,t.util.createBuffer(_.virtualHost));var M=t.util.createBuffer();u(M,2,$),u(V,2,M),K.putBuffer(V)}var G=K.length();G>0&&(G+=2);var Y=_.session.id,ne=Y.length+1+2+4+28+2+b+1+P+G,te=t.util.createBuffer();return te.putByte(a.HandshakeType.client_hello),te.putInt24(ne),te.putByte(_.version.major),te.putByte(_.version.minor),te.putBytes(_.session.sp.client_random),u(te,1,t.util.createBuffer(Y)),u(te,2,x),u(te,1,U),G>0&&u(te,2,K),te},a.createServerHello=function(_){var x=_.session.id,w=x.length+1+2+4+28+2+1,d=t.util.createBuffer();return d.putByte(a.HandshakeType.server_hello),d.putInt24(w),d.putByte(_.version.major),d.putByte(_.version.minor),d.putBytes(_.session.sp.server_random),u(d,1,t.util.createBuffer(x)),d.putByte(_.session.cipherSuite.id[0]),d.putByte(_.session.cipherSuite.id[1]),d.putByte(_.session.compressionMethod),d},a.createCertificate=function(_){var x=_.entity===a.ConnectionEnd.client,w=null;if(_.getCertificate){var d;x?d=_.session.certificateRequest:d=_.session.extensions.server_name.serverNameList,w=_.getCertificate(_,d)}var b=t.util.createBuffer();if(w!==null)try{t.util.isArray(w)||(w=[w]);for(var U=null,P=0;P<w.length;++P){var K=t.pem.decode(w[P])[0];if(K.type!=="CERTIFICATE"&&K.type!=="X509 CERTIFICATE"&&K.type!=="TRUSTED CERTIFICATE"){var V=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw V.headerType=K.type,V}if(K.procType&&K.procType.type==="ENCRYPTED")throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var $=t.util.createBuffer(K.body);U===null&&(U=t.asn1.fromDer($.bytes(),!1));var M=t.util.createBuffer();u(M,3,$),b.putBuffer(M)}w=t.pki.certificateFromAsn1(U),x?_.session.clientCertificate=w:_.session.serverCertificate=w}catch(ne){return _.error(_,{message:"Could not send certificate list.",cause:ne,send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.bad_certificate}})}var G=3+b.length(),Y=t.util.createBuffer();return Y.putByte(a.HandshakeType.certificate),Y.putInt24(G),u(Y,3,b),Y},a.createClientKeyExchange=function(_){var x=t.util.createBuffer();x.putByte(_.session.clientHelloVersion.major),x.putByte(_.session.clientHelloVersion.minor),x.putBytes(t.random.getBytes(46));var w=_.session.sp;w.pre_master_secret=x.getBytes();var d=_.session.serverCertificate.publicKey;x=d.encrypt(w.pre_master_secret);var b=x.length+2,U=t.util.createBuffer();return U.putByte(a.HandshakeType.client_key_exchange),U.putInt24(b),U.putInt16(x.length),U.putBytes(x),U},a.createServerKeyExchange=function(_){var x=t.util.createBuffer();return x},a.getClientSignature=function(_,x){var w=t.util.createBuffer();w.putBuffer(_.session.md5.digest()),w.putBuffer(_.session.sha1.digest()),w=w.getBytes(),_.getSignature=_.getSignature||function(d,b,U){var P=null;if(d.getPrivateKey)try{P=d.getPrivateKey(d,d.session.clientCertificate),P=t.pki.privateKeyFromPem(P)}catch(K){d.error(d,{message:"Could not get private key.",cause:K,send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.internal_error}})}P===null?d.error(d,{message:"No private key set.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.internal_error}}):b=P.sign(b,null),U(d,b)},_.getSignature(_,w,x)},a.createCertificateVerify=function(_,x){var w=x.length+2,d=t.util.createBuffer();return d.putByte(a.HandshakeType.certificate_verify),d.putInt24(w),d.putInt16(x.length),d.putBytes(x),d},a.createCertificateRequest=function(_){var x=t.util.createBuffer();x.putByte(1);var w=t.util.createBuffer();for(var d in _.caStore.certs){var b=_.caStore.certs[d],U=t.pki.distinguishedNameToAsn1(b.subject),P=t.asn1.toDer(U);w.putInt16(P.length()),w.putBuffer(P)}var K=1+x.length()+2+w.length(),V=t.util.createBuffer();return V.putByte(a.HandshakeType.certificate_request),V.putInt24(K),u(V,1,x),u(V,2,w),V},a.createServerHelloDone=function(_){var x=t.util.createBuffer();return x.putByte(a.HandshakeType.server_hello_done),x.putInt24(0),x},a.createChangeCipherSpec=function(){var _=t.util.createBuffer();return _.putByte(1),_},a.createFinished=function(_){var x=t.util.createBuffer();x.putBuffer(_.session.md5.digest()),x.putBuffer(_.session.sha1.digest());var w=_.entity===a.ConnectionEnd.client,d=_.session.sp,b=12,U=e,P=w?"client finished":"server finished";x=U(d.master_secret,P,x.getBytes(),b);var K=t.util.createBuffer();return K.putByte(a.HandshakeType.finished),K.putInt24(x.length()),K.putBuffer(x),K},a.createHeartbeat=function(_,x,w){typeof w>"u"&&(w=x.length);var d=t.util.createBuffer();d.putByte(_),d.putInt16(w),d.putBytes(x);var b=d.length(),U=Math.max(16,b-w-3);return d.putBytes(t.random.getBytes(U)),d},a.queue=function(_,x){if(x&&!(x.fragment.length()===0&&(x.type===a.ContentType.handshake||x.type===a.ContentType.alert||x.type===a.ContentType.change_cipher_spec))){if(x.type===a.ContentType.handshake){var w=x.fragment.bytes();_.session.md5.update(w),_.session.sha1.update(w),w=null}var d;if(x.fragment.length()<=a.MaxFragment)d=[x];else{d=[];for(var b=x.fragment.bytes();b.length>a.MaxFragment;)d.push(a.createRecord(_,{type:x.type,data:t.util.createBuffer(b.slice(0,a.MaxFragment))})),b=b.slice(a.MaxFragment);b.length>0&&d.push(a.createRecord(_,{type:x.type,data:t.util.createBuffer(b)}))}for(var U=0;U<d.length&&!_.fail;++U){var P=d[U],K=_.state.current.write;K.update(_,P)&&_.records.push(P)}}},a.flush=function(_){for(var x=0;x<_.records.length;++x){var w=_.records[x];_.tlsData.putByte(w.type),_.tlsData.putByte(w.version.major),_.tlsData.putByte(w.version.minor),_.tlsData.putInt16(w.fragment.length()),_.tlsData.putBuffer(_.records[x].fragment)}return _.records=[],_.tlsDataReady(_)};var ae=function(_){switch(_){case!0:return!0;case t.pki.certificateError.bad_certificate:return a.Alert.Description.bad_certificate;case t.pki.certificateError.unsupported_certificate:return a.Alert.Description.unsupported_certificate;case t.pki.certificateError.certificate_revoked:return a.Alert.Description.certificate_revoked;case t.pki.certificateError.certificate_expired:return a.Alert.Description.certificate_expired;case t.pki.certificateError.certificate_unknown:return a.Alert.Description.certificate_unknown;case t.pki.certificateError.unknown_ca:return a.Alert.Description.unknown_ca;default:return a.Alert.Description.bad_certificate}},ke=function(_){switch(_){case!0:return!0;case a.Alert.Description.bad_certificate:return t.pki.certificateError.bad_certificate;case a.Alert.Description.unsupported_certificate:return t.pki.certificateError.unsupported_certificate;case a.Alert.Description.certificate_revoked:return t.pki.certificateError.certificate_revoked;case a.Alert.Description.certificate_expired:return t.pki.certificateError.certificate_expired;case a.Alert.Description.certificate_unknown:return t.pki.certificateError.certificate_unknown;case a.Alert.Description.unknown_ca:return t.pki.certificateError.unknown_ca;default:return t.pki.certificateError.bad_certificate}};a.verifyCertificateChain=function(_,x){try{var w={};for(var d in _.verifyOptions)w[d]=_.verifyOptions[d];w.verify=function(U,P,K){var V=ae(U),$=_.verify(_,U,P,K);if($!==!0){if(typeof $=="object"&&!t.util.isArray($)){var M=new Error("The application rejected the certificate.");throw M.send=!0,M.alert={level:a.Alert.Level.fatal,description:a.Alert.Description.bad_certificate},$.message&&(M.message=$.message),$.alert&&(M.alert.description=$.alert),M}$!==U&&($=ke($))}return $},t.pki.verifyCertificateChain(_.caStore,x,w)}catch(U){var b=U;(typeof b!="object"||t.util.isArray(b))&&(b={send:!0,alert:{level:a.Alert.Level.fatal,description:ae(U)}}),"send"in b||(b.send=!0),"alert"in b||(b.alert={level:a.Alert.Level.fatal,description:ae(b.error)}),_.error(_,b)}return!_.fail},a.createSessionCache=function(_,x){var w=null;if(_&&_.getSession&&_.setSession&&_.order)w=_;else{w={},w.cache=_||{},w.capacity=Math.max(x||100,1),w.order=[];for(var d in _)w.order.length<=x?w.order.push(d):delete _[d];w.getSession=function(b){var U=null,P=null;if(b?P=t.util.bytesToHex(b):w.order.length>0&&(P=w.order[0]),P!==null&&P in w.cache){U=w.cache[P],delete w.cache[P];for(var K in w.order)if(w.order[K]===P){w.order.splice(K,1);break}}return U},w.setSession=function(b,U){if(w.order.length===w.capacity){var P=w.order.shift();delete w.cache[P]}var P=t.util.bytesToHex(b);w.order.push(P),w.cache[P]=U}}return w},a.createConnection=function(_){var x=null;_.caStore?t.util.isArray(_.caStore)?x=t.pki.createCaStore(_.caStore):x=_.caStore:x=t.pki.createCaStore();var w=_.cipherSuites||null;if(w===null){w=[];for(var d in a.CipherSuites)w.push(a.CipherSuites[d])}var b=_.server?a.ConnectionEnd.server:a.ConnectionEnd.client,U=_.sessionCache?a.createSessionCache(_.sessionCache):null,P={version:{major:a.Version.major,minor:a.Version.minor},entity:b,sessionId:_.sessionId,caStore:x,sessionCache:U,cipherSuites:w,connected:_.connected,virtualHost:_.virtualHost||null,verifyClient:_.verifyClient||!1,verify:_.verify||function(M,G,Y,ne){return G},verifyOptions:_.verifyOptions||{},getCertificate:_.getCertificate||null,getPrivateKey:_.getPrivateKey||null,getSignature:_.getSignature||null,input:t.util.createBuffer(),tlsData:t.util.createBuffer(),data:t.util.createBuffer(),tlsDataReady:_.tlsDataReady,dataReady:_.dataReady,heartbeatReceived:_.heartbeatReceived,closed:_.closed,error:function(M,G){G.origin=G.origin||(M.entity===a.ConnectionEnd.client?"client":"server"),G.send&&(a.queue(M,a.createAlert(M,G.alert)),a.flush(M));var Y=G.fatal!==!1;Y&&(M.fail=!0),_.error(M,G),Y&&M.close(!1)},deflate:_.deflate||null,inflate:_.inflate||null};P.reset=function(M){P.version={major:a.Version.major,minor:a.Version.minor},P.record=null,P.session=null,P.peerCertificate=null,P.state={pending:null,current:null},P.expect=P.entity===a.ConnectionEnd.client?p:i,P.fragmented=null,P.records=[],P.open=!1,P.handshakes=0,P.handshaking=!1,P.isConnected=!1,P.fail=!(M||typeof M>"u"),P.input.clear(),P.tlsData.clear(),P.data.clear(),P.state.current=a.createConnectionState(P)},P.reset();var K=function(M,G){var Y=G.type-a.ContentType.change_cipher_spec,ne=j[M.entity][M.expect];Y in ne?ne[Y](M,G):a.handleUnexpected(M,G)},V=function(M){var G=0,Y=M.input,ne=Y.length();if(ne<5)G=5-ne;else{M.record={type:Y.getByte(),version:{major:Y.getByte(),minor:Y.getByte()},length:Y.getInt16(),fragment:t.util.createBuffer(),ready:!1};var te=M.record.version.major===M.version.major;te&&M.session&&M.session.version&&(te=M.record.version.minor===M.version.minor),te||M.error(M,{message:"Incompatible TLS version.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.protocol_version}})}return G},$=function(M){var G=0,Y=M.input,ne=Y.length();if(ne<M.record.length)G=M.record.length-ne;else{M.record.fragment.putBytes(Y.getBytes(M.record.length)),Y.compact();var te=M.state.current.read;te.update(M,M.record)&&(M.fragmented!==null&&(M.fragmented.type===M.record.type?(M.fragmented.fragment.putBuffer(M.record.fragment),M.record=M.fragmented):M.error(M,{message:"Invalid fragmented record.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.unexpected_message}})),M.record.ready=!0)}return G};return P.handshake=function(M){if(P.entity!==a.ConnectionEnd.client)P.error(P,{message:"Cannot initiate handshake as a server.",fatal:!1});else if(P.handshaking)P.error(P,{message:"Handshake already in progress.",fatal:!1});else{P.fail&&!P.open&&P.handshakes===0&&(P.fail=!1),P.handshaking=!0,M=M||"";var G=null;M.length>0&&(P.sessionCache&&(G=P.sessionCache.getSession(M)),G===null&&(M="")),M.length===0&&P.sessionCache&&(G=P.sessionCache.getSession(),G!==null&&(M=G.id)),P.session={id:M,version:null,cipherSuite:null,compressionMethod:null,serverCertificate:null,certificateRequest:null,clientCertificate:null,sp:{},md5:t.md.md5.create(),sha1:t.md.sha1.create()},G&&(P.version=G.version,P.session.sp=G.sp),P.session.sp.client_random=a.createRandom().getBytes(),P.open=!0,a.queue(P,a.createRecord(P,{type:a.ContentType.handshake,data:a.createClientHello(P)})),a.flush(P)}},P.process=function(M){var G=0;return M&&P.input.putBytes(M),P.fail||(P.record!==null&&P.record.ready&&P.record.fragment.isEmpty()&&(P.record=null),P.record===null&&(G=V(P)),!P.fail&&P.record!==null&&!P.record.ready&&(G=$(P)),!P.fail&&P.record!==null&&P.record.ready&&K(P,P.record)),G},P.prepare=function(M){return a.queue(P,a.createRecord(P,{type:a.ContentType.application_data,data:t.util.createBuffer(M)})),a.flush(P)},P.prepareHeartbeatRequest=function(M,G){return M instanceof t.util.ByteBuffer&&(M=M.bytes()),typeof G>"u"&&(G=M.length),P.expectedHeartbeatPayload=M,a.queue(P,a.createRecord(P,{type:a.ContentType.heartbeat,data:a.createHeartbeat(a.HeartbeatMessageType.heartbeat_request,M,G)})),a.flush(P)},P.close=function(M){if(!P.fail&&P.sessionCache&&P.session){var G={id:P.session.id,version:P.session.version,sp:P.session.sp};G.sp.keys=null,P.sessionCache.setSession(G.id,G)}P.open&&(P.open=!1,P.input.clear(),(P.isConnected||P.handshaking)&&(P.isConnected=P.handshaking=!1,a.queue(P,a.createAlert(P,{level:a.Alert.Level.warning,description:a.Alert.Description.close_notify})),a.flush(P)),P.closed(P)),P.reset(M)},P},li=t.tls=t.tls||{};for(var fe in a)typeof a[fe]!="function"&&(t.tls[fe]=a[fe]);return t.tls.prf_tls1=e,t.tls.hmac_sha1=r,t.tls.createSessionCache=a.createSessionCache,t.tls.createConnection=a.createConnection,li}var Mo;function ad(){if(Mo)return qa.exports;Mo=1;var t=me();sr(),ku();var e=qa.exports=t.tls;e.CipherSuites.TLS_RSA_WITH_AES_128_CBC_SHA={id:[0,47],name:"TLS_RSA_WITH_AES_128_CBC_SHA",initSecurityParameters:function(p){p.bulk_cipher_algorithm=e.BulkCipherAlgorithm.aes,p.cipher_type=e.CipherType.block,p.enc_key_length=16,p.block_length=16,p.fixed_iv_length=16,p.record_iv_length=16,p.mac_algorithm=e.MACAlgorithm.hmac_sha1,p.mac_length=20,p.mac_key_length=20},initConnectionState:r},e.CipherSuites.TLS_RSA_WITH_AES_256_CBC_SHA={id:[0,53],name:"TLS_RSA_WITH_AES_256_CBC_SHA",initSecurityParameters:function(p){p.bulk_cipher_algorithm=e.BulkCipherAlgorithm.aes,p.cipher_type=e.CipherType.block,p.enc_key_length=32,p.block_length=16,p.fixed_iv_length=16,p.record_iv_length=16,p.mac_algorithm=e.MACAlgorithm.hmac_sha1,p.mac_length=20,p.mac_key_length=20},initConnectionState:r};function r(p,f,A){var C=f.entity===t.tls.ConnectionEnd.client;p.read.cipherState={init:!1,cipher:t.cipher.createDecipher("AES-CBC",C?A.keys.server_write_key:A.keys.client_write_key),iv:C?A.keys.server_write_IV:A.keys.client_write_IV},p.write.cipherState={init:!1,cipher:t.cipher.createCipher("AES-CBC",C?A.keys.client_write_key:A.keys.server_write_key),iv:C?A.keys.client_write_IV:A.keys.server_write_IV},p.read.cipherFunction=u,p.write.cipherFunction=n,p.read.macLength=p.write.macLength=A.mac_length,p.read.macFunction=p.write.macFunction=e.hmac_sha1}function n(p,f){var A=!1,C=f.macFunction(f.macKey,f.sequenceNumber,p);p.fragment.putBytes(C),f.updateSequenceNumber();var y;p.version.minor===e.Versions.TLS_1_0.minor?y=f.cipherState.init?null:f.cipherState.iv:y=t.random.getBytesSync(16),f.cipherState.init=!0;var o=f.cipherState.cipher;return o.start({iv:y}),p.version.minor>=e.Versions.TLS_1_1.minor&&o.output.putBytes(y),o.update(p.fragment),o.finish(s)&&(p.fragment=o.output,p.length=p.fragment.length(),A=!0),A}function s(p,f,A){if(!A){var C=p-f.length()%p;f.fillWithByte(C-1,C)}return!0}function c(p,f,A){var C=!0;if(A){for(var y=f.length(),o=f.last(),m=y-1-o;m<y-1;++m)C=C&&f.at(m)==o;C&&f.truncate(o+1)}return C}function u(p,f){var A=!1,C;p.version.minor===e.Versions.TLS_1_0.minor?C=f.cipherState.init?null:f.cipherState.iv:C=p.fragment.getBytes(16),f.cipherState.init=!0;var y=f.cipherState.cipher;y.start({iv:C}),y.update(p.fragment),A=y.finish(c);var o=f.macLength,m=t.random.getBytesSync(o),g=y.output.length();g>=o?(p.fragment=y.output.getBytes(g-o),m=y.output.getBytes(o)):p.fragment=y.output.getBytes(),p.fragment=t.util.createBuffer(p.fragment),p.length=p.fragment.length();var S=f.macFunction(f.macKey,f.sequenceNumber,p);return f.updateSequenceNumber(),A=a(f.macKey,m,S)&&A,A}function a(p,f,A){var C=t.hmac.create();return C.start("SHA1",p),C.update(f),f=C.digest().getBytes(),C.start(null,null),C.update(A),A=C.digest().getBytes(),f===A}return qa.exports}var fi={exports:{}},qo;function Du(){if(qo)return fi.exports;qo=1;var t=me();Ut(),Ae();var e=fi.exports=t.sha512=t.sha512||{};t.md.sha512=t.md.algorithms.sha512=e;var r=t.sha384=t.sha512.sha384=t.sha512.sha384||{};r.create=function(){return e.create("SHA-384")},t.md.sha384=t.md.algorithms.sha384=r,t.sha512.sha256=t.sha512.sha256||{create:function(){return e.create("SHA-512/256")}},t.md["sha512/256"]=t.md.algorithms["sha512/256"]=t.sha512.sha256,t.sha512.sha224=t.sha512.sha224||{create:function(){return e.create("SHA-512/224")}},t.md["sha512/224"]=t.md.algorithms["sha512/224"]=t.sha512.sha224,e.create=function(f){if(s||a(),typeof f>"u"&&(f="SHA-512"),!(f in u))throw new Error("Invalid SHA-512 algorithm: "+f);for(var A=u[f],C=null,y=t.util.createBuffer(),o=new Array(80),m=0;m<80;++m)o[m]=new Array(2);var g=64;switch(f){case"SHA-384":g=48;break;case"SHA-512/256":g=32;break;case"SHA-512/224":g=28;break}var S={algorithm:f.replace("-","").toLowerCase(),blockLength:128,digestLength:g,messageLength:0,fullMessageLength:null,messageLengthSize:16};return S.start=function(){S.messageLength=0,S.fullMessageLength=S.messageLength128=[];for(var i=S.messageLengthSize/4,v=0;v<i;++v)S.fullMessageLength.push(0);y=t.util.createBuffer(),C=new Array(A.length);for(var v=0;v<A.length;++v)C[v]=A[v].slice(0);return S},S.start(),S.update=function(i,v){v==="utf8"&&(i=t.util.encodeUtf8(i));var E=i.length;S.messageLength+=E,E=[E/4294967296>>>0,E>>>0];for(var I=S.fullMessageLength.length-1;I>=0;--I)S.fullMessageLength[I]+=E[1],E[1]=E[0]+(S.fullMessageLength[I]/4294967296>>>0),S.fullMessageLength[I]=S.fullMessageLength[I]>>>0,E[0]=E[1]/4294967296>>>0;return y.putBytes(i),p(C,o,y),(y.read>2048||y.length()===0)&&y.compact(),S},S.digest=function(){var i=t.util.createBuffer();i.putBytes(y.bytes());var v=S.fullMessageLength[S.fullMessageLength.length-1]+S.messageLengthSize,E=v&S.blockLength-1;i.putBytes(n.substr(0,S.blockLength-E));for(var I,B,T=S.fullMessageLength[0]*8,h=0;h<S.fullMessageLength.length-1;++h)I=S.fullMessageLength[h+1]*8,B=I/4294967296>>>0,T+=B,i.putInt32(T>>>0),T=I>>>0;i.putInt32(T);for(var l=new Array(C.length),h=0;h<C.length;++h)l[h]=C[h].slice(0);p(l,o,i);var R=t.util.createBuffer(),N;f==="SHA-512"?N=l.length:f==="SHA-384"?N=l.length-2:N=l.length-4;for(var h=0;h<N;++h)R.putInt32(l[h][0]),(h!==N-1||f!=="SHA-512/224")&&R.putInt32(l[h][1]);return R},S};var n=null,s=!1,c=null,u=null;function a(){n=String.fromCharCode(128),n+=t.util.fillString(String.fromCharCode(0),128),c=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],u={},u["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],u["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],u["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],u["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],s=!0}function p(f,A,C){for(var y,o,m,g,S,i,v,E,I,B,T,h,l,R,N,F,D,q,j,H,Q,J,X,re,se,de,ye,_e,W,he,ae,ke,fe,_,x,w=C.length();w>=128;){for(W=0;W<16;++W)A[W][0]=C.getInt32()>>>0,A[W][1]=C.getInt32()>>>0;for(;W<80;++W)ke=A[W-2],he=ke[0],ae=ke[1],y=((he>>>19|ae<<13)^(ae>>>29|he<<3)^he>>>6)>>>0,o=((he<<13|ae>>>19)^(ae<<3|he>>>29)^(he<<26|ae>>>6))>>>0,_=A[W-15],he=_[0],ae=_[1],m=((he>>>1|ae<<31)^(he>>>8|ae<<24)^he>>>7)>>>0,g=((he<<31|ae>>>1)^(he<<24|ae>>>8)^(he<<25|ae>>>7))>>>0,fe=A[W-7],x=A[W-16],ae=o+fe[1]+g+x[1],A[W][0]=y+fe[0]+m+x[0]+(ae/4294967296>>>0)>>>0,A[W][1]=ae>>>0;for(l=f[0][0],R=f[0][1],N=f[1][0],F=f[1][1],D=f[2][0],q=f[2][1],j=f[3][0],H=f[3][1],Q=f[4][0],J=f[4][1],X=f[5][0],re=f[5][1],se=f[6][0],de=f[6][1],ye=f[7][0],_e=f[7][1],W=0;W<80;++W)v=((Q>>>14|J<<18)^(Q>>>18|J<<14)^(J>>>9|Q<<23))>>>0,E=((Q<<18|J>>>14)^(Q<<14|J>>>18)^(J<<23|Q>>>9))>>>0,I=(se^Q&(X^se))>>>0,B=(de^J&(re^de))>>>0,S=((l>>>28|R<<4)^(R>>>2|l<<30)^(R>>>7|l<<25))>>>0,i=((l<<4|R>>>28)^(R<<30|l>>>2)^(R<<25|l>>>7))>>>0,T=(l&N|D&(l^N))>>>0,h=(R&F|q&(R^F))>>>0,ae=_e+E+B+c[W][1]+A[W][1],y=ye+v+I+c[W][0]+A[W][0]+(ae/4294967296>>>0)>>>0,o=ae>>>0,ae=i+h,m=S+T+(ae/4294967296>>>0)>>>0,g=ae>>>0,ye=se,_e=de,se=X,de=re,X=Q,re=J,ae=H+o,Q=j+y+(ae/4294967296>>>0)>>>0,J=ae>>>0,j=D,H=q,D=N,q=F,N=l,F=R,ae=o+g,l=y+m+(ae/4294967296>>>0)>>>0,R=ae>>>0;ae=f[0][1]+R,f[0][0]=f[0][0]+l+(ae/4294967296>>>0)>>>0,f[0][1]=ae>>>0,ae=f[1][1]+F,f[1][0]=f[1][0]+N+(ae/4294967296>>>0)>>>0,f[1][1]=ae>>>0,ae=f[2][1]+q,f[2][0]=f[2][0]+D+(ae/4294967296>>>0)>>>0,f[2][1]=ae>>>0,ae=f[3][1]+H,f[3][0]=f[3][0]+j+(ae/4294967296>>>0)>>>0,f[3][1]=ae>>>0,ae=f[4][1]+J,f[4][0]=f[4][0]+Q+(ae/4294967296>>>0)>>>0,f[4][1]=ae>>>0,ae=f[5][1]+re,f[5][0]=f[5][0]+X+(ae/4294967296>>>0)>>>0,f[5][1]=ae>>>0,ae=f[6][1]+de,f[6][0]=f[6][0]+se+(ae/4294967296>>>0)>>>0,f[6][1]=ae>>>0,ae=f[7][1]+_e,f[7][0]=f[7][0]+ye+(ae/4294967296>>>0)>>>0,f[7][1]=ae>>>0,w-=128}}return fi.exports}var xn={},Vo;function id(){if(Vo)return xn;Vo=1;var t=me();Tt();var e=t.asn1;return xn.privateKeyValidator={name:"PrivateKeyInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},xn.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{tagClass:e.Class.UNIVERSAL,type:e.Type.BITSTRING,constructed:!1,composed:!0,captureBitStringValue:"ed25519PublicKey"}]},xn}var di,Ko;function sd(){if(Ko)return di;Ko=1;var t=me();oa(),yt(),Du(),Ae();var e=id(),r=e.publicKeyValidator,n=e.privateKeyValidator;if(typeof s>"u")var s=t.jsbn.BigInteger;var c=t.util.ByteBuffer,u=typeof Buffer>"u"?Uint8Array:Buffer;t.pki=t.pki||{},di=t.pki.ed25519=t.ed25519=t.ed25519||{};var a=t.ed25519;a.constants={},a.constants.PUBLIC_KEY_BYTE_LENGTH=32,a.constants.PRIVATE_KEY_BYTE_LENGTH=64,a.constants.SEED_BYTE_LENGTH=32,a.constants.SIGN_BYTE_LENGTH=64,a.constants.HASH_BYTE_LENGTH=64,a.generateKeyPair=function(_){_=_||{};var x=_.seed;if(x===void 0)x=t.random.getBytesSync(a.constants.SEED_BYTE_LENGTH);else if(typeof x=="string"){if(x.length!==a.constants.SEED_BYTE_LENGTH)throw new TypeError('"seed" must be '+a.constants.SEED_BYTE_LENGTH+" bytes in length.")}else if(!(x instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, Uint8Array, or a binary string.');x=p({message:x,encoding:"binary"});for(var w=new u(a.constants.PUBLIC_KEY_BYTE_LENGTH),d=new u(a.constants.PRIVATE_KEY_BYTE_LENGTH),b=0;b<32;++b)d[b]=x[b];return v(w,d),{publicKey:w,privateKey:d}},a.privateKeyFromAsn1=function(_){var x={},w=[],d=t.asn1.validate(_,n,x,w);if(!d){var b=new Error("Invalid Key.");throw b.errors=w,b}var U=t.asn1.derToOid(x.privateKeyOid),P=t.oids.EdDSA25519;if(U!==P)throw new Error('Invalid OID "'+U+'"; OID must be "'+P+'".');var K=x.privateKey,V=p({message:t.asn1.fromDer(K).value,encoding:"binary"});return{privateKeyBytes:V}},a.publicKeyFromAsn1=function(_){var x={},w=[],d=t.asn1.validate(_,r,x,w);if(!d){var b=new Error("Invalid Key.");throw b.errors=w,b}var U=t.asn1.derToOid(x.publicKeyOid),P=t.oids.EdDSA25519;if(U!==P)throw new Error('Invalid OID "'+U+'"; OID must be "'+P+'".');var K=x.ed25519PublicKey;if(K.length!==a.constants.PUBLIC_KEY_BYTE_LENGTH)throw new Error("Key length is invalid.");return p({message:K,encoding:"binary"})},a.publicKeyFromPrivateKey=function(_){_=_||{};var x=p({message:_.privateKey,encoding:"binary"});if(x.length!==a.constants.PRIVATE_KEY_BYTE_LENGTH)throw new TypeError('"options.privateKey" must have a byte length of '+a.constants.PRIVATE_KEY_BYTE_LENGTH);for(var w=new u(a.constants.PUBLIC_KEY_BYTE_LENGTH),d=0;d<w.length;++d)w[d]=x[32+d];return w},a.sign=function(_){_=_||{};var x=p(_),w=p({message:_.privateKey,encoding:"binary"});if(w.length===a.constants.SEED_BYTE_LENGTH){var d=a.generateKeyPair({seed:w});w=d.privateKey}else if(w.length!==a.constants.PRIVATE_KEY_BYTE_LENGTH)throw new TypeError('"options.privateKey" must have a byte length of '+a.constants.SEED_BYTE_LENGTH+" or "+a.constants.PRIVATE_KEY_BYTE_LENGTH);var b=new u(a.constants.SIGN_BYTE_LENGTH+x.length);E(b,x,x.length,w);for(var U=new u(a.constants.SIGN_BYTE_LENGTH),P=0;P<U.length;++P)U[P]=b[P];return U},a.verify=function(_){_=_||{};var x=p(_);if(_.signature===void 0)throw new TypeError('"options.signature" must be a node.js Buffer, a Uint8Array, a forge ByteBuffer, or a binary string.');var w=p({message:_.signature,encoding:"binary"});if(w.length!==a.constants.SIGN_BYTE_LENGTH)throw new TypeError('"options.signature" must have a byte length of '+a.constants.SIGN_BYTE_LENGTH);var d=p({message:_.publicKey,encoding:"binary"});if(d.length!==a.constants.PUBLIC_KEY_BYTE_LENGTH)throw new TypeError('"options.publicKey" must have a byte length of '+a.constants.PUBLIC_KEY_BYTE_LENGTH);var b=new u(a.constants.SIGN_BYTE_LENGTH+x.length),U=new u(a.constants.SIGN_BYTE_LENGTH+x.length),P;for(P=0;P<a.constants.SIGN_BYTE_LENGTH;++P)b[P]=w[P];for(P=0;P<x.length;++P)b[P+a.constants.SIGN_BYTE_LENGTH]=x[P];return I(U,b,b.length,d)>=0};function p(_){var x=_.message;if(x instanceof Uint8Array||x instanceof u)return x;var w=_.encoding;if(x===void 0)if(_.md)x=_.md.digest().getBytes(),w="binary";else throw new TypeError('"options.message" or "options.md" not specified.');if(typeof x=="string"&&!w)throw new TypeError('"options.encoding" must be "binary" or "utf8".');if(typeof x=="string"){if(typeof Buffer<"u")return Buffer.from(x,w);x=new c(x,w)}else if(!(x instanceof c))throw new TypeError('"options.message" must be a node.js Buffer, a Uint8Array, a forge ByteBuffer, or a string with "options.encoding" specifying its encoding.');for(var d=new u(x.length()),b=0;b<d.length;++b)d[b]=x.at(b);return d}var f=W(),A=W([1]),C=W([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),y=W([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),o=W([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),m=W([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),g=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]),S=W([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function i(_,x){var w=t.md.sha512.create(),d=new c(_);w.update(d.getBytes(x),"binary");var b=w.digest().getBytes();if(typeof Buffer<"u")return Buffer.from(b,"binary");for(var U=new u(a.constants.HASH_BYTE_LENGTH),P=0;P<64;++P)U[P]=b.charCodeAt(P);return U}function v(_,x){var w=[W(),W(),W(),W()],d,b=i(x,32);for(b[0]&=248,b[31]&=127,b[31]|=64,re(w,b),R(_,w),d=0;d<32;++d)x[d+32]=_[d];return 0}function E(_,x,w,d){var b,U,P=new Float64Array(64),K=[W(),W(),W(),W()],V=i(d,32);V[0]&=248,V[31]&=127,V[31]|=64;var $=w+64;for(b=0;b<w;++b)_[64+b]=x[b];for(b=0;b<32;++b)_[32+b]=V[32+b];var M=i(_.subarray(32),w+32);for(T(M),re(K,M),R(_,K),b=32;b<64;++b)_[b]=d[b];var G=i(_,w+64);for(T(G),b=32;b<64;++b)P[b]=0;for(b=0;b<32;++b)P[b]=M[b];for(b=0;b<32;++b)for(U=0;U<32;U++)P[b+U]+=G[b]*V[U];return B(_.subarray(32),P),$}function I(_,x,w,d){var b,U,P=new u(32),K=[W(),W(),W(),W()],V=[W(),W(),W(),W()];if(U=-1,w<64||F(V,d))return-1;for(b=0;b<w;++b)_[b]=x[b];for(b=0;b<32;++b)_[b+32]=d[b];var $=i(_,w);if(T($),X(K,V,$),re(V,x.subarray(32)),h(K,V),R(P,K),w-=64,H(x,0,P,0)){for(b=0;b<w;++b)_[b]=0;return-1}for(b=0;b<w;++b)_[b]=x[b+64];return U=w,U}function B(_,x){var w,d,b,U;for(d=63;d>=32;--d){for(w=0,b=d-32,U=d-12;b<U;++b)x[b]+=w-16*x[d]*g[b-(d-32)],w=x[b]+128>>8,x[b]-=w*256;x[b]+=w,x[d]=0}for(w=0,b=0;b<32;++b)x[b]+=w-(x[31]>>4)*g[b],w=x[b]>>8,x[b]&=255;for(b=0;b<32;++b)x[b]-=w*g[b];for(d=0;d<32;++d)x[d+1]+=x[d]>>8,_[d]=x[d]&255}function T(_){for(var x=new Float64Array(64),w=0;w<64;++w)x[w]=_[w],_[w]=0;B(_,x)}function h(_,x){var w=W(),d=W(),b=W(),U=W(),P=W(),K=W(),V=W(),$=W(),M=W();ae(w,_[1],_[0]),ae(M,x[1],x[0]),fe(w,w,M),he(d,_[0],_[1]),he(M,x[0],x[1]),fe(d,d,M),fe(b,_[3],x[3]),fe(b,b,y),fe(U,_[2],x[2]),he(U,U,U),ae(P,d,w),ae(K,U,b),he(V,U,b),he($,d,w),fe(_[0],P,K),fe(_[1],$,V),fe(_[2],V,K),fe(_[3],P,$)}function l(_,x,w){for(var d=0;d<4;++d)_e(_[d],x[d],w)}function R(_,x){var w=W(),d=W(),b=W();de(b,x[2]),fe(w,x[0],b),fe(d,x[1],b),N(_,d),_[31]^=J(w)<<7}function N(_,x){var w,d,b,U=W(),P=W();for(w=0;w<16;++w)P[w]=x[w];for(ye(P),ye(P),ye(P),d=0;d<2;++d){for(U[0]=P[0]-65517,w=1;w<15;++w)U[w]=P[w]-65535-(U[w-1]>>16&1),U[w-1]&=65535;U[15]=P[15]-32767-(U[14]>>16&1),b=U[15]>>16&1,U[14]&=65535,_e(P,U,1-b)}for(w=0;w<16;w++)_[2*w]=P[w]&255,_[2*w+1]=P[w]>>8}function F(_,x){var w=W(),d=W(),b=W(),U=W(),P=W(),K=W(),V=W();return se(_[2],A),D(_[1],x),ke(b,_[1]),fe(U,b,C),ae(b,b,_[2]),he(U,_[2],U),ke(P,U),ke(K,P),fe(V,K,P),fe(w,V,b),fe(w,w,U),q(w,w),fe(w,w,b),fe(w,w,U),fe(w,w,U),fe(_[0],w,U),ke(d,_[0]),fe(d,d,U),j(d,b)&&fe(_[0],_[0],S),ke(d,_[0]),fe(d,d,U),j(d,b)?-1:(J(_[0])===x[31]>>7&&ae(_[0],f,_[0]),fe(_[3],_[0],_[1]),0)}function D(_,x){var w;for(w=0;w<16;++w)_[w]=x[2*w]+(x[2*w+1]<<8);_[15]&=32767}function q(_,x){var w=W(),d;for(d=0;d<16;++d)w[d]=x[d];for(d=250;d>=0;--d)ke(w,w),d!==1&&fe(w,w,x);for(d=0;d<16;++d)_[d]=w[d]}function j(_,x){var w=new u(32),d=new u(32);return N(w,_),N(d,x),H(w,0,d,0)}function H(_,x,w,d){return Q(_,x,w,d,32)}function Q(_,x,w,d,b){var U,P=0;for(U=0;U<b;++U)P|=_[x+U]^w[d+U];return(1&P-1>>>8)-1}function J(_){var x=new u(32);return N(x,_),x[0]&1}function X(_,x,w){var d,b;for(se(_[0],f),se(_[1],A),se(_[2],A),se(_[3],f),b=255;b>=0;--b)d=w[b/8|0]>>(b&7)&1,l(_,x,d),h(x,_),h(_,_),l(_,x,d)}function re(_,x){var w=[W(),W(),W(),W()];se(w[0],o),se(w[1],m),se(w[2],A),fe(w[3],o,m),X(_,w,x)}function se(_,x){var w;for(w=0;w<16;w++)_[w]=x[w]|0}function de(_,x){var w=W(),d;for(d=0;d<16;++d)w[d]=x[d];for(d=253;d>=0;--d)ke(w,w),d!==2&&d!==4&&fe(w,w,x);for(d=0;d<16;++d)_[d]=w[d]}function ye(_){var x,w,d=1;for(x=0;x<16;++x)w=_[x]+d+65535,d=Math.floor(w/65536),_[x]=w-d*65536;_[0]+=d-1+37*(d-1)}function _e(_,x,w){for(var d,b=~(w-1),U=0;U<16;++U)d=b&(_[U]^x[U]),_[U]^=d,x[U]^=d}function W(_){var x,w=new Float64Array(16);if(_)for(x=0;x<_.length;++x)w[x]=_[x];return w}function he(_,x,w){for(var d=0;d<16;++d)_[d]=x[d]+w[d]}function ae(_,x,w){for(var d=0;d<16;++d)_[d]=x[d]-w[d]}function ke(_,x){fe(_,x,x)}function fe(_,x,w){var d,b,U=0,P=0,K=0,V=0,$=0,M=0,G=0,Y=0,ne=0,te=0,ue=0,pe=0,ge=0,ce=0,le=0,ve=0,be=0,Ne=0,Pe=0,we=0,Oe=0,Ie=0,Te=0,Ee=0,gt=0,xt=0,kt=0,zt=0,ur=0,Pr=0,pn=0,Le=w[0],Fe=w[1],Me=w[2],qe=w[3],Ve=w[4],Ke=w[5],$e=w[6],Ge=w[7],je=w[8],He=w[9],ze=w[10],We=w[11],Re=w[12],De=w[13],Qe=w[14],Ye=w[15];d=x[0],U+=d*Le,P+=d*Fe,K+=d*Me,V+=d*qe,$+=d*Ve,M+=d*Ke,G+=d*$e,Y+=d*Ge,ne+=d*je,te+=d*He,ue+=d*ze,pe+=d*We,ge+=d*Re,ce+=d*De,le+=d*Qe,ve+=d*Ye,d=x[1],P+=d*Le,K+=d*Fe,V+=d*Me,$+=d*qe,M+=d*Ve,G+=d*Ke,Y+=d*$e,ne+=d*Ge,te+=d*je,ue+=d*He,pe+=d*ze,ge+=d*We,ce+=d*Re,le+=d*De,ve+=d*Qe,be+=d*Ye,d=x[2],K+=d*Le,V+=d*Fe,$+=d*Me,M+=d*qe,G+=d*Ve,Y+=d*Ke,ne+=d*$e,te+=d*Ge,ue+=d*je,pe+=d*He,ge+=d*ze,ce+=d*We,le+=d*Re,ve+=d*De,be+=d*Qe,Ne+=d*Ye,d=x[3],V+=d*Le,$+=d*Fe,M+=d*Me,G+=d*qe,Y+=d*Ve,ne+=d*Ke,te+=d*$e,ue+=d*Ge,pe+=d*je,ge+=d*He,ce+=d*ze,le+=d*We,ve+=d*Re,be+=d*De,Ne+=d*Qe,Pe+=d*Ye,d=x[4],$+=d*Le,M+=d*Fe,G+=d*Me,Y+=d*qe,ne+=d*Ve,te+=d*Ke,ue+=d*$e,pe+=d*Ge,ge+=d*je,ce+=d*He,le+=d*ze,ve+=d*We,be+=d*Re,Ne+=d*De,Pe+=d*Qe,we+=d*Ye,d=x[5],M+=d*Le,G+=d*Fe,Y+=d*Me,ne+=d*qe,te+=d*Ve,ue+=d*Ke,pe+=d*$e,ge+=d*Ge,ce+=d*je,le+=d*He,ve+=d*ze,be+=d*We,Ne+=d*Re,Pe+=d*De,we+=d*Qe,Oe+=d*Ye,d=x[6],G+=d*Le,Y+=d*Fe,ne+=d*Me,te+=d*qe,ue+=d*Ve,pe+=d*Ke,ge+=d*$e,ce+=d*Ge,le+=d*je,ve+=d*He,be+=d*ze,Ne+=d*We,Pe+=d*Re,we+=d*De,Oe+=d*Qe,Ie+=d*Ye,d=x[7],Y+=d*Le,ne+=d*Fe,te+=d*Me,ue+=d*qe,pe+=d*Ve,ge+=d*Ke,ce+=d*$e,le+=d*Ge,ve+=d*je,be+=d*He,Ne+=d*ze,Pe+=d*We,we+=d*Re,Oe+=d*De,Ie+=d*Qe,Te+=d*Ye,d=x[8],ne+=d*Le,te+=d*Fe,ue+=d*Me,pe+=d*qe,ge+=d*Ve,ce+=d*Ke,le+=d*$e,ve+=d*Ge,be+=d*je,Ne+=d*He,Pe+=d*ze,we+=d*We,Oe+=d*Re,Ie+=d*De,Te+=d*Qe,Ee+=d*Ye,d=x[9],te+=d*Le,ue+=d*Fe,pe+=d*Me,ge+=d*qe,ce+=d*Ve,le+=d*Ke,ve+=d*$e,be+=d*Ge,Ne+=d*je,Pe+=d*He,we+=d*ze,Oe+=d*We,Ie+=d*Re,Te+=d*De,Ee+=d*Qe,gt+=d*Ye,d=x[10],ue+=d*Le,pe+=d*Fe,ge+=d*Me,ce+=d*qe,le+=d*Ve,ve+=d*Ke,be+=d*$e,Ne+=d*Ge,Pe+=d*je,we+=d*He,Oe+=d*ze,Ie+=d*We,Te+=d*Re,Ee+=d*De,gt+=d*Qe,xt+=d*Ye,d=x[11],pe+=d*Le,ge+=d*Fe,ce+=d*Me,le+=d*qe,ve+=d*Ve,be+=d*Ke,Ne+=d*$e,Pe+=d*Ge,we+=d*je,Oe+=d*He,Ie+=d*ze,Te+=d*We,Ee+=d*Re,gt+=d*De,xt+=d*Qe,kt+=d*Ye,d=x[12],ge+=d*Le,ce+=d*Fe,le+=d*Me,ve+=d*qe,be+=d*Ve,Ne+=d*Ke,Pe+=d*$e,we+=d*Ge,Oe+=d*je,Ie+=d*He,Te+=d*ze,Ee+=d*We,gt+=d*Re,xt+=d*De,kt+=d*Qe,zt+=d*Ye,d=x[13],ce+=d*Le,le+=d*Fe,ve+=d*Me,be+=d*qe,Ne+=d*Ve,Pe+=d*Ke,we+=d*$e,Oe+=d*Ge,Ie+=d*je,Te+=d*He,Ee+=d*ze,gt+=d*We,xt+=d*Re,kt+=d*De,zt+=d*Qe,ur+=d*Ye,d=x[14],le+=d*Le,ve+=d*Fe,be+=d*Me,Ne+=d*qe,Pe+=d*Ve,we+=d*Ke,Oe+=d*$e,Ie+=d*Ge,Te+=d*je,Ee+=d*He,gt+=d*ze,xt+=d*We,kt+=d*Re,zt+=d*De,ur+=d*Qe,Pr+=d*Ye,d=x[15],ve+=d*Le,be+=d*Fe,Ne+=d*Me,Pe+=d*qe,we+=d*Ve,Oe+=d*Ke,Ie+=d*$e,Te+=d*Ge,Ee+=d*je,gt+=d*He,xt+=d*ze,kt+=d*We,zt+=d*Re,ur+=d*De,Pr+=d*Qe,pn+=d*Ye,U+=38*be,P+=38*Ne,K+=38*Pe,V+=38*we,$+=38*Oe,M+=38*Ie,G+=38*Te,Y+=38*Ee,ne+=38*gt,te+=38*xt,ue+=38*kt,pe+=38*zt,ge+=38*ur,ce+=38*Pr,le+=38*pn,b=1,d=U+b+65535,b=Math.floor(d/65536),U=d-b*65536,d=P+b+65535,b=Math.floor(d/65536),P=d-b*65536,d=K+b+65535,b=Math.floor(d/65536),K=d-b*65536,d=V+b+65535,b=Math.floor(d/65536),V=d-b*65536,d=$+b+65535,b=Math.floor(d/65536),$=d-b*65536,d=M+b+65535,b=Math.floor(d/65536),M=d-b*65536,d=G+b+65535,b=Math.floor(d/65536),G=d-b*65536,d=Y+b+65535,b=Math.floor(d/65536),Y=d-b*65536,d=ne+b+65535,b=Math.floor(d/65536),ne=d-b*65536,d=te+b+65535,b=Math.floor(d/65536),te=d-b*65536,d=ue+b+65535,b=Math.floor(d/65536),ue=d-b*65536,d=pe+b+65535,b=Math.floor(d/65536),pe=d-b*65536,d=ge+b+65535,b=Math.floor(d/65536),ge=d-b*65536,d=ce+b+65535,b=Math.floor(d/65536),ce=d-b*65536,d=le+b+65535,b=Math.floor(d/65536),le=d-b*65536,d=ve+b+65535,b=Math.floor(d/65536),ve=d-b*65536,U+=b-1+37*(b-1),b=1,d=U+b+65535,b=Math.floor(d/65536),U=d-b*65536,d=P+b+65535,b=Math.floor(d/65536),P=d-b*65536,d=K+b+65535,b=Math.floor(d/65536),K=d-b*65536,d=V+b+65535,b=Math.floor(d/65536),V=d-b*65536,d=$+b+65535,b=Math.floor(d/65536),$=d-b*65536,d=M+b+65535,b=Math.floor(d/65536),M=d-b*65536,d=G+b+65535,b=Math.floor(d/65536),G=d-b*65536,d=Y+b+65535,b=Math.floor(d/65536),Y=d-b*65536,d=ne+b+65535,b=Math.floor(d/65536),ne=d-b*65536,d=te+b+65535,b=Math.floor(d/65536),te=d-b*65536,d=ue+b+65535,b=Math.floor(d/65536),ue=d-b*65536,d=pe+b+65535,b=Math.floor(d/65536),pe=d-b*65536,d=ge+b+65535,b=Math.floor(d/65536),ge=d-b*65536,d=ce+b+65535,b=Math.floor(d/65536),ce=d-b*65536,d=le+b+65535,b=Math.floor(d/65536),le=d-b*65536,d=ve+b+65535,b=Math.floor(d/65536),ve=d-b*65536,U+=b-1+37*(b-1),_[0]=U,_[1]=P,_[2]=K,_[3]=V,_[4]=$,_[5]=M,_[6]=G,_[7]=Y,_[8]=ne,_[9]=te,_[10]=ue,_[11]=pe,_[12]=ge,_[13]=ce,_[14]=le,_[15]=ve}return di}var hi,$o;function od(){if($o)return hi;$o=1;var t=me();Ae(),yt(),oa(),hi=t.kem=t.kem||{};var e=t.jsbn.BigInteger;t.kem.rsa={},t.kem.rsa.create=function(n,s){s=s||{};var c=s.prng||t.random,u={};return u.encrypt=function(a,p){var f=Math.ceil(a.n.bitLength()/8),A;do A=new e(t.util.bytesToHex(c.getBytesSync(f)),16).mod(a.n);while(A.compareTo(e.ONE)<=0);A=t.util.hexToBytes(A.toString(16));var C=f-A.length;C>0&&(A=t.util.fillString(String.fromCharCode(0),C)+A);var y=a.encrypt(A,"NONE"),o=n.generate(A,p);return{encapsulation:y,key:o}},u.decrypt=function(a,p,f){var A=a.decrypt(p,"NONE");return n.generate(A,f)},u},t.kem.kdf1=function(n,s){r(this,n,0,s||n.digestLength)},t.kem.kdf2=function(n,s){r(this,n,1,s||n.digestLength)};function r(n,s,c,u){n.generate=function(a,p){for(var f=new t.util.ByteBuffer,A=Math.ceil(p/u)+c,C=new t.util.ByteBuffer,y=c;y<A;++y){C.putInt32(y),s.start(),s.update(a+C.getBytes());var o=s.digest();f.putBytes(o.getBytes(u))}return f.truncate(f.length()-p),f.getBytes()}}return hi}var pi,Go;function cd(){if(Go)return pi;Go=1;var t=me();Ae(),pi=t.log=t.log||{},t.log.levels=["none","error","warning","info","debug","verbose","max"];var e={},r=[],n=null;t.log.LEVEL_LOCKED=2,t.log.NO_LEVEL_CHECK=4,t.log.INTERPOLATE=8;for(var s=0;s<t.log.levels.length;++s){var c=t.log.levels[s];e[c]={index:s,name:c.toUpperCase()}}t.log.logMessage=function(y){for(var o=e[y.level].index,m=0;m<r.length;++m){var g=r[m];if(g.flags&t.log.NO_LEVEL_CHECK)g.f(y);else{var S=e[g.level].index;o<=S&&g.f(g,y)}}},t.log.prepareStandard=function(y){"standard"in y||(y.standard=e[y.level].name+" ["+y.category+"] "+y.message)},t.log.prepareFull=function(y){if(!("full"in y)){var o=[y.message];o=o.concat([]),y.full=t.util.format.apply(this,o)}},t.log.prepareStandardFull=function(y){"standardFull"in y||(t.log.prepareStandard(y),y.standardFull=y.standard)};for(var u=["error","warning","info","debug","verbose"],s=0;s<u.length;++s)(function(o){t.log[o]=function(m,g){var S=Array.prototype.slice.call(arguments).slice(2),i={timestamp:new Date,level:o,category:m,message:g,arguments:S};t.log.logMessage(i)}})(u[s]);if(t.log.makeLogger=function(y){var o={flags:0,f:y};return t.log.setLevel(o,"none"),o},t.log.setLevel=function(y,o){var m=!1;if(y&&!(y.flags&t.log.LEVEL_LOCKED))for(var g=0;g<t.log.levels.length;++g){var S=t.log.levels[g];if(o==S){y.level=o,m=!0;break}}return m},t.log.lock=function(y,o){typeof o>"u"||o?y.flags|=t.log.LEVEL_LOCKED:y.flags&=~t.log.LEVEL_LOCKED},t.log.addLogger=function(y){r.push(y)},typeof console<"u"&&"log"in console){var a;if(console.error&&console.warn&&console.info&&console.debug){var p={error:console.error,warning:console.warn,info:console.info,debug:console.debug,verbose:console.debug},f=function(y,o){t.log.prepareStandard(o);var m=p[o.level],g=[o.standard];g=g.concat(o.arguments.slice()),m.apply(console,g)};a=t.log.makeLogger(f)}else{var f=function(o,m){t.log.prepareStandardFull(m),console.log(m.standardFull)};a=t.log.makeLogger(f)}t.log.setLevel(a,"debug"),t.log.addLogger(a),n=a}else console={log:function(){}};if(n!==null&&typeof window<"u"&&window.location){var A=new URL(window.location.href).searchParams;if(A.has("console.level")&&t.log.setLevel(n,A.get("console.level").slice(-1)[0]),A.has("console.lock")){var C=A.get("console.lock").slice(-1)[0];C=="true"&&t.log.lock(n)}}return t.log.consoleLogger=n,pi}var yi,jo;function ud(){return jo||(jo=1,yi=Ut(),ys(),an(),_u(),Du()),yi}var gi={exports:{}},Ho;function ld(){if(Ho)return gi.exports;Ho=1;var t=me();sr(),Tt(),sa(),or(),Br(),Nu(),yt(),Ae(),ms();var e=t.asn1,r=gi.exports=t.pkcs7=t.pkcs7||{};r.messageFromPem=function(o){var m=t.pem.decode(o)[0];if(m.type!=="PKCS7"){var g=new Error('Could not convert PKCS#7 message from PEM; PEM header type is not "PKCS#7".');throw g.headerType=m.type,g}if(m.procType&&m.procType.type==="ENCRYPTED")throw new Error("Could not convert PKCS#7 message from PEM; PEM is encrypted.");var S=e.fromDer(m.body);return r.messageFromAsn1(S)},r.messageToPem=function(o,m){var g={type:"PKCS7",body:e.toDer(o.toAsn1()).getBytes()};return t.pem.encode(g,{maxline:m})},r.messageFromAsn1=function(o){var m={},g=[];if(!e.validate(o,r.asn1.contentInfoValidator,m,g)){var S=new Error("Cannot read PKCS#7 message. ASN.1 object is not an PKCS#7 ContentInfo.");throw S.errors=g,S}var i=e.derToOid(m.contentType),v;switch(i){case t.pki.oids.envelopedData:v=r.createEnvelopedData();break;case t.pki.oids.encryptedData:v=r.createEncryptedData();break;case t.pki.oids.signedData:v=r.createSignedData();break;default:throw new Error("Cannot read PKCS#7 message. ContentType with OID "+i+" is not (yet) supported.")}return v.fromAsn1(m.content.value[0]),v},r.createSignedData=function(){var o=null;return o={type:t.pki.oids.signedData,version:1,certificates:[],crls:[],signers:[],digestAlgorithmIdentifiers:[],contentInfo:null,signerInfos:[],fromAsn1:function(S){if(C(o,S,r.asn1.signedDataValidator),o.certificates=[],o.crls=[],o.digestAlgorithmIdentifiers=[],o.contentInfo=null,o.signerInfos=[],o.rawCapture.certificates)for(var i=o.rawCapture.certificates.value,v=0;v<i.length;++v)o.certificates.push(t.pki.certificateFromAsn1(i[v]))},toAsn1:function(){o.contentInfo||o.sign();for(var S=[],i=0;i<o.certificates.length;++i)S.push(t.pki.certificateToAsn1(o.certificates[i]));var v=[],E=e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(o.version).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SET,!0,o.digestAlgorithmIdentifiers),o.contentInfo])]);return S.length>0&&E.value[0].value.push(e.create(e.Class.CONTEXT_SPECIFIC,0,!0,S)),v.length>0&&E.value[0].value.push(e.create(e.Class.CONTEXT_SPECIFIC,1,!0,v)),E.value[0].value.push(e.create(e.Class.UNIVERSAL,e.Type.SET,!0,o.signerInfos)),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(o.type).getBytes()),E])},addSigner:function(S){var i=S.issuer,v=S.serialNumber;if(S.certificate){var E=S.certificate;typeof E=="string"&&(E=t.pki.certificateFromPem(E)),i=E.issuer.attributes,v=E.serialNumber}var I=S.key;if(!I)throw new Error("Could not add PKCS#7 signer; no private key specified.");typeof I=="string"&&(I=t.pki.privateKeyFromPem(I));var B=S.digestAlgorithm||t.pki.oids.sha1;switch(B){case t.pki.oids.sha1:case t.pki.oids.sha256:case t.pki.oids.sha384:case t.pki.oids.sha512:case t.pki.oids.md5:break;default:throw new Error("Could not add PKCS#7 signer; unknown message digest algorithm: "+B)}var T=S.authenticatedAttributes||[];if(T.length>0){for(var h=!1,l=!1,R=0;R<T.length;++R){var N=T[R];if(!h&&N.type===t.pki.oids.contentType){if(h=!0,l)break;continue}if(!l&&N.type===t.pki.oids.messageDigest){if(l=!0,h)break;continue}}if(!h||!l)throw new Error("Invalid signer.authenticatedAttributes. If signer.authenticatedAttributes is specified, then it must contain at least two attributes, PKCS #9 content-type and PKCS #9 message-digest.")}o.signers.push({key:I,version:1,issuer:i,serialNumber:v,digestAlgorithm:B,signatureAlgorithm:t.pki.oids.rsaEncryption,signature:null,authenticatedAttributes:T,unauthenticatedAttributes:[]})},sign:function(S){if(S=S||{},(typeof o.content!="object"||o.contentInfo===null)&&(o.contentInfo=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(t.pki.oids.data).getBytes())]),"content"in o)){var i;o.content instanceof t.util.ByteBuffer?i=o.content.bytes():typeof o.content=="string"&&(i=t.util.encodeUtf8(o.content)),S.detached?o.detachedContent=e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,i):o.contentInfo.value.push(e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,i)]))}if(o.signers.length!==0){var v=m();g(v)}},verify:function(){throw new Error("PKCS#7 signature verification not yet implemented.")},addCertificate:function(S){typeof S=="string"&&(S=t.pki.certificateFromPem(S)),o.certificates.push(S)},addCertificateRevokationList:function(S){throw new Error("PKCS#7 CRL support not yet implemented.")}},o;function m(){for(var S={},i=0;i<o.signers.length;++i){var v=o.signers[i],E=v.digestAlgorithm;E in S||(S[E]=t.md[t.pki.oids[E]].create()),v.authenticatedAttributes.length===0?v.md=S[E]:v.md=t.md[t.pki.oids[E]].create()}o.digestAlgorithmIdentifiers=[];for(var E in S)o.digestAlgorithmIdentifiers.push(e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(E).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")]));return S}function g(S){var i;if(o.detachedContent?i=o.detachedContent:(i=o.contentInfo.value[1],i=i.value[0]),!i)throw new Error("Could not sign PKCS#7 message; there is no content to sign.");var v=e.derToOid(o.contentInfo.value[0].value),E=e.toDer(i);E.getByte(),e.getBerValueLength(E),E=E.getBytes();for(var I in S)S[I].start().update(E);for(var B=new Date,T=0;T<o.signers.length;++T){var h=o.signers[T];if(h.authenticatedAttributes.length===0){if(v!==t.pki.oids.data)throw new Error("Invalid signer; authenticatedAttributes must be present when the ContentInfo content type is not PKCS#7 Data.")}else{h.authenticatedAttributesAsn1=e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[]);for(var l=e.create(e.Class.UNIVERSAL,e.Type.SET,!0,[]),R=0;R<h.authenticatedAttributes.length;++R){var N=h.authenticatedAttributes[R];N.type===t.pki.oids.messageDigest?N.value=S[h.digestAlgorithm].digest():N.type===t.pki.oids.signingTime&&(N.value||(N.value=B)),l.value.push(f(N)),h.authenticatedAttributesAsn1.value.push(f(N))}E=e.toDer(l).getBytes(),h.md.start().update(E)}h.signature=h.key.sign(h.md,"RSASSA-PKCS1-V1_5")}o.signerInfos=p(o.signers)}},r.createEncryptedData=function(){var o=null;return o={type:t.pki.oids.encryptedData,version:0,encryptedContent:{algorithm:t.pki.oids["aes256-CBC"]},fromAsn1:function(m){C(o,m,r.asn1.encryptedDataValidator)},decrypt:function(m){m!==void 0&&(o.encryptedContent.key=m),y(o)}},o},r.createEnvelopedData=function(){var o=null;return o={type:t.pki.oids.envelopedData,version:0,recipients:[],encryptedContent:{algorithm:t.pki.oids["aes256-CBC"]},fromAsn1:function(m){var g=C(o,m,r.asn1.envelopedDataValidator);o.recipients=c(g.recipientInfos.value)},toAsn1:function(){return e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(o.type).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(o.version).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SET,!0,u(o.recipients)),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,A(o.encryptedContent))])])])},findRecipient:function(m){for(var g=m.issuer.attributes,S=0;S<o.recipients.length;++S){var i=o.recipients[S],v=i.issuer;if(i.serialNumber===m.serialNumber&&v.length===g.length){for(var E=!0,I=0;I<g.length;++I)if(v[I].type!==g[I].type||v[I].value!==g[I].value){E=!1;break}if(E)return i}}return null},decrypt:function(m,g){if(o.encryptedContent.key===void 0&&m!==void 0&&g!==void 0)switch(m.encryptedContent.algorithm){case t.pki.oids.rsaEncryption:case t.pki.oids.desCBC:var S=g.decrypt(m.encryptedContent.content);o.encryptedContent.key=t.util.createBuffer(S);break;default:throw new Error("Unsupported asymmetric cipher, OID "+m.encryptedContent.algorithm)}y(o)},addRecipient:function(m){o.recipients.push({version:0,issuer:m.issuer.attributes,serialNumber:m.serialNumber,encryptedContent:{algorithm:t.pki.oids.rsaEncryption,key:m.publicKey}})},encrypt:function(m,g){if(o.encryptedContent.content===void 0){g=g||o.encryptedContent.algorithm,m=m||o.encryptedContent.key;var S,i,v;switch(g){case t.pki.oids["aes128-CBC"]:S=16,i=16,v=t.aes.createEncryptionCipher;break;case t.pki.oids["aes192-CBC"]:S=24,i=16,v=t.aes.createEncryptionCipher;break;case t.pki.oids["aes256-CBC"]:S=32,i=16,v=t.aes.createEncryptionCipher;break;case t.pki.oids["des-EDE3-CBC"]:S=24,i=8,v=t.des.createEncryptionCipher;break;default:throw new Error("Unsupported symmetric cipher, OID "+g)}if(m===void 0)m=t.util.createBuffer(t.random.getBytes(S));else if(m.length()!=S)throw new Error("Symmetric key has wrong length; got "+m.length()+" bytes, expected "+S+".");o.encryptedContent.algorithm=g,o.encryptedContent.key=m,o.encryptedContent.parameter=t.util.createBuffer(t.random.getBytes(i));var E=v(m);if(E.start(o.encryptedContent.parameter.copy()),E.update(o.content),!E.finish())throw new Error("Symmetric encryption failed.");o.encryptedContent.content=E.output}for(var I=0;I<o.recipients.length;++I){var B=o.recipients[I];if(B.encryptedContent.content===void 0)switch(B.encryptedContent.algorithm){case t.pki.oids.rsaEncryption:B.encryptedContent.content=B.encryptedContent.key.encrypt(o.encryptedContent.key.data);break;default:throw new Error("Unsupported asymmetric cipher, OID "+B.encryptedContent.algorithm)}}}},o};function n(o){var m={},g=[];if(!e.validate(o,r.asn1.recipientInfoValidator,m,g)){var S=new Error("Cannot read PKCS#7 RecipientInfo. ASN.1 object is not an PKCS#7 RecipientInfo.");throw S.errors=g,S}return{version:m.version.charCodeAt(0),issuer:t.pki.RDNAttributesAsArray(m.issuer),serialNumber:t.util.createBuffer(m.serial).toHex(),encryptedContent:{algorithm:e.derToOid(m.encAlgorithm),parameter:m.encParameter?m.encParameter.value:void 0,content:m.encKey}}}function s(o){return e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(o.version).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[t.pki.distinguishedNameToAsn1({attributes:o.issuer}),e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,t.util.hexToBytes(o.serialNumber))]),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(o.encryptedContent.algorithm).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")]),e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,o.encryptedContent.content)])}function c(o){for(var m=[],g=0;g<o.length;++g)m.push(n(o[g]));return m}function u(o){for(var m=[],g=0;g<o.length;++g)m.push(s(o[g]));return m}function a(o){var m=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(o.version).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[t.pki.distinguishedNameToAsn1({attributes:o.issuer}),e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,t.util.hexToBytes(o.serialNumber))]),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(o.digestAlgorithm).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")])]);if(o.authenticatedAttributesAsn1&&m.value.push(o.authenticatedAttributesAsn1),m.value.push(e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(o.signatureAlgorithm).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")])),m.value.push(e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,o.signature)),o.unauthenticatedAttributes.length>0){for(var g=e.create(e.Class.CONTEXT_SPECIFIC,1,!0,[]),S=0;S<o.unauthenticatedAttributes.length;++S){var i=o.unauthenticatedAttributes[S];g.values.push(f(i))}m.value.push(g)}return m}function p(o){for(var m=[],g=0;g<o.length;++g)m.push(a(o[g]));return m}function f(o){var m;if(o.type===t.pki.oids.contentType)m=e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(o.value).getBytes());else if(o.type===t.pki.oids.messageDigest)m=e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,o.value.bytes());else if(o.type===t.pki.oids.signingTime){var g=new Date("1950-01-01T00:00:00Z"),S=new Date("2050-01-01T00:00:00Z"),i=o.value;if(typeof i=="string"){var v=Date.parse(i);isNaN(v)?i.length===13?i=e.utcTimeToDate(i):i=e.generalizedTimeToDate(i):i=new Date(v)}i>=g&&i<S?m=e.create(e.Class.UNIVERSAL,e.Type.UTCTIME,!1,e.dateToUtcTime(i)):m=e.create(e.Class.UNIVERSAL,e.Type.GENERALIZEDTIME,!1,e.dateToGeneralizedTime(i))}return e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(o.type).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SET,!0,[m])])}function A(o){return[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(t.pki.oids.data).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(o.algorithm).getBytes()),o.parameter?e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,o.parameter.getBytes()):void 0]),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,o.content.getBytes())])]}function C(o,m,g){var S={},i=[];if(!e.validate(m,g,S,i)){var v=new Error("Cannot read PKCS#7 message. ASN.1 object is not a supported PKCS#7 message.");throw v.errors=v,v}var E=e.derToOid(S.contentType);if(E!==t.pki.oids.data)throw new Error("Unsupported PKCS#7 message. Only wrapped ContentType Data supported.");if(S.encryptedContent){var I="";if(t.util.isArray(S.encryptedContent))for(var B=0;B<S.encryptedContent.length;++B){if(S.encryptedContent[B].type!==e.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting encrypted content constructed of only OCTET STRING objects.");I+=S.encryptedContent[B].value}else I=S.encryptedContent;o.encryptedContent={algorithm:e.derToOid(S.encAlgorithm),parameter:t.util.createBuffer(S.encParameter.value),content:t.util.createBuffer(I)}}if(S.content){var I="";if(t.util.isArray(S.content))for(var B=0;B<S.content.length;++B){if(S.content[B].type!==e.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting content constructed of only OCTET STRING objects.");I+=S.content[B].value}else I=S.content;o.content=t.util.createBuffer(I)}return o.version=S.version.charCodeAt(0),o.rawCapture=S,S}function y(o){if(o.encryptedContent.key===void 0)throw new Error("Symmetric key not available.");if(o.content===void 0){var m;switch(o.encryptedContent.algorithm){case t.pki.oids["aes128-CBC"]:case t.pki.oids["aes192-CBC"]:case t.pki.oids["aes256-CBC"]:m=t.aes.createDecryptionCipher(o.encryptedContent.key);break;case t.pki.oids.desCBC:case t.pki.oids["des-EDE3-CBC"]:m=t.des.createDecryptionCipher(o.encryptedContent.key);break;default:throw new Error("Unsupported symmetric cipher, OID "+o.encryptedContent.algorithm)}if(m.start(o.encryptedContent.parameter),m.update(o.encryptedContent.content),!m.finish())throw new Error("Symmetric decryption failed.");o.content=m.output}}return gi.exports}var vi={exports:{}},zo;function fd(){if(zo)return vi.exports;zo=1;var t=me();sr(),nn(),ys(),an(),Ae();var e=vi.exports=t.ssh=t.ssh||{};e.privateKeyToPutty=function(c,u,a){a=a||"",u=u||"";var p="ssh-rsa",f=u===""?"none":"aes256-cbc",A="PuTTY-User-Key-File-2: "+p+`\r
`;A+="Encryption: "+f+`\r
`,A+="Comment: "+a+`\r
`;var C=t.util.createBuffer();n(C,p),r(C,c.e),r(C,c.n);var y=t.util.encode64(C.bytes(),64),o=Math.floor(y.length/66)+1;A+="Public-Lines: "+o+`\r
`,A+=y;var m=t.util.createBuffer();r(m,c.d),r(m,c.p),r(m,c.q),r(m,c.qInv);var g;if(!u)g=t.util.encode64(m.bytes(),64);else{var S=m.length()+16-1;S-=S%16;var i=s(m.bytes());i.truncate(i.length()-S+m.length()),m.putBuffer(i);var v=t.util.createBuffer();v.putBuffer(s("\0\0\0\0",u)),v.putBuffer(s("\0\0\0",u));var E=t.aes.createEncryptionCipher(v.truncate(8),"CBC");E.start(t.util.createBuffer().fillWithByte(0,16)),E.update(m.copy()),E.finish();var I=E.output;I.truncate(16),g=t.util.encode64(I.bytes(),64)}o=Math.floor(g.length/66)+1,A+=`\r
Private-Lines: `+o+`\r
`,A+=g;var B=s("putty-private-key-file-mac-key",u),T=t.util.createBuffer();n(T,p),n(T,f),n(T,a),T.putInt32(C.length()),T.putBuffer(C),T.putInt32(m.length()),T.putBuffer(m);var h=t.hmac.create();return h.start("sha1",B),h.update(T.bytes()),A+=`\r
Private-MAC: `+h.digest().toHex()+`\r
`,A},e.publicKeyToOpenSSH=function(c,u){var a="ssh-rsa";u=u||"";var p=t.util.createBuffer();return n(p,a),r(p,c.e),r(p,c.n),a+" "+t.util.encode64(p.bytes())+" "+u},e.privateKeyToOpenSSH=function(c,u){return u?t.pki.encryptRsaPrivateKey(c,u,{legacy:!0,algorithm:"aes128"}):t.pki.privateKeyToPem(c)},e.getPublicKeyFingerprint=function(c,u){u=u||{};var a=u.md||t.md.md5.create(),p="ssh-rsa",f=t.util.createBuffer();n(f,p),r(f,c.e),r(f,c.n),a.start(),a.update(f.getBytes());var A=a.digest();if(u.encoding==="hex"){var C=A.toHex();return u.delimiter?C.match(/.{2}/g).join(u.delimiter):C}else{if(u.encoding==="binary")return A.getBytes();if(u.encoding)throw new Error('Unknown encoding "'+u.encoding+'".')}return A};function r(c,u){var a=u.toString(16);a[0]>="8"&&(a="00"+a);var p=t.util.hexToBytes(a);c.putInt32(p.length),c.putBytes(p)}function n(c,u){c.putInt32(u.length),c.putString(u)}function s(){for(var c=t.md.sha1.create(),u=arguments.length,a=0;a<u;++a)c.update(arguments[a]);return c.digest()}return vi.exports}var mi,Wo;function dd(){return Wo||(Wo=1,mi=me(),sr(),ad(),Tt(),ps(),sa(),sd(),nn(),od(),cd(),ud(),Pu(),gs(),Br(),bu(),Ou(),ld(),Uu(),Bu(),wu(),vs(),yt(),Iu(),fd(),ku(),Ae()),mi}var Qo;function hd(){if(Qo)return Ur;Qo=1,Object.defineProperty(Ur,"__esModule",{value:!0}),Ur.getPem=void 0;const t=nr,e=dd(),n=(0,Pt.promisify)(t.readFile);function s(a,p){if(p)c(a).then(f=>p(null,f)).catch(f=>p(f,null));else return c(a)}Ur.getPem=s;function c(a){return n(a,{encoding:"base64"}).then(p=>u(p))}function u(a){const p=e.util.decode64(a),f=e.asn1.fromDer(p),C=e.pkcs12.pkcs12FromAsn1(f,"notasecret").getBags({friendlyName:"privatekey"});if(C.friendlyName){const y=C.friendlyName[0].key;return e.pki.privateKeyToPem(y).replace(/\r\n/g,`
`)}else throw new Error("Unable to get friendly name.")}return Ur}Object.defineProperty(ra,"__esModule",{value:!0});ra.GoogleToken=void 0;const Yo=nr,pd=At,yd=Ot,gd=qc,vd=Pt,Jo=Yo.readFile?(0,vd.promisify)(Yo.readFile):async()=>{throw new On("use key rather than keyFile.","MISSING_CREDENTIALS")},Xo="https://www.googleapis.com/oauth2/v4/token",md="https://accounts.google.com/o/oauth2/revoke?token=";class On extends Error{constructor(e,r){super(e),this.code=r}}let Ei;class Ed{constructor(e){this.transporter={request:r=>(0,pd.request)(r)},this.configure(e)}get accessToken(){return this.rawToken?this.rawToken.access_token:void 0}get idToken(){return this.rawToken?this.rawToken.id_token:void 0}get tokenType(){return this.rawToken?this.rawToken.token_type:void 0}get refreshToken(){return this.rawToken?this.rawToken.refresh_token:void 0}hasExpired(){const e=new Date().getTime();return this.rawToken&&this.expiresAt?e>=this.expiresAt:!0}isTokenExpiring(){var e;const r=new Date().getTime(),n=(e=this.eagerRefreshThresholdMillis)!==null&&e!==void 0?e:0;return this.rawToken&&this.expiresAt?this.expiresAt<=r+n:!0}getToken(e,r={}){if(typeof e=="object"&&(r=e,e=void 0),r=Object.assign({forceRefresh:!1},r),e){const n=e;this.getTokenAsync(r).then(s=>n(null,s),e);return}return this.getTokenAsync(r)}async getCredentials(e){switch(gd.extname(e)){case".json":{const n=await Jo(e,"utf8"),s=JSON.parse(n),c=s.private_key,u=s.client_email;if(!c||!u)throw new On("private_key and client_email are required.","MISSING_CREDENTIALS");return{privateKey:c,clientEmail:u}}case".der":case".crt":case".pem":return{privateKey:await Jo(e,"utf8")};case".p12":case".pfx":return Ei||(Ei=(await Promise.resolve().then(()=>hd())).getPem),{privateKey:await Ei(e)};default:throw new On("Unknown certificate type. Type is determined based on file extension. Current supported extensions are *.json, *.pem, and *.p12.","UNKNOWN_CERTIFICATE_TYPE")}}async getTokenAsync(e){if(this.inFlightRequest&&!e.forceRefresh)return this.inFlightRequest;try{return await(this.inFlightRequest=this.getTokenAsyncInner(e))}finally{this.inFlightRequest=void 0}}async getTokenAsyncInner(e){if(this.isTokenExpiring()===!1&&e.forceRefresh===!1)return Promise.resolve(this.rawToken);if(!this.key&&!this.keyFile)throw new Error("No key or keyFile set.");if(!this.key&&this.keyFile){const r=await this.getCredentials(this.keyFile);this.key=r.privateKey,this.iss=r.clientEmail||this.iss,r.clientEmail||this.ensureEmail()}return this.requestToken()}ensureEmail(){if(!this.iss)throw new On("email is required.","MISSING_CREDENTIALS")}revokeToken(e){if(e){this.revokeTokenAsync().then(()=>e(),e);return}return this.revokeTokenAsync()}async revokeTokenAsync(){if(!this.accessToken)throw new Error("No token to revoke.");const e=md+this.accessToken;await this.transporter.request({url:e}),this.configure({email:this.iss,sub:this.sub,key:this.key,keyFile:this.keyFile,scope:this.scope,additionalClaims:this.additionalClaims})}configure(e={}){this.keyFile=e.keyFile,this.key=e.key,this.rawToken=void 0,this.iss=e.email||e.iss,this.sub=e.sub,this.additionalClaims=e.additionalClaims,typeof e.scope=="object"?this.scope=e.scope.join(" "):this.scope=e.scope,this.eagerRefreshThresholdMillis=e.eagerRefreshThresholdMillis,e.transporter&&(this.transporter=e.transporter)}async requestToken(){var e,r;const n=Math.floor(new Date().getTime()/1e3),s=this.additionalClaims||{},c=Object.assign({iss:this.iss,scope:this.scope,aud:Xo,exp:n+3600,iat:n,sub:this.sub},s),u=yd.sign({header:{alg:"RS256"},payload:c,secret:this.key});try{const a=await this.transporter.request({method:"POST",url:Xo,data:{grant_type:"urn:ietf:params:oauth:grant-type:jwt-bearer",assertion:u},headers:{"Content-Type":"application/x-www-form-urlencoded"},responseType:"json"});return this.rawToken=a.data,this.expiresAt=a.data.expires_in===null||a.data.expires_in===void 0?void 0:(n+a.data.expires_in)*1e3,this.rawToken}catch(a){this.rawToken=void 0,this.tokenExpires=void 0;const p=a.response&&(!((e=a.response)===null||e===void 0)&&e.data)?(r=a.response)===null||r===void 0?void 0:r.data:{};if(p.error){const f=p.error_description?`: ${p.error_description}`:"";a.message=`${p.error}${f}`}throw a}}}ra.GoogleToken=Ed;var sn={},Ci,Zo;function Cd(){return Zo||(Zo=1,Ci=function(t){t.prototype[Symbol.iterator]=function*(){for(let e=this.head;e;e=e.next)yield e.value}}),Ci}var Sd=Se;Se.Node=Zt;Se.create=Se;function Se(t){var e=this;if(e instanceof Se||(e=new Se),e.tail=null,e.head=null,e.length=0,t&&typeof t.forEach=="function")t.forEach(function(s){e.push(s)});else if(arguments.length>0)for(var r=0,n=arguments.length;r<n;r++)e.push(arguments[r]);return e}Se.prototype.removeNode=function(t){if(t.list!==this)throw new Error("removing node which does not belong to this list");var e=t.next,r=t.prev;return e&&(e.prev=r),r&&(r.next=e),t===this.head&&(this.head=e),t===this.tail&&(this.tail=r),t.list.length--,t.next=null,t.prev=null,t.list=null,e};Se.prototype.unshiftNode=function(t){if(t!==this.head){t.list&&t.list.removeNode(t);var e=this.head;t.list=this,t.next=e,e&&(e.prev=t),this.head=t,this.tail||(this.tail=t),this.length++}};Se.prototype.pushNode=function(t){if(t!==this.tail){t.list&&t.list.removeNode(t);var e=this.tail;t.list=this,t.prev=e,e&&(e.next=t),this.tail=t,this.head||(this.head=t),this.length++}};Se.prototype.push=function(){for(var t=0,e=arguments.length;t<e;t++)Td(this,arguments[t]);return this.length};Se.prototype.unshift=function(){for(var t=0,e=arguments.length;t<e;t++)xd(this,arguments[t]);return this.length};Se.prototype.pop=function(){if(this.tail){var t=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,t}};Se.prototype.shift=function(){if(this.head){var t=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,t}};Se.prototype.forEach=function(t,e){e=e||this;for(var r=this.head,n=0;r!==null;n++)t.call(e,r.value,n,this),r=r.next};Se.prototype.forEachReverse=function(t,e){e=e||this;for(var r=this.tail,n=this.length-1;r!==null;n--)t.call(e,r.value,n,this),r=r.prev};Se.prototype.get=function(t){for(var e=0,r=this.head;r!==null&&e<t;e++)r=r.next;if(e===t&&r!==null)return r.value};Se.prototype.getReverse=function(t){for(var e=0,r=this.tail;r!==null&&e<t;e++)r=r.prev;if(e===t&&r!==null)return r.value};Se.prototype.map=function(t,e){e=e||this;for(var r=new Se,n=this.head;n!==null;)r.push(t.call(e,n.value,this)),n=n.next;return r};Se.prototype.mapReverse=function(t,e){e=e||this;for(var r=new Se,n=this.tail;n!==null;)r.push(t.call(e,n.value,this)),n=n.prev;return r};Se.prototype.reduce=function(t,e){var r,n=this.head;if(arguments.length>1)r=e;else if(this.head)n=this.head.next,r=this.head.value;else throw new TypeError("Reduce of empty list with no initial value");for(var s=0;n!==null;s++)r=t(r,n.value,s),n=n.next;return r};Se.prototype.reduceReverse=function(t,e){var r,n=this.tail;if(arguments.length>1)r=e;else if(this.tail)n=this.tail.prev,r=this.tail.value;else throw new TypeError("Reduce of empty list with no initial value");for(var s=this.length-1;n!==null;s--)r=t(r,n.value,s),n=n.prev;return r};Se.prototype.toArray=function(){for(var t=new Array(this.length),e=0,r=this.head;r!==null;e++)t[e]=r.value,r=r.next;return t};Se.prototype.toArrayReverse=function(){for(var t=new Array(this.length),e=0,r=this.tail;r!==null;e++)t[e]=r.value,r=r.prev;return t};Se.prototype.slice=function(t,e){e=e||this.length,e<0&&(e+=this.length),t=t||0,t<0&&(t+=this.length);var r=new Se;if(e<t||e<0)return r;t<0&&(t=0),e>this.length&&(e=this.length);for(var n=0,s=this.head;s!==null&&n<t;n++)s=s.next;for(;s!==null&&n<e;n++,s=s.next)r.push(s.value);return r};Se.prototype.sliceReverse=function(t,e){e=e||this.length,e<0&&(e+=this.length),t=t||0,t<0&&(t+=this.length);var r=new Se;if(e<t||e<0)return r;t<0&&(t=0),e>this.length&&(e=this.length);for(var n=this.length,s=this.tail;s!==null&&n>e;n--)s=s.prev;for(;s!==null&&n>t;n--,s=s.prev)r.push(s.value);return r};Se.prototype.splice=function(t,e,...r){t>this.length&&(t=this.length-1),t<0&&(t=this.length+t);for(var n=0,s=this.head;s!==null&&n<t;n++)s=s.next;for(var c=[],n=0;s&&n<e;n++)c.push(s.value),s=this.removeNode(s);s===null&&(s=this.tail),s!==this.head&&s!==this.tail&&(s=s.prev);for(var n=0;n<r.length;n++)s=Ad(this,s,r[n]);return c};Se.prototype.reverse=function(){for(var t=this.head,e=this.tail,r=t;r!==null;r=r.prev){var n=r.prev;r.prev=r.next,r.next=n}return this.head=e,this.tail=t,this};function Ad(t,e,r){var n=e===t.head?new Zt(r,null,e,t):new Zt(r,e,e.next,t);return n.next===null&&(t.tail=n),n.prev===null&&(t.head=n),t.length++,n}function Td(t,e){t.tail=new Zt(e,t.tail,null,t),t.head||(t.head=t.tail),t.length++}function xd(t,e){t.head=new Zt(e,null,t.head,t),t.tail||(t.tail=t.head),t.length++}function Zt(t,e,r,n){if(!(this instanceof Zt))return new Zt(t,e,r,n);this.list=n,this.value=t,e?(e.next=this,this.prev=e):this.prev=null,r?(r.prev=this,this.next=r):this.next=null}try{Cd()(Se)}catch{}const _d=Sd,Qt=Symbol("max"),Bt=Symbol("length"),hr=Symbol("lengthCalculator"),Kr=Symbol("allowStale"),Jt=Symbol("maxAge"),bt=Symbol("dispose"),ec=Symbol("noDisposeOnSet"),Xe=Symbol("lruList"),ht=Symbol("cache"),Lu=Symbol("updateAgeOnGet"),Si=()=>1;class wd{constructor(e){if(typeof e=="number"&&(e={max:e}),e||(e={}),e.max&&(typeof e.max!="number"||e.max<0))throw new TypeError("max must be a non-negative number");this[Qt]=e.max||1/0;const r=e.length||Si;if(this[hr]=typeof r!="function"?Si:r,this[Kr]=e.stale||!1,e.maxAge&&typeof e.maxAge!="number")throw new TypeError("maxAge must be a number");this[Jt]=e.maxAge||0,this[bt]=e.dispose,this[ec]=e.noDisposeOnSet||!1,this[Lu]=e.updateAgeOnGet||!1,this.reset()}set max(e){if(typeof e!="number"||e<0)throw new TypeError("max must be a non-negative number");this[Qt]=e||1/0,kr(this)}get max(){return this[Qt]}set allowStale(e){this[Kr]=!!e}get allowStale(){return this[Kr]}set maxAge(e){if(typeof e!="number")throw new TypeError("maxAge must be a non-negative number");this[Jt]=e,kr(this)}get maxAge(){return this[Jt]}set lengthCalculator(e){typeof e!="function"&&(e=Si),e!==this[hr]&&(this[hr]=e,this[Bt]=0,this[Xe].forEach(r=>{r.length=this[hr](r.value,r.key),this[Bt]+=r.length})),kr(this)}get lengthCalculator(){return this[hr]}get length(){return this[Bt]}get itemCount(){return this[Xe].length}rforEach(e,r){r=r||this;for(let n=this[Xe].tail;n!==null;){const s=n.prev;tc(this,e,n,r),n=s}}forEach(e,r){r=r||this;for(let n=this[Xe].head;n!==null;){const s=n.next;tc(this,e,n,r),n=s}}keys(){return this[Xe].toArray().map(e=>e.key)}values(){return this[Xe].toArray().map(e=>e.value)}reset(){this[bt]&&this[Xe]&&this[Xe].length&&this[Xe].forEach(e=>this[bt](e.key,e.value)),this[ht]=new Map,this[Xe]=new _d,this[Bt]=0}dump(){return this[Xe].map(e=>qn(this,e)?!1:{k:e.key,v:e.value,e:e.now+(e.maxAge||0)}).toArray().filter(e=>e)}dumpLru(){return this[Xe]}set(e,r,n){if(n=n||this[Jt],n&&typeof n!="number")throw new TypeError("maxAge must be a number");const s=n?Date.now():0,c=this[hr](r,e);if(this[ht].has(e)){if(c>this[Qt])return mr(this,this[ht].get(e)),!1;const p=this[ht].get(e).value;return this[bt]&&(this[ec]||this[bt](e,p.value)),p.now=s,p.maxAge=n,p.value=r,this[Bt]+=c-p.length,p.length=c,this.get(e),kr(this),!0}const u=new Id(e,r,c,s,n);return u.length>this[Qt]?(this[bt]&&this[bt](e,r),!1):(this[Bt]+=u.length,this[Xe].unshift(u),this[ht].set(e,this[Xe].head),kr(this),!0)}has(e){if(!this[ht].has(e))return!1;const r=this[ht].get(e).value;return!qn(this,r)}get(e){return Ai(this,e,!0)}peek(e){return Ai(this,e,!1)}pop(){const e=this[Xe].tail;return e?(mr(this,e),e.value):null}del(e){mr(this,this[ht].get(e))}load(e){this.reset();const r=Date.now();for(let n=e.length-1;n>=0;n--){const s=e[n],c=s.e||0;if(c===0)this.set(s.k,s.v);else{const u=c-r;u>0&&this.set(s.k,s.v,u)}}}prune(){this[ht].forEach((e,r)=>Ai(this,r,!1))}}const Ai=(t,e,r)=>{const n=t[ht].get(e);if(n){const s=n.value;if(qn(t,s)){if(mr(t,n),!t[Kr])return}else r&&(t[Lu]&&(n.value.now=Date.now()),t[Xe].unshiftNode(n));return s.value}},qn=(t,e)=>{if(!e||!e.maxAge&&!t[Jt])return!1;const r=Date.now()-e.now;return e.maxAge?r>e.maxAge:t[Jt]&&r>t[Jt]},kr=t=>{if(t[Bt]>t[Qt])for(let e=t[Xe].tail;t[Bt]>t[Qt]&&e!==null;){const r=e.prev;mr(t,e),e=r}},mr=(t,e)=>{if(e){const r=e.value;t[bt]&&t[bt](r.key,r.value),t[Bt]-=r.length,t[ht].delete(r.key),t[Xe].removeNode(e)}};class Id{constructor(e,r,n,s,c){this.key=e,this.value=r,this.length=n,this.now=s,this.maxAge=c||0}}const tc=(t,e,r,n)=>{let s=r.value;qn(t,s)&&(mr(t,r),t[Kr]||(s=void 0)),s&&e.call(n,s.value,s.key,t)};var bd=wd;Object.defineProperty(sn,"__esModule",{value:!0});sn.JWTAccess=void 0;const Bd=Ot,Rd=bd,rc={alg:"RS256",typ:"JWT"};class Es{constructor(e,r,n,s){this.cache=new Rd({max:500,maxAge:60*60*1e3}),this.email=e,this.key=r,this.keyId=n,this.eagerRefreshThresholdMillis=s??5*60*1e3}getCachedKey(e,r){let n=e;if(r&&Array.isArray(r)&&r.length?n=e?`${e}_${r.join("_")}`:`${r.join("_")}`:typeof r=="string"&&(n=e?`${e}_${r}`:r),!n)throw Error("Scopes or url must be provided");return n}getRequestHeaders(e,r,n){const s=this.getCachedKey(e,n),c=this.cache.get(s),u=Date.now();if(c&&c.expiration-u>this.eagerRefreshThresholdMillis)return c.headers;const a=Math.floor(Date.now()/1e3),p=Es.getExpirationTime(a);let f;if(Array.isArray(n)&&(n=n.join(" ")),n?f={iss:this.email,sub:this.email,scope:n,exp:p,iat:a}:f={iss:this.email,sub:this.email,aud:e,exp:p,iat:a},r){for(const m in f)if(r[m])throw new Error(`The '${m}' property is not allowed when passing additionalClaims. This claim is included in the JWT by default.`)}const A=this.keyId?{...rc,kid:this.keyId}:rc,C=Object.assign(f,r),o={Authorization:`Bearer ${Bd.sign({header:A,payload:C,secret:this.key})}`};return this.cache.set(s,{expiration:p*1e3,headers:o}),o}static getExpirationTime(e){return e+3600}fromJSON(e){if(!e)throw new Error("Must pass in a JSON object containing the service account auth settings.");if(!e.client_email)throw new Error("The incoming JSON object does not contain a client_email field");if(!e.private_key)throw new Error("The incoming JSON object does not contain a private_key field");this.email=e.client_email,this.key=e.private_key,this.keyId=e.private_key_id,this.projectId=e.project_id}fromStream(e,r){if(r)this.fromStreamAsync(e).then(()=>r(),r);else return this.fromStreamAsync(e)}fromStreamAsync(e){return new Promise((r,n)=>{e||n(new Error("Must pass in a stream containing the service account auth settings."));let s="";e.setEncoding("utf8").on("data",c=>s+=c).on("error",n).on("end",()=>{try{const c=JSON.parse(s);this.fromJSON(c),r()}catch(c){n(c)}})})}}sn.JWTAccess=Es;Object.defineProperty(tn,"__esModule",{value:!0});tn.JWT=void 0;const nc=ra,Nd=sn,Pd=ir;class Cs extends Pd.OAuth2Client{constructor(e,r,n,s,c,u){const a=e&&typeof e=="object"?e:{email:e,keyFile:r,key:n,keyId:u,scopes:s,subject:c};super({eagerRefreshThresholdMillis:a.eagerRefreshThresholdMillis,forceRefreshOnFailure:a.forceRefreshOnFailure}),this.email=a.email,this.keyFile=a.keyFile,this.key=a.key,this.keyId=a.keyId,this.scopes=a.scopes,this.subject=a.subject,this.additionalClaims=a.additionalClaims,this.credentials={refresh_token:"jwt-placeholder",expiry_date:1}}createScoped(e){return new Cs({email:this.email,keyFile:this.keyFile,key:this.key,keyId:this.keyId,scopes:e,subject:this.subject,additionalClaims:this.additionalClaims})}async getRequestMetadataAsync(e){e=this.defaultServicePath?`https://${this.defaultServicePath}/`:e;const r=!this.hasUserScopes()&&e||this.useJWTAccessWithScope&&this.hasAnyScopes();if(!this.apiKey&&r)if(this.additionalClaims&&this.additionalClaims.target_audience){const{tokens:n}=await this.refreshToken();return{headers:this.addSharedMetadataHeaders({Authorization:`Bearer ${n.id_token}`})}}else{this.access||(this.access=new Nd.JWTAccess(this.email,this.key,this.keyId,this.eagerRefreshThresholdMillis));let n;this.hasUserScopes()?n=this.scopes:e||(n=this.defaultScopes);const s=await this.access.getRequestHeaders(e??void 0,this.additionalClaims,this.useJWTAccessWithScope?n:void 0);return{headers:this.addSharedMetadataHeaders(s)}}else return this.hasAnyScopes()||this.apiKey?super.getRequestMetadataAsync(e):{headers:{}}}async fetchIdToken(e){const r=new nc.GoogleToken({iss:this.email,sub:this.subject,scope:this.scopes||this.defaultScopes,keyFile:this.keyFile,key:this.key,additionalClaims:{target_audience:e},transporter:this.transporter});if(await r.getToken({forceRefresh:!0}),!r.idToken)throw new Error("Unknown error: Failed to fetch ID token");return r.idToken}hasUserScopes(){return this.scopes?this.scopes.length>0:!1}hasAnyScopes(){return!!(this.scopes&&this.scopes.length>0||this.defaultScopes&&this.defaultScopes.length>0)}authorize(e){if(e)this.authorizeAsync().then(r=>e(null,r),e);else return this.authorizeAsync()}async authorizeAsync(){const e=await this.refreshToken();if(!e)throw new Error("No result returned");return this.credentials=e.tokens,this.credentials.refresh_token="jwt-placeholder",this.key=this.gtoken.key,this.email=this.gtoken.iss,e.tokens}async refreshTokenNoCache(e){const r=this.createGToken(),s={access_token:(await r.getToken({forceRefresh:this.isTokenExpiring()})).access_token,token_type:"Bearer",expiry_date:r.expiresAt,id_token:r.idToken};return this.emit("tokens",s),{res:null,tokens:s}}createGToken(){return this.gtoken||(this.gtoken=new nc.GoogleToken({iss:this.email,sub:this.subject,scope:this.scopes||this.defaultScopes,keyFile:this.keyFile,key:this.key,additionalClaims:this.additionalClaims,transporter:this.transporter})),this.gtoken}fromJSON(e){if(!e)throw new Error("Must pass in a JSON object containing the service account auth settings.");if(!e.client_email)throw new Error("The incoming JSON object does not contain a client_email field");if(!e.private_key)throw new Error("The incoming JSON object does not contain a private_key field");this.email=e.client_email,this.key=e.private_key,this.keyId=e.private_key_id,this.projectId=e.project_id,this.quotaProjectId=e.quota_project_id}fromStream(e,r){if(r)this.fromStreamAsync(e).then(()=>r(),r);else return this.fromStreamAsync(e)}fromStreamAsync(e){return new Promise((r,n)=>{if(!e)throw new Error("Must pass in a stream containing the service account auth settings.");let s="";e.setEncoding("utf8").on("error",n).on("data",c=>s+=c).on("end",()=>{try{const c=JSON.parse(s);this.fromJSON(c),r()}catch(c){n(c)}})})}fromAPIKey(e){if(typeof e!="string")throw new Error("Must provide an API Key string.");this.apiKey=e}async getCredentials(){if(this.key)return{private_key:this.key,client_email:this.email};if(this.keyFile){const r=await this.createGToken().getCredentials(this.keyFile);return{private_key:r.privateKey,client_email:r.clientEmail}}throw new Error("A key or a keyFile must be provided to getCredentials.")}}tn.JWT=Cs;var er={};Object.defineProperty(er,"__esModule",{value:!0});er.UserRefreshClient=er.USER_REFRESH_ACCOUNT_TYPE=void 0;const Od=ir;er.USER_REFRESH_ACCOUNT_TYPE="authorized_user";class Ud extends Od.OAuth2Client{constructor(e,r,n,s,c){const u=e&&typeof e=="object"?e:{clientId:e,clientSecret:r,refreshToken:n,eagerRefreshThresholdMillis:s,forceRefreshOnFailure:c};super({clientId:u.clientId,clientSecret:u.clientSecret,eagerRefreshThresholdMillis:u.eagerRefreshThresholdMillis,forceRefreshOnFailure:u.forceRefreshOnFailure}),this._refreshToken=u.refreshToken,this.credentials.refresh_token=u.refreshToken}async refreshTokenNoCache(e){return super.refreshTokenNoCache(this._refreshToken)}fromJSON(e){if(!e)throw new Error("Must pass in a JSON object containing the user refresh token");if(e.type!=="authorized_user")throw new Error('The incoming JSON object does not have the "authorized_user" type');if(!e.client_id)throw new Error("The incoming JSON object does not contain a client_id field");if(!e.client_secret)throw new Error("The incoming JSON object does not contain a client_secret field");if(!e.refresh_token)throw new Error("The incoming JSON object does not contain a refresh_token field");this._clientId=e.client_id,this._clientSecret=e.client_secret,this._refreshToken=e.refresh_token,this.credentials.refresh_token=e.refresh_token,this.quotaProjectId=e.quota_project_id}fromStream(e,r){if(r)this.fromStreamAsync(e).then(()=>r(),r);else return this.fromStreamAsync(e)}async fromStreamAsync(e){return new Promise((r,n)=>{if(!e)return n(new Error("Must pass in a stream containing the user refresh token."));let s="";e.setEncoding("utf8").on("error",n).on("data",c=>s+=c).on("end",()=>{try{const c=JSON.parse(s);return this.fromJSON(c),r()}catch(c){return n(c)}})})}}er.UserRefreshClient=Ud;var tr={};Object.defineProperty(tr,"__esModule",{value:!0});tr.Impersonated=tr.IMPERSONATED_ACCOUNT_TYPE=void 0;const ac=ir,kd=At;tr.IMPERSONATED_ACCOUNT_TYPE="impersonated_service_account";class Dd extends ac.OAuth2Client{constructor(e={}){var r,n,s,c,u,a;super(e),this.credentials={expiry_date:1,refresh_token:"impersonated-placeholder"},this.sourceClient=(r=e.sourceClient)!==null&&r!==void 0?r:new ac.OAuth2Client,this.targetPrincipal=(n=e.targetPrincipal)!==null&&n!==void 0?n:"",this.delegates=(s=e.delegates)!==null&&s!==void 0?s:[],this.targetScopes=(c=e.targetScopes)!==null&&c!==void 0?c:[],this.lifetime=(u=e.lifetime)!==null&&u!==void 0?u:3600,this.endpoint=(a=e.endpoint)!==null&&a!==void 0?a:"https://iamcredentials.googleapis.com"}async refreshToken(e){var r,n,s,c,u,a;try{await this.sourceClient.getAccessToken();const p="projects/-/serviceAccounts/"+this.targetPrincipal,f=`${this.endpoint}/v1/${p}:generateAccessToken`,A={delegates:this.delegates,scope:this.targetScopes,lifetime:this.lifetime+"s"},C=await this.sourceClient.request({url:f,data:A,method:"POST"}),y=C.data;return this.credentials.access_token=y.accessToken,this.credentials.expiry_date=Date.parse(y.expireTime),{tokens:this.credentials,res:C}}catch(p){if(!(p instanceof Error))throw p;let f=0,A="";throw p instanceof kd.GaxiosError&&(f=(s=(n=(r=p==null?void 0:p.response)===null||r===void 0?void 0:r.data)===null||n===void 0?void 0:n.error)===null||s===void 0?void 0:s.status,A=(a=(u=(c=p==null?void 0:p.response)===null||c===void 0?void 0:c.data)===null||u===void 0?void 0:u.error)===null||a===void 0?void 0:a.message),f&&A?(p.message=`${f}: unable to impersonate: ${A}`,p):(p.message=`unable to impersonate: ${p}`,p)}}async fetchIdToken(e,r){var n;await this.sourceClient.getAccessToken();const s=`projects/-/serviceAccounts/${this.targetPrincipal}`,c=`${this.endpoint}/v1/${s}:generateIdToken`,u={delegates:this.delegates,audience:e,includeEmail:(n=r==null?void 0:r.includeEmail)!==null&&n!==void 0?n:!0};return(await this.sourceClient.request({url:c,data:u,method:"POST"})).data.token}}tr.Impersonated=Dd;var on={},$t={},cn={},rr={};Object.defineProperty(rr,"__esModule",{value:!0});rr.getErrorFromOAuthErrorResponse=rr.OAuthClientAuthHandler=void 0;const ic=jn,Ld=Yr(),Fd=["PUT","POST","PATCH"];class Md{constructor(e){this.clientAuthentication=e,this.crypto=(0,Ld.createCrypto)()}applyClientAuthenticationOptions(e,r){this.injectAuthenticatedHeaders(e,r),r||this.injectAuthenticatedRequestBody(e)}injectAuthenticatedHeaders(e,r){var n;if(r)e.headers=e.headers||{},Object.assign(e.headers,{Authorization:`Bearer ${r}}`});else if(((n=this.clientAuthentication)===null||n===void 0?void 0:n.confidentialClientType)==="basic"){e.headers=e.headers||{};const s=this.clientAuthentication.clientId,c=this.clientAuthentication.clientSecret||"",u=this.crypto.encodeBase64StringUtf8(`${s}:${c}`);Object.assign(e.headers,{Authorization:`Basic ${u}`})}}injectAuthenticatedRequestBody(e){var r;if(((r=this.clientAuthentication)===null||r===void 0?void 0:r.confidentialClientType)==="request-body"){const n=(e.method||"GET").toUpperCase();if(Fd.indexOf(n)!==-1){let s;const c=e.headers||{};for(const u in c)if(u.toLowerCase()==="content-type"&&c[u]){s=c[u].toLowerCase();break}if(s==="application/x-www-form-urlencoded"){e.data=e.data||"";const u=ic.parse(e.data);Object.assign(u,{client_id:this.clientAuthentication.clientId,client_secret:this.clientAuthentication.clientSecret||""}),e.data=ic.stringify(u)}else if(s==="application/json")e.data=e.data||{},Object.assign(e.data,{client_id:this.clientAuthentication.clientId,client_secret:this.clientAuthentication.clientSecret||""});else throw new Error(`${s} content-types are not supported with ${this.clientAuthentication.confidentialClientType} client authentication`)}else throw new Error(`${n} HTTP method does not support ${this.clientAuthentication.confidentialClientType} client authentication`)}}}rr.OAuthClientAuthHandler=Md;function qd(t,e){const r=t.error,n=t.error_description,s=t.error_uri;let c=`Error code ${r}`;typeof n<"u"&&(c+=`: ${n}`),typeof s<"u"&&(c+=` - ${s}`);const u=new Error(c);if(e){const a=Object.keys(e);e.stack&&a.push("stack"),a.forEach(p=>{p!=="message"&&Object.defineProperty(u,p,{value:e[p],writable:!1,enumerable:!0})})}return u}rr.getErrorFromOAuthErrorResponse=qd;Object.defineProperty(cn,"__esModule",{value:!0});cn.StsCredentials=void 0;const Vd=At,Kd=jn,$d=ar,sc=rr;class Gd extends sc.OAuthClientAuthHandler{constructor(e,r){super(r),this.tokenExchangeEndpoint=e,this.transporter=new $d.DefaultTransporter}async exchangeToken(e,r,n){var s,c,u;const a={grant_type:e.grantType,resource:e.resource,audience:e.audience,scope:(s=e.scope)===null||s===void 0?void 0:s.join(" "),requested_token_type:e.requestedTokenType,subject_token:e.subjectToken,subject_token_type:e.subjectTokenType,actor_token:(c=e.actingParty)===null||c===void 0?void 0:c.actorToken,actor_token_type:(u=e.actingParty)===null||u===void 0?void 0:u.actorTokenType,options:n&&JSON.stringify(n)};Object.keys(a).forEach(A=>{typeof a[A]>"u"&&delete a[A]});const p={"Content-Type":"application/x-www-form-urlencoded"};Object.assign(p,r||{});const f={url:this.tokenExchangeEndpoint,method:"POST",headers:p,data:Kd.stringify(a),responseType:"json"};this.applyClientAuthenticationOptions(f);try{const A=await this.transporter.request(f),C=A.data;return C.res=A,C}catch(A){throw A instanceof Vd.GaxiosError&&A.response?(0,sc.getErrorFromOAuthErrorResponse)(A.response.data,A):A}}}cn.StsCredentials=Gd;(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.BaseExternalAccountClient=t.CLOUD_RESOURCE_MANAGER=t.EXTERNAL_ACCOUNT_TYPE=t.EXPIRATION_TIME_OFFSET=void 0;const e=Nt,r=Kt,n=cn,s="urn:ietf:params:oauth:grant-type:token-exchange",c="urn:ietf:params:oauth:token-type:access_token",u="https://www.googleapis.com/auth/cloud-platform",a=3600;t.EXPIRATION_TIME_OFFSET=5*60*1e3,t.EXTERNAL_ACCOUNT_TYPE="external_account",t.CLOUD_RESOURCE_MANAGER="https://cloudresourcemanager.googleapis.com/v1/projects/";const p="//iam.googleapis.com/locations/[^/]+/workforcePools/[^/]+/providers/.+";class f extends r.AuthClient{constructor(C,y){var o,m;if(super(),C.type!==t.EXTERNAL_ACCOUNT_TYPE)throw new Error(`Expected "${t.EXTERNAL_ACCOUNT_TYPE}" type but received "${C.type}"`);this.clientAuth=C.client_id?{confidentialClientType:"basic",clientId:C.client_id,clientSecret:C.client_secret}:void 0,this.stsCredential=new n.StsCredentials(C.token_url,this.clientAuth),this.scopes=[u],this.cachedAccessToken=null,this.audience=C.audience,this.subjectTokenType=C.subject_token_type,this.quotaProjectId=C.quota_project_id,this.workforcePoolUserProject=C.workforce_pool_user_project;const g=new RegExp(p);if(this.workforcePoolUserProject&&!this.audience.match(g))throw new Error("workforcePoolUserProject should not be set for non-workforce pool credentials.");this.serviceAccountImpersonationUrl=C.service_account_impersonation_url,this.serviceAccountImpersonationLifetime=(m=(o=C.service_account_impersonation)===null||o===void 0?void 0:o.token_lifetime_seconds)!==null&&m!==void 0?m:a,typeof(y==null?void 0:y.eagerRefreshThresholdMillis)!="number"?this.eagerRefreshThresholdMillis=t.EXPIRATION_TIME_OFFSET:this.eagerRefreshThresholdMillis=y.eagerRefreshThresholdMillis,this.forceRefreshOnFailure=!!(y!=null&&y.forceRefreshOnFailure),this.projectId=null,this.projectNumber=this.getProjectNumber(this.audience)}getServiceAccountEmail(){var C;if(this.serviceAccountImpersonationUrl){const o=/serviceAccounts\/(?<email>[^:]+):generateAccessToken$/.exec(this.serviceAccountImpersonationUrl);return((C=o==null?void 0:o.groups)===null||C===void 0?void 0:C.email)||null}return null}setCredentials(C){super.setCredentials(C),this.cachedAccessToken=C}async getAccessToken(){return(!this.cachedAccessToken||this.isExpired(this.cachedAccessToken))&&await this.refreshAccessTokenAsync(),{token:this.cachedAccessToken.access_token,res:this.cachedAccessToken.res}}async getRequestHeaders(){const y={Authorization:`Bearer ${(await this.getAccessToken()).token}`};return this.addSharedMetadataHeaders(y)}request(C,y){if(y)this.requestAsync(C).then(o=>y(null,o),o=>y(o,o.response));else return this.requestAsync(C)}async getProjectId(){const C=this.projectNumber||this.workforcePoolUserProject;if(this.projectId)return this.projectId;if(C){const y=await this.getRequestHeaders(),o=await this.transporter.request({headers:y,url:`${t.CLOUD_RESOURCE_MANAGER}${C}`,responseType:"json"});return this.projectId=o.data.projectId,this.projectId}return null}async requestAsync(C,y=!1){let o;try{const m=await this.getRequestHeaders();C.headers=C.headers||{},m&&m["x-goog-user-project"]&&(C.headers["x-goog-user-project"]=m["x-goog-user-project"]),m&&m.Authorization&&(C.headers.Authorization=m.Authorization),o=await this.transporter.request(C)}catch(m){const g=m.response;if(g){const S=g.status,i=g.config.data instanceof e.Readable;if(!y&&(S===401||S===403)&&!i&&this.forceRefreshOnFailure)return await this.refreshAccessTokenAsync(),await this.requestAsync(C,!0)}throw m}return o}async refreshAccessTokenAsync(){const C=await this.retrieveSubjectToken(),y={grantType:s,audience:this.audience,requestedTokenType:c,subjectToken:C,subjectTokenType:this.subjectTokenType,scope:this.serviceAccountImpersonationUrl?[u]:this.getScopesArray()},o=!this.clientAuth&&this.workforcePoolUserProject?{userProject:this.workforcePoolUserProject}:void 0,m=await this.stsCredential.exchangeToken(y,void 0,o);return this.serviceAccountImpersonationUrl?this.cachedAccessToken=await this.getImpersonatedAccessToken(m.access_token):m.expires_in?this.cachedAccessToken={access_token:m.access_token,expiry_date:new Date().getTime()+m.expires_in*1e3,res:m.res}:this.cachedAccessToken={access_token:m.access_token,res:m.res},this.credentials={},Object.assign(this.credentials,this.cachedAccessToken),delete this.credentials.res,this.emit("tokens",{refresh_token:null,expiry_date:this.cachedAccessToken.expiry_date,access_token:this.cachedAccessToken.access_token,token_type:"Bearer",id_token:null}),this.cachedAccessToken}getProjectNumber(C){const y=C.match(/\/projects\/([^/]+)/);return y?y[1]:null}async getImpersonatedAccessToken(C){const y={url:this.serviceAccountImpersonationUrl,method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${C}`},data:{scope:this.getScopesArray(),lifetime:this.serviceAccountImpersonationLifetime+"s"},responseType:"json"},o=await this.transporter.request(y),m=o.data;return{access_token:m.accessToken,expiry_date:new Date(m.expireTime).getTime(),res:o}}isExpired(C){const y=new Date().getTime();return C.expiry_date?y>=C.expiry_date-this.eagerRefreshThresholdMillis:!1}getScopesArray(){return typeof this.scopes=="string"?[this.scopes]:typeof this.scopes>"u"?[u]:this.scopes}}t.BaseExternalAccountClient=f})($t);var un={},Ti,xi,_i;Object.defineProperty(un,"__esModule",{value:!0});un.IdentityPoolClient=void 0;const Ss=nr,As=Pt,jd=$t,Hd=(0,As.promisify)((Ti=Ss.readFile)!==null&&Ti!==void 0?Ti:()=>{}),zd=(0,As.promisify)((xi=Ss.realpath)!==null&&xi!==void 0?xi:()=>{}),Wd=(0,As.promisify)((_i=Ss.lstat)!==null&&_i!==void 0?_i:()=>{});class Qd extends jd.BaseExternalAccountClient{constructor(e,r){var n,s;if(super(e,r),this.file=e.credential_source.file,this.url=e.credential_source.url,this.headers=e.credential_source.headers,!this.file&&!this.url)throw new Error('No valid Identity Pool "credential_source" provided');if(this.formatType=((n=e.credential_source.format)===null||n===void 0?void 0:n.type)||"text",this.formatSubjectTokenFieldName=(s=e.credential_source.format)===null||s===void 0?void 0:s.subject_token_field_name,this.formatType!=="json"&&this.formatType!=="text")throw new Error(`Invalid credential_source format "${this.formatType}"`);if(this.formatType==="json"&&!this.formatSubjectTokenFieldName)throw new Error("Missing subject_token_field_name for JSON credential_source format")}async retrieveSubjectToken(){return this.file?await this.getTokenFromFile(this.file,this.formatType,this.formatSubjectTokenFieldName):await this.getTokenFromUrl(this.url,this.formatType,this.formatSubjectTokenFieldName,this.headers)}async getTokenFromFile(e,r,n){try{if(e=await zd(e),!(await Wd(e)).isFile())throw new Error}catch(u){throw u instanceof Error&&(u.message=`The file at ${e} does not exist, or it is not a file. ${u.message}`),u}let s;const c=await Hd(e,{encoding:"utf8"});if(r==="text"?s=c:r==="json"&&n&&(s=JSON.parse(c)[n]),!s)throw new Error("Unable to parse the subject_token from the credential_source file");return s}async getTokenFromUrl(e,r,n,s){const c={url:e,method:"GET",headers:s,responseType:r};let u;if(r==="text"?u=(await this.transporter.request(c)).data:r==="json"&&n&&(u=(await this.transporter.request(c)).data[n]),!u)throw new Error("Unable to parse the subject_token from the credential_source URL");return u}}un.IdentityPoolClient=Qd;var ln={},ua={};Object.defineProperty(ua,"__esModule",{value:!0});ua.AwsRequestSigner=void 0;const Fu=Yr(),oc="AWS4-HMAC-SHA256",Yd="aws4_request";class Jd{constructor(e,r){this.getCredentials=e,this.region=r,this.crypto=(0,Fu.createCrypto)()}async getRequestOptions(e){if(!e.url)throw new Error('"url" is required in "amzOptions"');const r=typeof e.data=="object"?JSON.stringify(e.data):e.data,n=e.url,s=e.method||"GET",c=e.body||r,u=e.headers,a=await this.getCredentials(),p=new URL(n),f=await Zd({crypto:this.crypto,host:p.host,canonicalUri:p.pathname,canonicalQuerystring:p.search.substr(1),method:s,region:this.region,securityCredentials:a,requestPayload:c,additionalAmzHeaders:u}),A=Object.assign(f.amzDate?{"x-amz-date":f.amzDate}:{},{Authorization:f.authorizationHeader,host:p.host},u||{});a.token&&Object.assign(A,{"x-amz-security-token":a.token});const C={url:n,method:s,headers:A};return typeof c<"u"&&(C.body=c),C}}ua.AwsRequestSigner=Jd;async function Vr(t,e,r){return await t.signWithHmacSha256(e,r)}async function Xd(t,e,r,n,s){const c=await Vr(t,`AWS4${e}`,r),u=await Vr(t,c,n),a=await Vr(t,u,s);return await Vr(t,a,"aws4_request")}async function Zd(t){const e=t.additionalAmzHeaders||{},r=t.requestPayload||"",n=t.host.split(".")[0],s=new Date,c=s.toISOString().replace(/[-:]/g,"").replace(/\.[0-9]+/,""),u=s.toISOString().replace(/[-]/g,"").replace(/T.*/,""),a={};Object.keys(e).forEach(E=>{a[E.toLowerCase()]=e[E]}),t.securityCredentials.token&&(a["x-amz-security-token"]=t.securityCredentials.token);const p=Object.assign({host:t.host},a.date?{}:{"x-amz-date":c},a);let f="";const A=Object.keys(p).sort();A.forEach(E=>{f+=`${E}:${p[E]}
`});const C=A.join(";"),y=await t.crypto.sha256DigestHex(r),o=`${t.method}
${t.canonicalUri}
${t.canonicalQuerystring}
${f}
${C}
${y}`,m=`${u}/${t.region}/${n}/${Yd}`,g=`${oc}
${c}
${m}
`+await t.crypto.sha256DigestHex(o),S=await Xd(t.crypto,t.securityCredentials.secretAccessKey,u,t.region,n),i=await Vr(t.crypto,S,g),v=`${oc} Credential=${t.securityCredentials.accessKeyId}/${m}, SignedHeaders=${C}, Signature=${(0,Fu.fromArrayBufferToHex)(i)}`;return{amzDate:a.date?void 0:c,authorizationHeader:v,canonicalQuerystring:t.canonicalQuerystring}}Object.defineProperty(ln,"__esModule",{value:!0});ln.AwsClient=void 0;const eh=ua,th=$t;class Ts extends th.BaseExternalAccountClient{constructor(e,r){super(e,r),this.environmentId=e.credential_source.environment_id,this.regionUrl=e.credential_source.region_url,this.securityCredentialsUrl=e.credential_source.url,this.regionalCredVerificationUrl=e.credential_source.regional_cred_verification_url,this.imdsV2SessionTokenUrl=e.credential_source.imdsv2_session_token_url,this.awsRequestSigner=null,this.region="",this.validateEnvironmentId()}validateEnvironmentId(){var e;const r=(e=this.environmentId)===null||e===void 0?void 0:e.match(/^(aws)(\d+)$/);if(!r||!this.regionalCredVerificationUrl)throw new Error('No valid AWS "credential_source" provided');if(parseInt(r[2],10)!==1)throw new Error(`aws version "${r[2]}" is not supported in the current build.`)}async retrieveSubjectToken(){if(!this.awsRequestSigner){const s={};this.shouldUseMetadataServer()&&this.imdsV2SessionTokenUrl&&(s["x-aws-ec2-metadata-token"]=await this.getImdsV2SessionToken()),this.region=await this.getAwsRegion(s),this.awsRequestSigner=new eh.AwsRequestSigner(async()=>{if(this.securityCredentialsFromEnv)return this.securityCredentialsFromEnv;const c=await this.getAwsRoleName(s),u=await this.getAwsSecurityCredentials(c,s);return{accessKeyId:u.AccessKeyId,secretAccessKey:u.SecretAccessKey,token:u.Token}},this.region)}const e=await this.awsRequestSigner.getRequestOptions({url:this.regionalCredVerificationUrl.replace("{region}",this.region),method:"POST"}),r=[],n=Object.assign({"x-goog-cloud-target-resource":this.audience},e.headers);for(const s in n)r.push({key:s,value:n[s]});return encodeURIComponent(JSON.stringify({url:e.url,method:e.method,headers:r}))}async getImdsV2SessionToken(){const e={url:this.imdsV2SessionTokenUrl,method:"PUT",responseType:"text",headers:{"x-aws-ec2-metadata-token-ttl-seconds":"300"}};return(await this.transporter.request(e)).data}async getAwsRegion(e){if(this.regionFromEnv)return this.regionFromEnv;if(!this.regionUrl)throw new Error('Unable to determine AWS region due to missing "options.credential_source.region_url"');const r={url:this.regionUrl,method:"GET",responseType:"text",headers:e},n=await this.transporter.request(r);return n.data.substr(0,n.data.length-1)}async getAwsRoleName(e){if(!this.securityCredentialsUrl)throw new Error('Unable to determine AWS role name due to missing "options.credential_source.url"');const r={url:this.securityCredentialsUrl,method:"GET",responseType:"text",headers:e};return(await this.transporter.request(r)).data}async getAwsSecurityCredentials(e,r){return(await this.transporter.request({url:`${this.securityCredentialsUrl}/${e}`,responseType:"json",headers:r})).data}shouldUseMetadataServer(){return!this.regionFromEnv||!this.securityCredentialsFromEnv}get regionFromEnv(){return process.env.AWS_REGION||process.env.AWS_DEFAULT_REGION||null}get securityCredentialsFromEnv(){return process.env.AWS_ACCESS_KEY_ID&&process.env.AWS_SECRET_ACCESS_KEY?{accessKeyId:process.env.AWS_ACCESS_KEY_ID,secretAccessKey:process.env.AWS_SECRET_ACCESS_KEY,token:process.env.AWS_SESSION_TOKEN}:null}}ln.AwsClient=Ts;Ts.AWS_EC2_METADATA_IPV4_ADDRESS="169.254.169.254";Ts.AWS_EC2_METADATA_IPV6_ADDRESS="fd00:ec2::254";var Wt={},Ue={};Object.defineProperty(Ue,"__esModule",{value:!0});Ue.InvalidSubjectTokenError=Ue.InvalidMessageFieldError=Ue.InvalidCodeFieldError=Ue.InvalidTokenTypeFieldError=Ue.InvalidExpirationTimeFieldError=Ue.InvalidSuccessFieldError=Ue.InvalidVersionFieldError=Ue.ExecutableResponseError=Ue.ExecutableResponse=void 0;const _n="urn:ietf:params:oauth:token-type:saml2",wi="urn:ietf:params:oauth:token-type:id_token",Ii="urn:ietf:params:oauth:token-type:jwt";class rh{constructor(e){if(!e.version)throw new Mu("Executable response must contain a 'version' field.");if(e.success===void 0)throw new qu("Executable response must contain a 'success' field.");if(this.version=e.version,this.success=e.success,this.success){if(this.expirationTime=e.expiration_time,this.tokenType=e.token_type,this.tokenType!==_n&&this.tokenType!==wi&&this.tokenType!==Ii)throw new Vu(`Executable response must contain a 'token_type' field when successful and it must be one of ${wi}, ${Ii}, or ${_n}.`);if(this.tokenType===_n){if(!e.saml_response)throw new Xi(`Executable response must contain a 'saml_response' field when token_type=${_n}.`);this.subjectToken=e.saml_response}else{if(!e.id_token)throw new Xi(`Executable response must contain a 'id_token' field when token_type=${wi} or ${Ii}.`);this.subjectToken=e.id_token}}else{if(!e.code)throw new Ku("Executable response must contain a 'code' field when unsuccessful.");if(!e.message)throw new $u("Executable response must contain a 'message' field when unsuccessful.");this.errorCode=e.code,this.errorMessage=e.message}}isValid(){return!this.isExpired()&&this.success}isExpired(){return this.expirationTime!==void 0&&this.expirationTime<Math.round(Date.now()/1e3)}}Ue.ExecutableResponse=rh;class Gt extends Error{constructor(e){super(e),Object.setPrototypeOf(this,new.target.prototype)}}Ue.ExecutableResponseError=Gt;class Mu extends Gt{}Ue.InvalidVersionFieldError=Mu;class qu extends Gt{}Ue.InvalidSuccessFieldError=qu;class nh extends Gt{}Ue.InvalidExpirationTimeFieldError=nh;class Vu extends Gt{}Ue.InvalidTokenTypeFieldError=Vu;class Ku extends Gt{}Ue.InvalidCodeFieldError=Ku;class $u extends Gt{}Ue.InvalidMessageFieldError=$u;class Xi extends Gt{}Ue.InvalidSubjectTokenError=Xi;var Dr={},cc;function ah(){if(cc)return Dr;cc=1,Object.defineProperty(Dr,"__esModule",{value:!0}),Dr.PluggableAuthHandler=void 0;const t=xs(),e=Ue,r=Lc,n=nr;class s{constructor(u){if(!u.command)throw new Error("No command provided.");if(this.commandComponents=s.parseCommand(u.command),this.timeoutMillis=u.timeoutMillis,!this.timeoutMillis)throw new Error("No timeoutMillis provided.");this.outputFile=u.outputFile}retrieveResponseFromExecutable(u){return new Promise((a,p)=>{const f=r.spawn(this.commandComponents[0],this.commandComponents.slice(1),{env:{...process.env,...Object.fromEntries(u)}});let A="";f.stdout.on("data",y=>{A+=y}),f.stderr.on("data",y=>{A+=y});const C=setTimeout(()=>(f.removeAllListeners(),f.kill(),p(new Error("The executable failed to finish within the timeout specified."))),this.timeoutMillis);f.on("close",y=>{if(clearTimeout(C),y===0)try{const o=JSON.parse(A),m=new e.ExecutableResponse(o);return a(m)}catch(o){return o instanceof e.ExecutableResponseError?p(o):p(new e.ExecutableResponseError(`The executable returned an invalid response: ${A}`))}else return p(new t.ExecutableError(A,y.toString()))})})}async retrieveCachedResponse(){if(!this.outputFile||this.outputFile.length===0)return;let u;try{u=await n.promises.realpath(this.outputFile)}catch{return}if(!(await n.promises.lstat(u)).isFile())return;const a=await n.promises.readFile(u,{encoding:"utf8"});if(a!=="")try{const p=JSON.parse(a);return new e.ExecutableResponse(p).isValid()?new e.ExecutableResponse(p):void 0}catch(p){throw p instanceof e.ExecutableResponseError?p:new e.ExecutableResponseError(`The output file contained an invalid response: ${a}`)}}static parseCommand(u){const a=u.match(/(?:[^\s"]+|"[^"]*")+/g);if(!a)throw new Error(`Provided command: "${u}" could not be parsed.`);for(let p=0;p<a.length;p++)a[p][0]==='"'&&a[p].slice(-1)==='"'&&(a[p]=a[p].slice(1,-1));return a}}return Dr.PluggableAuthHandler=s,Dr}var uc;function xs(){if(uc)return Wt;uc=1,Object.defineProperty(Wt,"__esModule",{value:!0}),Wt.PluggableAuthClient=Wt.ExecutableError=void 0;const t=$t,e=Ue,r=ah();class n extends Error{constructor(C,y){super(`The executable failed with exit code: ${y} and error message: ${C}.`),this.code=y,Object.setPrototypeOf(this,new.target.prototype)}}Wt.ExecutableError=n;const s=30*1e3,c=5*1e3,u=120*1e3,a="GOOGLE_EXTERNAL_ACCOUNT_ALLOW_EXECUTABLES",p=1;class f extends t.BaseExternalAccountClient{constructor(C,y){if(super(C,y),!C.credential_source.executable)throw new Error('No valid Pluggable Auth "credential_source" provided.');if(this.command=C.credential_source.executable.command,!this.command)throw new Error('No valid Pluggable Auth "credential_source" provided.');if(C.credential_source.executable.timeout_millis===void 0)this.timeoutMillis=s;else if(this.timeoutMillis=C.credential_source.executable.timeout_millis,this.timeoutMillis<c||this.timeoutMillis>u)throw new Error(`Timeout must be between ${c} and ${u} milliseconds.`);this.outputFile=C.credential_source.executable.output_file,this.handler=new r.PluggableAuthHandler({command:this.command,timeoutMillis:this.timeoutMillis,outputFile:this.outputFile})}async retrieveSubjectToken(){if(process.env[a]!=="1")throw new Error("Pluggable Auth executables need to be explicitly allowed to run by setting the GOOGLE_EXTERNAL_ACCOUNT_ALLOW_EXECUTABLES environment Variable to 1.");let C;if(this.outputFile&&(C=await this.handler.retrieveCachedResponse()),!C){const y=new Map;y.set("GOOGLE_EXTERNAL_ACCOUNT_AUDIENCE",this.audience),y.set("GOOGLE_EXTERNAL_ACCOUNT_TOKEN_TYPE",this.subjectTokenType),y.set("GOOGLE_EXTERNAL_ACCOUNT_INTERACTIVE","0"),this.outputFile&&y.set("GOOGLE_EXTERNAL_ACCOUNT_OUTPUT_FILE",this.outputFile);const o=this.getServiceAccountEmail();o&&y.set("GOOGLE_EXTERNAL_ACCOUNT_IMPERSONATED_EMAIL",o),C=await this.handler.retrieveResponseFromExecutable(y)}if(C.version>p)throw new Error(`Version of executable is not currently supported, maximum supported version is ${p}.`);if(!C.success)throw new n(C.errorMessage,C.errorCode);if(this.outputFile&&!C.expirationTime)throw new e.InvalidExpirationTimeFieldError("The executable response must contain the `expiration_time` field for successful responses when an output_file has been specified in the configuration.");if(C.isExpired())throw new Error("Executable response is expired.");return C.subjectToken}}return Wt.PluggableAuthClient=f,Wt}Object.defineProperty(on,"__esModule",{value:!0});on.ExternalAccountClient=void 0;const ih=$t,sh=un,oh=ln,ch=xs();class uh{constructor(){throw new Error("ExternalAccountClients should be initialized via: ExternalAccountClient.fromJSON(), directly via explicit constructors, eg. new AwsClient(options), new IdentityPoolClient(options), newPluggableAuthClientOptions, or via new GoogleAuth(options).getClient()")}static fromJSON(e,r){var n,s;return e&&e.type===ih.EXTERNAL_ACCOUNT_TYPE?!((n=e.credential_source)===null||n===void 0)&&n.environment_id?new oh.AwsClient(e,r):!((s=e.credential_source)===null||s===void 0)&&s.executable?new ch.PluggableAuthClient(e,r):new sh.IdentityPoolClient(e,r):null}}on.ExternalAccountClient=uh;var Tr={};Object.defineProperty(Tr,"__esModule",{value:!0});Tr.ExternalAccountAuthorizedUserClient=Tr.EXTERNAL_ACCOUNT_AUTHORIZED_USER_TYPE=void 0;const lh=Kt,lc=rr,fh=At,dh=Nt,hh=$t;Tr.EXTERNAL_ACCOUNT_AUTHORIZED_USER_TYPE="external_account_authorized_user";class ph extends lc.OAuthClientAuthHandler{constructor(e,r,n){super(n),this.url=e,this.transporter=r}async refreshToken(e,r){const n=new URLSearchParams({grant_type:"refresh_token",refresh_token:e}),s={"Content-Type":"application/x-www-form-urlencoded",...r},c={url:this.url,method:"POST",headers:s,data:n.toString(),responseType:"json"};this.applyClientAuthenticationOptions(c);try{const u=await this.transporter.request(c),a=u.data;return a.res=u,a}catch(u){throw u instanceof fh.GaxiosError&&u.response?(0,lc.getErrorFromOAuthErrorResponse)(u.response.data,u):u}}}class yh extends lh.AuthClient{constructor(e,r){super(),this.refreshToken=e.refresh_token;const n={confidentialClientType:"basic",clientId:e.client_id,clientSecret:e.client_secret};this.externalAccountAuthorizedUserHandler=new ph(e.token_url,this.transporter,n),this.cachedAccessToken=null,this.quotaProjectId=e.quota_project_id,typeof(r==null?void 0:r.eagerRefreshThresholdMillis)!="number"?this.eagerRefreshThresholdMillis=hh.EXPIRATION_TIME_OFFSET:this.eagerRefreshThresholdMillis=r.eagerRefreshThresholdMillis,this.forceRefreshOnFailure=!!(r!=null&&r.forceRefreshOnFailure)}async getAccessToken(){return(!this.cachedAccessToken||this.isExpired(this.cachedAccessToken))&&await this.refreshAccessTokenAsync(),{token:this.cachedAccessToken.access_token,res:this.cachedAccessToken.res}}async getRequestHeaders(){const r={Authorization:`Bearer ${(await this.getAccessToken()).token}`};return this.addSharedMetadataHeaders(r)}request(e,r){if(r)this.requestAsync(e).then(n=>r(null,n),n=>r(n,n.response));else return this.requestAsync(e)}async requestAsync(e,r=!1){let n;try{const s=await this.getRequestHeaders();e.headers=e.headers||{},s&&s["x-goog-user-project"]&&(e.headers["x-goog-user-project"]=s["x-goog-user-project"]),s&&s.Authorization&&(e.headers.Authorization=s.Authorization),n=await this.transporter.request(e)}catch(s){const c=s.response;if(c){const u=c.status,a=c.config.data instanceof dh.Readable;if(!r&&(u===401||u===403)&&!a&&this.forceRefreshOnFailure)return await this.refreshAccessTokenAsync(),await this.requestAsync(e,!0)}throw s}return n}async refreshAccessTokenAsync(){const e=await this.externalAccountAuthorizedUserHandler.refreshToken(this.refreshToken);return this.cachedAccessToken={access_token:e.access_token,expiry_date:new Date().getTime()+e.expires_in*1e3,res:e.res},e.refresh_token!==void 0&&(this.refreshToken=e.refresh_token),this.cachedAccessToken}isExpired(e){const r=new Date().getTime();return e.expiry_date?r>=e.expiry_date-this.eagerRefreshThresholdMillis:!1}}Tr.ExternalAccountAuthorizedUserClient=yh;Object.defineProperty(Sr,"__esModule",{value:!0});Sr.GoogleAuth=Sr.CLOUD_SDK_CLIENT_ID=void 0;const gh=Lc,Lr=nr,bi=Wn,vh=Mc,Bi=qc,mh=Yr(),Eh=ar,Ch=Jr,Sh=en,Ah=us,pr=tn,Ri=er,wn=tr,Th=on,Fr=$t,fc=Tr;Sr.CLOUD_SDK_CLIENT_ID="764086051850-6qr4p6gpi6hn506pt8ejuq83di341hur.apps.googleusercontent.com";const dc={NO_PROJECT_ID_FOUND:`Unable to detect a Project Id in the current environment. 
To learn more about authentication and Google APIs, visit: 
https://cloud.google.com/docs/authentication/getting-started`};class Gu{get isGCE(){return this.checkIsGCE}constructor(e){this.checkIsGCE=void 0,this.jsonContent=null,this.cachedCredential=null,e=e||{},this._cachedProjectId=e.projectId||null,this.cachedCredential=e.authClient||null,this.keyFilename=e.keyFilename||e.keyFile,this.scopes=e.scopes,this.jsonContent=e.credentials||null,this.clientOptions=e.clientOptions}setGapicJWTValues(e){e.defaultServicePath=this.defaultServicePath,e.useJWTAccessWithScope=this.useJWTAccessWithScope,e.defaultScopes=this.defaultScopes}getProjectId(e){if(e)this.getProjectIdAsync().then(r=>e(null,r),e);else return this.getProjectIdAsync()}async getProjectIdOptional(){try{return await this.getProjectId()}catch(e){if(e instanceof Error&&e.message===dc.NO_PROJECT_ID_FOUND)return null;throw e}}async findAndCacheProjectId(){let e=null;if(e||(e=await this.getProductionProjectId()),e||(e=await this.getFileProjectId()),e||(e=await this.getDefaultServiceProjectId()),e||(e=await this.getGCEProjectId()),e||(e=await this.getExternalAccountClientProjectId()),e)return this._cachedProjectId=e,e;throw new Error(dc.NO_PROJECT_ID_FOUND)}async getProjectIdAsync(){return this._cachedProjectId?this._cachedProjectId:(this._findProjectIdPromise||(this._findProjectIdPromise=this.findAndCacheProjectId()),this._findProjectIdPromise)}getAnyScopes(){return this.scopes||this.defaultScopes}getApplicationDefault(e={},r){let n;if(typeof e=="function"?r=e:n=e,r)this.getApplicationDefaultAsync(n).then(s=>r(null,s.credential,s.projectId),r);else return this.getApplicationDefaultAsync(n)}async getApplicationDefaultAsync(e={}){if(this.cachedCredential)return await this.prepareAndCacheADC(this.cachedCredential);const r=process.env.GOOGLE_CLOUD_QUOTA_PROJECT;let n;if(n=await this._tryGetApplicationCredentialsFromEnvironmentVariable(e),n)return n instanceof pr.JWT?n.scopes=this.scopes:n instanceof Fr.BaseExternalAccountClient&&(n.scopes=this.getAnyScopes()),await this.prepareAndCacheADC(n,r);if(n=await this._tryGetApplicationCredentialsFromWellKnownFile(e),n)return n instanceof pr.JWT?n.scopes=this.scopes:n instanceof Fr.BaseExternalAccountClient&&(n.scopes=this.getAnyScopes()),await this.prepareAndCacheADC(n,r);let s;try{s=await this._checkIsGCE()}catch(c){throw c instanceof Error&&(c.message=`Unexpected error determining execution environment: ${c.message}`),c}if(!s)throw new Error("Could not load the default credentials. Browse to https://cloud.google.com/docs/authentication/getting-started for more information.");return e.scopes=this.getAnyScopes(),await this.prepareAndCacheADC(new Ch.Compute(e),r)}async prepareAndCacheADC(e,r){const n=await this.getProjectIdOptional();return r&&(e.quotaProjectId=r),this.cachedCredential=e,{credential:e,projectId:n}}async _checkIsGCE(){return this.checkIsGCE===void 0&&(this.checkIsGCE=await bi.isAvailable()),this.checkIsGCE}async _tryGetApplicationCredentialsFromEnvironmentVariable(e){const r=process.env.GOOGLE_APPLICATION_CREDENTIALS||process.env.google_application_credentials;if(!r||r.length===0)return null;try{return this._getApplicationCredentialsFromFilePath(r,e)}catch(n){throw n instanceof Error&&(n.message=`Unable to read the credential file specified by the GOOGLE_APPLICATION_CREDENTIALS environment variable: ${n.message}`),n}}async _tryGetApplicationCredentialsFromWellKnownFile(e){let r=null;if(this._isWindows())r=process.env.APPDATA;else{const s=process.env.HOME;s&&(r=Bi.join(s,".config"))}return r&&(r=Bi.join(r,"gcloud","application_default_credentials.json"),Lr.existsSync(r)||(r=null)),r?await this._getApplicationCredentialsFromFilePath(r,e):null}async _getApplicationCredentialsFromFilePath(e,r={}){if(!e||e.length===0)throw new Error("The file path is invalid.");try{if(e=Lr.realpathSync(e),!Lr.lstatSync(e).isFile())throw new Error}catch(s){throw s instanceof Error&&(s.message=`The file at ${e} does not exist, or it is not a file. ${s.message}`),s}const n=Lr.createReadStream(e);return this.fromStream(n,r)}fromImpersonatedJSON(e){var r,n,s,c;if(!e)throw new Error("Must pass in a JSON object containing an  impersonated refresh token");if(e.type!==wn.IMPERSONATED_ACCOUNT_TYPE)throw new Error(`The incoming JSON object does not have the "${wn.IMPERSONATED_ACCOUNT_TYPE}" type`);if(!e.source_credentials)throw new Error("The incoming JSON object does not contain a source_credentials field");if(!e.service_account_impersonation_url)throw new Error("The incoming JSON object does not contain a service_account_impersonation_url field");const u=new Ri.UserRefreshClient(e.source_credentials.client_id,e.source_credentials.client_secret,e.source_credentials.refresh_token),a=(n=(r=/(?<target>[^/]+):generateAccessToken$/.exec(e.service_account_impersonation_url))===null||r===void 0?void 0:r.groups)===null||n===void 0?void 0:n.target;if(!a)throw new RangeError(`Cannot extract target principal from ${e.service_account_impersonation_url}`);const p=(s=this.getAnyScopes())!==null&&s!==void 0?s:[];return new wn.Impersonated({delegates:(c=e.delegates)!==null&&c!==void 0?c:[],sourceClient:u,targetPrincipal:a,targetScopes:Array.isArray(p)?p:[p]})}fromJSON(e,r={}){let n;return r=r||{},e.type===Ri.USER_REFRESH_ACCOUNT_TYPE?(n=new Ri.UserRefreshClient(r),n.fromJSON(e)):e.type===wn.IMPERSONATED_ACCOUNT_TYPE?n=this.fromImpersonatedJSON(e):e.type===Fr.EXTERNAL_ACCOUNT_TYPE?(n=Th.ExternalAccountClient.fromJSON(e,r),n.scopes=this.getAnyScopes()):e.type===fc.EXTERNAL_ACCOUNT_AUTHORIZED_USER_TYPE?n=new fc.ExternalAccountAuthorizedUserClient(e,r):(r.scopes=this.scopes,n=new pr.JWT(r),this.setGapicJWTValues(n),n.fromJSON(e)),n}_cacheClientFromJSON(e,r){const n=this.fromJSON(e,r);return this.jsonContent=e,this.cachedCredential=n,n}fromStream(e,r={},n){let s={};if(typeof r=="function"?n=r:s=r,n)this.fromStreamAsync(e,s).then(c=>n(null,c),n);else return this.fromStreamAsync(e,s)}fromStreamAsync(e,r){return new Promise((n,s)=>{if(!e)throw new Error("Must pass in a stream containing the Google auth settings.");let c="";e.setEncoding("utf8").on("error",s).on("data",u=>c+=u).on("end",()=>{try{try{const u=JSON.parse(c),a=this._cacheClientFromJSON(u,r);return n(a)}catch(u){if(!this.keyFilename)throw u;const a=new pr.JWT({...this.clientOptions,keyFile:this.keyFilename});return this.cachedCredential=a,this.setGapicJWTValues(a),n(a)}}catch(u){return s(u)}})})}fromAPIKey(e,r){r=r||{};const n=new pr.JWT(r);return n.fromAPIKey(e),n}_isWindows(){const e=vh.platform();return!!(e&&e.length>=3&&e.substring(0,3).toLowerCase()==="win")}async getDefaultServiceProjectId(){return new Promise(e=>{(0,gh.exec)("gcloud config config-helper --format json",(r,n)=>{if(!r&&n)try{const s=JSON.parse(n).configuration.properties.core.project;e(s);return}catch{}e(null)})})}getProductionProjectId(){return process.env.GCLOUD_PROJECT||process.env.GOOGLE_CLOUD_PROJECT||process.env.gcloud_project||process.env.google_cloud_project}async getFileProjectId(){if(this.cachedCredential)return this.cachedCredential.projectId;if(this.keyFilename){const r=await this.getClient();if(r&&r.projectId)return r.projectId}const e=await this._tryGetApplicationCredentialsFromEnvironmentVariable();return e?e.projectId:null}async getExternalAccountClientProjectId(){return!this.jsonContent||this.jsonContent.type!==Fr.EXTERNAL_ACCOUNT_TYPE?null:await(await this.getClient()).getProjectId()}async getGCEProjectId(){try{return await bi.project("project-id")}catch{return null}}getCredentials(e){if(e)this.getCredentialsAsync().then(r=>e(null,r),e);else return this.getCredentialsAsync()}async getCredentialsAsync(){const e=await this.getClient();if(e instanceof Fr.BaseExternalAccountClient){const s=e.getServiceAccountEmail();if(s)return{client_email:s}}if(this.jsonContent)return{client_email:this.jsonContent.client_email,private_key:this.jsonContent.private_key};if(!await this._checkIsGCE())throw new Error("Unknown error.");const n=await bi.instance({property:"service-accounts/",params:{recursive:"true"}});if(!n||!n.default||!n.default.email)throw new Error("Failure from metadata server.");return{client_email:n.default.email}}async getClient(){if(!this.cachedCredential)if(this.jsonContent)this._cacheClientFromJSON(this.jsonContent,this.clientOptions);else if(this.keyFilename){const e=Bi.resolve(this.keyFilename),r=Lr.createReadStream(e);await this.fromStreamAsync(r,this.clientOptions)}else await this.getApplicationDefaultAsync(this.clientOptions);return this.cachedCredential}async getIdTokenClient(e){const r=await this.getClient();if(!("fetchIdToken"in r))throw new Error("Cannot fetch ID token in this environment, use GCE or set the GOOGLE_APPLICATION_CREDENTIALS environment variable to a service account credentials JSON file.");return new Sh.IdTokenClient({targetAudience:e,idTokenProvider:r})}async getAccessToken(){return(await(await this.getClient()).getAccessToken()).token}async getRequestHeaders(e){return(await this.getClient()).getRequestHeaders(e)}async authorizeRequest(e){e=e||{};const r=e.url||e.uri,s=await(await this.getClient()).getRequestHeaders(r);return e.headers=Object.assign(e.headers||{},s),e}async request(e){return(await this.getClient()).request(e)}getEnv(){return(0,Ah.getEnv)()}async sign(e){const r=await this.getClient(),n=(0,mh.createCrypto)();if(r instanceof pr.JWT&&r.key)return await n.sign(r.key,e);const s=await this.getCredentials();if(!s.client_email)throw new Error("Cannot sign data without `client_email`.");return this.signBlob(n,s.client_email,e)}async signBlob(e,r,n){const s=`https://iamcredentials.googleapis.com/v1/projects/-/serviceAccounts/${r}:signBlob`;return(await this.request({method:"POST",url:s,data:{payload:e.encodeBase64StringUtf8(n)}})).data.signedBlob}}Sr.GoogleAuth=Gu;Gu.DefaultTransporter=Eh.DefaultTransporter;var la={};Object.defineProperty(la,"__esModule",{value:!0});la.IAMAuth=void 0;class xh{constructor(e,r){this.selector=e,this.token=r,this.selector=e,this.token=r}getRequestHeaders(){return{"x-goog-iam-authority-selector":this.selector,"x-goog-iam-authorization-token":this.token}}}la.IAMAuth=xh;var ju={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.DownscopedClient=t.EXPIRATION_TIME_OFFSET=t.MAX_ACCESS_BOUNDARY_RULES_COUNT=void 0;const e=Nt,r=Kt,n=cn,s="urn:ietf:params:oauth:grant-type:token-exchange",c="urn:ietf:params:oauth:token-type:access_token",u="urn:ietf:params:oauth:token-type:access_token",a="https://sts.googleapis.com/v1/token";t.MAX_ACCESS_BOUNDARY_RULES_COUNT=10,t.EXPIRATION_TIME_OFFSET=5*60*1e3;class p extends r.AuthClient{constructor(A,C,y,o){if(super(),this.authClient=A,this.credentialAccessBoundary=C,C.accessBoundary.accessBoundaryRules.length===0)throw new Error("At least one access boundary rule needs to be defined.");if(C.accessBoundary.accessBoundaryRules.length>t.MAX_ACCESS_BOUNDARY_RULES_COUNT)throw new Error(`The provided access boundary has more than ${t.MAX_ACCESS_BOUNDARY_RULES_COUNT} access boundary rules.`);for(const m of C.accessBoundary.accessBoundaryRules)if(m.availablePermissions.length===0)throw new Error("At least one permission should be defined in access boundary rules.");this.stsCredential=new n.StsCredentials(a),this.cachedDownscopedAccessToken=null,typeof(y==null?void 0:y.eagerRefreshThresholdMillis)!="number"?this.eagerRefreshThresholdMillis=t.EXPIRATION_TIME_OFFSET:this.eagerRefreshThresholdMillis=y.eagerRefreshThresholdMillis,this.forceRefreshOnFailure=!!(y!=null&&y.forceRefreshOnFailure),this.quotaProjectId=o}setCredentials(A){if(!A.expiry_date)throw new Error("The access token expiry_date field is missing in the provided credentials.");super.setCredentials(A),this.cachedDownscopedAccessToken=A}async getAccessToken(){return(!this.cachedDownscopedAccessToken||this.isExpired(this.cachedDownscopedAccessToken))&&await this.refreshAccessTokenAsync(),{token:this.cachedDownscopedAccessToken.access_token,expirationTime:this.cachedDownscopedAccessToken.expiry_date,res:this.cachedDownscopedAccessToken.res}}async getRequestHeaders(){const C={Authorization:`Bearer ${(await this.getAccessToken()).token}`};return this.addSharedMetadataHeaders(C)}request(A,C){if(C)this.requestAsync(A).then(y=>C(null,y),y=>C(y,y.response));else return this.requestAsync(A)}async requestAsync(A,C=!1){let y;try{const o=await this.getRequestHeaders();A.headers=A.headers||{},o&&o["x-goog-user-project"]&&(A.headers["x-goog-user-project"]=o["x-goog-user-project"]),o&&o.Authorization&&(A.headers.Authorization=o.Authorization),y=await this.transporter.request(A)}catch(o){const m=o.response;if(m){const g=m.status,S=m.config.data instanceof e.Readable;if(!C&&(g===401||g===403)&&!S&&this.forceRefreshOnFailure)return await this.refreshAccessTokenAsync(),await this.requestAsync(A,!0)}throw o}return y}async refreshAccessTokenAsync(){var A;const C=(await this.authClient.getAccessToken()).token,y={grantType:s,requestedTokenType:c,subjectToken:C,subjectTokenType:u},o=await this.stsCredential.exchangeToken(y,void 0,this.credentialAccessBoundary),m=((A=this.authClient.credentials)===null||A===void 0?void 0:A.expiry_date)||null,g=o.expires_in?new Date().getTime()+o.expires_in*1e3:m;return this.cachedDownscopedAccessToken={access_token:o.access_token,expiry_date:g,res:o.res},this.credentials={},Object.assign(this.credentials,this.cachedDownscopedAccessToken),delete this.credentials.res,this.emit("tokens",{refresh_token:null,expiry_date:this.cachedDownscopedAccessToken.expiry_date,access_token:this.cachedDownscopedAccessToken.access_token,token_type:"Bearer",id_token:null}),this.cachedDownscopedAccessToken}isExpired(A){const C=new Date().getTime();return A.expiry_date?C>=A.expiry_date-this.eagerRefreshThresholdMillis:!1}}t.DownscopedClient=p})(ju);(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.GoogleAuth=t.auth=t.DefaultTransporter=t.PluggableAuthClient=t.DownscopedClient=t.BaseExternalAccountClient=t.ExternalAccountClient=t.IdentityPoolClient=t.AwsClient=t.UserRefreshClient=t.LoginTicket=t.OAuth2Client=t.CodeChallengeMethod=t.Impersonated=t.JWT=t.JWTAccess=t.IdTokenClient=t.IAMAuth=t.GCPEnv=t.Compute=t.AuthClient=void 0;const e=Sr;Object.defineProperty(t,"GoogleAuth",{enumerable:!0,get:function(){return e.GoogleAuth}});var r=Kt;Object.defineProperty(t,"AuthClient",{enumerable:!0,get:function(){return r.AuthClient}});var n=Jr;Object.defineProperty(t,"Compute",{enumerable:!0,get:function(){return n.Compute}});var s=us;Object.defineProperty(t,"GCPEnv",{enumerable:!0,get:function(){return s.GCPEnv}});var c=la;Object.defineProperty(t,"IAMAuth",{enumerable:!0,get:function(){return c.IAMAuth}});var u=en;Object.defineProperty(t,"IdTokenClient",{enumerable:!0,get:function(){return u.IdTokenClient}});var a=sn;Object.defineProperty(t,"JWTAccess",{enumerable:!0,get:function(){return a.JWTAccess}});var p=tn;Object.defineProperty(t,"JWT",{enumerable:!0,get:function(){return p.JWT}});var f=tr;Object.defineProperty(t,"Impersonated",{enumerable:!0,get:function(){return f.Impersonated}});var A=ir;Object.defineProperty(t,"CodeChallengeMethod",{enumerable:!0,get:function(){return A.CodeChallengeMethod}}),Object.defineProperty(t,"OAuth2Client",{enumerable:!0,get:function(){return A.OAuth2Client}});var C=Zr;Object.defineProperty(t,"LoginTicket",{enumerable:!0,get:function(){return C.LoginTicket}});var y=er;Object.defineProperty(t,"UserRefreshClient",{enumerable:!0,get:function(){return y.UserRefreshClient}});var o=ln;Object.defineProperty(t,"AwsClient",{enumerable:!0,get:function(){return o.AwsClient}});var m=un;Object.defineProperty(t,"IdentityPoolClient",{enumerable:!0,get:function(){return m.IdentityPoolClient}});var g=on;Object.defineProperty(t,"ExternalAccountClient",{enumerable:!0,get:function(){return g.ExternalAccountClient}});var S=$t;Object.defineProperty(t,"BaseExternalAccountClient",{enumerable:!0,get:function(){return S.BaseExternalAccountClient}});var i=ju;Object.defineProperty(t,"DownscopedClient",{enumerable:!0,get:function(){return i.DownscopedClient}});var v=xs();Object.defineProperty(t,"PluggableAuthClient",{enumerable:!0,get:function(){return v.PluggableAuthClient}});var E=ar;Object.defineProperty(t,"DefaultTransporter",{enumerable:!0,get:function(){return E.DefaultTransporter}});const I=new e.GoogleAuth;t.auth=I})(Qr);var fa={};Object.defineProperty(fa,"__esModule",{value:!0});fa.getAPI=void 0;function _h(t,e,r,n){let s;if(typeof e=="string")s=e,e={};else if(typeof e=="object")s=e.version,delete e.version;else throw new Error("Argument error: Accepts only string or object");try{const c=r[s],u=new c(e,n);return Object.freeze(u)}catch(c){throw new Error(`Unable to load endpoint ${t}("${s}"): ${c.message}`)}}fa.getAPI=_h;var Rr={},wh=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var e={},r=Symbol("test"),n=Object(r);if(typeof r=="string"||Object.prototype.toString.call(r)!=="[object Symbol]"||Object.prototype.toString.call(n)!=="[object Symbol]")return!1;var s=42;e[r]=s;for(r in e)return!1;if(typeof Object.keys=="function"&&Object.keys(e).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(e).length!==0)return!1;var c=Object.getOwnPropertySymbols(e);if(c.length!==1||c[0]!==r||!Object.prototype.propertyIsEnumerable.call(e,r))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var u=Object.getOwnPropertyDescriptor(e,r);if(u.value!==s||u.enumerable!==!0)return!1}return!0},hc=typeof Symbol<"u"&&Symbol,Ih=wh,bh=function(){return typeof hc!="function"||typeof Symbol!="function"||typeof hc("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:Ih()},Bh="Function.prototype.bind called on incompatible ",Ni=Array.prototype.slice,Rh=Object.prototype.toString,Nh="[object Function]",Ph=function(e){var r=this;if(typeof r!="function"||Rh.call(r)!==Nh)throw new TypeError(Bh+r);for(var n=Ni.call(arguments,1),s,c=function(){if(this instanceof s){var A=r.apply(this,n.concat(Ni.call(arguments)));return Object(A)===A?A:this}else return r.apply(e,n.concat(Ni.call(arguments)))},u=Math.max(0,r.length-n.length),a=[],p=0;p<u;p++)a.push("$"+p);if(s=Function("binder","return function ("+a.join(",")+"){ return binder.apply(this,arguments); }")(c),r.prototype){var f=function(){};f.prototype=r.prototype,s.prototype=new f,f.prototype=null}return s},Oh=Ph,_s=Function.prototype.bind||Oh,Uh=_s,kh=Uh.call(Function.call,Object.prototype.hasOwnProperty),Ce,xr=SyntaxError,Hu=Function,Er=TypeError,Pi=function(t){try{return Hu('"use strict"; return ('+t+").constructor;")()}catch{}},Xt=Object.getOwnPropertyDescriptor;if(Xt)try{Xt({},"")}catch{Xt=null}var Oi=function(){throw new Er},Dh=Xt?function(){try{return arguments.callee,Oi}catch{try{return Xt(arguments,"callee").get}catch{return Oi}}}():Oi,yr=bh(),Lt=Object.getPrototypeOf||function(t){return t.__proto__},vr={},Lh=typeof Uint8Array>"u"?Ce:Lt(Uint8Array),Cr={"%AggregateError%":typeof AggregateError>"u"?Ce:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?Ce:ArrayBuffer,"%ArrayIteratorPrototype%":yr?Lt([][Symbol.iterator]()):Ce,"%AsyncFromSyncIteratorPrototype%":Ce,"%AsyncFunction%":vr,"%AsyncGenerator%":vr,"%AsyncGeneratorFunction%":vr,"%AsyncIteratorPrototype%":vr,"%Atomics%":typeof Atomics>"u"?Ce:Atomics,"%BigInt%":typeof BigInt>"u"?Ce:BigInt,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?Ce:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":typeof Float32Array>"u"?Ce:Float32Array,"%Float64Array%":typeof Float64Array>"u"?Ce:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?Ce:FinalizationRegistry,"%Function%":Hu,"%GeneratorFunction%":vr,"%Int8Array%":typeof Int8Array>"u"?Ce:Int8Array,"%Int16Array%":typeof Int16Array>"u"?Ce:Int16Array,"%Int32Array%":typeof Int32Array>"u"?Ce:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":yr?Lt(Lt([][Symbol.iterator]())):Ce,"%JSON%":typeof JSON=="object"?JSON:Ce,"%Map%":typeof Map>"u"?Ce:Map,"%MapIteratorPrototype%":typeof Map>"u"||!yr?Ce:Lt(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?Ce:Promise,"%Proxy%":typeof Proxy>"u"?Ce:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":typeof Reflect>"u"?Ce:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?Ce:Set,"%SetIteratorPrototype%":typeof Set>"u"||!yr?Ce:Lt(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?Ce:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":yr?Lt(""[Symbol.iterator]()):Ce,"%Symbol%":yr?Symbol:Ce,"%SyntaxError%":xr,"%ThrowTypeError%":Dh,"%TypedArray%":Lh,"%TypeError%":Er,"%Uint8Array%":typeof Uint8Array>"u"?Ce:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?Ce:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?Ce:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?Ce:Uint32Array,"%URIError%":URIError,"%WeakMap%":typeof WeakMap>"u"?Ce:WeakMap,"%WeakRef%":typeof WeakRef>"u"?Ce:WeakRef,"%WeakSet%":typeof WeakSet>"u"?Ce:WeakSet},Fh=function t(e){var r;if(e==="%AsyncFunction%")r=Pi("async function () {}");else if(e==="%GeneratorFunction%")r=Pi("function* () {}");else if(e==="%AsyncGeneratorFunction%")r=Pi("async function* () {}");else if(e==="%AsyncGenerator%"){var n=t("%AsyncGeneratorFunction%");n&&(r=n.prototype)}else if(e==="%AsyncIteratorPrototype%"){var s=t("%AsyncGenerator%");s&&(r=Lt(s.prototype))}return Cr[e]=r,r},pc={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},fn=_s,Vn=kh,Mh=fn.call(Function.call,Array.prototype.concat),qh=fn.call(Function.apply,Array.prototype.splice),yc=fn.call(Function.call,String.prototype.replace),Kn=fn.call(Function.call,String.prototype.slice),Vh=fn.call(Function.call,RegExp.prototype.exec),Kh=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,$h=/\\(\\)?/g,Gh=function(e){var r=Kn(e,0,1),n=Kn(e,-1);if(r==="%"&&n!=="%")throw new xr("invalid intrinsic syntax, expected closing `%`");if(n==="%"&&r!=="%")throw new xr("invalid intrinsic syntax, expected opening `%`");var s=[];return yc(e,Kh,function(c,u,a,p){s[s.length]=a?yc(p,$h,"$1"):u||c}),s},jh=function(e,r){var n=e,s;if(Vn(pc,n)&&(s=pc[n],n="%"+s[0]+"%"),Vn(Cr,n)){var c=Cr[n];if(c===vr&&(c=Fh(n)),typeof c>"u"&&!r)throw new Er("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:s,name:n,value:c}}throw new xr("intrinsic "+e+" does not exist!")},ws=function(e,r){if(typeof e!="string"||e.length===0)throw new Er("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof r!="boolean")throw new Er('"allowMissing" argument must be a boolean');if(Vh(/^%?[^%]*%?$/,e)===null)throw new xr("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var n=Gh(e),s=n.length>0?n[0]:"",c=jh("%"+s+"%",r),u=c.name,a=c.value,p=!1,f=c.alias;f&&(s=f[0],qh(n,Mh([0,1],f)));for(var A=1,C=!0;A<n.length;A+=1){var y=n[A],o=Kn(y,0,1),m=Kn(y,-1);if((o==='"'||o==="'"||o==="`"||m==='"'||m==="'"||m==="`")&&o!==m)throw new xr("property names with quotes must have matching quotes");if((y==="constructor"||!C)&&(p=!0),s+="."+y,u="%"+s+"%",Vn(Cr,u))a=Cr[u];else if(a!=null){if(!(y in a)){if(!r)throw new Er("base intrinsic for "+e+" exists, but the property is not available.");return}if(Xt&&A+1>=n.length){var g=Xt(a,y);C=!!g,C&&"get"in g&&!("originalValue"in g.get)?a=g.get:a=a[y]}else C=Vn(a,y),a=a[y];C&&!p&&(Cr[u]=a)}}return a},zu={exports:{}};(function(t){var e=_s,r=ws,n=r("%Function.prototype.apply%"),s=r("%Function.prototype.call%"),c=r("%Reflect.apply%",!0)||e.call(s,n),u=r("%Object.getOwnPropertyDescriptor%",!0),a=r("%Object.defineProperty%",!0),p=r("%Math.max%");if(a)try{a({},"a",{value:1})}catch{a=null}t.exports=function(C){var y=c(e,s,arguments);if(u&&a){var o=u(y,"length");o.configurable&&a(y,"length",{value:1+p(0,C.length-(arguments.length-1))})}return y};var f=function(){return c(e,n,arguments)};a?a(t.exports,"apply",{value:f}):t.exports.apply=f})(zu);var Hh=zu.exports,Wu=ws,Qu=Hh,zh=Qu(Wu("String.prototype.indexOf")),Wh=function(e,r){var n=Wu(e,!!r);return typeof n=="function"&&zh(e,".prototype.")>-1?Qu(n):n};const Qh={},Yh=Object.freeze(Object.defineProperty({__proto__:null,default:Qh},Symbol.toStringTag,{value:"Module"})),Jh=Hl(Yh);var Is=typeof Map=="function"&&Map.prototype,Ui=Object.getOwnPropertyDescriptor&&Is?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,$n=Is&&Ui&&typeof Ui.get=="function"?Ui.get:null,Xh=Is&&Map.prototype.forEach,bs=typeof Set=="function"&&Set.prototype,ki=Object.getOwnPropertyDescriptor&&bs?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,Gn=bs&&ki&&typeof ki.get=="function"?ki.get:null,Zh=bs&&Set.prototype.forEach,ep=typeof WeakMap=="function"&&WeakMap.prototype,$r=ep?WeakMap.prototype.has:null,tp=typeof WeakSet=="function"&&WeakSet.prototype,Gr=tp?WeakSet.prototype.has:null,rp=typeof WeakRef=="function"&&WeakRef.prototype,gc=rp?WeakRef.prototype.deref:null,np=Boolean.prototype.valueOf,ap=Object.prototype.toString,ip=Function.prototype.toString,sp=String.prototype.match,Bs=String.prototype.slice,Mt=String.prototype.replace,op=String.prototype.toUpperCase,vc=String.prototype.toLowerCase,Yu=RegExp.prototype.test,mc=Array.prototype.concat,mt=Array.prototype.join,cp=Array.prototype.slice,Ec=Math.floor,Zi=typeof BigInt=="function"?BigInt.prototype.valueOf:null,Di=Object.getOwnPropertySymbols,es=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol.prototype.toString:null,_r=typeof Symbol=="function"&&typeof Symbol.iterator=="object",st=typeof Symbol=="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===_r||"symbol")?Symbol.toStringTag:null,Ju=Object.prototype.propertyIsEnumerable,Cc=(typeof Reflect=="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(t){return t.__proto__}:null);function Sc(t,e){if(t===1/0||t===-1/0||t!==t||t&&t>-1e3&&t<1e3||Yu.call(/e/,e))return e;var r=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof t=="number"){var n=t<0?-Ec(-t):Ec(t);if(n!==t){var s=String(n),c=Bs.call(e,s.length+1);return Mt.call(s,r,"$&_")+"."+Mt.call(Mt.call(c,/([0-9]{3})/g,"$&_"),/_$/,"")}}return Mt.call(e,r,"$&_")}var ts=Jh,Ac=ts.custom,Tc=Zu(Ac)?Ac:null,up=function t(e,r,n,s){var c=r||{};if(Ft(c,"quoteStyle")&&c.quoteStyle!=="single"&&c.quoteStyle!=="double")throw new TypeError('option "quoteStyle" must be "single" or "double"');if(Ft(c,"maxStringLength")&&(typeof c.maxStringLength=="number"?c.maxStringLength<0&&c.maxStringLength!==1/0:c.maxStringLength!==null))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var u=Ft(c,"customInspect")?c.customInspect:!0;if(typeof u!="boolean"&&u!=="symbol")throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(Ft(c,"indent")&&c.indent!==null&&c.indent!=="	"&&!(parseInt(c.indent,10)===c.indent&&c.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(Ft(c,"numericSeparator")&&typeof c.numericSeparator!="boolean")throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var a=c.numericSeparator;if(typeof e>"u")return"undefined";if(e===null)return"null";if(typeof e=="boolean")return e?"true":"false";if(typeof e=="string")return tl(e,c);if(typeof e=="number"){if(e===0)return 1/0/e>0?"0":"-0";var p=String(e);return a?Sc(e,p):p}if(typeof e=="bigint"){var f=String(e)+"n";return a?Sc(e,f):f}var A=typeof c.depth>"u"?5:c.depth;if(typeof n>"u"&&(n=0),n>=A&&A>0&&typeof e=="object")return rs(e)?"[Array]":"[Object]";var C=Ip(c,n);if(typeof s>"u")s=[];else if(el(s,e)>=0)return"[Circular]";function y(q,j,H){if(j&&(s=cp.call(s),s.push(j)),H){var Q={depth:c.depth};return Ft(c,"quoteStyle")&&(Q.quoteStyle=c.quoteStyle),t(q,Q,n+1,s)}return t(q,c,n+1,s)}if(typeof e=="function"&&!xc(e)){var o=mp(e),m=In(e,y);return"[Function"+(o?": "+o:" (anonymous)")+"]"+(m.length>0?" { "+mt.call(m,", ")+" }":"")}if(Zu(e)){var g=_r?Mt.call(String(e),/^(Symbol\(.*\))_[^)]*$/,"$1"):es.call(e);return typeof e=="object"&&!_r?Mr(g):g}if(xp(e)){for(var S="<"+vc.call(String(e.nodeName)),i=e.attributes||[],v=0;v<i.length;v++)S+=" "+i[v].name+"="+Xu(lp(i[v].value),"double",c);return S+=">",e.childNodes&&e.childNodes.length&&(S+="..."),S+="</"+vc.call(String(e.nodeName))+">",S}if(rs(e)){if(e.length===0)return"[]";var E=In(e,y);return C&&!wp(E)?"["+ns(E,C)+"]":"[ "+mt.call(E,", ")+" ]"}if(dp(e)){var I=In(e,y);return!("cause"in Error.prototype)&&"cause"in e&&!Ju.call(e,"cause")?"{ ["+String(e)+"] "+mt.call(mc.call("[cause]: "+y(e.cause),I),", ")+" }":I.length===0?"["+String(e)+"]":"{ ["+String(e)+"] "+mt.call(I,", ")+" }"}if(typeof e=="object"&&u){if(Tc&&typeof e[Tc]=="function"&&ts)return ts(e,{depth:A-n});if(u!=="symbol"&&typeof e.inspect=="function")return e.inspect()}if(Ep(e)){var B=[];return Xh.call(e,function(q,j){B.push(y(j,e,!0)+" => "+y(q,e))}),_c("Map",$n.call(e),B,C)}if(Ap(e)){var T=[];return Zh.call(e,function(q){T.push(y(q,e))}),_c("Set",Gn.call(e),T,C)}if(Cp(e))return Li("WeakMap");if(Tp(e))return Li("WeakSet");if(Sp(e))return Li("WeakRef");if(pp(e))return Mr(y(Number(e)));if(gp(e))return Mr(y(Zi.call(e)));if(yp(e))return Mr(np.call(e));if(hp(e))return Mr(y(String(e)));if(!fp(e)&&!xc(e)){var h=In(e,y),l=Cc?Cc(e)===Object.prototype:e instanceof Object||e.constructor===Object,R=e instanceof Object?"":"null prototype",N=!l&&st&&Object(e)===e&&st in e?Bs.call(jt(e),8,-1):R?"Object":"",F=l||typeof e.constructor!="function"?"":e.constructor.name?e.constructor.name+" ":"",D=F+(N||R?"["+mt.call(mc.call([],N||[],R||[]),": ")+"] ":"");return h.length===0?D+"{}":C?D+"{"+ns(h,C)+"}":D+"{ "+mt.call(h,", ")+" }"}return String(e)};function Xu(t,e,r){var n=(r.quoteStyle||e)==="double"?'"':"'";return n+t+n}function lp(t){return Mt.call(String(t),/"/g,"&quot;")}function rs(t){return jt(t)==="[object Array]"&&(!st||!(typeof t=="object"&&st in t))}function fp(t){return jt(t)==="[object Date]"&&(!st||!(typeof t=="object"&&st in t))}function xc(t){return jt(t)==="[object RegExp]"&&(!st||!(typeof t=="object"&&st in t))}function dp(t){return jt(t)==="[object Error]"&&(!st||!(typeof t=="object"&&st in t))}function hp(t){return jt(t)==="[object String]"&&(!st||!(typeof t=="object"&&st in t))}function pp(t){return jt(t)==="[object Number]"&&(!st||!(typeof t=="object"&&st in t))}function yp(t){return jt(t)==="[object Boolean]"&&(!st||!(typeof t=="object"&&st in t))}function Zu(t){if(_r)return t&&typeof t=="object"&&t instanceof Symbol;if(typeof t=="symbol")return!0;if(!t||typeof t!="object"||!es)return!1;try{return es.call(t),!0}catch{}return!1}function gp(t){if(!t||typeof t!="object"||!Zi)return!1;try{return Zi.call(t),!0}catch{}return!1}var vp=Object.prototype.hasOwnProperty||function(t){return t in this};function Ft(t,e){return vp.call(t,e)}function jt(t){return ap.call(t)}function mp(t){if(t.name)return t.name;var e=sp.call(ip.call(t),/^function\s*([\w$]+)/);return e?e[1]:null}function el(t,e){if(t.indexOf)return t.indexOf(e);for(var r=0,n=t.length;r<n;r++)if(t[r]===e)return r;return-1}function Ep(t){if(!$n||!t||typeof t!="object")return!1;try{$n.call(t);try{Gn.call(t)}catch{return!0}return t instanceof Map}catch{}return!1}function Cp(t){if(!$r||!t||typeof t!="object")return!1;try{$r.call(t,$r);try{Gr.call(t,Gr)}catch{return!0}return t instanceof WeakMap}catch{}return!1}function Sp(t){if(!gc||!t||typeof t!="object")return!1;try{return gc.call(t),!0}catch{}return!1}function Ap(t){if(!Gn||!t||typeof t!="object")return!1;try{Gn.call(t);try{$n.call(t)}catch{return!0}return t instanceof Set}catch{}return!1}function Tp(t){if(!Gr||!t||typeof t!="object")return!1;try{Gr.call(t,Gr);try{$r.call(t,$r)}catch{return!0}return t instanceof WeakSet}catch{}return!1}function xp(t){return!t||typeof t!="object"?!1:typeof HTMLElement<"u"&&t instanceof HTMLElement?!0:typeof t.nodeName=="string"&&typeof t.getAttribute=="function"}function tl(t,e){if(t.length>e.maxStringLength){var r=t.length-e.maxStringLength,n="... "+r+" more character"+(r>1?"s":"");return tl(Bs.call(t,0,e.maxStringLength),e)+n}var s=Mt.call(Mt.call(t,/(['\\])/g,"\\$1"),/[\x00-\x1f]/g,_p);return Xu(s,"single",e)}function _p(t){var e=t.charCodeAt(0),r={8:"b",9:"t",10:"n",12:"f",13:"r"}[e];return r?"\\"+r:"\\x"+(e<16?"0":"")+op.call(e.toString(16))}function Mr(t){return"Object("+t+")"}function Li(t){return t+" { ? }"}function _c(t,e,r,n){var s=n?ns(r,n):mt.call(r,", ");return t+" ("+e+") {"+s+"}"}function wp(t){for(var e=0;e<t.length;e++)if(el(t[e],`
`)>=0)return!1;return!0}function Ip(t,e){var r;if(t.indent==="	")r="	";else if(typeof t.indent=="number"&&t.indent>0)r=mt.call(Array(t.indent+1)," ");else return null;return{base:r,prev:mt.call(Array(e+1),r)}}function ns(t,e){if(t.length===0)return"";var r=`
`+e.prev+e.base;return r+mt.call(t,","+r)+`
`+e.prev}function In(t,e){var r=rs(t),n=[];if(r){n.length=t.length;for(var s=0;s<t.length;s++)n[s]=Ft(t,s)?e(t[s],t):""}var c=typeof Di=="function"?Di(t):[],u;if(_r){u={};for(var a=0;a<c.length;a++)u["$"+c[a]]=c[a]}for(var p in t)Ft(t,p)&&(r&&String(Number(p))===p&&p<t.length||_r&&u["$"+p]instanceof Symbol||(Yu.call(/[^\w$]/,p)?n.push(e(p,t)+": "+e(t[p],t)):n.push(p+": "+e(t[p],t))));if(typeof Di=="function")for(var f=0;f<c.length;f++)Ju.call(t,c[f])&&n.push("["+e(c[f])+"]: "+e(t[c[f]],t));return n}var Rs=ws,Nr=Wh,bp=up,Bp=Rs("%TypeError%"),bn=Rs("%WeakMap%",!0),Bn=Rs("%Map%",!0),Rp=Nr("WeakMap.prototype.get",!0),Np=Nr("WeakMap.prototype.set",!0),Pp=Nr("WeakMap.prototype.has",!0),Op=Nr("Map.prototype.get",!0),Up=Nr("Map.prototype.set",!0),kp=Nr("Map.prototype.has",!0),Ns=function(t,e){for(var r=t,n;(n=r.next)!==null;r=n)if(n.key===e)return r.next=n.next,n.next=t.next,t.next=n,n},Dp=function(t,e){var r=Ns(t,e);return r&&r.value},Lp=function(t,e,r){var n=Ns(t,e);n?n.value=r:t.next={key:e,next:t.next,value:r}},Fp=function(t,e){return!!Ns(t,e)},Mp=function(){var e,r,n,s={assert:function(c){if(!s.has(c))throw new Bp("Side channel does not contain "+bp(c))},get:function(c){if(bn&&c&&(typeof c=="object"||typeof c=="function")){if(e)return Rp(e,c)}else if(Bn){if(r)return Op(r,c)}else if(n)return Dp(n,c)},has:function(c){if(bn&&c&&(typeof c=="object"||typeof c=="function")){if(e)return Pp(e,c)}else if(Bn){if(r)return kp(r,c)}else if(n)return Fp(n,c);return!1},set:function(c,u){bn&&c&&(typeof c=="object"||typeof c=="function")?(e||(e=new bn),Np(e,c,u)):Bn?(r||(r=new Bn),Up(r,c,u)):(n||(n={key:{},next:null}),Lp(n,c,u))}};return s},qp=String.prototype.replace,Vp=/%20/g,Fi={RFC1738:"RFC1738",RFC3986:"RFC3986"},Ps={default:Fi.RFC3986,formatters:{RFC1738:function(t){return qp.call(t,Vp,"+")},RFC3986:function(t){return String(t)}},RFC1738:Fi.RFC1738,RFC3986:Fi.RFC3986},Kp=Ps,Mi=Object.prototype.hasOwnProperty,Yt=Array.isArray,vt=function(){for(var t=[],e=0;e<256;++e)t.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return t}(),$p=function(e){for(;e.length>1;){var r=e.pop(),n=r.obj[r.prop];if(Yt(n)){for(var s=[],c=0;c<n.length;++c)typeof n[c]<"u"&&s.push(n[c]);r.obj[r.prop]=s}}},rl=function(e,r){for(var n=r&&r.plainObjects?Object.create(null):{},s=0;s<e.length;++s)typeof e[s]<"u"&&(n[s]=e[s]);return n},Gp=function t(e,r,n){if(!r)return e;if(typeof r!="object"){if(Yt(e))e.push(r);else if(e&&typeof e=="object")(n&&(n.plainObjects||n.allowPrototypes)||!Mi.call(Object.prototype,r))&&(e[r]=!0);else return[e,r];return e}if(!e||typeof e!="object")return[e].concat(r);var s=e;return Yt(e)&&!Yt(r)&&(s=rl(e,n)),Yt(e)&&Yt(r)?(r.forEach(function(c,u){if(Mi.call(e,u)){var a=e[u];a&&typeof a=="object"&&c&&typeof c=="object"?e[u]=t(a,c,n):e.push(c)}else e[u]=c}),e):Object.keys(r).reduce(function(c,u){var a=r[u];return Mi.call(c,u)?c[u]=t(c[u],a,n):c[u]=a,c},s)},jp=function(e,r){return Object.keys(r).reduce(function(n,s){return n[s]=r[s],n},e)},Hp=function(t,e,r){var n=t.replace(/\+/g," ");if(r==="iso-8859-1")return n.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(n)}catch{return n}},zp=function(e,r,n,s,c){if(e.length===0)return e;var u=e;if(typeof e=="symbol"?u=Symbol.prototype.toString.call(e):typeof e!="string"&&(u=String(e)),n==="iso-8859-1")return escape(u).replace(/%u[0-9a-f]{4}/gi,function(A){return"%26%23"+parseInt(A.slice(2),16)+"%3B"});for(var a="",p=0;p<u.length;++p){var f=u.charCodeAt(p);if(f===45||f===46||f===95||f===126||f>=48&&f<=57||f>=65&&f<=90||f>=97&&f<=122||c===Kp.RFC1738&&(f===40||f===41)){a+=u.charAt(p);continue}if(f<128){a=a+vt[f];continue}if(f<2048){a=a+(vt[192|f>>6]+vt[128|f&63]);continue}if(f<55296||f>=57344){a=a+(vt[224|f>>12]+vt[128|f>>6&63]+vt[128|f&63]);continue}p+=1,f=65536+((f&1023)<<10|u.charCodeAt(p)&1023),a+=vt[240|f>>18]+vt[128|f>>12&63]+vt[128|f>>6&63]+vt[128|f&63]}return a},Wp=function(e){for(var r=[{obj:{o:e},prop:"o"}],n=[],s=0;s<r.length;++s)for(var c=r[s],u=c.obj[c.prop],a=Object.keys(u),p=0;p<a.length;++p){var f=a[p],A=u[f];typeof A=="object"&&A!==null&&n.indexOf(A)===-1&&(r.push({obj:u,prop:f}),n.push(A))}return $p(r),e},Qp=function(e){return Object.prototype.toString.call(e)==="[object RegExp]"},Yp=function(e){return!e||typeof e!="object"?!1:!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))},Jp=function(e,r){return[].concat(e,r)},Xp=function(e,r){if(Yt(e)){for(var n=[],s=0;s<e.length;s+=1)n.push(r(e[s]));return n}return r(e)},nl={arrayToObject:rl,assign:jp,combine:Jp,compact:Wp,decode:Hp,encode:zp,isBuffer:Yp,isRegExp:Qp,maybeMap:Xp,merge:Gp},al=Mp,as=nl,jr=Ps,Zp=Object.prototype.hasOwnProperty,wc={brackets:function(e){return e+"[]"},comma:"comma",indices:function(e,r){return e+"["+r+"]"},repeat:function(e){return e}},Rt=Array.isArray,ey=String.prototype.split,ty=Array.prototype.push,il=function(t,e){ty.apply(t,Rt(e)?e:[e])},ry=Date.prototype.toISOString,Ic=jr.default,tt={addQueryPrefix:!1,allowDots:!1,charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encoder:as.encode,encodeValuesOnly:!1,format:Ic,formatter:jr.formatters[Ic],indices:!1,serializeDate:function(e){return ry.call(e)},skipNulls:!1,strictNullHandling:!1},ny=function(e){return typeof e=="string"||typeof e=="number"||typeof e=="boolean"||typeof e=="symbol"||typeof e=="bigint"},qi={},ay=function t(e,r,n,s,c,u,a,p,f,A,C,y,o,m,g,S){for(var i=e,v=S,E=0,I=!1;(v=v.get(qi))!==void 0&&!I;){var B=v.get(e);if(E+=1,typeof B<"u"){if(B===E)throw new RangeError("Cyclic object value");I=!0}typeof v.get(qi)>"u"&&(E=0)}if(typeof p=="function"?i=p(r,i):i instanceof Date?i=C(i):n==="comma"&&Rt(i)&&(i=as.maybeMap(i,function(re){return re instanceof Date?C(re):re})),i===null){if(c)return a&&!m?a(r,tt.encoder,g,"key",y):r;i=""}if(ny(i)||as.isBuffer(i)){if(a){var T=m?r:a(r,tt.encoder,g,"key",y);if(n==="comma"&&m){for(var h=ey.call(String(i),","),l="",R=0;R<h.length;++R)l+=(R===0?"":",")+o(a(h[R],tt.encoder,g,"value",y));return[o(T)+(s&&Rt(i)&&h.length===1?"[]":"")+"="+l]}return[o(T)+"="+o(a(i,tt.encoder,g,"value",y))]}return[o(r)+"="+o(String(i))]}var N=[];if(typeof i>"u")return N;var F;if(n==="comma"&&Rt(i))F=[{value:i.length>0?i.join(",")||null:void 0}];else if(Rt(p))F=p;else{var D=Object.keys(i);F=f?D.sort(f):D}for(var q=s&&Rt(i)&&i.length===1?r+"[]":r,j=0;j<F.length;++j){var H=F[j],Q=typeof H=="object"&&typeof H.value<"u"?H.value:i[H];if(!(u&&Q===null)){var J=Rt(i)?typeof n=="function"?n(q,H):q:q+(A?"."+H:"["+H+"]");S.set(e,E);var X=al();X.set(qi,S),il(N,t(Q,J,n,s,c,u,a,p,f,A,C,y,o,m,g,X))}}return N},iy=function(e){if(!e)return tt;if(e.encoder!==null&&typeof e.encoder<"u"&&typeof e.encoder!="function")throw new TypeError("Encoder has to be a function.");var r=e.charset||tt.charset;if(typeof e.charset<"u"&&e.charset!=="utf-8"&&e.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var n=jr.default;if(typeof e.format<"u"){if(!Zp.call(jr.formatters,e.format))throw new TypeError("Unknown format option provided.");n=e.format}var s=jr.formatters[n],c=tt.filter;return(typeof e.filter=="function"||Rt(e.filter))&&(c=e.filter),{addQueryPrefix:typeof e.addQueryPrefix=="boolean"?e.addQueryPrefix:tt.addQueryPrefix,allowDots:typeof e.allowDots>"u"?tt.allowDots:!!e.allowDots,charset:r,charsetSentinel:typeof e.charsetSentinel=="boolean"?e.charsetSentinel:tt.charsetSentinel,delimiter:typeof e.delimiter>"u"?tt.delimiter:e.delimiter,encode:typeof e.encode=="boolean"?e.encode:tt.encode,encoder:typeof e.encoder=="function"?e.encoder:tt.encoder,encodeValuesOnly:typeof e.encodeValuesOnly=="boolean"?e.encodeValuesOnly:tt.encodeValuesOnly,filter:c,format:n,formatter:s,serializeDate:typeof e.serializeDate=="function"?e.serializeDate:tt.serializeDate,skipNulls:typeof e.skipNulls=="boolean"?e.skipNulls:tt.skipNulls,sort:typeof e.sort=="function"?e.sort:null,strictNullHandling:typeof e.strictNullHandling=="boolean"?e.strictNullHandling:tt.strictNullHandling}},sy=function(t,e){var r=t,n=iy(e),s,c;typeof n.filter=="function"?(c=n.filter,r=c("",r)):Rt(n.filter)&&(c=n.filter,s=c);var u=[];if(typeof r!="object"||r===null)return"";var a;e&&e.arrayFormat in wc?a=e.arrayFormat:e&&"indices"in e?a=e.indices?"indices":"repeat":a="indices";var p=wc[a];if(e&&"commaRoundTrip"in e&&typeof e.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");var f=p==="comma"&&e&&e.commaRoundTrip;s||(s=Object.keys(r)),n.sort&&s.sort(n.sort);for(var A=al(),C=0;C<s.length;++C){var y=s[C];n.skipNulls&&r[y]===null||il(u,ay(r[y],y,p,f,n.strictNullHandling,n.skipNulls,n.encode?n.encoder:null,n.filter,n.sort,n.allowDots,n.serializeDate,n.format,n.formatter,n.encodeValuesOnly,n.charset,A))}var o=u.join(n.delimiter),m=n.addQueryPrefix===!0?"?":"";return n.charsetSentinel&&(n.charset==="iso-8859-1"?m+="utf8=%26%2310003%3B&":m+="utf8=%E2%9C%93&"),o.length>0?m+o:""},wr=nl,is=Object.prototype.hasOwnProperty,oy=Array.isArray,Ze={allowDots:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decoder:wr.decode,delimiter:"&",depth:5,ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictNullHandling:!1},cy=function(t){return t.replace(/&#(\d+);/g,function(e,r){return String.fromCharCode(parseInt(r,10))})},sl=function(t,e){return t&&typeof t=="string"&&e.comma&&t.indexOf(",")>-1?t.split(","):t},uy="utf8=%26%2310003%3B",ly="utf8=%E2%9C%93",fy=function(e,r){var n={},s=r.ignoreQueryPrefix?e.replace(/^\?/,""):e,c=r.parameterLimit===1/0?void 0:r.parameterLimit,u=s.split(r.delimiter,c),a=-1,p,f=r.charset;if(r.charsetSentinel)for(p=0;p<u.length;++p)u[p].indexOf("utf8=")===0&&(u[p]===ly?f="utf-8":u[p]===uy&&(f="iso-8859-1"),a=p,p=u.length);for(p=0;p<u.length;++p)if(p!==a){var A=u[p],C=A.indexOf("]="),y=C===-1?A.indexOf("="):C+1,o,m;y===-1?(o=r.decoder(A,Ze.decoder,f,"key"),m=r.strictNullHandling?null:""):(o=r.decoder(A.slice(0,y),Ze.decoder,f,"key"),m=wr.maybeMap(sl(A.slice(y+1),r),function(g){return r.decoder(g,Ze.decoder,f,"value")})),m&&r.interpretNumericEntities&&f==="iso-8859-1"&&(m=cy(m)),A.indexOf("[]=")>-1&&(m=oy(m)?[m]:m),is.call(n,o)?n[o]=wr.combine(n[o],m):n[o]=m}return n},dy=function(t,e,r,n){for(var s=n?e:sl(e,r),c=t.length-1;c>=0;--c){var u,a=t[c];if(a==="[]"&&r.parseArrays)u=[].concat(s);else{u=r.plainObjects?Object.create(null):{};var p=a.charAt(0)==="["&&a.charAt(a.length-1)==="]"?a.slice(1,-1):a,f=parseInt(p,10);!r.parseArrays&&p===""?u={0:s}:!isNaN(f)&&a!==p&&String(f)===p&&f>=0&&r.parseArrays&&f<=r.arrayLimit?(u=[],u[f]=s):p!=="__proto__"&&(u[p]=s)}s=u}return s},hy=function(e,r,n,s){if(e){var c=n.allowDots?e.replace(/\.([^.[]+)/g,"[$1]"):e,u=/(\[[^[\]]*])/,a=/(\[[^[\]]*])/g,p=n.depth>0&&u.exec(c),f=p?c.slice(0,p.index):c,A=[];if(f){if(!n.plainObjects&&is.call(Object.prototype,f)&&!n.allowPrototypes)return;A.push(f)}for(var C=0;n.depth>0&&(p=a.exec(c))!==null&&C<n.depth;){if(C+=1,!n.plainObjects&&is.call(Object.prototype,p[1].slice(1,-1))&&!n.allowPrototypes)return;A.push(p[1])}return p&&A.push("["+c.slice(p.index)+"]"),dy(A,r,n,s)}},py=function(e){if(!e)return Ze;if(e.decoder!==null&&e.decoder!==void 0&&typeof e.decoder!="function")throw new TypeError("Decoder has to be a function.");if(typeof e.charset<"u"&&e.charset!=="utf-8"&&e.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var r=typeof e.charset>"u"?Ze.charset:e.charset;return{allowDots:typeof e.allowDots>"u"?Ze.allowDots:!!e.allowDots,allowPrototypes:typeof e.allowPrototypes=="boolean"?e.allowPrototypes:Ze.allowPrototypes,allowSparse:typeof e.allowSparse=="boolean"?e.allowSparse:Ze.allowSparse,arrayLimit:typeof e.arrayLimit=="number"?e.arrayLimit:Ze.arrayLimit,charset:r,charsetSentinel:typeof e.charsetSentinel=="boolean"?e.charsetSentinel:Ze.charsetSentinel,comma:typeof e.comma=="boolean"?e.comma:Ze.comma,decoder:typeof e.decoder=="function"?e.decoder:Ze.decoder,delimiter:typeof e.delimiter=="string"||wr.isRegExp(e.delimiter)?e.delimiter:Ze.delimiter,depth:typeof e.depth=="number"||e.depth===!1?+e.depth:Ze.depth,ignoreQueryPrefix:e.ignoreQueryPrefix===!0,interpretNumericEntities:typeof e.interpretNumericEntities=="boolean"?e.interpretNumericEntities:Ze.interpretNumericEntities,parameterLimit:typeof e.parameterLimit=="number"?e.parameterLimit:Ze.parameterLimit,parseArrays:e.parseArrays!==!1,plainObjects:typeof e.plainObjects=="boolean"?e.plainObjects:Ze.plainObjects,strictNullHandling:typeof e.strictNullHandling=="boolean"?e.strictNullHandling:Ze.strictNullHandling}},yy=function(t,e){var r=py(e);if(t===""||t===null||typeof t>"u")return r.plainObjects?Object.create(null):{};for(var n=typeof t=="string"?fy(t,r):t,s=r.plainObjects?Object.create(null):{},c=Object.keys(n),u=0;u<c.length;++u){var a=c[u],p=hy(a,n[a],r,typeof t=="string");s=wr.merge(s,p,r)}return r.allowSparse===!0?s:wr.compact(s)},gy=sy,vy=yy,my=Ps,ol={formats:my,parse:vy,stringify:gy},cl={exports:{}};(function(t,e){(function(r,n){t.exports=n()})(Be,function(){function r(){}return r.prototype.encodeReserved=function(n){return n.split(/(%[0-9A-Fa-f]{2})/g).map(function(s){return/%[0-9A-Fa-f]/.test(s)||(s=encodeURI(s).replace(/%5B/g,"[").replace(/%5D/g,"]")),s}).join("")},r.prototype.encodeUnreserved=function(n){return encodeURIComponent(n).replace(/[!'()*]/g,function(s){return"%"+s.charCodeAt(0).toString(16).toUpperCase()})},r.prototype.encodeValue=function(n,s,c){return s=n==="+"||n==="#"?this.encodeReserved(s):this.encodeUnreserved(s),c?this.encodeUnreserved(c)+"="+s:s},r.prototype.isDefined=function(n){return n!=null},r.prototype.isKeyOperator=function(n){return n===";"||n==="&"||n==="?"},r.prototype.getValues=function(n,s,c,u){var a=n[c],p=[];if(this.isDefined(a)&&a!=="")if(typeof a=="string"||typeof a=="number"||typeof a=="boolean")a=a.toString(),u&&u!=="*"&&(a=a.substring(0,parseInt(u,10))),p.push(this.encodeValue(s,a,this.isKeyOperator(s)?c:null));else if(u==="*")Array.isArray(a)?a.filter(this.isDefined).forEach(function(A){p.push(this.encodeValue(s,A,this.isKeyOperator(s)?c:null))},this):Object.keys(a).forEach(function(A){this.isDefined(a[A])&&p.push(this.encodeValue(s,a[A],A))},this);else{var f=[];Array.isArray(a)?a.filter(this.isDefined).forEach(function(A){f.push(this.encodeValue(s,A))},this):Object.keys(a).forEach(function(A){this.isDefined(a[A])&&(f.push(this.encodeUnreserved(A)),f.push(this.encodeValue(s,a[A].toString())))},this),this.isKeyOperator(s)?p.push(this.encodeUnreserved(c)+"="+f.join(",")):f.length!==0&&p.push(f.join(","))}else s===";"?this.isDefined(a)&&p.push(this.encodeUnreserved(c)):a===""&&(s==="&"||s==="?")?p.push(this.encodeUnreserved(c)+"="):a===""&&p.push("");return p},r.prototype.parse=function(n){var s=this,c=["+","#",".","/",";","?","&"];return{expand:function(u){return n.replace(/\{([^\{\}]+)\}|([^\{\}]+)/g,function(a,p,f){if(p){var A=null,C=[];if(c.indexOf(p.charAt(0))!==-1&&(A=p.charAt(0),p=p.substr(1)),p.split(/,/g).forEach(function(o){var m=/([^:\*]*)(?::(\d+)|(\*))?/.exec(o);C.push.apply(C,s.getValues(u,A,m[1],m[2]||m[3]))}),A&&A!=="+"){var y=",";return A==="?"?y="&":A!=="#"&&(y=A),(C.length!==0?A:"")+C.join(y)}else return C.join(",")}else return s.encodeReserved(f)})}}},new r})})(cl);var Ey=cl.exports,ul={},da={},ha={};Object.defineProperty(ha,"__esModule",{value:!0});ha.default=Sy;let Rn;const Cy=new Uint8Array(16);function Sy(){if(!Rn&&(Rn=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Rn))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Rn(Cy)}var Ht={},cr={},pa={};Object.defineProperty(pa,"__esModule",{value:!0});pa.default=void 0;var Ay=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;pa.default=Ay;Object.defineProperty(cr,"__esModule",{value:!0});cr.default=void 0;var Ty=xy(pa);function xy(t){return t&&t.__esModule?t:{default:t}}function _y(t){return typeof t=="string"&&Ty.default.test(t)}var wy=_y;cr.default=wy;Object.defineProperty(Ht,"__esModule",{value:!0});Ht.default=void 0;Ht.unsafeStringify=ll;var Iy=by(cr);function by(t){return t&&t.__esModule?t:{default:t}}const et=[];for(let t=0;t<256;++t)et.push((t+256).toString(16).slice(1));function ll(t,e=0){return(et[t[e+0]]+et[t[e+1]]+et[t[e+2]]+et[t[e+3]]+"-"+et[t[e+4]]+et[t[e+5]]+"-"+et[t[e+6]]+et[t[e+7]]+"-"+et[t[e+8]]+et[t[e+9]]+"-"+et[t[e+10]]+et[t[e+11]]+et[t[e+12]]+et[t[e+13]]+et[t[e+14]]+et[t[e+15]]).toLowerCase()}function By(t,e=0){const r=ll(t,e);if(!(0,Iy.default)(r))throw TypeError("Stringified UUID is invalid");return r}var Ry=By;Ht.default=Ry;Object.defineProperty(da,"__esModule",{value:!0});da.default=void 0;var Ny=Oy(ha),Py=Ht;function Oy(t){return t&&t.__esModule?t:{default:t}}let bc,Vi,Ki=0,$i=0;function Uy(t,e,r){let n=e&&r||0;const s=e||new Array(16);t=t||{};let c=t.node||bc,u=t.clockseq!==void 0?t.clockseq:Vi;if(c==null||u==null){const y=t.random||(t.rng||Ny.default)();c==null&&(c=bc=[y[0]|1,y[1],y[2],y[3],y[4],y[5]]),u==null&&(u=Vi=(y[6]<<8|y[7])&16383)}let a=t.msecs!==void 0?t.msecs:Date.now(),p=t.nsecs!==void 0?t.nsecs:$i+1;const f=a-Ki+(p-$i)/1e4;if(f<0&&t.clockseq===void 0&&(u=u+1&16383),(f<0||a>Ki)&&t.nsecs===void 0&&(p=0),p>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");Ki=a,$i=p,Vi=u,a+=122192928e5;const A=((a&268435455)*1e4+p)%4294967296;s[n++]=A>>>24&255,s[n++]=A>>>16&255,s[n++]=A>>>8&255,s[n++]=A&255;const C=a/4294967296*1e4&268435455;s[n++]=C>>>8&255,s[n++]=C&255,s[n++]=C>>>24&15|16,s[n++]=C>>>16&255,s[n++]=u>>>8|128,s[n++]=u&255;for(let y=0;y<6;++y)s[n+y]=c[y];return e||(0,Py.unsafeStringify)(s)}var ky=Uy;da.default=ky;var ya={},Vt={},dn={};Object.defineProperty(dn,"__esModule",{value:!0});dn.default=void 0;var Dy=Ly(cr);function Ly(t){return t&&t.__esModule?t:{default:t}}function Fy(t){if(!(0,Dy.default)(t))throw TypeError("Invalid UUID");let e;const r=new Uint8Array(16);return r[0]=(e=parseInt(t.slice(0,8),16))>>>24,r[1]=e>>>16&255,r[2]=e>>>8&255,r[3]=e&255,r[4]=(e=parseInt(t.slice(9,13),16))>>>8,r[5]=e&255,r[6]=(e=parseInt(t.slice(14,18),16))>>>8,r[7]=e&255,r[8]=(e=parseInt(t.slice(19,23),16))>>>8,r[9]=e&255,r[10]=(e=parseInt(t.slice(24,36),16))/1099511627776&255,r[11]=e/4294967296&255,r[12]=e>>>24&255,r[13]=e>>>16&255,r[14]=e>>>8&255,r[15]=e&255,r}var My=Fy;dn.default=My;Object.defineProperty(Vt,"__esModule",{value:!0});Vt.URL=Vt.DNS=void 0;Vt.default=Gy;var qy=Ht,Vy=Ky(dn);function Ky(t){return t&&t.__esModule?t:{default:t}}function $y(t){t=unescape(encodeURIComponent(t));const e=[];for(let r=0;r<t.length;++r)e.push(t.charCodeAt(r));return e}const fl="6ba7b810-9dad-11d1-80b4-00c04fd430c8";Vt.DNS=fl;const dl="6ba7b811-9dad-11d1-80b4-00c04fd430c8";Vt.URL=dl;function Gy(t,e,r){function n(s,c,u,a){var p;if(typeof s=="string"&&(s=$y(s)),typeof c=="string"&&(c=(0,Vy.default)(c)),((p=c)===null||p===void 0?void 0:p.length)!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let f=new Uint8Array(16+s.length);if(f.set(c),f.set(s,c.length),f=r(f),f[6]=f[6]&15|e,f[8]=f[8]&63|128,u){a=a||0;for(let A=0;A<16;++A)u[a+A]=f[A];return u}return(0,qy.unsafeStringify)(f)}try{n.name=t}catch{}return n.DNS=fl,n.URL=dl,n}var ga={};Object.defineProperty(ga,"__esModule",{value:!0});ga.default=void 0;function jy(t){if(typeof t=="string"){const e=unescape(encodeURIComponent(t));t=new Uint8Array(e.length);for(let r=0;r<e.length;++r)t[r]=e.charCodeAt(r)}return Hy(zy(Wy(t),t.length*8))}function Hy(t){const e=[],r=t.length*32,n="0123456789abcdef";for(let s=0;s<r;s+=8){const c=t[s>>5]>>>s%32&255,u=parseInt(n.charAt(c>>>4&15)+n.charAt(c&15),16);e.push(u)}return e}function hl(t){return(t+64>>>9<<4)+14+1}function zy(t,e){t[e>>5]|=128<<e%32,t[hl(e)-1]=e;let r=1732584193,n=-271733879,s=-1732584194,c=271733878;for(let u=0;u<t.length;u+=16){const a=r,p=n,f=s,A=c;r=rt(r,n,s,c,t[u],7,-680876936),c=rt(c,r,n,s,t[u+1],12,-389564586),s=rt(s,c,r,n,t[u+2],17,606105819),n=rt(n,s,c,r,t[u+3],22,-1044525330),r=rt(r,n,s,c,t[u+4],7,-176418897),c=rt(c,r,n,s,t[u+5],12,1200080426),s=rt(s,c,r,n,t[u+6],17,-1473231341),n=rt(n,s,c,r,t[u+7],22,-45705983),r=rt(r,n,s,c,t[u+8],7,1770035416),c=rt(c,r,n,s,t[u+9],12,-1958414417),s=rt(s,c,r,n,t[u+10],17,-42063),n=rt(n,s,c,r,t[u+11],22,-1990404162),r=rt(r,n,s,c,t[u+12],7,1804603682),c=rt(c,r,n,s,t[u+13],12,-40341101),s=rt(s,c,r,n,t[u+14],17,-1502002290),n=rt(n,s,c,r,t[u+15],22,1236535329),r=nt(r,n,s,c,t[u+1],5,-165796510),c=nt(c,r,n,s,t[u+6],9,-1069501632),s=nt(s,c,r,n,t[u+11],14,643717713),n=nt(n,s,c,r,t[u],20,-373897302),r=nt(r,n,s,c,t[u+5],5,-701558691),c=nt(c,r,n,s,t[u+10],9,38016083),s=nt(s,c,r,n,t[u+15],14,-660478335),n=nt(n,s,c,r,t[u+4],20,-405537848),r=nt(r,n,s,c,t[u+9],5,568446438),c=nt(c,r,n,s,t[u+14],9,-1019803690),s=nt(s,c,r,n,t[u+3],14,-187363961),n=nt(n,s,c,r,t[u+8],20,1163531501),r=nt(r,n,s,c,t[u+13],5,-1444681467),c=nt(c,r,n,s,t[u+2],9,-51403784),s=nt(s,c,r,n,t[u+7],14,1735328473),n=nt(n,s,c,r,t[u+12],20,-1926607734),r=at(r,n,s,c,t[u+5],4,-378558),c=at(c,r,n,s,t[u+8],11,-2022574463),s=at(s,c,r,n,t[u+11],16,1839030562),n=at(n,s,c,r,t[u+14],23,-35309556),r=at(r,n,s,c,t[u+1],4,-1530992060),c=at(c,r,n,s,t[u+4],11,1272893353),s=at(s,c,r,n,t[u+7],16,-155497632),n=at(n,s,c,r,t[u+10],23,-1094730640),r=at(r,n,s,c,t[u+13],4,681279174),c=at(c,r,n,s,t[u],11,-358537222),s=at(s,c,r,n,t[u+3],16,-722521979),n=at(n,s,c,r,t[u+6],23,76029189),r=at(r,n,s,c,t[u+9],4,-640364487),c=at(c,r,n,s,t[u+12],11,-421815835),s=at(s,c,r,n,t[u+15],16,530742520),n=at(n,s,c,r,t[u+2],23,-995338651),r=it(r,n,s,c,t[u],6,-198630844),c=it(c,r,n,s,t[u+7],10,1126891415),s=it(s,c,r,n,t[u+14],15,-1416354905),n=it(n,s,c,r,t[u+5],21,-57434055),r=it(r,n,s,c,t[u+12],6,1700485571),c=it(c,r,n,s,t[u+3],10,-1894986606),s=it(s,c,r,n,t[u+10],15,-1051523),n=it(n,s,c,r,t[u+1],21,-2054922799),r=it(r,n,s,c,t[u+8],6,1873313359),c=it(c,r,n,s,t[u+15],10,-30611744),s=it(s,c,r,n,t[u+6],15,-1560198380),n=it(n,s,c,r,t[u+13],21,1309151649),r=it(r,n,s,c,t[u+4],6,-145523070),c=it(c,r,n,s,t[u+11],10,-1120210379),s=it(s,c,r,n,t[u+2],15,718787259),n=it(n,s,c,r,t[u+9],21,-343485551),r=qt(r,a),n=qt(n,p),s=qt(s,f),c=qt(c,A)}return[r,n,s,c]}function Wy(t){if(t.length===0)return[];const e=t.length*8,r=new Uint32Array(hl(e));for(let n=0;n<e;n+=8)r[n>>5]|=(t[n/8]&255)<<n%32;return r}function qt(t,e){const r=(t&65535)+(e&65535);return(t>>16)+(e>>16)+(r>>16)<<16|r&65535}function Qy(t,e){return t<<e|t>>>32-e}function va(t,e,r,n,s,c){return qt(Qy(qt(qt(e,t),qt(n,c)),s),r)}function rt(t,e,r,n,s,c,u){return va(e&r|~e&n,t,e,s,c,u)}function nt(t,e,r,n,s,c,u){return va(e&n|r&~n,t,e,s,c,u)}function at(t,e,r,n,s,c,u){return va(e^r^n,t,e,s,c,u)}function it(t,e,r,n,s,c,u){return va(r^(e|~n),t,e,s,c,u)}var Yy=jy;ga.default=Yy;Object.defineProperty(ya,"__esModule",{value:!0});ya.default=void 0;var Jy=pl(Vt),Xy=pl(ga);function pl(t){return t&&t.__esModule?t:{default:t}}const Zy=(0,Jy.default)("v3",48,Xy.default);var eg=Zy;ya.default=eg;var ma={},Ea={};Object.defineProperty(Ea,"__esModule",{value:!0});Ea.default=void 0;const tg=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);var rg={randomUUID:tg};Ea.default=rg;Object.defineProperty(ma,"__esModule",{value:!0});ma.default=void 0;var Bc=yl(Ea),ng=yl(ha),ag=Ht;function yl(t){return t&&t.__esModule?t:{default:t}}function ig(t,e,r){if(Bc.default.randomUUID&&!e&&!t)return Bc.default.randomUUID();t=t||{};const n=t.random||(t.rng||ng.default)();if(n[6]=n[6]&15|64,n[8]=n[8]&63|128,e){r=r||0;for(let s=0;s<16;++s)e[r+s]=n[s];return e}return(0,ag.unsafeStringify)(n)}var sg=ig;ma.default=sg;var Ca={},Sa={};Object.defineProperty(Sa,"__esModule",{value:!0});Sa.default=void 0;function og(t,e,r,n){switch(t){case 0:return e&r^~e&n;case 1:return e^r^n;case 2:return e&r^e&n^r&n;case 3:return e^r^n}}function Gi(t,e){return t<<e|t>>>32-e}function cg(t){const e=[1518500249,1859775393,2400959708,3395469782],r=[1732584193,4023233417,2562383102,271733878,3285377520];if(typeof t=="string"){const u=unescape(encodeURIComponent(t));t=[];for(let a=0;a<u.length;++a)t.push(u.charCodeAt(a))}else Array.isArray(t)||(t=Array.prototype.slice.call(t));t.push(128);const n=t.length/4+2,s=Math.ceil(n/16),c=new Array(s);for(let u=0;u<s;++u){const a=new Uint32Array(16);for(let p=0;p<16;++p)a[p]=t[u*64+p*4]<<24|t[u*64+p*4+1]<<16|t[u*64+p*4+2]<<8|t[u*64+p*4+3];c[u]=a}c[s-1][14]=(t.length-1)*8/Math.pow(2,32),c[s-1][14]=Math.floor(c[s-1][14]),c[s-1][15]=(t.length-1)*8&4294967295;for(let u=0;u<s;++u){const a=new Uint32Array(80);for(let o=0;o<16;++o)a[o]=c[u][o];for(let o=16;o<80;++o)a[o]=Gi(a[o-3]^a[o-8]^a[o-14]^a[o-16],1);let p=r[0],f=r[1],A=r[2],C=r[3],y=r[4];for(let o=0;o<80;++o){const m=Math.floor(o/20),g=Gi(p,5)+og(m,f,A,C)+y+e[m]+a[o]>>>0;y=C,C=A,A=Gi(f,30)>>>0,f=p,p=g}r[0]=r[0]+p>>>0,r[1]=r[1]+f>>>0,r[2]=r[2]+A>>>0,r[3]=r[3]+C>>>0,r[4]=r[4]+y>>>0}return[r[0]>>24&255,r[0]>>16&255,r[0]>>8&255,r[0]&255,r[1]>>24&255,r[1]>>16&255,r[1]>>8&255,r[1]&255,r[2]>>24&255,r[2]>>16&255,r[2]>>8&255,r[2]&255,r[3]>>24&255,r[3]>>16&255,r[3]>>8&255,r[3]&255,r[4]>>24&255,r[4]>>16&255,r[4]>>8&255,r[4]&255]}var ug=cg;Sa.default=ug;Object.defineProperty(Ca,"__esModule",{value:!0});Ca.default=void 0;var lg=gl(Vt),fg=gl(Sa);function gl(t){return t&&t.__esModule?t:{default:t}}const dg=(0,lg.default)("v5",80,fg.default);var hg=dg;Ca.default=hg;var Aa={};Object.defineProperty(Aa,"__esModule",{value:!0});Aa.default=void 0;var pg="00000000-0000-0000-0000-000000000000";Aa.default=pg;var Ta={};Object.defineProperty(Ta,"__esModule",{value:!0});Ta.default=void 0;var yg=gg(cr);function gg(t){return t&&t.__esModule?t:{default:t}}function vg(t){if(!(0,yg.default)(t))throw TypeError("Invalid UUID");return parseInt(t.slice(14,15),16)}var mg=vg;Ta.default=mg;(function(t){Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"NIL",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(t,"parse",{enumerable:!0,get:function(){return f.default}}),Object.defineProperty(t,"stringify",{enumerable:!0,get:function(){return p.default}}),Object.defineProperty(t,"v1",{enumerable:!0,get:function(){return e.default}}),Object.defineProperty(t,"v3",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(t,"v4",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(t,"v5",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(t,"validate",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(t,"version",{enumerable:!0,get:function(){return u.default}});var e=A(da),r=A(ya),n=A(ma),s=A(Ca),c=A(Aa),u=A(Ta),a=A(cr),p=A(Ht),f=A(dn);function A(C){return C&&C.__esModule?C:{default:C}}})(ul);var xa={};Object.defineProperty(xa,"__esModule",{value:!0});xa.isBrowser=void 0;function Eg(){return typeof window<"u"}xa.isBrowser=Eg;var vl={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.closeSession=t.request=t.sessions=void 0;const e=Kl,r=$l,n=Hn,s=ol,c=os,u=Nt,a=Pt,p=Gl,f=Ir,{HTTP2_HEADER_CONTENT_ENCODING:A,HTTP2_HEADER_CONTENT_TYPE:C,HTTP2_HEADER_METHOD:y,HTTP2_HEADER_PATH:o,HTTP2_HEADER_STATUS:m}=e.constants,g=!!p.env.HTTP2_DEBUG;t.sessions={};async function S(I){const B=c(!0,{},I);B.validateStatus=B.validateStatus||i,B.responseType=B.responseType||"json";const T=new n.URL(B.url),h=v(T.host);h.timeoutHandle!==void 0&&clearTimeout(h.timeoutHandle);let l=T.pathname;if(I.params&&Object.keys(I.params).length>0){const H=(I.paramsSerializer||s.stringify)(B.params);l+=`?${H}`}const R=Object.assign({},B.headers,{[o]:l,[y]:I.method||"GET"});R[C]||B.responseType!=="text"&&(R[C]="application/json");const N={config:I,request:{},headers:[],status:0,data:{},statusText:""},F=[],D=h.session;let q;return new Promise((j,H)=>{try{q=D.request(R).on("response",Q=>{N.headers=Q,N.status=Number(Q[m]);let J=q;if(Q[A]==="gzip"&&(J=q.pipe(r.createGunzip())),B.responseType==="stream"){N.data=J,j(N);return}J.on("data",X=>{F.push(X)}).on("error",X=>{H(X)}).on("end",()=>{const X=Buffer.concat(F);let re=X;if(X){if(B.responseType==="json")try{re=JSON.parse(X.toString("utf8"))}catch{re=X.toString("utf8")}else B.responseType==="text"?re=X.toString("utf8"):B.responseType==="arraybuffer"&&(re=X.buffer);N.data=re}if(!B.validateStatus(N.status)){let se=`Request failed with status code ${N.status}. `;if(N.data&&typeof N.data=="object"){const de=a.inspect(N.data,{depth:5});se=`${se}
'${de}`}H(new f.GaxiosError(se,B,N))}j(N)})}).on("error",Q=>{H(Q)})}catch(Q){E(T),H(Q)}if(N.request=q,I.data){if(I.data instanceof u.Stream)I.data.pipe(q);else if(typeof I.data=="string"){const Q=Buffer.from(I.data);q.end(Q)}else if(typeof I.data=="object"){const Q=JSON.stringify(I.data);q.end(Q)}}h.timeoutHandle=setTimeout(()=>{E(T)},500)})}t.request=S;function i(I){return I>=200&&I<300}function v(I){if(t.sessions[I])g&&console.log(`Used cached client for ${I}`);else{g&&console.log(`Creating client for ${I}`);const B=e.connect(`https://${I}`);B.on("error",T=>{console.error(`*ERROR*: ${T}`),delete t.sessions[I]}).on("goaway",(T,h)=>{console.error(`*GOAWAY*: ${T} : ${h}`),delete t.sessions[I]}),t.sessions[I]={session:B}}return t.sessions[I]}async function E(I){const B=t.sessions[I.host];if(!B)return;const{session:T}=B;delete t.sessions[I.host],g&&console.error(`Closing ${I.host}`),T.close(()=>{g&&console.error(`Closed ${I.host}`)}),setTimeout(()=>{T&&!T.destroyed&&(g&&console.log(`Forcing close ${I.host}`),T&&T.destroy())},1e3)}t.closeSession=E})(vl);const Cg="googleapis-common",Sg="6.0.4",Ag="A common tooling library used by the googleapis npm module. You probably don't want to use this directly.",Tg="googleapis/nodejs-googleapis-common",xg="build/src/index.js",_g="build/src/index.d.ts",wg=["build/src","!build/src/**/*.map"],Ig={prebenchmark:"npm run compile",benchmark:"node build/benchmark/bench.js",compile:"tsc -p .",test:"c8 mocha build/test","system-test":"c8 mocha build/system-test --timeout 600000","presystem-test":"npm run compile",fix:"gts fix",prepare:"npm run compile",pretest:"npm run compile",lint:"gts check","samples-test":"mocha build/samples-test",docs:"compodoc src/","docs-test":"linkinator docs",webpack:"webpack","browser-test":"karma start","predocs-test":"npm run docs",prelint:"cd samples; npm link ../; npm install",clean:"gts clean",precompile:"gts clean"},bg=[],Bg="Google LLC",Rg="Apache-2.0",Ng={extend:"^3.0.2",gaxios:"^5.0.1","google-auth-library":"^8.0.2",qs:"^6.7.0","url-template":"^2.0.8",uuid:"^9.0.0"},Pg={"@compodoc/compodoc":"^1.1.9","@types/execa":"^0.9.0","@types/extend":"^3.0.1","@types/mocha":"^9.0.0","@types/mv":"^2.1.0","@types/ncp":"^2.0.1","@types/nock":"^10.0.3","@types/proxyquire":"^1.3.28","@types/qs":"^6.5.3","@types/sinon":"^10.0.0","@types/tmp":"0.2.3","@types/url-template":"^2.0.28","@types/uuid":"^8.0.0",c8:"^7.0.0",codecov:"^3.5.0",execa:"^5.0.0",gts:"^3.1.0",http2spy:"^2.0.0","is-docker":"^2.0.0",karma:"^6.0.0","karma-chrome-launcher":"^3.0.0","karma-coverage":"^2.0.0","karma-firefox-launcher":"^2.0.0","karma-mocha":"^2.0.0","karma-remap-coverage":"^0.1.5","karma-sourcemap-loader":"^0.3.7","karma-webpack":"^5.0.0",linkinator:"^3.1.0",mocha:"^9.2.2",mv:"^2.1.1",ncp:"^2.0.0",nock:"^13.0.0","null-loader":"^4.0.0",proxyquire:"^2.1.3",puppeteer:"^18.2.1",sinon:"^14.0.0",tmp:"^0.2.0","ts-loader":"^8.0.0",typescript:"^4.6.4",webpack:"^5.30.0","webpack-cli":"^4.0.0"},Og={node:">=12.0.0"},Ug={name:Cg,version:Sg,description:Ag,repository:Tg,main:xg,types:_g,files:wg,scripts:Ig,keywords:bg,author:Bg,license:Rg,dependencies:Ng,devDependencies:Pg,engines:Og};Object.defineProperty(Rr,"__esModule",{value:!0});Rr.createAPIRequest=void 0;const kg=Qr,Dg=ol,ml=Nt,Rc=Ey,Nc=ul,ji=os,ss=xa,Lg=vl,El=Ug;function Fg(t){return t!==null&&typeof t=="object"&&typeof t.pipe=="function"&&t.readable!==!1&&typeof t._read=="function"&&typeof t._readableState=="object"}function Mg(t,e){const r=new Array;return e.forEach(n=>{t[n]===void 0&&r.push(n)}),r.length>0?r:null}function qg(t,e){if(e)Pc(t).then(r=>e(null,r),e);else return Pc(t)}Rr.createAPIRequest=qg;async function Pc(t){var e;const r=ji(!0,{},((e=t.context.google)===null||e===void 0?void 0:e._options)||{},t.context._options||{},t.options),n=ji(!0,{},r.params,t.params);r.userAgentDirectives=r.userAgentDirectives||[];const s=n.media||{};let c=n.requestBody;!n.requestBody&&n.resource&&(!t.requiredParams.includes("resource")||typeof n.resource!="string")&&(c=n.resource,delete n.resource),delete n.requestBody;let u=n.auth||r.auth;const a=typeof s.body=="string"?"text/plain":"application/octet-stream";delete n.media,delete n.auth;const p=n.headers||{};Kg(p),delete n.headers,Object.keys(n).forEach(y=>{if(y.slice(-1)==="_"){const o=y.slice(0,-1);n[o]=n[y],delete n[y]}});const f=Mg(n,t.requiredParams);if(f)throw new Error("Missing required parameters: "+f.join(", "));if(r.url&&(r.url=Rc.parse(r.url).expand(n)),t.mediaUrl&&(t.mediaUrl=Rc.parse(t.mediaUrl).expand(n)),t.context._options.rootUrl!==void 0&&r.url!==void 0){const y=new URL(r.url),o=y.href.substr(y.origin.length);r.url=new URL(o,t.context._options.rootUrl).href}r.paramsSerializer=y=>Dg.stringify(y,{arrayFormat:"repeat"}),t.pathParams.forEach(y=>delete n[y]),typeof u=="string"&&(n.key=n.key||u,u=void 0);function A(y){const o=Nc.v4(),m=`--${o}--`,g=new ml.PassThrough({flush(v){this.push(`\r
`),this.push(m),v()}}),S=new Vg,i=Fg(y[1].body);p["content-type"]=`multipart/related; boundary=${o}`;for(const v of y){const E=`--${o}\r
content-type: ${v["content-type"]}\r
\r
`;g.push(E),typeof v.body=="string"?(g.push(v.body),g.push(`\r
`)):(S.on("progress",I=>{r.onUploadProgress&&r.onUploadProgress({bytesRead:I})}),v.body.pipe(S).pipe(g))}i||(g.push(m),g.push(null)),r.data=g}function C(y){const o=Nc.v4(),m=`--${o}--`;p["content-type"]=`multipart/related; boundary=${o}`;let g="";for(const S of y){const i=`--${o}\r
content-type: ${S["content-type"]}\r
\r
`;g+=i,typeof S.body=="string"&&(g+=S.body,g+=`\r
`)}g+=m,r.data=g}if(t.mediaUrl&&s.body)if(r.url=t.mediaUrl,c){n.uploadType="multipart";const y=[{"content-type":"application/json",body:JSON.stringify(c)},{"content-type":s.mimeType||c&&c.mimeType||a,body:s.body}];(0,ss.isBrowser)()?C(y):A(y)}else n.uploadType="media",Object.assign(p,{"content-type":s.mimeType||a}),r.data=s.body;else r.data=c||void 0;if(r.headers=ji(!0,r.headers||{},p),r.params=n,!(0,ss.isBrowser)()){r.headers["Accept-Encoding"]="gzip",r.userAgentDirectives.push({product:"google-api-nodejs-client",version:El.version,comment:"gzip"});const y=r.userAgentDirectives.map(o=>{let m=`${o.product}/${o.version}`;return o.comment&&(m+=` (${o.comment})`),m}).join(" ");r.headers["User-Agent"]=y}if(r.validateStatus||(r.validateStatus=y=>y>=200&&y<300||y===304),r.retry=r.retry===void 0?!0:r.retry,delete r.auth,u&&typeof u=="object")if(r.http2){const y=await u.getRequestHeaders(r.url),o=Object.assign({},r);return o.headers=Object.assign(o.headers,y),Lg.request(o)}else return u.request(r);else return new kg.DefaultTransporter().request(r)}class Vg extends ml.Transform{constructor(){super(...arguments),this.bytesRead=0}_transform(e,r,n){this.bytesRead+=e.length,this.emit("progress",this.bytesRead),this.push(e),n()}}function Kg(t){(0,ss.isBrowser)()||(t["x-goog-api-client"]=`gdcl/${El.version} gl-node/${process.versions.node}`)}var _a={};Object.defineProperty(_a,"__esModule",{value:!0});_a.AuthPlus=void 0;const It=Qr;class $g extends It.GoogleAuth{constructor(){super(...arguments),this.JWT=It.JWT,this.Compute=It.Compute,this.OAuth2=It.OAuth2Client,this.GoogleAuth=It.GoogleAuth,this.AwsClient=It.AwsClient,this.IdentityPoolClient=It.IdentityPoolClient,this.ExternalAccountClient=It.ExternalAccountClient}async getClient(e){return this._cachedAuth=new It.GoogleAuth(e),this._cachedAuth.getClient()}getProjectId(e){return e?this._cachedAuth?this._cachedAuth.getProjectId(e):super.getProjectId(e):this._cachedAuth?this._cachedAuth.getProjectId():super.getProjectId()}}_a.AuthPlus=$g;var wa={},hn={};Object.defineProperty(hn,"__esModule",{value:!0});hn.Endpoint=void 0;const Oc=Rr;class Gg{constructor(e){this._options=e||{}}applySchema(e,r,n,s){if(this.applyMethodsFromSchema(e,r,n,s),n.resources){for(const c in n.resources)if(Object.prototype.hasOwnProperty.call(n.resources,c)){const u=n.resources[c];e[c]||(e[c]={}),this.applySchema(e[c],r,u,s)}}}applyMethodsFromSchema(e,r,n,s){if(n.methods){for(const c in n.methods)if(Object.prototype.hasOwnProperty.call(n.methods,c)){const u=n.methods[c];e[c]=this.makeMethod(r,u,s)}}}makeMethod(e,r,n){return(s,c)=>{const u=typeof s=="function"?{}:s;c=typeof s=="function"?s:c;const a=Uc(e.rootUrl+e.servicePath+r.path),p={options:{url:a.substring(1,a.length-1),method:r.httpMethod},params:u,requiredParams:r.parameterOrder||[],pathParams:this.getPathParams(r.parameters),context:n};if(r.mediaUpload&&r.mediaUpload.protocols&&r.mediaUpload.protocols.simple&&r.mediaUpload.protocols.simple.path){const f=Uc(e.rootUrl+r.mediaUpload.protocols.simple.path);p.mediaUrl=f.substring(1,f.length-1)}if(!c)return(0,Oc.createAPIRequest)(p);(0,Oc.createAPIRequest)(p,c)}}getPathParams(e){const r=new Array;return typeof e!="object"&&(e={}),Object.keys(e).forEach(n=>{e[n].location==="path"&&r.push(n)}),r}}hn.Endpoint=Gg;function Uc(t){return t?`'${t}'`.replace(/([^:]\/)\/+/g,"$1"):""}Object.defineProperty(wa,"__esModule",{value:!0});wa.Discovery=void 0;const jg=nr,Hg=Qr,zg=Hn,Cl=Pt,Wg=Rr,Qg=hn,Yg=Cl.promisify(jg.readFile);class Jg{constructor(e){this.transporter=new Hg.DefaultTransporter,this.options=e||{}}makeEndpoint(e){return r=>{const n=new Qg.Endpoint(r);return n.applySchema(n,e,e,n),n}}log(...e){this.options&&this.options.debug&&console.log(...e)}async discoverAllAPIs(e){const r=this.options.includePrivate?{}:{"X-User-Ip":"0.0.0.0"},s=(await this.transporter.request({url:e,headers:r})).data.items,c=await Promise.all(s.map(async p=>{const f=await this.discoverAPI(p.discoveryRestUrl);return{api:p,endpointCreator:f}})),u={},a={};for(const p of c)a[p.api.name]||(u[p.api.name]={},a[p.api.name]=f=>{const A=typeof f;let C;if(A==="string")C=f,f={};else if(A==="object")C=f.version,delete f.version;else throw new Error("Argument error: Accepts only string or object");try{const y=p.endpointCreator(f,this);return Object.freeze(y)}catch(y){throw new Error(Cl.format('Unable to load endpoint %s("%s"): %s',p.api.name,C,y.message))}}),u[p.api.name][p.api.version]=p.endpointCreator;return a}async discoverAPI(e){if(typeof e=="string"){const r=zg.parse(e);if(e&&!r.protocol){this.log("Reading from file "+e);const n=await Yg(e,{encoding:"utf8"});return this.makeEndpoint(JSON.parse(n))}else{this.log("Requesting "+e);const n=await this.transporter.request({url:e});return this.makeEndpoint(n.data)}}else{const r=e;this.log("Requesting "+r.url);const n=r.url;delete r.url;const s={options:{url:n,method:"GET"},requiredParams:[],pathParams:[],params:r,context:{google:{_options:{}},_options:{}}},c=await(0,Wg.createAPIRequest)(s);return this.makeEndpoint(c.data)}}}wa.Discovery=Jg;(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Endpoint=t.Discovery=t.AuthPlus=t.createAPIRequest=t.getAPI=t.GaxiosError=t.Gaxios=t.AwsClient=t.IdentityPoolClient=t.BaseExternalAccountClient=t.ExternalAccountClient=t.GoogleAuth=t.DefaultTransporter=t.UserRefreshClient=t.Compute=t.JWT=t.OAuth2Client=void 0;var e=Qr;Object.defineProperty(t,"OAuth2Client",{enumerable:!0,get:function(){return e.OAuth2Client}}),Object.defineProperty(t,"JWT",{enumerable:!0,get:function(){return e.JWT}}),Object.defineProperty(t,"Compute",{enumerable:!0,get:function(){return e.Compute}}),Object.defineProperty(t,"UserRefreshClient",{enumerable:!0,get:function(){return e.UserRefreshClient}}),Object.defineProperty(t,"DefaultTransporter",{enumerable:!0,get:function(){return e.DefaultTransporter}}),Object.defineProperty(t,"GoogleAuth",{enumerable:!0,get:function(){return e.GoogleAuth}}),Object.defineProperty(t,"ExternalAccountClient",{enumerable:!0,get:function(){return e.ExternalAccountClient}}),Object.defineProperty(t,"BaseExternalAccountClient",{enumerable:!0,get:function(){return e.BaseExternalAccountClient}}),Object.defineProperty(t,"IdentityPoolClient",{enumerable:!0,get:function(){return e.IdentityPoolClient}}),Object.defineProperty(t,"AwsClient",{enumerable:!0,get:function(){return e.AwsClient}});var r=At;Object.defineProperty(t,"Gaxios",{enumerable:!0,get:function(){return r.Gaxios}}),Object.defineProperty(t,"GaxiosError",{enumerable:!0,get:function(){return r.GaxiosError}});var n=fa;Object.defineProperty(t,"getAPI",{enumerable:!0,get:function(){return n.getAPI}});var s=Rr;Object.defineProperty(t,"createAPIRequest",{enumerable:!0,get:function(){return s.createAPIRequest}});var c=_a;Object.defineProperty(t,"AuthPlus",{enumerable:!0,get:function(){return c.AuthPlus}});var u=wa;Object.defineProperty(t,"Discovery",{enumerable:!0,get:function(){return u.Discovery}});var a=hn;Object.defineProperty(t,"Endpoint",{enumerable:!0,get:function(){return a.Endpoint}})})(Un);var Sl={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.calendar_v3=void 0;const e=Un;(function(r){class n{constructor(o,m){this.context={_options:o||{},google:m},this.acl=new s(this.context),this.calendarList=new c(this.context),this.calendars=new u(this.context),this.channels=new a(this.context),this.colors=new p(this.context),this.events=new f(this.context),this.freebusy=new A(this.context),this.settings=new C(this.context)}}r.Calendar=n;class s{constructor(o){this.context=o}delete(o,m,g){let S=o||{},i=m||{};typeof o=="function"&&(g=o,S={},i={}),typeof m=="function"&&(g=m,i={});const v=i.rootUrl||"https://www.googleapis.com/",E={options:Object.assign({url:(v+"/calendar/v3/calendars/{calendarId}/acl/{ruleId}").replace(/([^:]\/)\/+/g,"$1"),method:"DELETE"},i),params:S,requiredParams:["calendarId","ruleId"],pathParams:["calendarId","ruleId"],context:this.context};if(g)(0,e.createAPIRequest)(E,g);else return(0,e.createAPIRequest)(E)}get(o,m,g){let S=o||{},i=m||{};typeof o=="function"&&(g=o,S={},i={}),typeof m=="function"&&(g=m,i={});const v=i.rootUrl||"https://www.googleapis.com/",E={options:Object.assign({url:(v+"/calendar/v3/calendars/{calendarId}/acl/{ruleId}").replace(/([^:]\/)\/+/g,"$1"),method:"GET"},i),params:S,requiredParams:["calendarId","ruleId"],pathParams:["calendarId","ruleId"],context:this.context};if(g)(0,e.createAPIRequest)(E,g);else return(0,e.createAPIRequest)(E)}insert(o,m,g){let S=o||{},i=m||{};typeof o=="function"&&(g=o,S={},i={}),typeof m=="function"&&(g=m,i={});const v=i.rootUrl||"https://www.googleapis.com/",E={options:Object.assign({url:(v+"/calendar/v3/calendars/{calendarId}/acl").replace(/([^:]\/)\/+/g,"$1"),method:"POST"},i),params:S,requiredParams:["calendarId"],pathParams:["calendarId"],context:this.context};if(g)(0,e.createAPIRequest)(E,g);else return(0,e.createAPIRequest)(E)}list(o,m,g){let S=o||{},i=m||{};typeof o=="function"&&(g=o,S={},i={}),typeof m=="function"&&(g=m,i={});const v=i.rootUrl||"https://www.googleapis.com/",E={options:Object.assign({url:(v+"/calendar/v3/calendars/{calendarId}/acl").replace(/([^:]\/)\/+/g,"$1"),method:"GET"},i),params:S,requiredParams:["calendarId"],pathParams:["calendarId"],context:this.context};if(g)(0,e.createAPIRequest)(E,g);else return(0,e.createAPIRequest)(E)}patch(o,m,g){let S=o||{},i=m||{};typeof o=="function"&&(g=o,S={},i={}),typeof m=="function"&&(g=m,i={});const v=i.rootUrl||"https://www.googleapis.com/",E={options:Object.assign({url:(v+"/calendar/v3/calendars/{calendarId}/acl/{ruleId}").replace(/([^:]\/)\/+/g,"$1"),method:"PATCH"},i),params:S,requiredParams:["calendarId","ruleId"],pathParams:["calendarId","ruleId"],context:this.context};if(g)(0,e.createAPIRequest)(E,g);else return(0,e.createAPIRequest)(E)}update(o,m,g){let S=o||{},i=m||{};typeof o=="function"&&(g=o,S={},i={}),typeof m=="function"&&(g=m,i={});const v=i.rootUrl||"https://www.googleapis.com/",E={options:Object.assign({url:(v+"/calendar/v3/calendars/{calendarId}/acl/{ruleId}").replace(/([^:]\/)\/+/g,"$1"),method:"PUT"},i),params:S,requiredParams:["calendarId","ruleId"],pathParams:["calendarId","ruleId"],context:this.context};if(g)(0,e.createAPIRequest)(E,g);else return(0,e.createAPIRequest)(E)}watch(o,m,g){let S=o||{},i=m||{};typeof o=="function"&&(g=o,S={},i={}),typeof m=="function"&&(g=m,i={});const v=i.rootUrl||"https://www.googleapis.com/",E={options:Object.assign({url:(v+"/calendar/v3/calendars/{calendarId}/acl/watch").replace(/([^:]\/)\/+/g,"$1"),method:"POST"},i),params:S,requiredParams:["calendarId"],pathParams:["calendarId"],context:this.context};if(g)(0,e.createAPIRequest)(E,g);else return(0,e.createAPIRequest)(E)}}r.Resource$Acl=s;class c{constructor(o){this.context=o}delete(o,m,g){let S=o||{},i=m||{};typeof o=="function"&&(g=o,S={},i={}),typeof m=="function"&&(g=m,i={});const v=i.rootUrl||"https://www.googleapis.com/",E={options:Object.assign({url:(v+"/calendar/v3/users/me/calendarList/{calendarId}").replace(/([^:]\/)\/+/g,"$1"),method:"DELETE"},i),params:S,requiredParams:["calendarId"],pathParams:["calendarId"],context:this.context};if(g)(0,e.createAPIRequest)(E,g);else return(0,e.createAPIRequest)(E)}get(o,m,g){let S=o||{},i=m||{};typeof o=="function"&&(g=o,S={},i={}),typeof m=="function"&&(g=m,i={});const v=i.rootUrl||"https://www.googleapis.com/",E={options:Object.assign({url:(v+"/calendar/v3/users/me/calendarList/{calendarId}").replace(/([^:]\/)\/+/g,"$1"),method:"GET"},i),params:S,requiredParams:["calendarId"],pathParams:["calendarId"],context:this.context};if(g)(0,e.createAPIRequest)(E,g);else return(0,e.createAPIRequest)(E)}insert(o,m,g){let S=o||{},i=m||{};typeof o=="function"&&(g=o,S={},i={}),typeof m=="function"&&(g=m,i={});const v=i.rootUrl||"https://www.googleapis.com/",E={options:Object.assign({url:(v+"/calendar/v3/users/me/calendarList").replace(/([^:]\/)\/+/g,"$1"),method:"POST"},i),params:S,requiredParams:[],pathParams:[],context:this.context};if(g)(0,e.createAPIRequest)(E,g);else return(0,e.createAPIRequest)(E)}list(o,m,g){let S=o||{},i=m||{};typeof o=="function"&&(g=o,S={},i={}),typeof m=="function"&&(g=m,i={});const v=i.rootUrl||"https://www.googleapis.com/",E={options:Object.assign({url:(v+"/calendar/v3/users/me/calendarList").replace(/([^:]\/)\/+/g,"$1"),method:"GET"},i),params:S,requiredParams:[],pathParams:[],context:this.context};if(g)(0,e.createAPIRequest)(E,g);else return(0,e.createAPIRequest)(E)}patch(o,m,g){let S=o||{},i=m||{};typeof o=="function"&&(g=o,S={},i={}),typeof m=="function"&&(g=m,i={});const v=i.rootUrl||"https://www.googleapis.com/",E={options:Object.assign({url:(v+"/calendar/v3/users/me/calendarList/{calendarId}").replace(/([^:]\/)\/+/g,"$1"),method:"PATCH"},i),params:S,requiredParams:["calendarId"],pathParams:["calendarId"],context:this.context};if(g)(0,e.createAPIRequest)(E,g);else return(0,e.createAPIRequest)(E)}update(o,m,g){let S=o||{},i=m||{};typeof o=="function"&&(g=o,S={},i={}),typeof m=="function"&&(g=m,i={});const v=i.rootUrl||"https://www.googleapis.com/",E={options:Object.assign({url:(v+"/calendar/v3/users/me/calendarList/{calendarId}").replace(/([^:]\/)\/+/g,"$1"),method:"PUT"},i),params:S,requiredParams:["calendarId"],pathParams:["calendarId"],context:this.context};if(g)(0,e.createAPIRequest)(E,g);else return(0,e.createAPIRequest)(E)}watch(o,m,g){let S=o||{},i=m||{};typeof o=="function"&&(g=o,S={},i={}),typeof m=="function"&&(g=m,i={});const v=i.rootUrl||"https://www.googleapis.com/",E={options:Object.assign({url:(v+"/calendar/v3/users/me/calendarList/watch").replace(/([^:]\/)\/+/g,"$1"),method:"POST"},i),params:S,requiredParams:[],pathParams:[],context:this.context};if(g)(0,e.createAPIRequest)(E,g);else return(0,e.createAPIRequest)(E)}}r.Resource$Calendarlist=c;class u{constructor(o){this.context=o}clear(o,m,g){let S=o||{},i=m||{};typeof o=="function"&&(g=o,S={},i={}),typeof m=="function"&&(g=m,i={});const v=i.rootUrl||"https://www.googleapis.com/",E={options:Object.assign({url:(v+"/calendar/v3/calendars/{calendarId}/clear").replace(/([^:]\/)\/+/g,"$1"),method:"POST"},i),params:S,requiredParams:["calendarId"],pathParams:["calendarId"],context:this.context};if(g)(0,e.createAPIRequest)(E,g);else return(0,e.createAPIRequest)(E)}delete(o,m,g){let S=o||{},i=m||{};typeof o=="function"&&(g=o,S={},i={}),typeof m=="function"&&(g=m,i={});const v=i.rootUrl||"https://www.googleapis.com/",E={options:Object.assign({url:(v+"/calendar/v3/calendars/{calendarId}").replace(/([^:]\/)\/+/g,"$1"),method:"DELETE"},i),params:S,requiredParams:["calendarId"],pathParams:["calendarId"],context:this.context};if(g)(0,e.createAPIRequest)(E,g);else return(0,e.createAPIRequest)(E)}get(o,m,g){let S=o||{},i=m||{};typeof o=="function"&&(g=o,S={},i={}),typeof m=="function"&&(g=m,i={});const v=i.rootUrl||"https://www.googleapis.com/",E={options:Object.assign({url:(v+"/calendar/v3/calendars/{calendarId}").replace(/([^:]\/)\/+/g,"$1"),method:"GET"},i),params:S,requiredParams:["calendarId"],pathParams:["calendarId"],context:this.context};if(g)(0,e.createAPIRequest)(E,g);else return(0,e.createAPIRequest)(E)}insert(o,m,g){let S=o||{},i=m||{};typeof o=="function"&&(g=o,S={},i={}),typeof m=="function"&&(g=m,i={});const v=i.rootUrl||"https://www.googleapis.com/",E={options:Object.assign({url:(v+"/calendar/v3/calendars").replace(/([^:]\/)\/+/g,"$1"),method:"POST"},i),params:S,requiredParams:[],pathParams:[],context:this.context};if(g)(0,e.createAPIRequest)(E,g);else return(0,e.createAPIRequest)(E)}patch(o,m,g){let S=o||{},i=m||{};typeof o=="function"&&(g=o,S={},i={}),typeof m=="function"&&(g=m,i={});const v=i.rootUrl||"https://www.googleapis.com/",E={options:Object.assign({url:(v+"/calendar/v3/calendars/{calendarId}").replace(/([^:]\/)\/+/g,"$1"),method:"PATCH"},i),params:S,requiredParams:["calendarId"],pathParams:["calendarId"],context:this.context};if(g)(0,e.createAPIRequest)(E,g);else return(0,e.createAPIRequest)(E)}update(o,m,g){let S=o||{},i=m||{};typeof o=="function"&&(g=o,S={},i={}),typeof m=="function"&&(g=m,i={});const v=i.rootUrl||"https://www.googleapis.com/",E={options:Object.assign({url:(v+"/calendar/v3/calendars/{calendarId}").replace(/([^:]\/)\/+/g,"$1"),method:"PUT"},i),params:S,requiredParams:["calendarId"],pathParams:["calendarId"],context:this.context};if(g)(0,e.createAPIRequest)(E,g);else return(0,e.createAPIRequest)(E)}}r.Resource$Calendars=u;class a{constructor(o){this.context=o}stop(o,m,g){let S=o||{},i=m||{};typeof o=="function"&&(g=o,S={},i={}),typeof m=="function"&&(g=m,i={});const v=i.rootUrl||"https://www.googleapis.com/",E={options:Object.assign({url:(v+"/calendar/v3/channels/stop").replace(/([^:]\/)\/+/g,"$1"),method:"POST"},i),params:S,requiredParams:[],pathParams:[],context:this.context};if(g)(0,e.createAPIRequest)(E,g);else return(0,e.createAPIRequest)(E)}}r.Resource$Channels=a;class p{constructor(o){this.context=o}get(o,m,g){let S=o||{},i=m||{};typeof o=="function"&&(g=o,S={},i={}),typeof m=="function"&&(g=m,i={});const v=i.rootUrl||"https://www.googleapis.com/",E={options:Object.assign({url:(v+"/calendar/v3/colors").replace(/([^:]\/)\/+/g,"$1"),method:"GET"},i),params:S,requiredParams:[],pathParams:[],context:this.context};if(g)(0,e.createAPIRequest)(E,g);else return(0,e.createAPIRequest)(E)}}r.Resource$Colors=p;class f{constructor(o){this.context=o}delete(o,m,g){let S=o||{},i=m||{};typeof o=="function"&&(g=o,S={},i={}),typeof m=="function"&&(g=m,i={});const v=i.rootUrl||"https://www.googleapis.com/",E={options:Object.assign({url:(v+"/calendar/v3/calendars/{calendarId}/events/{eventId}").replace(/([^:]\/)\/+/g,"$1"),method:"DELETE"},i),params:S,requiredParams:["calendarId","eventId"],pathParams:["calendarId","eventId"],context:this.context};if(g)(0,e.createAPIRequest)(E,g);else return(0,e.createAPIRequest)(E)}get(o,m,g){let S=o||{},i=m||{};typeof o=="function"&&(g=o,S={},i={}),typeof m=="function"&&(g=m,i={});const v=i.rootUrl||"https://www.googleapis.com/",E={options:Object.assign({url:(v+"/calendar/v3/calendars/{calendarId}/events/{eventId}").replace(/([^:]\/)\/+/g,"$1"),method:"GET"},i),params:S,requiredParams:["calendarId","eventId"],pathParams:["calendarId","eventId"],context:this.context};if(g)(0,e.createAPIRequest)(E,g);else return(0,e.createAPIRequest)(E)}import(o,m,g){let S=o||{},i=m||{};typeof o=="function"&&(g=o,S={},i={}),typeof m=="function"&&(g=m,i={});const v=i.rootUrl||"https://www.googleapis.com/",E={options:Object.assign({url:(v+"/calendar/v3/calendars/{calendarId}/events/import").replace(/([^:]\/)\/+/g,"$1"),method:"POST"},i),params:S,requiredParams:["calendarId"],pathParams:["calendarId"],context:this.context};if(g)(0,e.createAPIRequest)(E,g);else return(0,e.createAPIRequest)(E)}insert(o,m,g){let S=o||{},i=m||{};typeof o=="function"&&(g=o,S={},i={}),typeof m=="function"&&(g=m,i={});const v=i.rootUrl||"https://www.googleapis.com/",E={options:Object.assign({url:(v+"/calendar/v3/calendars/{calendarId}/events").replace(/([^:]\/)\/+/g,"$1"),method:"POST"},i),params:S,requiredParams:["calendarId"],pathParams:["calendarId"],context:this.context};if(g)(0,e.createAPIRequest)(E,g);else return(0,e.createAPIRequest)(E)}instances(o,m,g){let S=o||{},i=m||{};typeof o=="function"&&(g=o,S={},i={}),typeof m=="function"&&(g=m,i={});const v=i.rootUrl||"https://www.googleapis.com/",E={options:Object.assign({url:(v+"/calendar/v3/calendars/{calendarId}/events/{eventId}/instances").replace(/([^:]\/)\/+/g,"$1"),method:"GET"},i),params:S,requiredParams:["calendarId","eventId"],pathParams:["calendarId","eventId"],context:this.context};if(g)(0,e.createAPIRequest)(E,g);else return(0,e.createAPIRequest)(E)}list(o,m,g){let S=o||{},i=m||{};typeof o=="function"&&(g=o,S={},i={}),typeof m=="function"&&(g=m,i={});const v=i.rootUrl||"https://www.googleapis.com/",E={options:Object.assign({url:(v+"/calendar/v3/calendars/{calendarId}/events").replace(/([^:]\/)\/+/g,"$1"),method:"GET"},i),params:S,requiredParams:["calendarId"],pathParams:["calendarId"],context:this.context};if(g)(0,e.createAPIRequest)(E,g);else return(0,e.createAPIRequest)(E)}move(o,m,g){let S=o||{},i=m||{};typeof o=="function"&&(g=o,S={},i={}),typeof m=="function"&&(g=m,i={});const v=i.rootUrl||"https://www.googleapis.com/",E={options:Object.assign({url:(v+"/calendar/v3/calendars/{calendarId}/events/{eventId}/move").replace(/([^:]\/)\/+/g,"$1"),method:"POST"},i),params:S,requiredParams:["calendarId","eventId","destination"],pathParams:["calendarId","eventId"],context:this.context};if(g)(0,e.createAPIRequest)(E,g);else return(0,e.createAPIRequest)(E)}patch(o,m,g){let S=o||{},i=m||{};typeof o=="function"&&(g=o,S={},i={}),typeof m=="function"&&(g=m,i={});const v=i.rootUrl||"https://www.googleapis.com/",E={options:Object.assign({url:(v+"/calendar/v3/calendars/{calendarId}/events/{eventId}").replace(/([^:]\/)\/+/g,"$1"),method:"PATCH"},i),params:S,requiredParams:["calendarId","eventId"],pathParams:["calendarId","eventId"],context:this.context};if(g)(0,e.createAPIRequest)(E,g);else return(0,e.createAPIRequest)(E)}quickAdd(o,m,g){let S=o||{},i=m||{};typeof o=="function"&&(g=o,S={},i={}),typeof m=="function"&&(g=m,i={});const v=i.rootUrl||"https://www.googleapis.com/",E={options:Object.assign({url:(v+"/calendar/v3/calendars/{calendarId}/events/quickAdd").replace(/([^:]\/)\/+/g,"$1"),method:"POST"},i),params:S,requiredParams:["calendarId","text"],pathParams:["calendarId"],context:this.context};if(g)(0,e.createAPIRequest)(E,g);else return(0,e.createAPIRequest)(E)}update(o,m,g){let S=o||{},i=m||{};typeof o=="function"&&(g=o,S={},i={}),typeof m=="function"&&(g=m,i={});const v=i.rootUrl||"https://www.googleapis.com/",E={options:Object.assign({url:(v+"/calendar/v3/calendars/{calendarId}/events/{eventId}").replace(/([^:]\/)\/+/g,"$1"),method:"PUT"},i),params:S,requiredParams:["calendarId","eventId"],pathParams:["calendarId","eventId"],context:this.context};if(g)(0,e.createAPIRequest)(E,g);else return(0,e.createAPIRequest)(E)}watch(o,m,g){let S=o||{},i=m||{};typeof o=="function"&&(g=o,S={},i={}),typeof m=="function"&&(g=m,i={});const v=i.rootUrl||"https://www.googleapis.com/",E={options:Object.assign({url:(v+"/calendar/v3/calendars/{calendarId}/events/watch").replace(/([^:]\/)\/+/g,"$1"),method:"POST"},i),params:S,requiredParams:["calendarId"],pathParams:["calendarId"],context:this.context};if(g)(0,e.createAPIRequest)(E,g);else return(0,e.createAPIRequest)(E)}}r.Resource$Events=f;class A{constructor(o){this.context=o}query(o,m,g){let S=o||{},i=m||{};typeof o=="function"&&(g=o,S={},i={}),typeof m=="function"&&(g=m,i={});const v=i.rootUrl||"https://www.googleapis.com/",E={options:Object.assign({url:(v+"/calendar/v3/freeBusy").replace(/([^:]\/)\/+/g,"$1"),method:"POST"},i),params:S,requiredParams:[],pathParams:[],context:this.context};if(g)(0,e.createAPIRequest)(E,g);else return(0,e.createAPIRequest)(E)}}r.Resource$Freebusy=A;class C{constructor(o){this.context=o}get(o,m,g){let S=o||{},i=m||{};typeof o=="function"&&(g=o,S={},i={}),typeof m=="function"&&(g=m,i={});const v=i.rootUrl||"https://www.googleapis.com/",E={options:Object.assign({url:(v+"/calendar/v3/users/me/settings/{setting}").replace(/([^:]\/)\/+/g,"$1"),method:"GET"},i),params:S,requiredParams:["setting"],pathParams:["setting"],context:this.context};if(g)(0,e.createAPIRequest)(E,g);else return(0,e.createAPIRequest)(E)}list(o,m,g){let S=o||{},i=m||{};typeof o=="function"&&(g=o,S={},i={}),typeof m=="function"&&(g=m,i={});const v=i.rootUrl||"https://www.googleapis.com/",E={options:Object.assign({url:(v+"/calendar/v3/users/me/settings").replace(/([^:]\/)\/+/g,"$1"),method:"GET"},i),params:S,requiredParams:[],pathParams:[],context:this.context};if(g)(0,e.createAPIRequest)(E,g);else return(0,e.createAPIRequest)(E)}watch(o,m,g){let S=o||{},i=m||{};typeof o=="function"&&(g=o,S={},i={}),typeof m=="function"&&(g=m,i={});const v=i.rootUrl||"https://www.googleapis.com/",E={options:Object.assign({url:(v+"/calendar/v3/users/me/settings/watch").replace(/([^:]\/)\/+/g,"$1"),method:"POST"},i),params:S,requiredParams:[],pathParams:[],context:this.context};if(g)(0,e.createAPIRequest)(E,g);else return(0,e.createAPIRequest)(E)}}r.Resource$Settings=C})(t.calendar_v3||(t.calendar_v3={}))})(Sl);(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.AuthPlus=t.calendar_v3=t.auth=t.calendar=t.VERSIONS=void 0;/*! THIS FILE IS AUTO-GENERATED */const e=Un,r=Sl;Object.defineProperty(t,"calendar_v3",{enumerable:!0,get:function(){return r.calendar_v3}}),t.VERSIONS={v3:r.calendar_v3.Calendar};function n(u){return(0,e.getAPI)("calendar",u,t.VERSIONS,this)}t.calendar=n;const s=new e.AuthPlus;t.auth=s;var c=Un;Object.defineProperty(t,"AuthPlus",{enumerable:!0,get:function(){return c.AuthPlus}})})(zi);const Hi="tokens",Nn="connected_calendars",kc="channels",Dc="last_sync",Xg=jl("google-calendar",t=>{const e=`${t.pluginSlug}-get-events`,r=`${t.pluginSlug}-calendars-sync`,n=`${t.pluginSlug}-upsert-item-from-event`,s=`${t.pluginSlug}-process-events-webhook`,c=`flow-${t.pluginSlug}-events-webhook`,u=async()=>{const p=await t.store.getPluginItem(Hi);if(!p)throw new Error("NOT_AUTHENTICATED: You are not authenticated and will need to connect your Google account first.");if(t.dayjs().isAfter(p.value.expires_at)){const f=await fetch("https://google-calendar-api-flow-dev.vercel.app/api/auth/refresh?refresh_token="+p.value.refresh_token);if(!f.ok)throw new Error("COULD_NOT_REFRESH_TOKEN: Could not refresh token.");const A=await f.json(),C={...A,refresh_token:p.value.refresh_token,expires_at:t.dayjs().add((A.expires_in??10)-10,"seconds").toISOString()};return await t.store.setSecretItem(Hi,C),C}return p.value},a=async()=>{const p=await u(),f=new zi.auth.OAuth2;return f.setCredentials(p),zi.calendar({version:"v3",auth:f})};return{onRequest:async(p,f)=>{var A;if(p.path==="/auth")return f.redirect(`https://google-calendar-api-flow-dev.vercel.app/api/auth?api_endpoint=${t.serverOrigin}/api/plugin/${t.pluginSlug}/auth/callback`);if(p.path==="/auth/callback"&&p.method==="POST"){const C={...p.body,expires_at:t.dayjs().add((p.body.expires_in??10)-10,"seconds").toISOString()};return delete C.expires_in,await t.store.setSecretItem(Hi,C),f.status(200).send()}else if(p.path==="/events/webhook"&&p.method==="POST"){const C=p.headers["x-goog-resource-uri"],y=(A=C.match(/\/calendars\/(.*)\/events/))==null?void 0:A[1];if(!y)return console.log("❌ Could not find calendarId in x-goog-resource-uri header",C),f.status(200).send();const o=decodeURIComponent(y);return await t.pgBoss.send(s,{calendarId:o}),f.status(200).send()}},operations:{calendars:async()=>{var y;const f=await(await a()).calendarList.list(),A=await t.store.getPluginItem(Nn),C=new Set((A==null?void 0:A.value)??[]);return{data:((y=f.data.items)==null?void 0:y.map(o=>({...o,connected:C.has(o.id??"")})))??[]}},connectCalendars:async p=>{var g,S,i,v;const f=await a(),A=await f.calendarList.list(),C=await t.store.getPluginItem(Nn),y=new Set((C==null?void 0:C.value)??[]),o=await t.store.getPluginItem(kc),m=new Map(((g=o==null?void 0:o.value)==null?void 0:g.map(E=>[E.calendarId,E]))??[]);for(const E of p.calendarIds){if(y.has(E)||!((S=A.data.items)!=null&&S.some(B=>B.id===E)))continue;y.add(E),await t.pgBoss.send(e,{calendarId:E,days:7});const I=await f.events.watch({calendarId:E,requestBody:{id:c,type:"web_hook",address:`${t.serverOrigin}/api/plugin/${t.pluginSlug}/events/webhook`}});console.log("✔ Set up webhook for calendar",E),m.set(E,{calendarId:E,id:I.data.id??c,resourceId:I.data.resourceId,expires_at:t.dayjs(I.data.expiration??0).toISOString()})}for(const E of((i=A.data.items)==null?void 0:i.map(I=>I.id))??[]){if(!E||p.calendarIds.includes(E))continue;y.delete(E);const I=m.get(E);I&&(await f.channels.stop({requestBody:{id:I.id,resourceId:I.resourceId}}),console.log("✔ Removed webhook for calendar",E),m.delete(E))}return await t.store.setItem(Nn,Array.from(y)),await t.store.setItem(kc,Array.from(m.values())),await t.pgBoss.schedule(r,"0 0 */3 * *",{calendarIds:p.calendarIds}),console.log("✔ Scheduled calendars sync job"),{operationName:"calendars",data:((v=A.data.items)==null?void 0:v.map(E=>({...E,connected:y.has(E.id??"")})))??[]}},refreshEvents:async p=>{const f=await t.store.getPluginItem(Nn);return await t.pgBoss.send(r,{calendarIds:(f==null?void 0:f.value)??[],days:p.days??7}),{data:"Job sent to refresh events."}}},handlePgBossWork:p=>[p(n,{batchSize:5},async f=>{var A,C,y,o,m,g,S,i;for(const v of f){const E=v.data,I=await t.prisma.item.findFirst({where:{pluginDatas:{some:{originalId:E.id,pluginSlug:t.pluginSlug}}},include:{pluginDatas:{where:{originalId:E.id,pluginSlug:t.pluginSlug},select:{id:!0}}}});if(E.status==="cancelled"&&I){try{await t.prisma.itemPluginData.delete({where:{id:(A=I.pluginDatas[0])==null?void 0:A.id}}),await t.prisma.item.delete({where:{id:I.id}})}catch(l){console.log("Error deleting item and it's dependencies:",l)}console.log("✔ Deleted item from event",I.title,I.scheduledAt);continue}const B={title:E.summary??"No title",color:E.calendarColor?t.getNearestItemColor(E.calendarColor):null,isAllDay:!!((C=E.start)!=null&&C.date),scheduledAt:((y=E.start)==null?void 0:y.dateTime)??null,durationInMinutes:t.dayjs((o=E.end)==null?void 0:o.dateTime).diff((m=E.start)==null?void 0:m.dateTime,"minute"),isRelevant:!0},T={status:E.status,htmlLink:E.htmlLink,numOfAttendees:((g=E.attendees)==null?void 0:g.length)??0},h={...T,description:E.description,attendees:E.attendees,eventType:E.eventType,organizer:E.organizer,hangoutLink:E.hangoutLink,conferenceData:E.conferenceData,backgroundColor:E.calendarColor};I?await t.prisma.item.update({where:{id:I.id},data:{...B,pluginDatas:{update:{where:{id:(S=I.pluginDatas[0])==null?void 0:S.id},data:{min:T,full:h}}}}}):await t.prisma.item.create({data:{...B,pluginDatas:{create:{pluginSlug:t.pluginSlug,originalId:E.id,min:T,full:h}}}}),console.log("✔ Upserted item from event",E.summary,(i=E.start)==null?void 0:i.dateTime)}}),p(e,async f=>{var m,g;const A=f.data,C=await a(),y=await C.calendarList.get({calendarId:A.calendarId}),o=await C.events.list({calendarId:A.calendarId,timeMin:t.dayjs().startOf("day").toISOString(),timeMax:t.dayjs().add(A.days??7,"day").toISOString(),singleEvents:!0,orderBy:"startTime"});console.log(((m=o.data.items)==null?void 0:m.length)??0,((g=o.data.items)==null?void 0:g.length)===1?"event":"events","to process from initial sync of calendar",A.calendarId);for(const S of o.data.items??[])await t.pgBoss.send(n,{...S,calendarColor:y.data.backgroundColor??null})}),p(s,async f=>{var S,i;const A=f.data,C=await t.store.getPluginItem(Dc),y=C!=null&&C.value?t.dayjs(C.value):null,o=await a(),m=await o.calendarList.get({calendarId:A.calendarId}),g=await o.events.list({calendarId:A.calendarId,updatedMin:(y==null?void 0:y.toISOString())??t.dayjs().subtract(10,"minute").toISOString(),singleEvents:!0,orderBy:"updated"});console.log(((S=g.data.items)==null?void 0:S.length)??0,((i=g.data.items)==null?void 0:i.length)===1?"event":"events","to process from webhook of calendar",A.calendarId);for(const v of g.data.items??[])await t.pgBoss.send(n,{...v,calendarColor:m.data.backgroundColor??null});await t.store.setServerOnlyItem(Dc,t.dayjs().toISOString())}),p(r,async f=>{const A=f.data;for(const C of A.calendarIds)await t.pgBoss.send(e,{calendarId:C,days:A.days??7})})]}});module.exports=Xg;
