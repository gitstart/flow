"use strict";const Lu=require("child_process"),nr=require("fs"),Fl=require("https"),Hn=require("querystring"),zn=require("url"),Ml=require("net"),ql=require("tls"),Vl=require("assert"),Du=require("events"),Fu=require("os"),Mu=require("path"),Qr=require("crypto"),Nt=require("stream"),Wn=require("buffer"),Pt=require("util"),Kl=require("http2"),$l=require("zlib"),Gl=require("process"),jl=(t,e)=>({slug:t,plugin:e});var Re=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Hl(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var r=function n(){if(this instanceof n){var s=[null];s.push.apply(s,arguments);var u=Function.bind.apply(e,s);return new u}return e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(n){var s=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(r,n,s.get?s:{enumerable:!0,get:function(){return t[n]}})}),r}var qu={},kn={},Yr={},Sr={},Qn={},At={},Yn={},Un=Object.prototype.hasOwnProperty,Vu=Object.prototype.toString,Us=Object.defineProperty,Os=Object.getOwnPropertyDescriptor,ks=function(e){return typeof Array.isArray=="function"?Array.isArray(e):Vu.call(e)==="[object Array]"},Ls=function(e){if(!e||Vu.call(e)!=="[object Object]")return!1;var r=Un.call(e,"constructor"),n=e.constructor&&e.constructor.prototype&&Un.call(e.constructor.prototype,"isPrototypeOf");if(e.constructor&&!r&&!n)return!1;var s;for(s in e);return typeof s>"u"||Un.call(e,s)},Ds=function(e,r){Us&&r.name==="__proto__"?Us(e,r.name,{enumerable:!0,configurable:!0,value:r.newValue,writable:!0}):e[r.name]=r.newValue},Fs=function(e,r){if(r==="__proto__")if(Un.call(e,r)){if(Os)return Os(e,r).value}else return;return e[r]},os=function t(){var e,r,n,s,u,c,i=arguments[0],y=1,f=arguments.length,A=!1;for(typeof i=="boolean"&&(A=i,i=arguments[1]||{},y=2),(i==null||typeof i!="object"&&typeof i!="function")&&(i={});y<f;++y)if(e=arguments[y],e!=null)for(r in e)n=Fs(i,r),s=Fs(e,r),i!==s&&(A&&s&&(Ls(s)||(u=ks(s)))?(u?(u=!1,c=n&&ks(n)?n:[]):c=n&&Ls(n)?n:{},Ds(i,{name:r,newValue:t(A,c,s)})):typeof s<"u"&&Ds(i,{name:r,newValue:s}));return i},Wa={exports:{}};(function(t,e){var r=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof Re<"u")return Re;throw new Error("unable to locate global object")},n=r();t.exports=e=n.fetch,n.fetch&&(e.default=n.fetch.bind(n)),e.Headers=n.Headers,e.Request=n.Request,e.Response=n.Response})(Wa,Wa.exports);var zl=Wa.exports;const Ct=t=>t!==null&&typeof t=="object"&&typeof t.pipe=="function";Ct.writable=t=>Ct(t)&&t.writable!==!1&&typeof t._write=="function"&&typeof t._writableState=="object";Ct.readable=t=>Ct(t)&&t.readable!==!1&&typeof t._read=="function"&&typeof t._readableState=="object";Ct.duplex=t=>Ct.writable(t)&&Ct.readable(t);Ct.transform=t=>Ct.duplex(t)&&typeof t._transform=="function";var Wl=Ct,Ir={};Object.defineProperty(Ir,"__esModule",{value:!0});Ir.GaxiosError=void 0;class Ql extends Error{constructor(e,r,n){super(e),this.response=n,this.config=r,this.code=n.status.toString()}}Ir.GaxiosError=Ql;var Jn={};Object.defineProperty(Jn,"__esModule",{value:!0});Jn.getRetryConfig=void 0;async function Yl(t){var e;let r=Ku(t);if(!t||!t.config||!r&&!t.config.retry)return{shouldRetry:!1};r=r||{},r.currentRetryAttempt=r.currentRetryAttempt||0,r.retry=r.retry===void 0||r.retry===null?3:r.retry,r.httpMethodsToRetry=r.httpMethodsToRetry||["GET","HEAD","PUT","OPTIONS","DELETE"],r.noResponseRetries=r.noResponseRetries===void 0||r.noResponseRetries===null?2:r.noResponseRetries;const n=[[100,199],[429,429],[500,599]];if(r.statusCodesToRetry=r.statusCodesToRetry||n,t.config.retryConfig=r,!await(r.shouldRetry||Jl)(t))return{shouldRetry:!1,config:t.config};const c=(r.currentRetryAttempt?0:(e=r.retryDelay)!==null&&e!==void 0?e:100)+(Math.pow(2,r.currentRetryAttempt)-1)/2*1e3;t.config.retryConfig.currentRetryAttempt+=1;const i=r.retryBackoff?r.retryBackoff(t,c):new Promise(y=>{setTimeout(y,c)});return r.onRetryAttempt&&r.onRetryAttempt(t),await i,{shouldRetry:!0,config:t.config}}Jn.getRetryConfig=Yl;function Jl(t){const e=Ku(t);if(t.name==="AbortError"||!e||e.retry===0||!t.response&&(e.currentRetryAttempt||0)>=e.noResponseRetries||!t.config.method||e.httpMethodsToRetry.indexOf(t.config.method.toUpperCase())<0)return!1;if(t.response&&t.response.status){let r=!1;for(const[n,s]of e.statusCodesToRetry){const u=t.response.status;if(u>=n&&u<=s){r=!0;break}}if(!r)return!1}return e.currentRetryAttempt=e.currentRetryAttempt||0,!(e.currentRetryAttempt>=e.retry)}function Ku(t){if(t&&t.config&&t.config.retryConfig)return t.config.retryConfig}var mn={},En={exports:{}},Ri,Ms;function Xl(){if(Ms)return Ri;Ms=1;var t=1e3,e=t*60,r=e*60,n=r*24,s=n*7,u=n*365.25;Ri=function(A,C){C=C||{};var p=typeof A;if(p==="string"&&A.length>0)return c(A);if(p==="number"&&isFinite(A))return C.long?y(A):i(A);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(A))};function c(A){if(A=String(A),!(A.length>100)){var C=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(A);if(C){var p=parseFloat(C[1]),o=(C[2]||"ms").toLowerCase();switch(o){case"years":case"year":case"yrs":case"yr":case"y":return p*u;case"weeks":case"week":case"w":return p*s;case"days":case"day":case"d":return p*n;case"hours":case"hour":case"hrs":case"hr":case"h":return p*r;case"minutes":case"minute":case"mins":case"min":case"m":return p*e;case"seconds":case"second":case"secs":case"sec":case"s":return p*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return p;default:return}}}}function i(A){var C=Math.abs(A);return C>=n?Math.round(A/n)+"d":C>=r?Math.round(A/r)+"h":C>=e?Math.round(A/e)+"m":C>=t?Math.round(A/t)+"s":A+"ms"}function y(A){var C=Math.abs(A);return C>=n?f(A,C,n,"day"):C>=r?f(A,C,r,"hour"):C>=e?f(A,C,e,"minute"):C>=t?f(A,C,t,"second"):A+" ms"}function f(A,C,p,o){var m=C>=p*1.5;return Math.round(A/p)+" "+o+(m?"s":"")}return Ri}var Bi,qs;function Zl(){if(qs)return Bi;qs=1;function t(e){n.debug=n,n.default=n,n.coerce=f,n.disable=c,n.enable=u,n.enabled=i,n.humanize=Xl(),n.destroy=A,Object.keys(e).forEach(C=>{n[C]=e[C]}),n.names=[],n.skips=[],n.formatters={};function r(C){let p=0;for(let o=0;o<C.length;o++)p=(p<<5)-p+C.charCodeAt(o),p|=0;return n.colors[Math.abs(p)%n.colors.length]}n.selectColor=r;function n(C){let p,o=null,m,g;function S(...a){if(!S.enabled)return;const v=S,E=Number(new Date),b=E-(p||E);v.diff=b,v.prev=p,v.curr=E,p=E,a[0]=n.coerce(a[0]),typeof a[0]!="string"&&a.unshift("%O");let R=0;a[0]=a[0].replace(/%([a-zA-Z%])/g,(h,l)=>{if(h==="%%")return"%";R++;const B=n.formatters[l];if(typeof B=="function"){const N=a[R];h=B.call(v,N),a.splice(R,1),R--}return h}),n.formatArgs.call(v,a),(v.log||n.log).apply(v,a)}return S.namespace=C,S.useColors=n.useColors(),S.color=n.selectColor(C),S.extend=s,S.destroy=n.destroy,Object.defineProperty(S,"enabled",{enumerable:!0,configurable:!1,get:()=>o!==null?o:(m!==n.namespaces&&(m=n.namespaces,g=n.enabled(C)),g),set:a=>{o=a}}),typeof n.init=="function"&&n.init(S),S}function s(C,p){const o=n(this.namespace+(typeof p>"u"?":":p)+C);return o.log=this.log,o}function u(C){n.save(C),n.namespaces=C,n.names=[],n.skips=[];let p;const o=(typeof C=="string"?C:"").split(/[\s,]+/),m=o.length;for(p=0;p<m;p++)o[p]&&(C=o[p].replace(/\*/g,".*?"),C[0]==="-"?n.skips.push(new RegExp("^"+C.slice(1)+"$")):n.names.push(new RegExp("^"+C+"$")))}function c(){const C=[...n.names.map(y),...n.skips.map(y).map(p=>"-"+p)].join(",");return n.enable(""),C}function i(C){if(C[C.length-1]==="*")return!0;let p,o;for(p=0,o=n.skips.length;p<o;p++)if(n.skips[p].test(C))return!1;for(p=0,o=n.names.length;p<o;p++)if(n.names[p].test(C))return!0;return!1}function y(C){return C.toString().substring(2,C.toString().length-2).replace(/\.\*\?$/,"*")}function f(C){return C instanceof Error?C.stack||C.message:C}function A(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return n.enable(n.load()),n}return Bi=t,Bi}var Vs;function us(){return Vs||(Vs=1,function(t,e){e.formatArgs=n,e.save=s,e.load=u,e.useColors=r,e.storage=c(),e.destroy=(()=>{let y=!1;return()=>{y||(y=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function r(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function n(y){if(y[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+y[0]+(this.useColors?"%c ":" ")+"+"+t.exports.humanize(this.diff),!this.useColors)return;const f="color: "+this.color;y.splice(1,0,f,"color: inherit");let A=0,C=0;y[0].replace(/%[a-zA-Z%]/g,p=>{p!=="%%"&&(A++,p==="%c"&&(C=A))}),y.splice(C,0,f)}e.log=console.debug||console.log||(()=>{});function s(y){try{y?e.storage.setItem("debug",y):e.storage.removeItem("debug")}catch{}}function u(){let y;try{y=e.storage.getItem("debug")}catch{}return!y&&typeof process<"u"&&"env"in process&&(y=process.env.DEBUG),y}function c(){try{return localStorage}catch{}}t.exports=Zl()(e);const{formatters:i}=t.exports;i.j=function(y){try{return JSON.stringify(y)}catch(f){return"[UnexpectedJSONParseError]: "+f.message}}}(En,En.exports)),En.exports}var Cn={},Ks;function ef(){if(Ks)return Cn;Ks=1,Object.defineProperty(Cn,"__esModule",{value:!0});function t(e){return function(r,n){return new Promise((s,u)=>{e.call(this,r,n,(c,i)=>{c?u(c):s(i)})})}}return Cn.default=t,Cn}var Ni,$s;function tf(){if($s)return Ni;$s=1;var t=Re&&Re.__importDefault||function(y){return y&&y.__esModule?y:{default:y}};const e=Du,r=t(us()),n=t(ef()),s=r.default("agent-base");function u(y){return!!y&&typeof y.addRequest=="function"}function c(){const{stack:y}=new Error;return typeof y!="string"?!1:y.split(`
`).some(f=>f.indexOf("(https.js:")!==-1||f.indexOf("node:https:")!==-1)}function i(y,f){return new i.Agent(y,f)}return function(y){class f extends e.EventEmitter{constructor(C,p){super();let o=p;typeof C=="function"?this.callback=C:C&&(o=C),this.timeout=null,o&&typeof o.timeout=="number"&&(this.timeout=o.timeout),this.maxFreeSockets=1,this.maxSockets=1,this.maxTotalSockets=1/0,this.sockets={},this.freeSockets={},this.requests={},this.options={}}get defaultPort(){return typeof this.explicitDefaultPort=="number"?this.explicitDefaultPort:c()?443:80}set defaultPort(C){this.explicitDefaultPort=C}get protocol(){return typeof this.explicitProtocol=="string"?this.explicitProtocol:c()?"https:":"http:"}set protocol(C){this.explicitProtocol=C}callback(C,p,o){throw new Error('"agent-base" has no default implementation, you must subclass and override `callback()`')}addRequest(C,p){const o=Object.assign({},p);typeof o.secureEndpoint!="boolean"&&(o.secureEndpoint=c()),o.host==null&&(o.host="localhost"),o.port==null&&(o.port=o.secureEndpoint?443:80),o.protocol==null&&(o.protocol=o.secureEndpoint?"https:":"http:"),o.host&&o.path&&delete o.path,delete o.agent,delete o.hostname,delete o._defaultAgent,delete o.defaultPort,delete o.createConnection,C._last=!0,C.shouldKeepAlive=!1;let m=!1,g=null;const S=o.timeout||this.timeout,a=R=>{C._hadError||(C.emit("error",R),C._hadError=!0)},v=()=>{g=null,m=!0;const R=new Error(`A "socket" was not created for HTTP request before ${S}ms`);R.code="ETIMEOUT",a(R)},E=R=>{m||(g!==null&&(clearTimeout(g),g=null),a(R))},b=R=>{if(m)return;if(g!=null&&(clearTimeout(g),g=null),u(R)){s("Callback returned another Agent instance %o",R.constructor.name),R.addRequest(C,o);return}if(R){R.once("free",()=>{this.freeSocket(R,o)}),C.onSocket(R);return}const T=new Error(`no Duplex stream was returned to agent-base for \`${C.method} ${C.path}\``);a(T)};if(typeof this.callback!="function"){a(new Error("`callback` is not defined"));return}this.promisifiedCallback||(this.callback.length>=3?(s("Converting legacy callback function to promise"),this.promisifiedCallback=n.default(this.callback)):this.promisifiedCallback=this.callback),typeof S=="number"&&S>0&&(g=setTimeout(v,S)),"port"in o&&typeof o.port!="number"&&(o.port=Number(o.port));try{s("Resolving socket for %o request: %o",o.protocol,`${C.method} ${C.path}`),Promise.resolve(this.promisifiedCallback(C,o)).then(b,E)}catch(R){Promise.reject(R).catch(E)}}freeSocket(C,p){s("Freeing socket %o %o",C.constructor.name,p),C.destroy()}destroy(){s("Destroying agent %o",this.constructor.name)}}y.Agent=f,y.prototype=y.Agent.prototype}(i||(i={})),Ni=i,Ni}var Sn={},Gs;function rf(){if(Gs)return Sn;Gs=1;var t=Re&&Re.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(Sn,"__esModule",{value:!0});const r=t(us()).default("https-proxy-agent:parse-proxy-response");function n(s){return new Promise((u,c)=>{let i=0;const y=[];function f(){const g=s.read();g?m(g):s.once("readable",f)}function A(){s.removeListener("end",p),s.removeListener("error",o),s.removeListener("close",C),s.removeListener("readable",f)}function C(g){r("onclose had error %o",g)}function p(){r("onend")}function o(g){A(),r("onerror %o",g),c(g)}function m(g){y.push(g),i+=g.length;const S=Buffer.concat(y,i);if(S.indexOf(`\r
\r
`)===-1){r("have not received end of HTTP headers yet..."),f();return}const v=S.toString("ascii",0,S.indexOf(`\r
`)),E=+v.split(" ")[1];r("got proxy server response: %o",v),u({statusCode:E,buffered:S})}s.on("error",o),s.on("close",C),s.on("end",p),f()})}return Sn.default=n,Sn}var js;function nf(){if(js)return mn;js=1;var t=Re&&Re.__awaiter||function(g,S,a,v){function E(b){return b instanceof a?b:new a(function(R){R(b)})}return new(a||(a=Promise))(function(b,R){function T(B){try{l(v.next(B))}catch(N){R(N)}}function h(B){try{l(v.throw(B))}catch(N){R(N)}}function l(B){B.done?b(B.value):E(B.value).then(T,h)}l((v=v.apply(g,S||[])).next())})},e=Re&&Re.__importDefault||function(g){return g&&g.__esModule?g:{default:g}};Object.defineProperty(mn,"__esModule",{value:!0});const r=e(Ml),n=e(ql),s=e(zn),u=e(Vl),c=e(us()),i=tf(),y=e(rf()),f=c.default("https-proxy-agent:agent");class A extends i.Agent{constructor(S){let a;if(typeof S=="string"?a=s.default.parse(S):a=S,!a)throw new Error("an HTTP(S) proxy server `host` and `port` must be specified!");f("creating new HttpsProxyAgent instance: %o",a),super(a);const v=Object.assign({},a);this.secureProxy=a.secureProxy||o(v.protocol),v.host=v.hostname||v.host,typeof v.port=="string"&&(v.port=parseInt(v.port,10)),!v.port&&v.host&&(v.port=this.secureProxy?443:80),this.secureProxy&&!("ALPNProtocols"in v)&&(v.ALPNProtocols=["http 1.1"]),v.host&&v.path&&(delete v.path,delete v.pathname),this.proxy=v}callback(S,a){return t(this,void 0,void 0,function*(){const{proxy:v,secureProxy:E}=this;let b;E?(f("Creating `tls.Socket`: %o",v),b=n.default.connect(v)):(f("Creating `net.Socket`: %o",v),b=r.default.connect(v));const R=Object.assign({},v.headers);let h=`CONNECT ${`${a.host}:${a.port}`} HTTP/1.1\r
`;v.auth&&(R["Proxy-Authorization"]=`Basic ${Buffer.from(v.auth).toString("base64")}`);let{host:l,port:B,secureEndpoint:N}=a;p(B,N)||(l+=`:${B}`),R.Host=l,R.Connection="close";for(const H of Object.keys(R))h+=`${H}: ${R[H]}\r
`;const F=y.default(b);b.write(`${h}\r
`);const{statusCode:L,buffered:q}=yield F;if(L===200){if(S.once("socket",C),a.secureEndpoint){f("Upgrading socket connection to TLS");const H=a.servername||a.host;return n.default.connect(Object.assign(Object.assign({},m(a,"host","hostname","path","port")),{socket:b,servername:H}))}return b}b.destroy();const j=new r.default.Socket({writable:!1});return j.readable=!0,S.once("socket",H=>{f("replaying proxy buffer for failed request"),u.default(H.listenerCount("data")>0),H.push(q),H.push(null)}),j})}}mn.default=A;function C(g){g.resume()}function p(g,S){return!!(!S&&g===80||S&&g===443)}function o(g){return typeof g=="string"?/^https:?$/i.test(g):!1}function m(g,...S){const a={};let v;for(v in g)S.includes(v)||(a[v]=g[v]);return a}return mn}var Pi,Hs;function af(){if(Hs)return Pi;Hs=1;var t=Re&&Re.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};const e=t(nf());function r(n){return new e.default(n)}return function(n){n.HttpsProxyAgent=e.default,n.prototype=e.default.prototype}(r||(r={})),Pi=r,Pi}var Xn=Re&&Re.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Yn,"__esModule",{value:!0});Yn.Gaxios=void 0;const sf=Xn(os),of=Fl,uf=Xn(zl),cf=Xn(Hn),lf=Xn(Wl),$u=zn,ff=Ir,df=Jn,hf=yf()?window.fetch:uf.default;function pf(){return typeof window<"u"&&!!window}function yf(){return pf()&&!!window.fetch}function gf(){return typeof Buffer<"u"}function zs(t,e){return!!Gu(t,e)}function Gu(t,e){e=e.toLowerCase();for(const r of Object.keys((t==null?void 0:t.headers)||{}))if(e===r.toLowerCase())return t.headers[r]}let Qa;function ju(){var t,e,r,n;const s=((t=process==null?void 0:process.env)===null||t===void 0?void 0:t.HTTPS_PROXY)||((e=process==null?void 0:process.env)===null||e===void 0?void 0:e.https_proxy)||((r=process==null?void 0:process.env)===null||r===void 0?void 0:r.HTTP_PROXY)||((n=process==null?void 0:process.env)===null||n===void 0?void 0:n.http_proxy);return s&&(Qa=af()),s}ju();function vf(t){var e;const r=(e=process.env.NO_PROXY)!==null&&e!==void 0?e:process.env.no_proxy;if(!r)return!1;const n=r.split(","),s=new $u.URL(t);return!!n.find(u=>u.startsWith("*.")||u.startsWith(".")?(u=u.replace(/^\*\./,"."),s.hostname.endsWith(u)):u===s.origin||u===s.hostname)}function mf(t){if(!vf(t))return ju()}class Ef{constructor(e){this.agentCache=new Map,this.defaults=e||{}}async request(e={}){return e=this.validateOpts(e),this._request(e)}async _defaultAdapter(e){const n=await(e.fetchImplementation||hf)(e.url,e),s=await this.getResponseData(e,n);return this.translateResponse(e,n,s)}async _request(e={}){try{let r;if(e.adapter?r=await e.adapter(e,this._defaultAdapter.bind(this)):r=await this._defaultAdapter(e),!e.validateStatus(r.status))throw new ff.GaxiosError(`Request failed with status code ${r.status}`,e,r);return r}catch(r){const n=r;n.config=e;const{shouldRetry:s,config:u}=await(0,df.getRetryConfig)(n);if(s&&u)return n.config.retryConfig.currentRetryAttempt=u.retryConfig.currentRetryAttempt,this._request(n.config);throw n}}async getResponseData(e,r){switch(e.responseType){case"stream":return r.body;case"json":{let n=await r.text();try{n=JSON.parse(n)}catch{}return n}case"arraybuffer":return r.arrayBuffer();case"blob":return r.blob();default:return r.text()}}validateOpts(e){const r=(0,sf.default)(!0,{},this.defaults,e);if(!r.url)throw new Error("URL is required.");const n=r.baseUrl||r.baseURL;if(n&&(r.url=n+r.url),r.paramsSerializer=r.paramsSerializer||this.paramsSerializer,r.params&&Object.keys(r.params).length>0){let u=r.paramsSerializer(r.params);u.startsWith("?")&&(u=u.slice(1));const c=r.url.includes("?")?"&":"?";r.url=r.url+c+u}if(typeof e.maxContentLength=="number"&&(r.size=e.maxContentLength),typeof e.maxRedirects=="number"&&(r.follow=e.maxRedirects),r.headers=r.headers||{},r.data){const u=typeof FormData>"u"?!1:(r==null?void 0:r.data)instanceof FormData;lf.default.readable(r.data)?r.body=r.data:gf()&&Buffer.isBuffer(r.data)?(r.body=r.data,zs(r,"Content-Type")||(r.headers["Content-Type"]="application/json")):typeof r.data=="object"?u||(Gu(r,"content-type")==="application/x-www-form-urlencoded"?r.body=r.paramsSerializer(r.data):(zs(r,"Content-Type")||(r.headers["Content-Type"]="application/json"),r.body=JSON.stringify(r.data))):r.body=r.data}r.validateStatus=r.validateStatus||this.validateStatus,r.responseType=r.responseType||"json",!r.headers.Accept&&r.responseType==="json"&&(r.headers.Accept="application/json"),r.method=r.method||"GET";const s=mf(r.url);if(s)if(this.agentCache.has(s))r.agent=this.agentCache.get(s);else{if(r.cert&&r.key){const u=new $u.URL(s);r.agent=new Qa({port:u.port,host:u.host,protocol:u.protocol,cert:r.cert,key:r.key})}else r.agent=new Qa(s);this.agentCache.set(s,r.agent)}else r.cert&&r.key&&(this.agentCache.has(r.key)?r.agent=this.agentCache.get(r.key):(r.agent=new of.Agent({cert:r.cert,key:r.key}),this.agentCache.set(r.key,r.agent)));return r}validateStatus(e){return e>=200&&e<300}paramsSerializer(e){return cf.default.stringify(e)}translateResponse(e,r,n){const s={};return r.headers.forEach((u,c)=>{s[c]=u}),{config:e,data:n,headers:s,status:r.status,statusText:r.statusText,request:{responseURL:r.url}}}}Yn.Gaxios=Ef;(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.request=t.instance=t.Gaxios=t.GaxiosError=void 0;const e=Yn;Object.defineProperty(t,"Gaxios",{enumerable:!0,get:function(){return e.Gaxios}});var r=Ir;Object.defineProperty(t,"GaxiosError",{enumerable:!0,get:function(){return r.GaxiosError}}),t.instance=new e.Gaxios;async function n(s){return t.instance.request(s)}t.request=n})(At);var Zn={exports:{}},Hu={exports:{}},zu={exports:{}};(function(t){(function(e){var r,n=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,s=Math.ceil,u=Math.floor,c="[BigNumber Error] ",i=c+"Number primitive has more than 15 significant digits: ",y=1e14,f=14,A=9007199254740991,C=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],p=1e7,o=1e9;function m(T){var h,l,B,N=W.prototype={constructor:W,toString:null,valueOf:null},F=new W(1),L=20,q=4,j=-7,H=21,Q=-1e7,J=1e7,X=!1,re=1,se=0,de={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},ye="0123456789abcdefghijklmnopqrstuvwxyz",_e=!0;function W(x,w){var d,I,O,P,K,V,$,M,G=this;if(!(G instanceof W))return new W(x,w);if(w==null){if(x&&x._isBigNumber===!0){G.s=x.s,!x.c||x.e>J?G.c=G.e=null:x.e<Q?G.c=[G.e=0]:(G.e=x.e,G.c=x.c.slice());return}if((V=typeof x=="number")&&x*0==0){if(G.s=1/x<0?(x=-x,-1):1,x===~~x){for(P=0,K=x;K>=10;K/=10,P++);P>J?G.c=G.e=null:(G.e=P,G.c=[x]);return}M=String(x)}else{if(!n.test(M=String(x)))return B(G,M,V);G.s=M.charCodeAt(0)==45?(M=M.slice(1),-1):1}(P=M.indexOf("."))>-1&&(M=M.replace(".","")),(K=M.search(/e/i))>0?(P<0&&(P=K),P+=+M.slice(K+1),M=M.substring(0,K)):P<0&&(P=M.length)}else{if(v(w,2,ye.length,"Base"),w==10&&_e)return G=new W(x),fe(G,L+G.e+1,q);if(M=String(x),V=typeof x=="number"){if(x*0!=0)return B(G,M,V,w);if(G.s=1/x<0?(M=M.slice(1),-1):1,W.DEBUG&&M.replace(/^0\.0*|\./,"").length>15)throw Error(i+x)}else G.s=M.charCodeAt(0)===45?(M=M.slice(1),-1):1;for(d=ye.slice(0,w),P=K=0,$=M.length;K<$;K++)if(d.indexOf(I=M.charAt(K))<0){if(I=="."){if(K>P){P=$;continue}}else if(!O&&(M==M.toUpperCase()&&(M=M.toLowerCase())||M==M.toLowerCase()&&(M=M.toUpperCase()))){O=!0,K=-1,P=0;continue}return B(G,String(x),V,w)}V=!1,M=l(M,w,10,G.s),(P=M.indexOf("."))>-1?M=M.replace(".",""):P=M.length}for(K=0;M.charCodeAt(K)===48;K++);for($=M.length;M.charCodeAt(--$)===48;);if(M=M.slice(K,++$)){if($-=K,V&&W.DEBUG&&$>15&&(x>A||x!==u(x)))throw Error(i+G.s*x);if((P=P-K-1)>J)G.c=G.e=null;else if(P<Q)G.c=[G.e=0];else{if(G.e=P,G.c=[],K=(P+1)%f,P<0&&(K+=f),K<$){for(K&&G.c.push(+M.slice(0,K)),$-=f;K<$;)G.c.push(+M.slice(K,K+=f));K=f-(M=M.slice(K)).length}else K-=$;for(;K--;M+="0");G.c.push(+M)}}else G.c=[G.e=0]}W.clone=m,W.ROUND_UP=0,W.ROUND_DOWN=1,W.ROUND_CEIL=2,W.ROUND_FLOOR=3,W.ROUND_HALF_UP=4,W.ROUND_HALF_DOWN=5,W.ROUND_HALF_EVEN=6,W.ROUND_HALF_CEIL=7,W.ROUND_HALF_FLOOR=8,W.EUCLID=9,W.config=W.set=function(x){var w,d;if(x!=null)if(typeof x=="object"){if(x.hasOwnProperty(w="DECIMAL_PLACES")&&(d=x[w],v(d,0,o,w),L=d),x.hasOwnProperty(w="ROUNDING_MODE")&&(d=x[w],v(d,0,8,w),q=d),x.hasOwnProperty(w="EXPONENTIAL_AT")&&(d=x[w],d&&d.pop?(v(d[0],-o,0,w),v(d[1],0,o,w),j=d[0],H=d[1]):(v(d,-o,o,w),j=-(H=d<0?-d:d))),x.hasOwnProperty(w="RANGE"))if(d=x[w],d&&d.pop)v(d[0],-o,-1,w),v(d[1],1,o,w),Q=d[0],J=d[1];else if(v(d,-o,o,w),d)Q=-(J=d<0?-d:d);else throw Error(c+w+" cannot be zero: "+d);if(x.hasOwnProperty(w="CRYPTO"))if(d=x[w],d===!!d)if(d)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))X=d;else throw X=!d,Error(c+"crypto unavailable");else X=d;else throw Error(c+w+" not true or false: "+d);if(x.hasOwnProperty(w="MODULO_MODE")&&(d=x[w],v(d,0,9,w),re=d),x.hasOwnProperty(w="POW_PRECISION")&&(d=x[w],v(d,0,o,w),se=d),x.hasOwnProperty(w="FORMAT"))if(d=x[w],typeof d=="object")de=d;else throw Error(c+w+" not an object: "+d);if(x.hasOwnProperty(w="ALPHABET"))if(d=x[w],typeof d=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(d))_e=d.slice(0,10)=="0123456789",ye=d;else throw Error(c+w+" invalid: "+d)}else throw Error(c+"Object expected: "+x);return{DECIMAL_PLACES:L,ROUNDING_MODE:q,EXPONENTIAL_AT:[j,H],RANGE:[Q,J],CRYPTO:X,MODULO_MODE:re,POW_PRECISION:se,FORMAT:de,ALPHABET:ye}},W.isBigNumber=function(x){if(!x||x._isBigNumber!==!0)return!1;if(!W.DEBUG)return!0;var w,d,I=x.c,O=x.e,P=x.s;e:if({}.toString.call(I)=="[object Array]"){if((P===1||P===-1)&&O>=-o&&O<=o&&O===u(O)){if(I[0]===0){if(O===0&&I.length===1)return!0;break e}if(w=(O+1)%f,w<1&&(w+=f),String(I[0]).length==w){for(w=0;w<I.length;w++)if(d=I[w],d<0||d>=y||d!==u(d))break e;if(d!==0)return!0}}}else if(I===null&&O===null&&(P===null||P===1||P===-1))return!0;throw Error(c+"Invalid BigNumber: "+x)},W.maximum=W.max=function(){return ie(arguments,N.lt)},W.minimum=W.min=function(){return ie(arguments,N.gt)},W.random=function(){var x=9007199254740992,w=Math.random()*x&2097151?function(){return u(Math.random()*x)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(d){var I,O,P,K,V,$=0,M=[],G=new W(F);if(d==null?d=L:v(d,0,o),K=s(d/f),X)if(crypto.getRandomValues){for(I=crypto.getRandomValues(new Uint32Array(K*=2));$<K;)V=I[$]*131072+(I[$+1]>>>11),V>=9e15?(O=crypto.getRandomValues(new Uint32Array(2)),I[$]=O[0],I[$+1]=O[1]):(M.push(V%1e14),$+=2);$=K/2}else if(crypto.randomBytes){for(I=crypto.randomBytes(K*=7);$<K;)V=(I[$]&31)*281474976710656+I[$+1]*1099511627776+I[$+2]*4294967296+I[$+3]*16777216+(I[$+4]<<16)+(I[$+5]<<8)+I[$+6],V>=9e15?crypto.randomBytes(7).copy(I,$):(M.push(V%1e14),$+=7);$=K/7}else throw X=!1,Error(c+"crypto unavailable");if(!X)for(;$<K;)V=w(),V<9e15&&(M[$++]=V%1e14);for(K=M[--$],d%=f,K&&d&&(V=C[f-d],M[$]=u(K/V)*V);M[$]===0;M.pop(),$--);if($<0)M=[P=0];else{for(P=-1;M[0]===0;M.splice(0,1),P-=f);for($=1,V=M[0];V>=10;V/=10,$++);$<f&&(P-=f-$)}return G.e=P,G.c=M,G}}(),W.sum=function(){for(var x=1,w=arguments,d=new W(w[0]);x<w.length;)d=d.plus(w[x++]);return d},l=function(){var x="0123456789";function w(d,I,O,P){for(var K,V=[0],$,M=0,G=d.length;M<G;){for($=V.length;$--;V[$]*=I);for(V[0]+=P.indexOf(d.charAt(M++)),K=0;K<V.length;K++)V[K]>O-1&&(V[K+1]==null&&(V[K+1]=0),V[K+1]+=V[K]/O|0,V[K]%=O)}return V.reverse()}return function(d,I,O,P,K){var V,$,M,G,Y,ne,te,ce,pe=d.indexOf("."),ge=L,ue=q;for(pe>=0&&(G=se,se=0,d=d.replace(".",""),ce=new W(I),ne=ce.pow(d.length-pe),se=G,ce.c=w(R(S(ne.c),ne.e,"0"),10,O,x),ce.e=ce.c.length),te=w(d,I,O,K?(V=ye,x):(V=x,ye)),M=G=te.length;te[--G]==0;te.pop());if(!te[0])return V.charAt(0);if(pe<0?--M:(ne.c=te,ne.e=M,ne.s=P,ne=h(ne,ce,ge,ue,O),te=ne.c,Y=ne.r,M=ne.e),$=M+ge+1,pe=te[$],G=O/2,Y=Y||$<0||te[$+1]!=null,Y=ue<4?(pe!=null||Y)&&(ue==0||ue==(ne.s<0?3:2)):pe>G||pe==G&&(ue==4||Y||ue==6&&te[$-1]&1||ue==(ne.s<0?8:7)),$<1||!te[0])d=Y?R(V.charAt(1),-ge,V.charAt(0)):V.charAt(0);else{if(te.length=$,Y)for(--O;++te[--$]>O;)te[$]=0,$||(++M,te=[1].concat(te));for(G=te.length;!te[--G];);for(pe=0,d="";pe<=G;d+=V.charAt(te[pe++]));d=R(d,M,V.charAt(0))}return d}}(),h=function(){function x(I,O,P){var K,V,$,M,G=0,Y=I.length,ne=O%p,te=O/p|0;for(I=I.slice();Y--;)$=I[Y]%p,M=I[Y]/p|0,K=te*$+M*ne,V=ne*$+K%p*p+G,G=(V/P|0)+(K/p|0)+te*M,I[Y]=V%P;return G&&(I=[G].concat(I)),I}function w(I,O,P,K){var V,$;if(P!=K)$=P>K?1:-1;else for(V=$=0;V<P;V++)if(I[V]!=O[V]){$=I[V]>O[V]?1:-1;break}return $}function d(I,O,P,K){for(var V=0;P--;)I[P]-=V,V=I[P]<O[P]?1:0,I[P]=V*K+I[P]-O[P];for(;!I[0]&&I.length>1;I.splice(0,1));}return function(I,O,P,K,V){var $,M,G,Y,ne,te,ce,pe,ge,ue,le,ve,be,Ne,Pe,we,Ue,Ie=I.s==O.s?1:-1,Te=I.c,Ee=O.c;if(!Te||!Te[0]||!Ee||!Ee[0])return new W(!I.s||!O.s||(Te?Ee&&Te[0]==Ee[0]:!Ee)?NaN:Te&&Te[0]==0||!Ee?Ie*0:Ie/0);for(pe=new W(Ie),ge=pe.c=[],M=I.e-O.e,Ie=P+M+1,V||(V=y,M=g(I.e/f)-g(O.e/f),Ie=Ie/f|0),G=0;Ee[G]==(Te[G]||0);G++);if(Ee[G]>(Te[G]||0)&&M--,Ie<0)ge.push(1),Y=!0;else{for(Ne=Te.length,we=Ee.length,G=0,Ie+=2,ne=u(V/(Ee[0]+1)),ne>1&&(Ee=x(Ee,ne,V),Te=x(Te,ne,V),we=Ee.length,Ne=Te.length),be=we,ue=Te.slice(0,we),le=ue.length;le<we;ue[le++]=0);Ue=Ee.slice(),Ue=[0].concat(Ue),Pe=Ee[0],Ee[1]>=V/2&&Pe++;do{if(ne=0,$=w(Ee,ue,we,le),$<0){if(ve=ue[0],we!=le&&(ve=ve*V+(ue[1]||0)),ne=u(ve/Pe),ne>1)for(ne>=V&&(ne=V-1),te=x(Ee,ne,V),ce=te.length,le=ue.length;w(te,ue,ce,le)==1;)ne--,d(te,we<ce?Ue:Ee,ce,V),ce=te.length,$=1;else ne==0&&($=ne=1),te=Ee.slice(),ce=te.length;if(ce<le&&(te=[0].concat(te)),d(ue,te,le,V),le=ue.length,$==-1)for(;w(Ee,ue,we,le)<1;)ne++,d(ue,we<le?Ue:Ee,le,V),le=ue.length}else $===0&&(ne++,ue=[0]);ge[G++]=ne,ue[0]?ue[le++]=Te[be]||0:(ue=[Te[be]],le=1)}while((be++<Ne||ue[0]!=null)&&Ie--);Y=ue[0]!=null,ge[0]||ge.splice(0,1)}if(V==y){for(G=1,Ie=ge[0];Ie>=10;Ie/=10,G++);fe(pe,P+(pe.e=G+M*f-1)+1,K,Y)}else pe.e=M,pe.r=+Y;return pe}}();function he(x,w,d,I){var O,P,K,V,$;if(d==null?d=q:v(d,0,8),!x.c)return x.toString();if(O=x.c[0],K=x.e,w==null)$=S(x.c),$=I==1||I==2&&(K<=j||K>=H)?b($,K):R($,K,"0");else if(x=fe(new W(x),w,d),P=x.e,$=S(x.c),V=$.length,I==1||I==2&&(w<=P||P<=j)){for(;V<w;$+="0",V++);$=b($,P)}else if(w-=K,$=R($,P,"0"),P+1>V){if(--w>0)for($+=".";w--;$+="0");}else if(w+=P-V,w>0)for(P+1==V&&($+=".");w--;$+="0");return x.s<0&&O?"-"+$:$}function ie(x,w){for(var d,I=1,O=new W(x[0]);I<x.length;I++)if(d=new W(x[I]),d.s)w.call(O,d)&&(O=d);else{O=d;break}return O}function ke(x,w,d){for(var I=1,O=w.length;!w[--O];w.pop());for(O=w[0];O>=10;O/=10,I++);return(d=I+d*f-1)>J?x.c=x.e=null:d<Q?x.c=[x.e=0]:(x.e=d,x.c=w),x}B=function(){var x=/^(-?)0([xbo])(?=\w[\w.]*$)/i,w=/^([^.]+)\.$/,d=/^\.([^.]+)$/,I=/^-?(Infinity|NaN)$/,O=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(P,K,V,$){var M,G=V?K:K.replace(O,"");if(I.test(G))P.s=isNaN(G)?null:G<0?-1:1;else{if(!V&&(G=G.replace(x,function(Y,ne,te){return M=(te=te.toLowerCase())=="x"?16:te=="b"?2:8,!$||$==M?ne:Y}),$&&(M=$,G=G.replace(w,"$1").replace(d,"0.$1")),K!=G))return new W(G,M);if(W.DEBUG)throw Error(c+"Not a"+($?" base "+$:"")+" number: "+K);P.s=null}P.c=P.e=null}}();function fe(x,w,d,I){var O,P,K,V,$,M,G,Y=x.c,ne=C;if(Y){e:{for(O=1,V=Y[0];V>=10;V/=10,O++);if(P=w-O,P<0)P+=f,K=w,$=Y[M=0],G=$/ne[O-K-1]%10|0;else if(M=s((P+1)/f),M>=Y.length)if(I){for(;Y.length<=M;Y.push(0));$=G=0,O=1,P%=f,K=P-f+1}else break e;else{for($=V=Y[M],O=1;V>=10;V/=10,O++);P%=f,K=P-f+O,G=K<0?0:$/ne[O-K-1]%10|0}if(I=I||w<0||Y[M+1]!=null||(K<0?$:$%ne[O-K-1]),I=d<4?(G||I)&&(d==0||d==(x.s<0?3:2)):G>5||G==5&&(d==4||I||d==6&&(P>0?K>0?$/ne[O-K]:0:Y[M-1])%10&1||d==(x.s<0?8:7)),w<1||!Y[0])return Y.length=0,I?(w-=x.e+1,Y[0]=ne[(f-w%f)%f],x.e=-w||0):Y[0]=x.e=0,x;if(P==0?(Y.length=M,V=1,M--):(Y.length=M+1,V=ne[f-P],Y[M]=K>0?u($/ne[O-K]%ne[K])*V:0),I)for(;;)if(M==0){for(P=1,K=Y[0];K>=10;K/=10,P++);for(K=Y[0]+=V,V=1;K>=10;K/=10,V++);P!=V&&(x.e++,Y[0]==y&&(Y[0]=1));break}else{if(Y[M]+=V,Y[M]!=y)break;Y[M--]=0,V=1}for(P=Y.length;Y[--P]===0;Y.pop());}x.e>J?x.c=x.e=null:x.e<Q&&(x.c=[x.e=0])}return x}function _(x){var w,d=x.e;return d===null?x.toString():(w=S(x.c),w=d<=j||d>=H?b(w,d):R(w,d,"0"),x.s<0?"-"+w:w)}return N.absoluteValue=N.abs=function(){var x=new W(this);return x.s<0&&(x.s=1),x},N.comparedTo=function(x,w){return a(this,new W(x,w))},N.decimalPlaces=N.dp=function(x,w){var d,I,O,P=this;if(x!=null)return v(x,0,o),w==null?w=q:v(w,0,8),fe(new W(P),x+P.e+1,w);if(!(d=P.c))return null;if(I=((O=d.length-1)-g(this.e/f))*f,O=d[O])for(;O%10==0;O/=10,I--);return I<0&&(I=0),I},N.dividedBy=N.div=function(x,w){return h(this,new W(x,w),L,q)},N.dividedToIntegerBy=N.idiv=function(x,w){return h(this,new W(x,w),0,1)},N.exponentiatedBy=N.pow=function(x,w){var d,I,O,P,K,V,$,M,G,Y=this;if(x=new W(x),x.c&&!x.isInteger())throw Error(c+"Exponent not an integer: "+_(x));if(w!=null&&(w=new W(w)),V=x.e>14,!Y.c||!Y.c[0]||Y.c[0]==1&&!Y.e&&Y.c.length==1||!x.c||!x.c[0])return G=new W(Math.pow(+_(Y),V?x.s*(2-E(x)):+_(x))),w?G.mod(w):G;if($=x.s<0,w){if(w.c?!w.c[0]:!w.s)return new W(NaN);I=!$&&Y.isInteger()&&w.isInteger(),I&&(Y=Y.mod(w))}else{if(x.e>9&&(Y.e>0||Y.e<-1||(Y.e==0?Y.c[0]>1||V&&Y.c[1]>=24e7:Y.c[0]<8e13||V&&Y.c[0]<=9999975e7)))return P=Y.s<0&&E(x)?-0:0,Y.e>-1&&(P=1/P),new W($?1/P:P);se&&(P=s(se/f+2))}for(V?(d=new W(.5),$&&(x.s=1),M=E(x)):(O=Math.abs(+_(x)),M=O%2),G=new W(F);;){if(M){if(G=G.times(Y),!G.c)break;P?G.c.length>P&&(G.c.length=P):I&&(G=G.mod(w))}if(O){if(O=u(O/2),O===0)break;M=O%2}else if(x=x.times(d),fe(x,x.e+1,1),x.e>14)M=E(x);else{if(O=+_(x),O===0)break;M=O%2}Y=Y.times(Y),P?Y.c&&Y.c.length>P&&(Y.c.length=P):I&&(Y=Y.mod(w))}return I?G:($&&(G=F.div(G)),w?G.mod(w):P?fe(G,se,q,K):G)},N.integerValue=function(x){var w=new W(this);return x==null?x=q:v(x,0,8),fe(w,w.e+1,x)},N.isEqualTo=N.eq=function(x,w){return a(this,new W(x,w))===0},N.isFinite=function(){return!!this.c},N.isGreaterThan=N.gt=function(x,w){return a(this,new W(x,w))>0},N.isGreaterThanOrEqualTo=N.gte=function(x,w){return(w=a(this,new W(x,w)))===1||w===0},N.isInteger=function(){return!!this.c&&g(this.e/f)>this.c.length-2},N.isLessThan=N.lt=function(x,w){return a(this,new W(x,w))<0},N.isLessThanOrEqualTo=N.lte=function(x,w){return(w=a(this,new W(x,w)))===-1||w===0},N.isNaN=function(){return!this.s},N.isNegative=function(){return this.s<0},N.isPositive=function(){return this.s>0},N.isZero=function(){return!!this.c&&this.c[0]==0},N.minus=function(x,w){var d,I,O,P,K=this,V=K.s;if(x=new W(x,w),w=x.s,!V||!w)return new W(NaN);if(V!=w)return x.s=-w,K.plus(x);var $=K.e/f,M=x.e/f,G=K.c,Y=x.c;if(!$||!M){if(!G||!Y)return G?(x.s=-w,x):new W(Y?K:NaN);if(!G[0]||!Y[0])return Y[0]?(x.s=-w,x):new W(G[0]?K:q==3?-0:0)}if($=g($),M=g(M),G=G.slice(),V=$-M){for((P=V<0)?(V=-V,O=G):(M=$,O=Y),O.reverse(),w=V;w--;O.push(0));O.reverse()}else for(I=(P=(V=G.length)<(w=Y.length))?V:w,V=w=0;w<I;w++)if(G[w]!=Y[w]){P=G[w]<Y[w];break}if(P&&(O=G,G=Y,Y=O,x.s=-x.s),w=(I=Y.length)-(d=G.length),w>0)for(;w--;G[d++]=0);for(w=y-1;I>V;){if(G[--I]<Y[I]){for(d=I;d&&!G[--d];G[d]=w);--G[d],G[I]+=y}G[I]-=Y[I]}for(;G[0]==0;G.splice(0,1),--M);return G[0]?ke(x,G,M):(x.s=q==3?-1:1,x.c=[x.e=0],x)},N.modulo=N.mod=function(x,w){var d,I,O=this;return x=new W(x,w),!O.c||!x.s||x.c&&!x.c[0]?new W(NaN):!x.c||O.c&&!O.c[0]?new W(O):(re==9?(I=x.s,x.s=1,d=h(O,x,0,3),x.s=I,d.s*=I):d=h(O,x,0,re),x=O.minus(d.times(x)),!x.c[0]&&re==1&&(x.s=O.s),x)},N.multipliedBy=N.times=function(x,w){var d,I,O,P,K,V,$,M,G,Y,ne,te,ce,pe,ge,ue=this,le=ue.c,ve=(x=new W(x,w)).c;if(!le||!ve||!le[0]||!ve[0])return!ue.s||!x.s||le&&!le[0]&&!ve||ve&&!ve[0]&&!le?x.c=x.e=x.s=null:(x.s*=ue.s,!le||!ve?x.c=x.e=null:(x.c=[0],x.e=0)),x;for(I=g(ue.e/f)+g(x.e/f),x.s*=ue.s,$=le.length,Y=ve.length,$<Y&&(ce=le,le=ve,ve=ce,O=$,$=Y,Y=O),O=$+Y,ce=[];O--;ce.push(0));for(pe=y,ge=p,O=Y;--O>=0;){for(d=0,ne=ve[O]%ge,te=ve[O]/ge|0,K=$,P=O+K;P>O;)M=le[--K]%ge,G=le[K]/ge|0,V=te*M+G*ne,M=ne*M+V%ge*ge+ce[P]+d,d=(M/pe|0)+(V/ge|0)+te*G,ce[P--]=M%pe;ce[P]=d}return d?++I:ce.splice(0,1),ke(x,ce,I)},N.negated=function(){var x=new W(this);return x.s=-x.s||null,x},N.plus=function(x,w){var d,I=this,O=I.s;if(x=new W(x,w),w=x.s,!O||!w)return new W(NaN);if(O!=w)return x.s=-w,I.minus(x);var P=I.e/f,K=x.e/f,V=I.c,$=x.c;if(!P||!K){if(!V||!$)return new W(O/0);if(!V[0]||!$[0])return $[0]?x:new W(V[0]?I:O*0)}if(P=g(P),K=g(K),V=V.slice(),O=P-K){for(O>0?(K=P,d=$):(O=-O,d=V),d.reverse();O--;d.push(0));d.reverse()}for(O=V.length,w=$.length,O-w<0&&(d=$,$=V,V=d,w=O),O=0;w;)O=(V[--w]=V[w]+$[w]+O)/y|0,V[w]=y===V[w]?0:V[w]%y;return O&&(V=[O].concat(V),++K),ke(x,V,K)},N.precision=N.sd=function(x,w){var d,I,O,P=this;if(x!=null&&x!==!!x)return v(x,1,o),w==null?w=q:v(w,0,8),fe(new W(P),x,w);if(!(d=P.c))return null;if(O=d.length-1,I=O*f+1,O=d[O]){for(;O%10==0;O/=10,I--);for(O=d[0];O>=10;O/=10,I++);}return x&&P.e+1>I&&(I=P.e+1),I},N.shiftedBy=function(x){return v(x,-A,A),this.times("1e"+x)},N.squareRoot=N.sqrt=function(){var x,w,d,I,O,P=this,K=P.c,V=P.s,$=P.e,M=L+4,G=new W("0.5");if(V!==1||!K||!K[0])return new W(!V||V<0&&(!K||K[0])?NaN:K?P:1/0);if(V=Math.sqrt(+_(P)),V==0||V==1/0?(w=S(K),(w.length+$)%2==0&&(w+="0"),V=Math.sqrt(+w),$=g(($+1)/2)-($<0||$%2),V==1/0?w="5e"+$:(w=V.toExponential(),w=w.slice(0,w.indexOf("e")+1)+$),d=new W(w)):d=new W(V+""),d.c[0]){for($=d.e,V=$+M,V<3&&(V=0);;)if(O=d,d=G.times(O.plus(h(P,O,M,1))),S(O.c).slice(0,V)===(w=S(d.c)).slice(0,V))if(d.e<$&&--V,w=w.slice(V-3,V+1),w=="9999"||!I&&w=="4999"){if(!I&&(fe(O,O.e+L+2,0),O.times(O).eq(P))){d=O;break}M+=4,V+=4,I=1}else{(!+w||!+w.slice(1)&&w.charAt(0)=="5")&&(fe(d,d.e+L+2,1),x=!d.times(d).eq(P));break}}return fe(d,d.e+L+1,q,x)},N.toExponential=function(x,w){return x!=null&&(v(x,0,o),x++),he(this,x,w,1)},N.toFixed=function(x,w){return x!=null&&(v(x,0,o),x=x+this.e+1),he(this,x,w)},N.toFormat=function(x,w,d){var I,O=this;if(d==null)x!=null&&w&&typeof w=="object"?(d=w,w=null):x&&typeof x=="object"?(d=x,x=w=null):d=de;else if(typeof d!="object")throw Error(c+"Argument not an object: "+d);if(I=O.toFixed(x,w),O.c){var P,K=I.split("."),V=+d.groupSize,$=+d.secondaryGroupSize,M=d.groupSeparator||"",G=K[0],Y=K[1],ne=O.s<0,te=ne?G.slice(1):G,ce=te.length;if($&&(P=V,V=$,$=P,ce-=P),V>0&&ce>0){for(P=ce%V||V,G=te.substr(0,P);P<ce;P+=V)G+=M+te.substr(P,V);$>0&&(G+=M+te.slice(P)),ne&&(G="-"+G)}I=Y?G+(d.decimalSeparator||"")+(($=+d.fractionGroupSize)?Y.replace(new RegExp("\\d{"+$+"}\\B","g"),"$&"+(d.fractionGroupSeparator||"")):Y):G}return(d.prefix||"")+I+(d.suffix||"")},N.toFraction=function(x){var w,d,I,O,P,K,V,$,M,G,Y,ne,te=this,ce=te.c;if(x!=null&&(V=new W(x),!V.isInteger()&&(V.c||V.s!==1)||V.lt(F)))throw Error(c+"Argument "+(V.isInteger()?"out of range: ":"not an integer: ")+_(V));if(!ce)return new W(te);for(w=new W(F),M=d=new W(F),I=$=new W(F),ne=S(ce),P=w.e=ne.length-te.e-1,w.c[0]=C[(K=P%f)<0?f+K:K],x=!x||V.comparedTo(w)>0?P>0?w:M:V,K=J,J=1/0,V=new W(ne),$.c[0]=0;G=h(V,w,0,1),O=d.plus(G.times(I)),O.comparedTo(x)!=1;)d=I,I=O,M=$.plus(G.times(O=M)),$=O,w=V.minus(G.times(O=w)),V=O;return O=h(x.minus(d),I,0,1),$=$.plus(O.times(M)),d=d.plus(O.times(I)),$.s=M.s=te.s,P=P*2,Y=h(M,I,P,q).minus(te).abs().comparedTo(h($,d,P,q).minus(te).abs())<1?[M,I]:[$,d],J=K,Y},N.toNumber=function(){return+_(this)},N.toPrecision=function(x,w){return x!=null&&v(x,1,o),he(this,x,w,2)},N.toString=function(x){var w,d=this,I=d.s,O=d.e;return O===null?I?(w="Infinity",I<0&&(w="-"+w)):w="NaN":(x==null?w=O<=j||O>=H?b(S(d.c),O):R(S(d.c),O,"0"):x===10&&_e?(d=fe(new W(d),L+O+1,q),w=R(S(d.c),d.e,"0")):(v(x,2,ye.length,"Base"),w=l(R(S(d.c),O,"0"),10,x,I,!0)),I<0&&d.c[0]&&(w="-"+w)),w},N.valueOf=N.toJSON=function(){return _(this)},N._isBigNumber=!0,T!=null&&W.set(T),W}function g(T){var h=T|0;return T>0||T===h?h:h-1}function S(T){for(var h,l,B=1,N=T.length,F=T[0]+"";B<N;){for(h=T[B++]+"",l=f-h.length;l--;h="0"+h);F+=h}for(N=F.length;F.charCodeAt(--N)===48;);return F.slice(0,N+1||1)}function a(T,h){var l,B,N=T.c,F=h.c,L=T.s,q=h.s,j=T.e,H=h.e;if(!L||!q)return null;if(l=N&&!N[0],B=F&&!F[0],l||B)return l?B?0:-q:L;if(L!=q)return L;if(l=L<0,B=j==H,!N||!F)return B?0:!N^l?1:-1;if(!B)return j>H^l?1:-1;for(q=(j=N.length)<(H=F.length)?j:H,L=0;L<q;L++)if(N[L]!=F[L])return N[L]>F[L]^l?1:-1;return j==H?0:j>H^l?1:-1}function v(T,h,l,B){if(T<h||T>l||T!==u(T))throw Error(c+(B||"Argument")+(typeof T=="number"?T<h||T>l?" out of range: ":" not an integer: ":" not a primitive number: ")+String(T))}function E(T){var h=T.c.length-1;return g(T.e/f)==h&&T.c[h]%2!=0}function b(T,h){return(T.length>1?T.charAt(0)+"."+T.slice(1):T)+(h<0?"e":"e+")+h}function R(T,h,l){var B,N;if(h<0){for(N=l+".";++h;N+=l);T=N+T}else if(B=T.length,++h>B){for(N=l,h-=B;--h;N+=l);T+=N}else h<B&&(T=T.slice(0,h)+"."+T.slice(h));return T}r=m(),r.default=r.BigNumber=r,t.exports?t.exports=r:(e||(e=typeof self<"u"&&self?self:window),e.BigNumber=r)})(Re)})(zu);var Wu=zu.exports;(function(t){var e=Wu,r=t.exports;(function(){var n=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,s,u,c={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},i;function y(A){return n.lastIndex=0,n.test(A)?'"'+A.replace(n,function(C){var p=c[C];return typeof p=="string"?p:"\\u"+("0000"+C.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+A+'"'}function f(A,C){var p,o,m,g,S=s,a,v=C[A],E=v!=null&&(v instanceof e||e.isBigNumber(v));switch(v&&typeof v=="object"&&typeof v.toJSON=="function"&&(v=v.toJSON(A)),typeof i=="function"&&(v=i.call(C,A,v)),typeof v){case"string":return E?v:y(v);case"number":return isFinite(v)?String(v):"null";case"boolean":case"null":case"bigint":return String(v);case"object":if(!v)return"null";if(s+=u,a=[],Object.prototype.toString.apply(v)==="[object Array]"){for(g=v.length,p=0;p<g;p+=1)a[p]=f(p,v)||"null";return m=a.length===0?"[]":s?`[
`+s+a.join(`,
`+s)+`
`+S+"]":"["+a.join(",")+"]",s=S,m}if(i&&typeof i=="object")for(g=i.length,p=0;p<g;p+=1)typeof i[p]=="string"&&(o=i[p],m=f(o,v),m&&a.push(y(o)+(s?": ":":")+m));else Object.keys(v).forEach(function(b){var R=f(b,v);R&&a.push(y(b)+(s?": ":":")+R)});return m=a.length===0?"{}":s?`{
`+s+a.join(`,
`+s)+`
`+S+"}":"{"+a.join(",")+"}",s=S,m}}typeof r.stringify!="function"&&(r.stringify=function(A,C,p){var o;if(s="",u="",typeof p=="number")for(o=0;o<p;o+=1)u+=" ";else typeof p=="string"&&(u=p);if(i=C,C&&typeof C!="function"&&(typeof C!="object"||typeof C.length!="number"))throw new Error("JSON.stringify");return f("",{"":A})})})()})(Hu);var Cf=Hu.exports,An=null;const Sf=/(?:_|\\u005[Ff])(?:_|\\u005[Ff])(?:p|\\u0070)(?:r|\\u0072)(?:o|\\u006[Ff])(?:t|\\u0074)(?:o|\\u006[Ff])(?:_|\\u005[Ff])(?:_|\\u005[Ff])/,Af=/(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)/;var Tf=function(t){var e={strict:!1,storeAsString:!1,alwaysParseAsBig:!1,useNativeBigInt:!1,protoAction:"error",constructorAction:"error"};if(t!=null){if(t.strict===!0&&(e.strict=!0),t.storeAsString===!0&&(e.storeAsString=!0),e.alwaysParseAsBig=t.alwaysParseAsBig===!0?t.alwaysParseAsBig:!1,e.useNativeBigInt=t.useNativeBigInt===!0?t.useNativeBigInt:!1,typeof t.constructorAction<"u")if(t.constructorAction==="error"||t.constructorAction==="ignore"||t.constructorAction==="preserve")e.constructorAction=t.constructorAction;else throw new Error(`Incorrect value for constructorAction option, must be "error", "ignore" or undefined but passed ${t.constructorAction}`);if(typeof t.protoAction<"u")if(t.protoAction==="error"||t.protoAction==="ignore"||t.protoAction==="preserve")e.protoAction=t.protoAction;else throw new Error(`Incorrect value for protoAction option, must be "error", "ignore" or undefined but passed ${t.protoAction}`)}var r,n,s={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:`
`,r:"\r",t:"	"},u,c=function(g){throw{name:"SyntaxError",message:g,at:r,text:u}},i=function(g){return g&&g!==n&&c("Expected '"+g+"' instead of '"+n+"'"),n=u.charAt(r),r+=1,n},y=function(){var g,S="";for(n==="-"&&(S="-",i("-"));n>="0"&&n<="9";)S+=n,i();if(n===".")for(S+=".";i()&&n>="0"&&n<="9";)S+=n;if(n==="e"||n==="E")for(S+=n,i(),(n==="-"||n==="+")&&(S+=n,i());n>="0"&&n<="9";)S+=n,i();if(g=+S,!isFinite(g))c("Bad number");else return An==null&&(An=Wu),S.length>15?e.storeAsString?S:e.useNativeBigInt?BigInt(S):new An(S):e.alwaysParseAsBig?e.useNativeBigInt?BigInt(g):new An(g):g},f=function(){var g,S,a="",v;if(n==='"')for(var E=r;i();){if(n==='"')return r-1>E&&(a+=u.substring(E,r-1)),i(),a;if(n==="\\"){if(r-1>E&&(a+=u.substring(E,r-1)),i(),n==="u"){for(v=0,S=0;S<4&&(g=parseInt(i(),16),!!isFinite(g));S+=1)v=v*16+g;a+=String.fromCharCode(v)}else if(typeof s[n]=="string")a+=s[n];else break;E=r}}c("Bad string")},A=function(){for(;n&&n<=" ";)i()},C=function(){switch(n){case"t":return i("t"),i("r"),i("u"),i("e"),!0;case"f":return i("f"),i("a"),i("l"),i("s"),i("e"),!1;case"n":return i("n"),i("u"),i("l"),i("l"),null}c("Unexpected '"+n+"'")},p,o=function(){var g=[];if(n==="["){if(i("["),A(),n==="]")return i("]"),g;for(;n;){if(g.push(p()),A(),n==="]")return i("]"),g;i(","),A()}}c("Bad array")},m=function(){var g,S=Object.create(null);if(n==="{"){if(i("{"),A(),n==="}")return i("}"),S;for(;n;){if(g=f(),A(),i(":"),e.strict===!0&&Object.hasOwnProperty.call(S,g)&&c('Duplicate key "'+g+'"'),Sf.test(g)===!0?e.protoAction==="error"?c("Object contains forbidden prototype property"):e.protoAction==="ignore"?p():S[g]=p():Af.test(g)===!0?e.constructorAction==="error"?c("Object contains forbidden constructor property"):e.constructorAction==="ignore"?p():S[g]=p():S[g]=p(),A(),n==="}")return i("}"),S;i(","),A()}}c("Bad object")};return p=function(){switch(A(),n){case"{":return m();case"[":return o();case'"':return f();case"-":return y();default:return n>="0"&&n<="9"?y():C()}},function(g,S){var a;return u=g+"",r=0,n=" ",a=p(),A(),n&&c("Syntax error"),typeof S=="function"?function v(E,b){var R,T=E[b];return T&&typeof T=="object"&&Object.keys(T).forEach(function(h){R=v(T,h),R!==void 0?T[h]=R:delete T[h]}),S.call(E,b,T)}({"":a},""):a}},xf=Tf,Qu=Cf.stringify,Yu=xf;Zn.exports=function(t){return{parse:Yu(t),stringify:Qu}};Zn.exports.parse=Yu();Zn.exports.stringify=Qu;var _f=Zn.exports,Ya={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.detectGCPResidency=t.isGoogleComputeEngine=t.isGoogleComputeEngineMACAddress=t.isGoogleComputeEngineLinux=t.isGoogleCloudServerless=t.GCE_LINUX_BIOS_PATHS=void 0;const e=nr,r=Fu;t.GCE_LINUX_BIOS_PATHS={BIOS_DATE:"/sys/class/dmi/id/bios_date",BIOS_VENDOR:"/sys/class/dmi/id/bios_vendor"};const n=/^42:01/;function s(){return!!(process.env.CLOUD_RUN_JOB||process.env.FUNCTION_NAME||process.env.K_SERVICE)}t.isGoogleCloudServerless=s;function u(){if((0,r.platform)()!=="linux")return!1;try{(0,e.statSync)(t.GCE_LINUX_BIOS_PATHS.BIOS_DATE);const f=(0,e.readFileSync)(t.GCE_LINUX_BIOS_PATHS.BIOS_VENDOR,"utf8");return/Google/.test(f)}catch{return!1}}t.isGoogleComputeEngineLinux=u;function c(){const f=(0,r.networkInterfaces)();for(const A of Object.values(f))if(A){for(const{mac:C}of A)if(n.test(C))return!0}return!1}t.isGoogleComputeEngineMACAddress=c;function i(){return u()||c()}t.isGoogleComputeEngine=i;function y(){return s()||i()}t.detectGCPResidency=y})(Ya);(function(t){var e=Re&&Re.__createBinding||(Object.create?function(v,E,b,R){R===void 0&&(R=b);var T=Object.getOwnPropertyDescriptor(E,b);(!T||("get"in T?!E.__esModule:T.writable||T.configurable))&&(T={enumerable:!0,get:function(){return E[b]}}),Object.defineProperty(v,R,T)}:function(v,E,b,R){R===void 0&&(R=b),v[R]=E[b]}),r=Re&&Re.__exportStar||function(v,E){for(var b in v)b!=="default"&&!Object.prototype.hasOwnProperty.call(E,b)&&e(E,v,b)};Object.defineProperty(t,"__esModule",{value:!0}),t.requestTimeout=t.setGCPResidency=t.gcpResidencyCache=t.resetIsAvailableCache=t.isAvailable=t.project=t.instance=t.HEADERS=t.HEADER_VALUE=t.HEADER_NAME=t.SECONDARY_HOST_ADDRESS=t.HOST_ADDRESS=t.BASE_PATH=void 0;const n=At,s=_f,u=Ya;t.BASE_PATH="/computeMetadata/v1",t.HOST_ADDRESS="http://169.254.169.254",t.SECONDARY_HOST_ADDRESS="http://metadata.google.internal.",t.HEADER_NAME="Metadata-Flavor",t.HEADER_VALUE="Google",t.HEADERS=Object.freeze({[t.HEADER_NAME]:t.HEADER_VALUE});function c(v){return v||(v=process.env.GCE_METADATA_IP||process.env.GCE_METADATA_HOST||t.HOST_ADDRESS),/^https?:\/\//.test(v)||(v=`http://${v}`),new URL(t.BASE_PATH,v).href}function i(v){Object.keys(v).forEach(E=>{switch(E){case"params":case"property":case"headers":break;case"qs":throw new Error("'qs' is not a valid configuration option. Please use 'params' instead.");default:throw new Error(`'${E}' is not a valid configuration option.`)}})}async function y(v,E,b=3,R=!1){E=E||{},typeof E=="string"&&(E={property:E});let T="";typeof E=="object"&&E.property&&(T="/"+E.property),i(E);try{const l=await(R?f:n.request)({url:`${c()}/${v}${T}`,headers:Object.assign({},t.HEADERS,E.headers),retryConfig:{noResponseRetries:b},params:E.params,responseType:"text",timeout:a()});if(l.headers[t.HEADER_NAME.toLowerCase()]!==t.HEADER_VALUE)throw new Error(`Invalid response from metadata service: incorrect ${t.HEADER_NAME} header.`);if(!l.data)throw new Error("Invalid response from the metadata service");if(typeof l.data=="string")try{return s.parse(l.data)}catch{}return l.data}catch(h){const l=h;throw l.response&&l.response.status!==200&&(l.message=`Unsuccessful response status code. ${l.message}`),h}}async function f(v){const E={...v,url:v.url.replace(c(),c(t.SECONDARY_HOST_ADDRESS))};let b=!1;const R=(0,n.request)(v).then(h=>(b=!0,h)).catch(h=>{if(b)return T;throw b=!0,h}),T=(0,n.request)(E).then(h=>(b=!0,h)).catch(h=>{if(b)return R;throw b=!0,h});return Promise.race([R,T])}function A(v){return y("instance",v)}t.instance=A;function C(v){return y("project",v)}t.project=C;function p(){return process.env.DETECT_GCP_RETRIES?Number(process.env.DETECT_GCP_RETRIES):0}let o;async function m(){try{return o===void 0&&(o=y("instance",void 0,p(),!(process.env.GCE_METADATA_IP||process.env.GCE_METADATA_HOST))),await o,!0}catch(v){const E=v;if(process.env.DEBUG_AUTH&&console.info(E),E.type==="request-timeout"||E.response&&E.response.status===404)return!1;if(!(E.response&&E.response.status===404)&&(!E.code||!["EHOSTDOWN","EHOSTUNREACH","ENETUNREACH","ENOENT","ENOTFOUND","ECONNREFUSED"].includes(E.code))){let b="UNKNOWN";E.code&&(b=E.code),process.emitWarning(`received unexpected error = ${E.message} code = ${b}`,"MetadataLookupWarning")}return!1}}t.isAvailable=m;function g(){o=void 0}t.resetIsAvailableCache=g,t.gcpResidencyCache=null;function S(v=null){t.gcpResidencyCache=v!==null?v:(0,u.detectGCPResidency)()}t.setGCPResidency=S;function a(){return t.gcpResidencyCache===null&&(t.gcpResidencyCache=(0,u.detectGCPResidency)()),t.gcpResidencyCache?0:3e3}t.requestTimeout=a,r(Ya,t)})(Qn);var wt={},Ur={},ei={};ei.byteLength=bf;ei.toByteArray=Bf;ei.fromByteArray=Uf;var Et=[],ct=[],wf=typeof Uint8Array<"u"?Uint8Array:Array,Ui="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var fr=0,If=Ui.length;fr<If;++fr)Et[fr]=Ui[fr],ct[Ui.charCodeAt(fr)]=fr;ct["-".charCodeAt(0)]=62;ct["_".charCodeAt(0)]=63;function Ju(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=t.indexOf("=");r===-1&&(r=e);var n=r===e?0:4-r%4;return[r,n]}function bf(t){var e=Ju(t),r=e[0],n=e[1];return(r+n)*3/4-n}function Rf(t,e,r){return(e+r)*3/4-r}function Bf(t){var e,r=Ju(t),n=r[0],s=r[1],u=new wf(Rf(t,n,s)),c=0,i=s>0?n-4:n,y;for(y=0;y<i;y+=4)e=ct[t.charCodeAt(y)]<<18|ct[t.charCodeAt(y+1)]<<12|ct[t.charCodeAt(y+2)]<<6|ct[t.charCodeAt(y+3)],u[c++]=e>>16&255,u[c++]=e>>8&255,u[c++]=e&255;return s===2&&(e=ct[t.charCodeAt(y)]<<2|ct[t.charCodeAt(y+1)]>>4,u[c++]=e&255),s===1&&(e=ct[t.charCodeAt(y)]<<10|ct[t.charCodeAt(y+1)]<<4|ct[t.charCodeAt(y+2)]>>2,u[c++]=e>>8&255,u[c++]=e&255),u}function Nf(t){return Et[t>>18&63]+Et[t>>12&63]+Et[t>>6&63]+Et[t&63]}function Pf(t,e,r){for(var n,s=[],u=e;u<r;u+=3)n=(t[u]<<16&16711680)+(t[u+1]<<8&65280)+(t[u+2]&255),s.push(Nf(n));return s.join("")}function Uf(t){for(var e,r=t.length,n=r%3,s=[],u=16383,c=0,i=r-n;c<i;c+=u)s.push(Pf(t,c,c+u>i?i:c+u));return n===1?(e=t[r-1],s.push(Et[e>>2]+Et[e<<4&63]+"==")):n===2&&(e=(t[r-2]<<8)+t[r-1],s.push(Et[e>>10]+Et[e>>4&63]+Et[e<<2&63]+"=")),s.join("")}var Ws={},Qs;function Of(){return Qs||(Qs=1,function(t){function e(a,v){var E;return a instanceof Buffer?E=a:E=Buffer.from(a.buffer,a.byteOffset,a.byteLength),E.toString(v)}var r=function(a){return Buffer.from(a)};function n(a){for(var v=0,E=Math.min(256*256,a.length+1),b=new Uint16Array(E),R=[],T=0;;){var h=v<a.length;if(!h||T>=E-1){var l=b.subarray(0,T),B=l;if(R.push(String.fromCharCode.apply(null,B)),!h)return R.join("");a=a.subarray(v),v=0,T=0}var N=a[v++];if(!(N&128))b[T++]=N;else if((N&224)===192){var F=a[v++]&63;b[T++]=(N&31)<<6|F}else if((N&240)===224){var F=a[v++]&63,L=a[v++]&63;b[T++]=(N&31)<<12|F<<6|L}else if((N&248)===240){var F=a[v++]&63,L=a[v++]&63,q=a[v++]&63,j=(N&7)<<18|F<<12|L<<6|q;j>65535&&(j-=65536,b[T++]=j>>>10&1023|55296,j=56320|j&1023),b[T++]=j}}}function s(a){for(var v=0,E=a.length,b=0,R=Math.max(32,E+(E>>>1)+7),T=new Uint8Array(R>>>3<<3);v<E;){var h=a.charCodeAt(v++);if(h>=55296&&h<=56319){if(v<E){var l=a.charCodeAt(v);(l&64512)===56320&&(++v,h=((h&1023)<<10)+(l&1023)+65536)}if(h>=55296&&h<=56319)continue}if(b+4>T.length){R+=8,R*=1+v/a.length*2,R=R>>>3<<3;var B=new Uint8Array(R);B.set(T),T=B}if(h&4294967168)if(!(h&4294965248))T[b++]=h>>>6&31|192;else if(!(h&4294901760))T[b++]=h>>>12&15|224,T[b++]=h>>>6&63|128;else if(!(h&4292870144))T[b++]=h>>>18&7|240,T[b++]=h>>>12&63|128,T[b++]=h>>>6&63|128;else continue;else{T[b++]=h;continue}T[b++]=h&63|128}return T.slice?T.slice(0,b):T.subarray(0,b)}var u="Failed to ",c=function(a,v,E){if(a)throw new Error("".concat(u).concat(v,": the '").concat(E,"' option is unsupported."))},i=typeof Buffer=="function"&&Buffer.from,y=i?r:s;function f(){this.encoding="utf-8"}f.prototype.encode=function(a,v){return c(v&&v.stream,"encode","stream"),y(a)};function A(a){var v;try{var E=new Blob([a],{type:"text/plain;charset=UTF-8"});v=URL.createObjectURL(E);var b=new XMLHttpRequest;return b.open("GET",v,!1),b.send(),b.responseText}finally{v&&URL.revokeObjectURL(v)}}var C=!i&&typeof Blob=="function"&&typeof URL=="function"&&typeof URL.createObjectURL=="function",p=["utf-8","utf8","unicode-1-1-utf-8"],o=n;i?o=e:C&&(o=function(a){try{return A(a)}catch{return n(a)}});var m="construct 'TextDecoder'",g="".concat(u," ").concat(m,": the ");function S(a,v){c(v&&v.fatal,m,"fatal"),a=a||"utf-8";var E;if(i?E=Buffer.isEncoding(a):E=p.indexOf(a.toLowerCase())!==-1,!E)throw new RangeError("".concat(g," encoding label provided ('").concat(a,"') is invalid."));this.encoding=a,this.fatal=!1,this.ignoreBOM=!1}S.prototype.decode=function(a,v){c(v&&v.stream,"decode","stream");var E;return a instanceof Uint8Array?E=a:a.buffer instanceof ArrayBuffer?E=new Uint8Array(a.buffer):E=new Uint8Array(a),o(E,this.encoding)},t.TextEncoder=t.TextEncoder||f,t.TextDecoder=t.TextDecoder||S}(typeof window<"u"?window:Re)),Ws}var Ys;function kf(){if(Ys)return Ur;Ys=1,Object.defineProperty(Ur,"__esModule",{value:!0}),Ur.BrowserCrypto=void 0;const t=ei;typeof process>"u"&&typeof TextEncoder>"u"&&Of();const e=Jr();class r{constructor(){if(typeof window>"u"||window.crypto===void 0||window.crypto.subtle===void 0)throw new Error("SubtleCrypto not found. Make sure it's an https:// website.")}async sha256DigestBase64(s){const u=new TextEncoder().encode(s),c=await window.crypto.subtle.digest("SHA-256",u);return t.fromByteArray(new Uint8Array(c))}randomBytesBase64(s){const u=new Uint8Array(s);return window.crypto.getRandomValues(u),t.fromByteArray(u)}static padBase64(s){for(;s.length%4!==0;)s+="=";return s}async verify(s,u,c){const i={name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},y=new TextEncoder().encode(u),f=t.toByteArray(r.padBase64(c)),A=await window.crypto.subtle.importKey("jwk",s,i,!0,["verify"]);return await window.crypto.subtle.verify(i,A,f,y)}async sign(s,u){const c={name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},i=new TextEncoder().encode(u),y=await window.crypto.subtle.importKey("jwk",s,c,!0,["sign"]),f=await window.crypto.subtle.sign(c,y,i);return t.fromByteArray(new Uint8Array(f))}decodeBase64StringUtf8(s){const u=t.toByteArray(r.padBase64(s));return new TextDecoder().decode(u)}encodeBase64StringUtf8(s){const u=new TextEncoder().encode(s);return t.fromByteArray(u)}async sha256DigestHex(s){const u=new TextEncoder().encode(s),c=await window.crypto.subtle.digest("SHA-256",u);return(0,e.fromArrayBufferToHex)(c)}async signWithHmacSha256(s,u){const c=typeof s=="string"?s:String.fromCharCode(...new Uint16Array(s)),i=new TextEncoder,y=await window.crypto.subtle.importKey("raw",i.encode(c),{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]);return window.crypto.subtle.sign("HMAC",y,i.encode(u))}}return Ur.BrowserCrypto=r,Ur}var ti={};Object.defineProperty(ti,"__esModule",{value:!0});ti.NodeCrypto=void 0;const dr=Qr;class Lf{async sha256DigestBase64(e){return dr.createHash("sha256").update(e).digest("base64")}randomBytesBase64(e){return dr.randomBytes(e).toString("base64")}async verify(e,r,n){const s=dr.createVerify("sha256");return s.update(r),s.end(),s.verify(e,n,"base64")}async sign(e,r){const n=dr.createSign("RSA-SHA256");return n.update(r),n.end(),n.sign(e,"base64")}decodeBase64StringUtf8(e){return Buffer.from(e,"base64").toString("utf-8")}encodeBase64StringUtf8(e){return Buffer.from(e,"utf-8").toString("base64")}async sha256DigestHex(e){return dr.createHash("sha256").update(e).digest("hex")}async signWithHmacSha256(e,r){const n=typeof e=="string"?e:Ff(e);return Df(dr.createHmac("sha256",n).update(r).digest())}}ti.NodeCrypto=Lf;function Df(t){return t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength)}function Ff(t){return Buffer.from(t)}var Js;function Jr(){if(Js)return wt;Js=1,Object.defineProperty(wt,"__esModule",{value:!0}),wt.fromArrayBufferToHex=wt.hasBrowserCrypto=wt.createCrypto=void 0;const t=kf(),e=ti;function r(){return n()?new t.BrowserCrypto:new e.NodeCrypto}wt.createCrypto=r;function n(){return typeof window<"u"&&typeof window.crypto<"u"&&typeof window.crypto.subtle<"u"}wt.hasBrowserCrypto=n;function s(u){return Array.from(new Uint8Array(u)).map(i=>i.toString(16).padStart(2,"0")).join("")}return wt.fromArrayBufferToHex=s,wt}var ir={},ri={};Object.defineProperty(ri,"__esModule",{value:!0});ri.validate=void 0;function Mf(t){const e=[{invalid:"uri",expected:"url"},{invalid:"json",expected:"data"},{invalid:"qs",expected:"params"}];for(const r of e)if(t[r.invalid]){const n=`'${r.invalid}' is not a valid configuration option. Please use '${r.expected}' instead. This library is using Axios for requests. Please see https://github.com/axios/axios to learn more about the valid request options.`;throw new Error(n)}}ri.validate=Mf;const qf="google-auth-library",Vf="8.8.0",Kf="Google Inc.",$f="Google APIs Authentication Client Library for Node.js",Gf={node:">=12"},jf="./build/src/index.js",Hf="./build/src/index.d.ts",zf="googleapis/google-auth-library-nodejs.git",Wf=["google","api","google apis","client","client library"],Qf={arrify:"^2.0.0","base64-js":"^1.3.0","ecdsa-sig-formatter":"^1.0.11","fast-text-encoding":"^1.0.0",gaxios:"^5.0.0","gcp-metadata":"^5.2.0",gtoken:"^6.1.0",jws:"^4.0.0","lru-cache":"^6.0.0"},Yf={"@compodoc/compodoc":"^1.1.7","@types/base64-js":"^1.2.5","@types/chai":"^4.1.7","@types/jws":"^3.1.0","@types/lru-cache":"^5.0.0","@types/mocha":"^9.0.0","@types/mv":"^2.1.0","@types/ncp":"^2.0.1","@types/node":"^16.0.0","@types/sinon":"^10.0.0","assert-rejects":"^1.0.0",c8:"^7.0.0",chai:"^4.2.0",codecov:"^3.0.2",execa:"^5.0.0",gts:"^3.1.0","is-docker":"^2.0.0",karma:"^6.0.0","karma-chrome-launcher":"^3.0.0","karma-coverage":"^2.0.0","karma-firefox-launcher":"^2.0.0","karma-mocha":"^2.0.0","karma-sourcemap-loader":"^0.4.0","karma-webpack":"^5.0.0",keypair:"^1.0.4",linkinator:"^4.0.0",mocha:"^9.2.2",mv:"^2.1.1",ncp:"^2.0.0",nock:"^13.0.0","null-loader":"^4.0.0",puppeteer:"^18.0.0",sinon:"^15.0.0","ts-loader":"^8.0.0",typescript:"^4.6.3",webpack:"^5.21.2","webpack-cli":"^4.0.0"},Jf=["build/src","!build/src/**/*.map"],Xf={test:"c8 mocha build/test",clean:"gts clean",prepare:"npm run compile",lint:"gts check",compile:"tsc -p .",fix:"gts fix",pretest:"npm run compile",docs:"compodoc src/","samples-setup":"cd samples/ && npm link ../ && npm run setup && cd ../","samples-test":"cd samples/ && npm link ../ && npm test && cd ../","system-test":"mocha build/system-test --timeout 60000","presystem-test":"npm run compile",webpack:"webpack","browser-test":"karma start","docs-test":"linkinator docs","predocs-test":"npm run docs",prelint:"cd samples; npm link ../; npm install",precompile:"gts clean"},Zf="Apache-2.0",e0={name:qf,version:Vf,author:Kf,description:$f,engines:Gf,main:jf,types:Hf,repository:zf,keywords:Wf,dependencies:Qf,devDependencies:Yf,files:Jf,scripts:Xf,license:Zf};Object.defineProperty(ir,"__esModule",{value:!0});ir.DefaultTransporter=void 0;const Xs=At,t0=ri,Xu=e0,Zu="google-api-nodejs-client";class zr{configure(e={}){if(e.headers=e.headers||{},typeof window>"u"){const r=e.headers["User-Agent"];r?r.includes(`${Zu}/`)||(e.headers["User-Agent"]=`${r} ${zr.USER_AGENT}`):e.headers["User-Agent"]=zr.USER_AGENT;const n=`auth/${Xu.version}`;if(e.headers["x-goog-api-client"]&&!e.headers["x-goog-api-client"].includes(n))e.headers["x-goog-api-client"]=`${e.headers["x-goog-api-client"]} ${n}`;else if(!e.headers["x-goog-api-client"]){const s=process.version.replace(/^v/,"");e.headers["x-goog-api-client"]=`gl-node/${s} ${n}`}}return e}request(e,r){e=this.configure(e);try{(0,t0.validate)(e)}catch(n){if(r)return r(n);throw n}if(r)(0,Xs.request)(e).then(n=>{r(null,n)},n=>{r(this.processError(n))});else return(0,Xs.request)(e).catch(n=>{throw this.processError(n)})}processError(e){const r=e.response,n=e,s=r?r.data:null;return r&&s&&s.error&&r.status!==200?typeof s.error=="string"?(n.message=s.error,n.code=r.status.toString()):Array.isArray(s.error.errors)?(n.message=s.error.errors.map(u=>u.message).join(`
`),n.code=s.error.code,n.errors=s.error.errors):(n.message=s.error.message,n.code=s.error.code||r.status):r&&r.status>=400&&(n.message=s,n.code=r.status.toString()),n}}ir.DefaultTransporter=zr;zr.USER_AGENT=`${Zu}/${Xu.version}`;var Xr={};const r0=t=>t==null?[]:Array.isArray(t)?t:typeof t=="string"?[t]:typeof t[Symbol.iterator]=="function"?[...t]:[t];var n0=r0,ar={},Ja={exports:{}};/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */(function(t,e){var r=Wn,n=r.Buffer;function s(c,i){for(var y in c)i[y]=c[y]}n.from&&n.alloc&&n.allocUnsafe&&n.allocUnsafeSlow?t.exports=r:(s(r,e),e.Buffer=u);function u(c,i,y){return n(c,i,y)}u.prototype=Object.create(n.prototype),s(n,u),u.from=function(c,i,y){if(typeof c=="number")throw new TypeError("Argument must not be a number");return n(c,i,y)},u.alloc=function(c,i,y){if(typeof c!="number")throw new TypeError("Argument must be a number");var f=n(c);return i!==void 0?typeof y=="string"?f.fill(i,y):f.fill(i):f.fill(0),f},u.allocUnsafe=function(c){if(typeof c!="number")throw new TypeError("Argument must be a number");return n(c)},u.allocUnsafeSlow=function(c){if(typeof c!="number")throw new TypeError("Argument must be a number");return r.SlowBuffer(c)}})(Ja,Ja.exports);var Zr=Ja.exports;function Oi(t){var e=(t/8|0)+(t%8===0?0:1);return e}var i0={ES256:Oi(256),ES384:Oi(384),ES512:Oi(521)};function a0(t){var e=i0[t];if(e)return e;throw new Error('Unknown algorithm "'+t+'"')}var s0=a0,Ln=Zr.Buffer,ec=s0,Dn=128,tc=0,o0=32,u0=16,c0=2,rc=u0|o0|tc<<6,Fn=c0|tc<<6;function l0(t){return t.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function nc(t){if(Ln.isBuffer(t))return t;if(typeof t=="string")return Ln.from(t,"base64");throw new TypeError("ECDSA signature must be a Base64 string or a Buffer")}function f0(t,e){t=nc(t);var r=ec(e),n=r+1,s=t.length,u=0;if(t[u++]!==rc)throw new Error('Could not find expected "seq"');var c=t[u++];if(c===(Dn|1)&&(c=t[u++]),s-u<c)throw new Error('"seq" specified length of "'+c+'", only "'+(s-u)+'" remaining');if(t[u++]!==Fn)throw new Error('Could not find expected "int" for "r"');var i=t[u++];if(s-u-2<i)throw new Error('"r" specified length of "'+i+'", only "'+(s-u-2)+'" available');if(n<i)throw new Error('"r" specified length of "'+i+'", max of "'+n+'" is acceptable');var y=u;if(u+=i,t[u++]!==Fn)throw new Error('Could not find expected "int" for "s"');var f=t[u++];if(s-u!==f)throw new Error('"s" specified length of "'+f+'", expected "'+(s-u)+'"');if(n<f)throw new Error('"s" specified length of "'+f+'", max of "'+n+'" is acceptable');var A=u;if(u+=f,u!==s)throw new Error('Expected to consume entire buffer, but "'+(s-u)+'" bytes remain');var C=r-i,p=r-f,o=Ln.allocUnsafe(C+i+p+f);for(u=0;u<C;++u)o[u]=0;t.copy(o,u,y+Math.max(-C,0),y+i),u=r;for(var m=u;u<m+p;++u)o[u]=0;return t.copy(o,u,A+Math.max(-p,0),A+f),o=o.toString("base64"),o=l0(o),o}function Zs(t,e,r){for(var n=0;e+n<r&&t[e+n]===0;)++n;var s=t[e+n]>=Dn;return s&&--n,n}function d0(t,e){t=nc(t);var r=ec(e),n=t.length;if(n!==r*2)throw new TypeError('"'+e+'" signatures must be "'+r*2+'" bytes, saw "'+n+'"');var s=Zs(t,0,r),u=Zs(t,r,t.length),c=r-s,i=r-u,y=1+1+c+1+1+i,f=y<Dn,A=Ln.allocUnsafe((f?2:3)+y),C=0;return A[C++]=rc,f?A[C++]=y:(A[C++]=Dn|1,A[C++]=y&255),A[C++]=Fn,A[C++]=c,s<0?(A[C++]=0,C+=t.copy(A,C,0,r)):C+=t.copy(A,C,s,r),A[C++]=Fn,A[C++]=i,u<0?(A[C++]=0,t.copy(A,C,r)):t.copy(A,C,r+u),A}var ic={derToJose:f0,joseToDer:d0},Kt={};Object.defineProperty(Kt,"__esModule",{value:!0});Kt.AuthClient=void 0;const h0=Du,p0=ir;class y0 extends h0.EventEmitter{constructor(){super(...arguments),this.transporter=new p0.DefaultTransporter,this.credentials={},this.eagerRefreshThresholdMillis=5*60*1e3,this.forceRefreshOnFailure=!1}setCredentials(e){this.credentials=e}addSharedMetadataHeaders(e){return!e["x-goog-user-project"]&&this.quotaProjectId&&(e["x-goog-user-project"]=this.quotaProjectId),e}}Kt.AuthClient=y0;var en={};Object.defineProperty(en,"__esModule",{value:!0});en.LoginTicket=void 0;class g0{constructor(e,r){this.envelope=e,this.payload=r}getEnvelope(){return this.envelope}getPayload(){return this.payload}getUserId(){const e=this.getPayload();return e&&e.sub?e.sub:null}getAttributes(){return{envelope:this.getEnvelope(),payload:this.getPayload()}}}en.LoginTicket=g0;(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.OAuth2Client=t.CertificateFormat=t.CodeChallengeMethod=void 0;const e=At,r=Hn,n=Nt,s=ic,u=Jr(),c=Kt,i=en;(function(A){A.Plain="plain",A.S256="S256"})(t.CodeChallengeMethod||(t.CodeChallengeMethod={}));var y;(function(A){A.PEM="PEM",A.JWK="JWK"})(y=t.CertificateFormat||(t.CertificateFormat={}));class f extends c.AuthClient{constructor(C,p,o){super(),this.certificateCache={},this.certificateExpiry=null,this.certificateCacheFormat=y.PEM,this.refreshTokenPromises=new Map;const m=C&&typeof C=="object"?C:{clientId:C,clientSecret:p,redirectUri:o};this._clientId=m.clientId,this._clientSecret=m.clientSecret,this.redirectUri=m.redirectUri,this.eagerRefreshThresholdMillis=m.eagerRefreshThresholdMillis||5*60*1e3,this.forceRefreshOnFailure=!!m.forceRefreshOnFailure}generateAuthUrl(C={}){if(C.code_challenge_method&&!C.code_challenge)throw new Error("If a code_challenge_method is provided, code_challenge must be included.");return C.response_type=C.response_type||"code",C.client_id=C.client_id||this._clientId,C.redirect_uri=C.redirect_uri||this.redirectUri,Array.isArray(C.scope)&&(C.scope=C.scope.join(" ")),f.GOOGLE_OAUTH2_AUTH_BASE_URL_+"?"+r.stringify(C)}generateCodeVerifier(){throw new Error("generateCodeVerifier is removed, please use generateCodeVerifierAsync instead.")}async generateCodeVerifierAsync(){const C=(0,u.createCrypto)(),o=C.randomBytesBase64(96).replace(/\+/g,"~").replace(/=/g,"_").replace(/\//g,"-"),g=(await C.sha256DigestBase64(o)).split("=")[0].replace(/\+/g,"-").replace(/\//g,"_");return{codeVerifier:o,codeChallenge:g}}getToken(C,p){const o=typeof C=="string"?{code:C}:C;if(p)this.getTokenAsync(o).then(m=>p(null,m.tokens,m.res),m=>p(m,null,m.response));else return this.getTokenAsync(o)}async getTokenAsync(C){const p=f.GOOGLE_OAUTH2_TOKEN_URL_,o={code:C.code,client_id:C.client_id||this._clientId,client_secret:this._clientSecret,redirect_uri:C.redirect_uri||this.redirectUri,grant_type:"authorization_code",code_verifier:C.codeVerifier},m=await this.transporter.request({method:"POST",url:p,data:r.stringify(o),headers:{"Content-Type":"application/x-www-form-urlencoded"}}),g=m.data;return m.data&&m.data.expires_in&&(g.expiry_date=new Date().getTime()+m.data.expires_in*1e3,delete g.expires_in),this.emit("tokens",g),{tokens:g,res:m}}async refreshToken(C){if(!C)return this.refreshTokenNoCache(C);if(this.refreshTokenPromises.has(C))return this.refreshTokenPromises.get(C);const p=this.refreshTokenNoCache(C).then(o=>(this.refreshTokenPromises.delete(C),o),o=>{throw this.refreshTokenPromises.delete(C),o});return this.refreshTokenPromises.set(C,p),p}async refreshTokenNoCache(C){var p;if(!C)throw new Error("No refresh token is set.");const o=f.GOOGLE_OAUTH2_TOKEN_URL_,m={refresh_token:C,client_id:this._clientId,client_secret:this._clientSecret,grant_type:"refresh_token"};let g;try{g=await this.transporter.request({method:"POST",url:o,data:r.stringify(m),headers:{"Content-Type":"application/x-www-form-urlencoded"}})}catch(a){throw a instanceof e.GaxiosError&&a.message==="invalid_grant"&&(!((p=a.response)===null||p===void 0)&&p.data)&&/ReAuth/i.test(a.response.data.error_description)&&(a.message=JSON.stringify(a.response.data)),a}const S=g.data;return g.data&&g.data.expires_in&&(S.expiry_date=new Date().getTime()+g.data.expires_in*1e3,delete S.expires_in),this.emit("tokens",S),{tokens:S,res:g}}refreshAccessToken(C){if(C)this.refreshAccessTokenAsync().then(p=>C(null,p.credentials,p.res),C);else return this.refreshAccessTokenAsync()}async refreshAccessTokenAsync(){const C=await this.refreshToken(this.credentials.refresh_token),p=C.tokens;return p.refresh_token=this.credentials.refresh_token,this.credentials=p,{credentials:this.credentials,res:C.res}}getAccessToken(C){if(C)this.getAccessTokenAsync().then(p=>C(null,p.token,p.res),C);else return this.getAccessTokenAsync()}async getAccessTokenAsync(){if(!this.credentials.access_token||this.isTokenExpiring()){if(!this.credentials.refresh_token)if(this.refreshHandler){const o=await this.processAndValidateRefreshHandler();if(o!=null&&o.access_token)return this.setCredentials(o),{token:this.credentials.access_token}}else throw new Error("No refresh token or refresh handler callback is set.");const p=await this.refreshAccessTokenAsync();if(!p.credentials||p.credentials&&!p.credentials.access_token)throw new Error("Could not refresh access token.");return{token:p.credentials.access_token,res:p.res}}else return{token:this.credentials.access_token}}async getRequestHeaders(C){return(await this.getRequestMetadataAsync(C)).headers}async getRequestMetadataAsync(C){const p=this.credentials;if(!p.access_token&&!p.refresh_token&&!this.apiKey&&!this.refreshHandler)throw new Error("No access, refresh token, API key or refresh handler callback is set.");if(p.access_token&&!this.isTokenExpiring()){p.token_type=p.token_type||"Bearer";const a={Authorization:p.token_type+" "+p.access_token};return{headers:this.addSharedMetadataHeaders(a)}}if(this.refreshHandler){const a=await this.processAndValidateRefreshHandler();if(a!=null&&a.access_token){this.setCredentials(a);const v={Authorization:"Bearer "+this.credentials.access_token};return{headers:this.addSharedMetadataHeaders(v)}}}if(this.apiKey)return{headers:{"X-Goog-Api-Key":this.apiKey}};let o=null,m=null;try{o=await this.refreshToken(p.refresh_token),m=o.tokens}catch(a){const v=a;throw v.response&&(v.response.status===403||v.response.status===404)&&(v.message=`Could not refresh access token: ${v.message}`),v}const g=this.credentials;g.token_type=g.token_type||"Bearer",m.refresh_token=g.refresh_token,this.credentials=m;const S={Authorization:g.token_type+" "+m.access_token};return{headers:this.addSharedMetadataHeaders(S),res:o.res}}static getRevokeTokenUrl(C){const p=r.stringify({token:C});return`${f.GOOGLE_OAUTH2_REVOKE_URL_}?${p}`}revokeToken(C,p){const o={url:f.getRevokeTokenUrl(C),method:"POST"};if(p)this.transporter.request(o).then(m=>p(null,m),p);else return this.transporter.request(o)}revokeCredentials(C){if(C)this.revokeCredentialsAsync().then(p=>C(null,p),C);else return this.revokeCredentialsAsync()}async revokeCredentialsAsync(){const C=this.credentials.access_token;if(this.credentials={},C)return this.revokeToken(C);throw new Error("No access token to revoke.")}request(C,p){if(p)this.requestAsync(C).then(o=>p(null,o),o=>p(o,o.response));else return this.requestAsync(C)}async requestAsync(C,p=!1){let o;try{const m=await this.getRequestMetadataAsync(C.url);C.headers=C.headers||{},m.headers&&m.headers["x-goog-user-project"]&&(C.headers["x-goog-user-project"]=m.headers["x-goog-user-project"]),m.headers&&m.headers.Authorization&&(C.headers.Authorization=m.headers.Authorization),this.apiKey&&(C.headers["X-Goog-Api-Key"]=this.apiKey),o=await this.transporter.request(C)}catch(m){const g=m.response;if(g){const S=g.status,a=this.credentials&&this.credentials.access_token&&this.credentials.refresh_token&&(!this.credentials.expiry_date||this.forceRefreshOnFailure),v=this.credentials&&this.credentials.access_token&&!this.credentials.refresh_token&&(!this.credentials.expiry_date||this.forceRefreshOnFailure)&&this.refreshHandler,E=g.config.data instanceof n.Readable,b=S===401||S===403;if(!p&&b&&!E&&a)return await this.refreshAccessTokenAsync(),this.requestAsync(C,!0);if(!p&&b&&!E&&v){const R=await this.processAndValidateRefreshHandler();return R!=null&&R.access_token&&this.setCredentials(R),this.requestAsync(C,!0)}}throw m}return o}verifyIdToken(C,p){if(p&&typeof p!="function")throw new Error("This method accepts an options object as the first parameter, which includes the idToken, audience, and maxExpiry.");if(p)this.verifyIdTokenAsync(C).then(o=>p(null,o),p);else return this.verifyIdTokenAsync(C)}async verifyIdTokenAsync(C){if(!C.idToken)throw new Error("The verifyIdToken method requires an ID Token");const p=await this.getFederatedSignonCertsAsync();return await this.verifySignedJwtWithCertsAsync(C.idToken,p.certs,C.audience,f.ISSUERS_,C.maxExpiry)}async getTokenInfo(C){const{data:p}=await this.transporter.request({method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:`Bearer ${C}`},url:f.GOOGLE_TOKEN_INFO_URL}),o=Object.assign({expiry_date:new Date().getTime()+p.expires_in*1e3,scopes:p.scope.split(" ")},p);return delete o.expires_in,delete o.scope,o}getFederatedSignonCerts(C){if(C)this.getFederatedSignonCertsAsync().then(p=>C(null,p.certs,p.res),C);else return this.getFederatedSignonCertsAsync()}async getFederatedSignonCertsAsync(){const C=new Date().getTime(),p=(0,u.hasBrowserCrypto)()?y.JWK:y.PEM;if(this.certificateExpiry&&C<this.certificateExpiry.getTime()&&this.certificateCacheFormat===p)return{certs:this.certificateCache,format:p};let o,m;switch(p){case y.PEM:m=f.GOOGLE_OAUTH2_FEDERATED_SIGNON_PEM_CERTS_URL_;break;case y.JWK:m=f.GOOGLE_OAUTH2_FEDERATED_SIGNON_JWK_CERTS_URL_;break;default:throw new Error(`Unsupported certificate format ${p}`)}try{o=await this.transporter.request({url:m})}catch(E){throw E instanceof Error&&(E.message=`Failed to retrieve verification certificates: ${E.message}`),E}const g=o?o.headers["cache-control"]:void 0;let S=-1;if(g){const b=new RegExp("max-age=([0-9]*)").exec(g);b&&b.length===2&&(S=Number(b[1])*1e3)}let a={};switch(p){case y.PEM:a=o.data;break;case y.JWK:for(const E of o.data.keys)a[E.kid]=E;break;default:throw new Error(`Unsupported certificate format ${p}`)}const v=new Date;return this.certificateExpiry=S===-1?null:new Date(v.getTime()+S),this.certificateCache=a,this.certificateCacheFormat=p,{certs:a,format:p,res:o}}getIapPublicKeys(C){if(C)this.getIapPublicKeysAsync().then(p=>C(null,p.pubkeys,p.res),C);else return this.getIapPublicKeysAsync()}async getIapPublicKeysAsync(){let C;const p=f.GOOGLE_OAUTH2_IAP_PUBLIC_KEY_URL_;try{C=await this.transporter.request({url:p})}catch(o){throw o instanceof Error&&(o.message=`Failed to retrieve verification certificates: ${o.message}`),o}return{pubkeys:C.data,res:C}}verifySignedJwtWithCerts(){throw new Error("verifySignedJwtWithCerts is removed, please use verifySignedJwtWithCertsAsync instead.")}async verifySignedJwtWithCertsAsync(C,p,o,m,g){const S=(0,u.createCrypto)();g||(g=f.MAX_TOKEN_LIFETIME_SECS_);const a=C.split(".");if(a.length!==3)throw new Error("Wrong number of segments in token: "+C);const v=a[0]+"."+a[1];let E=a[2],b,R;try{b=JSON.parse(S.decodeBase64StringUtf8(a[0]))}catch(q){throw q instanceof Error&&(q.message=`Can't parse token envelope: ${a[0]}': ${q.message}`),q}if(!b)throw new Error("Can't parse token envelope: "+a[0]);try{R=JSON.parse(S.decodeBase64StringUtf8(a[1]))}catch(q){throw q instanceof Error&&(q.message=`Can't parse token payload '${a[0]}`),q}if(!R)throw new Error("Can't parse token payload: "+a[1]);if(!Object.prototype.hasOwnProperty.call(p,b.kid))throw new Error("No pem found for envelope: "+JSON.stringify(b));const T=p[b.kid];if(b.alg==="ES256"&&(E=s.joseToDer(E,"ES256").toString("base64")),!await S.verify(T,v,E))throw new Error("Invalid token signature: "+C);if(!R.iat)throw new Error("No issue time in token: "+JSON.stringify(R));if(!R.exp)throw new Error("No expiration time in token: "+JSON.stringify(R));const l=Number(R.iat);if(isNaN(l))throw new Error("iat field using invalid format");const B=Number(R.exp);if(isNaN(B))throw new Error("exp field using invalid format");const N=new Date().getTime()/1e3;if(B>=N+g)throw new Error("Expiration time too far in future: "+JSON.stringify(R));const F=l-f.CLOCK_SKEW_SECS_,L=B+f.CLOCK_SKEW_SECS_;if(N<F)throw new Error("Token used too early, "+N+" < "+F+": "+JSON.stringify(R));if(N>L)throw new Error("Token used too late, "+N+" > "+L+": "+JSON.stringify(R));if(m&&m.indexOf(R.iss)<0)throw new Error("Invalid issuer, expected one of ["+m+"], but got "+R.iss);if(typeof o<"u"&&o!==null){const q=R.aud;let j=!1;if(o.constructor===Array?j=o.indexOf(q)>-1:j=q===o,!j)throw new Error("Wrong recipient, payload audience != requiredAudience")}return new i.LoginTicket(b,R)}async processAndValidateRefreshHandler(){if(this.refreshHandler){const C=await this.refreshHandler();if(!C.access_token)throw new Error("No access token is returned by the refreshHandler callback.");return C}}isTokenExpiring(){const C=this.credentials.expiry_date;return C?C<=new Date().getTime()+this.eagerRefreshThresholdMillis:!1}}t.OAuth2Client=f,f.GOOGLE_TOKEN_INFO_URL="https://oauth2.googleapis.com/tokeninfo",f.GOOGLE_OAUTH2_AUTH_BASE_URL_="https://accounts.google.com/o/oauth2/v2/auth",f.GOOGLE_OAUTH2_TOKEN_URL_="https://oauth2.googleapis.com/token",f.GOOGLE_OAUTH2_REVOKE_URL_="https://oauth2.googleapis.com/revoke",f.GOOGLE_OAUTH2_FEDERATED_SIGNON_PEM_CERTS_URL_="https://www.googleapis.com/oauth2/v1/certs",f.GOOGLE_OAUTH2_FEDERATED_SIGNON_JWK_CERTS_URL_="https://www.googleapis.com/oauth2/v3/certs",f.GOOGLE_OAUTH2_IAP_PUBLIC_KEY_URL_="https://www.gstatic.com/iap/verify/public_key",f.CLOCK_SKEW_SECS_=300,f.MAX_TOKEN_LIFETIME_SECS_=86400,f.ISSUERS_=["accounts.google.com","https://accounts.google.com"]})(ar);Object.defineProperty(Xr,"__esModule",{value:!0});Xr.Compute=void 0;const v0=n0,m0=At,eo=Qn,E0=ar;class C0 extends E0.OAuth2Client{constructor(e={}){super(e),this.credentials={expiry_date:1,refresh_token:"compute-placeholder"},this.serviceAccountEmail=e.serviceAccountEmail||"default",this.scopes=v0(e.scopes)}async refreshTokenNoCache(e){const r=`service-accounts/${this.serviceAccountEmail}/token`;let n;try{const u={property:r};this.scopes.length>0&&(u.params={scopes:this.scopes.join(",")}),n=await eo.instance(u)}catch(u){throw u instanceof m0.GaxiosError&&(u.message=`Could not refresh access token: ${u.message}`,this.wrapError(u)),u}const s=n;return n&&n.expires_in&&(s.expiry_date=new Date().getTime()+n.expires_in*1e3,delete s.expires_in),this.emit("tokens",s),{tokens:s,res:null}}async fetchIdToken(e){const r=`service-accounts/${this.serviceAccountEmail}/identity?format=full&audience=${e}`;let n;try{const s={property:r};n=await eo.instance(s)}catch(s){throw s instanceof Error&&(s.message=`Could not fetch ID token: ${s.message}`),s}return n}wrapError(e){const r=e.response;r&&r.status&&(e.code=r.status.toString(),r.status===403?e.message="A Forbidden error was returned while attempting to retrieve an access token for the Compute Engine built-in service account. This may be because the Compute Engine instance does not have the correct permission scopes specified: "+e.message:r.status===404&&(e.message="A Not Found error was returned while attempting to retrieve an accesstoken for the Compute Engine built-in service account. This may be because the Compute Engine instance does not have any permission scopes specified: "+e.message))}}Xr.Compute=C0;var tn={};Object.defineProperty(tn,"__esModule",{value:!0});tn.IdTokenClient=void 0;const S0=ar;class A0 extends S0.OAuth2Client{constructor(e){super(),this.targetAudience=e.targetAudience,this.idTokenProvider=e.idTokenProvider}async getRequestMetadataAsync(e){if(!this.credentials.id_token||(this.credentials.expiry_date||0)<Date.now()){const n=await this.idTokenProvider.fetchIdToken(this.targetAudience);this.credentials={id_token:n,expiry_date:this.getIdTokenExpiryDate(n)}}return{headers:{Authorization:"Bearer "+this.credentials.id_token}}}getIdTokenExpiryDate(e){const r=e.split(".")[1];if(r)return JSON.parse(Buffer.from(r,"base64").toString("ascii")).exp*1e3}}tn.IdTokenClient=A0;var cs={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.getEnv=t.clear=t.GCPEnv=void 0;const e=Qn;var r;(function(p){p.APP_ENGINE="APP_ENGINE",p.KUBERNETES_ENGINE="KUBERNETES_ENGINE",p.CLOUD_FUNCTIONS="CLOUD_FUNCTIONS",p.COMPUTE_ENGINE="COMPUTE_ENGINE",p.CLOUD_RUN="CLOUD_RUN",p.NONE="NONE"})(r=t.GCPEnv||(t.GCPEnv={}));let n;function s(){n=void 0}t.clear=s;async function u(){return n||(n=c(),n)}t.getEnv=u;async function c(){let p=r.NONE;return i()?p=r.APP_ENGINE:y()?p=r.CLOUD_FUNCTIONS:await C()?await A()?p=r.KUBERNETES_ENGINE:f()?p=r.CLOUD_RUN:p=r.COMPUTE_ENGINE:p=r.NONE,p}function i(){return!!(process.env.GAE_SERVICE||process.env.GAE_MODULE_NAME)}function y(){return!!(process.env.FUNCTION_NAME||process.env.FUNCTION_TARGET)}function f(){return!!process.env.K_CONFIGURATION}async function A(){try{return await e.instance("attributes/cluster-name"),!0}catch{return!1}}async function C(){return e.isAvailable()}})(cs);var rn={},ni={},Ut={},Mn=Zr.Buffer,T0=Nt,x0=Pt;function ii(t){if(this.buffer=null,this.writable=!0,this.readable=!0,!t)return this.buffer=Mn.alloc(0),this;if(typeof t.pipe=="function")return this.buffer=Mn.alloc(0),t.pipe(this),this;if(t.length||typeof t=="object")return this.buffer=t,this.writable=!1,process.nextTick(function(){this.emit("end",t),this.readable=!1,this.emit("close")}.bind(this)),this;throw new TypeError("Unexpected data type ("+typeof t+")")}x0.inherits(ii,T0);ii.prototype.write=function(e){this.buffer=Mn.concat([this.buffer,Mn.from(e)]),this.emit("data",e)};ii.prototype.end=function(e){e&&this.write(e),this.emit("end",e),this.emit("close"),this.writable=!1,this.readable=!1};var ac=ii,Wr=Wn.Buffer,ls=Wn.SlowBuffer,_0=qn;function qn(t,e){if(!Wr.isBuffer(t)||!Wr.isBuffer(e)||t.length!==e.length)return!1;for(var r=0,n=0;n<t.length;n++)r|=t[n]^e[n];return r===0}qn.install=function(){Wr.prototype.equal=ls.prototype.equal=function(e){return qn(this,e)}};var w0=Wr.prototype.equal,I0=ls.prototype.equal;qn.restore=function(){Wr.prototype.equal=w0,ls.prototype.equal=I0};var b0=_0,Ar=Zr.Buffer,St=Qr,sc=ic,to=Pt,R0=`"%s" is not a valid algorithm.
  Supported algorithms are:
  "HS256", "HS384", "HS512", "RS256", "RS384", "RS512", "PS256", "PS384", "PS512", "ES256", "ES384", "ES512" and "none".`,Vr="secret must be a string or buffer",gr="key must be a string or a buffer",B0="key must be a string, a buffer or an object",fs=typeof St.createPublicKey=="function";fs&&(gr+=" or a KeyObject",Vr+="or a KeyObject");function oc(t){if(!Ar.isBuffer(t)&&typeof t!="string"&&(!fs||typeof t!="object"||typeof t.type!="string"||typeof t.asymmetricKeyType!="string"||typeof t.export!="function"))throw pt(gr)}function uc(t){if(!Ar.isBuffer(t)&&typeof t!="string"&&typeof t!="object")throw pt(B0)}function N0(t){if(!Ar.isBuffer(t)){if(typeof t=="string")return t;if(!fs||typeof t!="object"||t.type!=="secret"||typeof t.export!="function")throw pt(Vr)}}function ds(t){return t.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function cc(t){t=t.toString();var e=4-t.length%4;if(e!==4)for(var r=0;r<e;++r)t+="=";return t.replace(/\-/g,"+").replace(/_/g,"/")}function pt(t){var e=[].slice.call(arguments,1),r=to.format.bind(to,t).apply(null,e);return new TypeError(r)}function P0(t){return Ar.isBuffer(t)||typeof t=="string"}function nn(t){return P0(t)||(t=JSON.stringify(t)),t}function lc(t){return function(r,n){N0(n),r=nn(r);var s=St.createHmac("sha"+t,n),u=(s.update(r),s.digest("base64"));return ds(u)}}function U0(t){return function(r,n,s){var u=lc(t)(r,s);return b0(Ar.from(n),Ar.from(u))}}function fc(t){return function(r,n){uc(n),r=nn(r);var s=St.createSign("RSA-SHA"+t),u=(s.update(r),s.sign(n,"base64"));return ds(u)}}function dc(t){return function(r,n,s){oc(s),r=nn(r),n=cc(n);var u=St.createVerify("RSA-SHA"+t);return u.update(r),u.verify(s,n,"base64")}}function O0(t){return function(r,n){uc(n),r=nn(r);var s=St.createSign("RSA-SHA"+t),u=(s.update(r),s.sign({key:n,padding:St.constants.RSA_PKCS1_PSS_PADDING,saltLength:St.constants.RSA_PSS_SALTLEN_DIGEST},"base64"));return ds(u)}}function k0(t){return function(r,n,s){oc(s),r=nn(r),n=cc(n);var u=St.createVerify("RSA-SHA"+t);return u.update(r),u.verify({key:s,padding:St.constants.RSA_PKCS1_PSS_PADDING,saltLength:St.constants.RSA_PSS_SALTLEN_DIGEST},n,"base64")}}function L0(t){var e=fc(t);return function(){var n=e.apply(null,arguments);return n=sc.derToJose(n,"ES"+t),n}}function D0(t){var e=dc(t);return function(n,s,u){s=sc.joseToDer(s,"ES"+t).toString("base64");var c=e(n,s,u);return c}}function F0(){return function(){return""}}function M0(){return function(e,r){return r===""}}var hc=function(e){var r={hs:lc,rs:fc,ps:O0,es:L0,none:F0},n={hs:U0,rs:dc,ps:k0,es:D0,none:M0},s=e.match(/^(RS|PS|ES|HS)(256|384|512)$|^(none)$/);if(!s)throw pt(R0,e);var u=(s[1]||s[3]).toLowerCase(),c=s[2];return{sign:r[u](c),verify:n[u](c)}},q0=Wn.Buffer,pc=function(e){return typeof e=="string"?e:typeof e=="number"||q0.isBuffer(e)?e.toString():JSON.stringify(e)},V0=Zr.Buffer,ro=ac,K0=hc,$0=Nt,no=pc,hs=Pt;function io(t,e){return V0.from(t,e).toString("base64").replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function G0(t,e,r){r=r||"utf8";var n=io(no(t),"binary"),s=io(no(e),r);return hs.format("%s.%s",n,s)}function yc(t){var e=t.header,r=t.payload,n=t.secret||t.privateKey,s=t.encoding,u=K0(e.alg),c=G0(e,r,s),i=u.sign(c,n);return hs.format("%s.%s",c,i)}function ai(t){var e=t.secret||t.privateKey||t.key,r=new ro(e);this.readable=!0,this.header=t.header,this.encoding=t.encoding,this.secret=this.privateKey=this.key=r,this.payload=new ro(t.payload),this.secret.once("close",function(){!this.payload.writable&&this.readable&&this.sign()}.bind(this)),this.payload.once("close",function(){!this.secret.writable&&this.readable&&this.sign()}.bind(this))}hs.inherits(ai,$0);ai.prototype.sign=function(){try{var e=yc({header:this.header,payload:this.payload.buffer,secret:this.secret.buffer,encoding:this.encoding});return this.emit("done",e),this.emit("data",e),this.emit("end"),this.readable=!1,e}catch(r){this.readable=!1,this.emit("error",r),this.emit("close")}};ai.sign=yc;var j0=ai,gc=Zr.Buffer,ao=ac,H0=hc,z0=Nt,vc=pc,W0=Pt,Q0=/^[a-zA-Z0-9\-_]+?\.[a-zA-Z0-9\-_]+?\.([a-zA-Z0-9\-_]+)?$/;function Y0(t){return Object.prototype.toString.call(t)==="[object Object]"}function J0(t){if(Y0(t))return t;try{return JSON.parse(t)}catch{return}}function mc(t){var e=t.split(".",1)[0];return J0(gc.from(e,"base64").toString("binary"))}function X0(t){return t.split(".",2).join(".")}function Ec(t){return t.split(".")[2]}function Z0(t,e){e=e||"utf8";var r=t.split(".")[1];return gc.from(r,"base64").toString(e)}function Cc(t){return Q0.test(t)&&!!mc(t)}function Sc(t,e,r){if(!e){var n=new Error("Missing algorithm parameter for jws.verify");throw n.code="MISSING_ALGORITHM",n}t=vc(t);var s=Ec(t),u=X0(t),c=H0(e);return c.verify(u,s,r)}function Ac(t,e){if(e=e||{},t=vc(t),!Cc(t))return null;var r=mc(t);if(!r)return null;var n=Z0(t);return(r.typ==="JWT"||e.json)&&(n=JSON.parse(n,e.encoding)),{header:r,payload:n,signature:Ec(t)}}function br(t){t=t||{};var e=t.secret||t.publicKey||t.key,r=new ao(e);this.readable=!0,this.algorithm=t.algorithm,this.encoding=t.encoding,this.secret=this.publicKey=this.key=r,this.signature=new ao(t.signature),this.secret.once("close",function(){!this.signature.writable&&this.readable&&this.verify()}.bind(this)),this.signature.once("close",function(){!this.secret.writable&&this.readable&&this.verify()}.bind(this))}W0.inherits(br,z0);br.prototype.verify=function(){try{var e=Sc(this.signature.buffer,this.algorithm,this.key.buffer),r=Ac(this.signature.buffer,this.encoding);return this.emit("done",e,r),this.emit("data",e),this.emit("end"),this.readable=!1,e}catch(n){this.readable=!1,this.emit("error",n),this.emit("close")}};br.decode=Ac;br.isValid=Cc;br.verify=Sc;var ed=br,Tc=j0,si=ed,td=["HS256","HS384","HS512","RS256","RS384","RS512","PS256","PS384","PS512","ES256","ES384","ES512"];Ut.ALGORITHMS=td;Ut.sign=Tc.sign;Ut.verify=si.verify;Ut.decode=si.decode;Ut.isValid=si.isValid;Ut.createSign=function(e){return new Tc(e)};Ut.createVerify=function(e){return new si(e)};var Or={},ki,so;function me(){return so||(so=1,ki={options:{usePureJavaScript:!1}}),ki}var Li={exports:{}},Di,oo;function rd(){if(oo)return Di;oo=1;var t={};Di=t;var e={};t.encode=function(n,s,u){if(typeof s!="string")throw new TypeError('"alphabet" must be a string.');if(u!==void 0&&typeof u!="number")throw new TypeError('"maxline" must be a number.');var c="";if(!(n instanceof Uint8Array))c=r(n,s);else{var i=0,y=s.length,f=s.charAt(0),A=[0];for(i=0;i<n.length;++i){for(var C=0,p=n[i];C<A.length;++C)p+=A[C]<<8,A[C]=p%y,p=p/y|0;for(;p>0;)A.push(p%y),p=p/y|0}for(i=0;n[i]===0&&i<n.length-1;++i)c+=f;for(i=A.length-1;i>=0;--i)c+=s[A[i]]}if(u){var o=new RegExp(".{1,"+u+"}","g");c=c.match(o).join(`\r
`)}return c},t.decode=function(n,s){if(typeof n!="string")throw new TypeError('"input" must be a string.');if(typeof s!="string")throw new TypeError('"alphabet" must be a string.');var u=e[s];if(!u){u=e[s]=[];for(var c=0;c<s.length;++c)u[s.charCodeAt(c)]=c}n=n.replace(/\s/g,"");for(var i=s.length,y=s.charAt(0),f=[0],c=0;c<n.length;c++){var A=u[n.charCodeAt(c)];if(A===void 0)return;for(var C=0,p=A;C<f.length;++C)p+=f[C]*i,f[C]=p&255,p>>=8;for(;p>0;)f.push(p&255),p>>=8}for(var o=0;n[o]===y&&o<n.length-1;++o)f.push(0);return typeof Buffer<"u"?Buffer.from(f.reverse()):new Uint8Array(f.reverse())};function r(n,s){var u=0,c=s.length,i=s.charAt(0),y=[0];for(u=0;u<n.length();++u){for(var f=0,A=n.at(u);f<y.length;++f)A+=y[f]<<8,y[f]=A%c,A=A/c|0;for(;A>0;)y.push(A%c),A=A/c|0}var C="";for(u=0;n.at(u)===0&&u<n.length()-1;++u)C+=i;for(u=y.length-1;u>=0;--u)C+=s[y[u]];return C}return Di}var uo;function Ae(){if(uo)return Li.exports;uo=1;var t=me(),e=rd(),r=Li.exports=t.util=t.util||{};(function(){if(typeof process<"u"&&process.nextTick&&!process.browser){r.nextTick=process.nextTick,typeof setImmediate=="function"?r.setImmediate=setImmediate:r.setImmediate=r.nextTick;return}if(typeof setImmediate=="function"){r.setImmediate=function(){return setImmediate.apply(void 0,arguments)},r.nextTick=function(h){return setImmediate(h)};return}if(r.setImmediate=function(h){setTimeout(h,0)},typeof window<"u"&&typeof window.postMessage=="function"){let h=function(l){if(l.source===window&&l.data===a){l.stopPropagation();var B=v.slice();v.length=0,B.forEach(function(N){N()})}};var a="forge.setImmediate",v=[];r.setImmediate=function(l){v.push(l),v.length===1&&window.postMessage(a,"*")},window.addEventListener("message",h,!0)}if(typeof MutationObserver<"u"){var E=Date.now(),b=!0,R=document.createElement("div"),v=[];new MutationObserver(function(){var l=v.slice();v.length=0,l.forEach(function(B){B()})}).observe(R,{attributes:!0});var T=r.setImmediate;r.setImmediate=function(l){Date.now()-E>15?(E=Date.now(),T(l)):(v.push(l),v.length===1&&R.setAttribute("a",b=!b))}}r.nextTick=r.setImmediate})(),r.isNodejs=typeof process<"u"&&process.versions&&process.versions.node,r.globalScope=function(){return r.isNodejs?Re:typeof self>"u"?window:self}(),r.isArray=Array.isArray||function(a){return Object.prototype.toString.call(a)==="[object Array]"},r.isArrayBuffer=function(a){return typeof ArrayBuffer<"u"&&a instanceof ArrayBuffer},r.isArrayBufferView=function(a){return a&&r.isArrayBuffer(a.buffer)&&a.byteLength!==void 0};function n(a){if(!(a===8||a===16||a===24||a===32))throw new Error("Only 8, 16, 24, or 32 bits supported: "+a)}r.ByteBuffer=s;function s(a){if(this.data="",this.read=0,typeof a=="string")this.data=a;else if(r.isArrayBuffer(a)||r.isArrayBufferView(a))if(typeof Buffer<"u"&&a instanceof Buffer)this.data=a.toString("binary");else{var v=new Uint8Array(a);try{this.data=String.fromCharCode.apply(null,v)}catch{for(var E=0;E<v.length;++E)this.putByte(v[E])}}else(a instanceof s||typeof a=="object"&&typeof a.data=="string"&&typeof a.read=="number")&&(this.data=a.data,this.read=a.read);this._constructedStringLength=0}r.ByteStringBuffer=s;var u=4096;r.ByteStringBuffer.prototype._optimizeConstructedString=function(a){this._constructedStringLength+=a,this._constructedStringLength>u&&(this.data.substr(0,1),this._constructedStringLength=0)},r.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read},r.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0},r.ByteStringBuffer.prototype.putByte=function(a){return this.putBytes(String.fromCharCode(a))},r.ByteStringBuffer.prototype.fillWithByte=function(a,v){a=String.fromCharCode(a);for(var E=this.data;v>0;)v&1&&(E+=a),v>>>=1,v>0&&(a+=a);return this.data=E,this._optimizeConstructedString(v),this},r.ByteStringBuffer.prototype.putBytes=function(a){return this.data+=a,this._optimizeConstructedString(a.length),this},r.ByteStringBuffer.prototype.putString=function(a){return this.putBytes(r.encodeUtf8(a))},r.ByteStringBuffer.prototype.putInt16=function(a){return this.putBytes(String.fromCharCode(a>>8&255)+String.fromCharCode(a&255))},r.ByteStringBuffer.prototype.putInt24=function(a){return this.putBytes(String.fromCharCode(a>>16&255)+String.fromCharCode(a>>8&255)+String.fromCharCode(a&255))},r.ByteStringBuffer.prototype.putInt32=function(a){return this.putBytes(String.fromCharCode(a>>24&255)+String.fromCharCode(a>>16&255)+String.fromCharCode(a>>8&255)+String.fromCharCode(a&255))},r.ByteStringBuffer.prototype.putInt16Le=function(a){return this.putBytes(String.fromCharCode(a&255)+String.fromCharCode(a>>8&255))},r.ByteStringBuffer.prototype.putInt24Le=function(a){return this.putBytes(String.fromCharCode(a&255)+String.fromCharCode(a>>8&255)+String.fromCharCode(a>>16&255))},r.ByteStringBuffer.prototype.putInt32Le=function(a){return this.putBytes(String.fromCharCode(a&255)+String.fromCharCode(a>>8&255)+String.fromCharCode(a>>16&255)+String.fromCharCode(a>>24&255))},r.ByteStringBuffer.prototype.putInt=function(a,v){n(v);var E="";do v-=8,E+=String.fromCharCode(a>>v&255);while(v>0);return this.putBytes(E)},r.ByteStringBuffer.prototype.putSignedInt=function(a,v){return a<0&&(a+=2<<v-1),this.putInt(a,v)},r.ByteStringBuffer.prototype.putBuffer=function(a){return this.putBytes(a.getBytes())},r.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)},r.ByteStringBuffer.prototype.getInt16=function(){var a=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,a},r.ByteStringBuffer.prototype.getInt24=function(){var a=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,a},r.ByteStringBuffer.prototype.getInt32=function(){var a=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,a},r.ByteStringBuffer.prototype.getInt16Le=function(){var a=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,a},r.ByteStringBuffer.prototype.getInt24Le=function(){var a=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,a},r.ByteStringBuffer.prototype.getInt32Le=function(){var a=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,a},r.ByteStringBuffer.prototype.getInt=function(a){n(a);var v=0;do v=(v<<8)+this.data.charCodeAt(this.read++),a-=8;while(a>0);return v},r.ByteStringBuffer.prototype.getSignedInt=function(a){var v=this.getInt(a),E=2<<a-2;return v>=E&&(v-=E<<1),v},r.ByteStringBuffer.prototype.getBytes=function(a){var v;return a?(a=Math.min(this.length(),a),v=this.data.slice(this.read,this.read+a),this.read+=a):a===0?v="":(v=this.read===0?this.data:this.data.slice(this.read),this.clear()),v},r.ByteStringBuffer.prototype.bytes=function(a){return typeof a>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+a)},r.ByteStringBuffer.prototype.at=function(a){return this.data.charCodeAt(this.read+a)},r.ByteStringBuffer.prototype.setAt=function(a,v){return this.data=this.data.substr(0,this.read+a)+String.fromCharCode(v)+this.data.substr(this.read+a+1),this},r.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)},r.ByteStringBuffer.prototype.copy=function(){var a=r.createBuffer(this.data);return a.read=this.read,a},r.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this},r.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this},r.ByteStringBuffer.prototype.truncate=function(a){var v=Math.max(0,this.length()-a);return this.data=this.data.substr(this.read,v),this.read=0,this},r.ByteStringBuffer.prototype.toHex=function(){for(var a="",v=this.read;v<this.data.length;++v){var E=this.data.charCodeAt(v);E<16&&(a+="0"),a+=E.toString(16)}return a},r.ByteStringBuffer.prototype.toString=function(){return r.decodeUtf8(this.bytes())};function c(a,v){v=v||{},this.read=v.readOffset||0,this.growSize=v.growSize||1024;var E=r.isArrayBuffer(a),b=r.isArrayBufferView(a);if(E||b){E?this.data=new DataView(a):this.data=new DataView(a.buffer,a.byteOffset,a.byteLength),this.write="writeOffset"in v?v.writeOffset:this.data.byteLength;return}this.data=new DataView(new ArrayBuffer(0)),this.write=0,a!=null&&this.putBytes(a),"writeOffset"in v&&(this.write=v.writeOffset)}r.DataBuffer=c,r.DataBuffer.prototype.length=function(){return this.write-this.read},r.DataBuffer.prototype.isEmpty=function(){return this.length()<=0},r.DataBuffer.prototype.accommodate=function(a,v){if(this.length()>=a)return this;v=Math.max(v||this.growSize,a);var E=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),b=new Uint8Array(this.length()+v);return b.set(E),this.data=new DataView(b.buffer),this},r.DataBuffer.prototype.putByte=function(a){return this.accommodate(1),this.data.setUint8(this.write++,a),this},r.DataBuffer.prototype.fillWithByte=function(a,v){this.accommodate(v);for(var E=0;E<v;++E)this.data.setUint8(a);return this},r.DataBuffer.prototype.putBytes=function(a,v){if(r.isArrayBufferView(a)){var E=new Uint8Array(a.buffer,a.byteOffset,a.byteLength),b=E.byteLength-E.byteOffset;this.accommodate(b);var R=new Uint8Array(this.data.buffer,this.write);return R.set(E),this.write+=b,this}if(r.isArrayBuffer(a)){var E=new Uint8Array(a);this.accommodate(E.byteLength);var R=new Uint8Array(this.data.buffer);return R.set(E,this.write),this.write+=E.byteLength,this}if(a instanceof r.DataBuffer||typeof a=="object"&&typeof a.read=="number"&&typeof a.write=="number"&&r.isArrayBufferView(a.data)){var E=new Uint8Array(a.data.byteLength,a.read,a.length());this.accommodate(E.byteLength);var R=new Uint8Array(a.data.byteLength,this.write);return R.set(E),this.write+=E.byteLength,this}if(a instanceof r.ByteStringBuffer&&(a=a.data,v="binary"),v=v||"binary",typeof a=="string"){var T;if(v==="hex")return this.accommodate(Math.ceil(a.length/2)),T=new Uint8Array(this.data.buffer,this.write),this.write+=r.binary.hex.decode(a,T,this.write),this;if(v==="base64")return this.accommodate(Math.ceil(a.length/4)*3),T=new Uint8Array(this.data.buffer,this.write),this.write+=r.binary.base64.decode(a,T,this.write),this;if(v==="utf8"&&(a=r.encodeUtf8(a),v="binary"),v==="binary"||v==="raw")return this.accommodate(a.length),T=new Uint8Array(this.data.buffer,this.write),this.write+=r.binary.raw.decode(T),this;if(v==="utf16")return this.accommodate(a.length*2),T=new Uint16Array(this.data.buffer,this.write),this.write+=r.text.utf16.encode(T),this;throw new Error("Invalid encoding: "+v)}throw Error("Invalid parameter: "+a)},r.DataBuffer.prototype.putBuffer=function(a){return this.putBytes(a),a.clear(),this},r.DataBuffer.prototype.putString=function(a){return this.putBytes(a,"utf16")},r.DataBuffer.prototype.putInt16=function(a){return this.accommodate(2),this.data.setInt16(this.write,a),this.write+=2,this},r.DataBuffer.prototype.putInt24=function(a){return this.accommodate(3),this.data.setInt16(this.write,a>>8&65535),this.data.setInt8(this.write,a>>16&255),this.write+=3,this},r.DataBuffer.prototype.putInt32=function(a){return this.accommodate(4),this.data.setInt32(this.write,a),this.write+=4,this},r.DataBuffer.prototype.putInt16Le=function(a){return this.accommodate(2),this.data.setInt16(this.write,a,!0),this.write+=2,this},r.DataBuffer.prototype.putInt24Le=function(a){return this.accommodate(3),this.data.setInt8(this.write,a>>16&255),this.data.setInt16(this.write,a>>8&65535,!0),this.write+=3,this},r.DataBuffer.prototype.putInt32Le=function(a){return this.accommodate(4),this.data.setInt32(this.write,a,!0),this.write+=4,this},r.DataBuffer.prototype.putInt=function(a,v){n(v),this.accommodate(v/8);do v-=8,this.data.setInt8(this.write++,a>>v&255);while(v>0);return this},r.DataBuffer.prototype.putSignedInt=function(a,v){return n(v),this.accommodate(v/8),a<0&&(a+=2<<v-1),this.putInt(a,v)},r.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)},r.DataBuffer.prototype.getInt16=function(){var a=this.data.getInt16(this.read);return this.read+=2,a},r.DataBuffer.prototype.getInt24=function(){var a=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,a},r.DataBuffer.prototype.getInt32=function(){var a=this.data.getInt32(this.read);return this.read+=4,a},r.DataBuffer.prototype.getInt16Le=function(){var a=this.data.getInt16(this.read,!0);return this.read+=2,a},r.DataBuffer.prototype.getInt24Le=function(){var a=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,a},r.DataBuffer.prototype.getInt32Le=function(){var a=this.data.getInt32(this.read,!0);return this.read+=4,a},r.DataBuffer.prototype.getInt=function(a){n(a);var v=0;do v=(v<<8)+this.data.getInt8(this.read++),a-=8;while(a>0);return v},r.DataBuffer.prototype.getSignedInt=function(a){var v=this.getInt(a),E=2<<a-2;return v>=E&&(v-=E<<1),v},r.DataBuffer.prototype.getBytes=function(a){var v;return a?(a=Math.min(this.length(),a),v=this.data.slice(this.read,this.read+a),this.read+=a):a===0?v="":(v=this.read===0?this.data:this.data.slice(this.read),this.clear()),v},r.DataBuffer.prototype.bytes=function(a){return typeof a>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+a)},r.DataBuffer.prototype.at=function(a){return this.data.getUint8(this.read+a)},r.DataBuffer.prototype.setAt=function(a,v){return this.data.setUint8(a,v),this},r.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)},r.DataBuffer.prototype.copy=function(){return new r.DataBuffer(this)},r.DataBuffer.prototype.compact=function(){if(this.read>0){var a=new Uint8Array(this.data.buffer,this.read),v=new Uint8Array(a.byteLength);v.set(a),this.data=new DataView(v),this.write-=this.read,this.read=0}return this},r.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this},r.DataBuffer.prototype.truncate=function(a){return this.write=Math.max(0,this.length()-a),this.read=Math.min(this.read,this.write),this},r.DataBuffer.prototype.toHex=function(){for(var a="",v=this.read;v<this.data.byteLength;++v){var E=this.data.getUint8(v);E<16&&(a+="0"),a+=E.toString(16)}return a},r.DataBuffer.prototype.toString=function(a){var v=new Uint8Array(this.data,this.read,this.length());if(a=a||"utf8",a==="binary"||a==="raw")return r.binary.raw.encode(v);if(a==="hex")return r.binary.hex.encode(v);if(a==="base64")return r.binary.base64.encode(v);if(a==="utf8")return r.text.utf8.decode(v);if(a==="utf16")return r.text.utf16.decode(v);throw new Error("Invalid encoding: "+a)},r.createBuffer=function(a,v){return v=v||"raw",a!==void 0&&v==="utf8"&&(a=r.encodeUtf8(a)),new r.ByteBuffer(a)},r.fillString=function(a,v){for(var E="";v>0;)v&1&&(E+=a),v>>>=1,v>0&&(a+=a);return E},r.xorBytes=function(a,v,E){for(var b="",R="",T="",h=0,l=0;E>0;--E,++h)R=a.charCodeAt(h)^v.charCodeAt(h),l>=10&&(b+=T,T="",l=0),T+=String.fromCharCode(R),++l;return b+=T,b},r.hexToBytes=function(a){var v="",E=0;for(a.length&!0&&(E=1,v+=String.fromCharCode(parseInt(a[0],16)));E<a.length;E+=2)v+=String.fromCharCode(parseInt(a.substr(E,2),16));return v},r.bytesToHex=function(a){return r.createBuffer(a).toHex()},r.int32ToBytes=function(a){return String.fromCharCode(a>>24&255)+String.fromCharCode(a>>16&255)+String.fromCharCode(a>>8&255)+String.fromCharCode(a&255)};var i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",y=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],f="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";r.encode64=function(a,v){for(var E="",b="",R,T,h,l=0;l<a.length;)R=a.charCodeAt(l++),T=a.charCodeAt(l++),h=a.charCodeAt(l++),E+=i.charAt(R>>2),E+=i.charAt((R&3)<<4|T>>4),isNaN(T)?E+="==":(E+=i.charAt((T&15)<<2|h>>6),E+=isNaN(h)?"=":i.charAt(h&63)),v&&E.length>v&&(b+=E.substr(0,v)+`\r
`,E=E.substr(v));return b+=E,b},r.decode64=function(a){a=a.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var v="",E,b,R,T,h=0;h<a.length;)E=y[a.charCodeAt(h++)-43],b=y[a.charCodeAt(h++)-43],R=y[a.charCodeAt(h++)-43],T=y[a.charCodeAt(h++)-43],v+=String.fromCharCode(E<<2|b>>4),R!==64&&(v+=String.fromCharCode((b&15)<<4|R>>2),T!==64&&(v+=String.fromCharCode((R&3)<<6|T)));return v},r.encodeUtf8=function(a){return unescape(encodeURIComponent(a))},r.decodeUtf8=function(a){return decodeURIComponent(escape(a))},r.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:e.encode,decode:e.decode}},r.binary.raw.encode=function(a){return String.fromCharCode.apply(null,a)},r.binary.raw.decode=function(a,v,E){var b=v;b||(b=new Uint8Array(a.length)),E=E||0;for(var R=E,T=0;T<a.length;++T)b[R++]=a.charCodeAt(T);return v?R-E:b},r.binary.hex.encode=r.bytesToHex,r.binary.hex.decode=function(a,v,E){var b=v;b||(b=new Uint8Array(Math.ceil(a.length/2))),E=E||0;var R=0,T=E;for(a.length&1&&(R=1,b[T++]=parseInt(a[0],16));R<a.length;R+=2)b[T++]=parseInt(a.substr(R,2),16);return v?T-E:b},r.binary.base64.encode=function(a,v){for(var E="",b="",R,T,h,l=0;l<a.byteLength;)R=a[l++],T=a[l++],h=a[l++],E+=i.charAt(R>>2),E+=i.charAt((R&3)<<4|T>>4),isNaN(T)?E+="==":(E+=i.charAt((T&15)<<2|h>>6),E+=isNaN(h)?"=":i.charAt(h&63)),v&&E.length>v&&(b+=E.substr(0,v)+`\r
`,E=E.substr(v));return b+=E,b},r.binary.base64.decode=function(a,v,E){var b=v;b||(b=new Uint8Array(Math.ceil(a.length/4)*3)),a=a.replace(/[^A-Za-z0-9\+\/\=]/g,""),E=E||0;for(var R,T,h,l,B=0,N=E;B<a.length;)R=y[a.charCodeAt(B++)-43],T=y[a.charCodeAt(B++)-43],h=y[a.charCodeAt(B++)-43],l=y[a.charCodeAt(B++)-43],b[N++]=R<<2|T>>4,h!==64&&(b[N++]=(T&15)<<4|h>>2,l!==64&&(b[N++]=(h&3)<<6|l));return v?N-E:b.subarray(0,N)},r.binary.base58.encode=function(a,v){return r.binary.baseN.encode(a,f,v)},r.binary.base58.decode=function(a,v){return r.binary.baseN.decode(a,f,v)},r.text={utf8:{},utf16:{}},r.text.utf8.encode=function(a,v,E){a=r.encodeUtf8(a);var b=v;b||(b=new Uint8Array(a.length)),E=E||0;for(var R=E,T=0;T<a.length;++T)b[R++]=a.charCodeAt(T);return v?R-E:b},r.text.utf8.decode=function(a){return r.decodeUtf8(String.fromCharCode.apply(null,a))},r.text.utf16.encode=function(a,v,E){var b=v;b||(b=new Uint8Array(a.length*2));var R=new Uint16Array(b.buffer);E=E||0;for(var T=E,h=E,l=0;l<a.length;++l)R[h++]=a.charCodeAt(l),T+=2;return v?T-E:b},r.text.utf16.decode=function(a){return String.fromCharCode.apply(null,new Uint16Array(a.buffer))},r.deflate=function(a,v,E){if(v=r.decode64(a.deflate(r.encode64(v)).rval),E){var b=2,R=v.charCodeAt(1);R&32&&(b=6),v=v.substring(b,v.length-4)}return v},r.inflate=function(a,v,E){var b=a.inflate(r.encode64(v)).rval;return b===null?null:r.decode64(b)};var A=function(a,v,E){if(!a)throw new Error("WebStorage not available.");var b;if(E===null?b=a.removeItem(v):(E=r.encode64(JSON.stringify(E)),b=a.setItem(v,E)),typeof b<"u"&&b.rval!==!0){var R=new Error(b.error.message);throw R.id=b.error.id,R.name=b.error.name,R}},C=function(a,v){if(!a)throw new Error("WebStorage not available.");var E=a.getItem(v);if(a.init)if(E.rval===null){if(E.error){var b=new Error(E.error.message);throw b.id=E.error.id,b.name=E.error.name,b}E=null}else E=E.rval;return E!==null&&(E=JSON.parse(r.decode64(E))),E},p=function(a,v,E,b){var R=C(a,v);R===null&&(R={}),R[E]=b,A(a,v,R)},o=function(a,v,E){var b=C(a,v);return b!==null&&(b=E in b?b[E]:null),b},m=function(a,v,E){var b=C(a,v);if(b!==null&&E in b){delete b[E];var R=!0;for(var T in b){R=!1;break}R&&(b=null),A(a,v,b)}},g=function(a,v){A(a,v,null)},S=function(a,v,E){var b=null;typeof E>"u"&&(E=["web","flash"]);var R,T=!1,h=null;for(var l in E){R=E[l];try{if(R==="flash"||R==="both"){if(v[0]===null)throw new Error("Flash local storage not available.");b=a.apply(this,v),T=R==="flash"}(R==="web"||R==="both")&&(v[0]=localStorage,b=a.apply(this,v),T=!0)}catch(B){h=B}if(T)break}if(!T)throw h;return b};return r.setItem=function(a,v,E,b,R){S(p,arguments,R)},r.getItem=function(a,v,E,b){return S(o,arguments,b)},r.removeItem=function(a,v,E,b){S(m,arguments,b)},r.clearItems=function(a,v,E){S(g,arguments,E)},r.isEmpty=function(a){for(var v in a)if(a.hasOwnProperty(v))return!1;return!0},r.format=function(a){for(var v=/%./g,E,b,R=0,T=[],h=0;E=v.exec(a);){b=a.substring(h,v.lastIndex-2),b.length>0&&T.push(b),h=v.lastIndex;var l=E[0][1];switch(l){case"s":case"o":R<arguments.length?T.push(arguments[R+++1]):T.push("<?>");break;case"%":T.push("%");break;default:T.push("<%"+l+"?>")}}return T.push(a.substring(h)),T.join("")},r.formatNumber=function(a,v,E,b){var R=a,T=isNaN(v=Math.abs(v))?2:v,h=E===void 0?",":E,l=b===void 0?".":b,B=R<0?"-":"",N=parseInt(R=Math.abs(+R||0).toFixed(T),10)+"",F=N.length>3?N.length%3:0;return B+(F?N.substr(0,F)+l:"")+N.substr(F).replace(/(\d{3})(?=\d)/g,"$1"+l)+(T?h+Math.abs(R-N).toFixed(T).slice(2):"")},r.formatSize=function(a){return a>=1073741824?a=r.formatNumber(a/1073741824,2,".","")+" GiB":a>=1048576?a=r.formatNumber(a/1048576,2,".","")+" MiB":a>=1024?a=r.formatNumber(a/1024,0)+" KiB":a=r.formatNumber(a,0)+" bytes",a},r.bytesFromIP=function(a){return a.indexOf(".")!==-1?r.bytesFromIPv4(a):a.indexOf(":")!==-1?r.bytesFromIPv6(a):null},r.bytesFromIPv4=function(a){if(a=a.split("."),a.length!==4)return null;for(var v=r.createBuffer(),E=0;E<a.length;++E){var b=parseInt(a[E],10);if(isNaN(b))return null;v.putByte(b)}return v.getBytes()},r.bytesFromIPv6=function(a){var v=0;a=a.split(":").filter(function(h){return h.length===0&&++v,!0});for(var E=(8-a.length+v)*2,b=r.createBuffer(),R=0;R<8;++R){if(!a[R]||a[R].length===0){b.fillWithByte(0,E),E=0;continue}var T=r.hexToBytes(a[R]);T.length<2&&b.putByte(0),b.putBytes(T)}return b.getBytes()},r.bytesToIP=function(a){return a.length===4?r.bytesToIPv4(a):a.length===16?r.bytesToIPv6(a):null},r.bytesToIPv4=function(a){if(a.length!==4)return null;for(var v=[],E=0;E<a.length;++E)v.push(a.charCodeAt(E));return v.join(".")},r.bytesToIPv6=function(a){if(a.length!==16)return null;for(var v=[],E=[],b=0,R=0;R<a.length;R+=2){for(var T=r.bytesToHex(a[R]+a[R+1]);T[0]==="0"&&T!=="0";)T=T.substr(1);if(T==="0"){var h=E[E.length-1],l=v.length;!h||l!==h.end+1?E.push({start:l,end:l}):(h.end=l,h.end-h.start>E[b].end-E[b].start&&(b=E.length-1))}v.push(T)}if(E.length>0){var B=E[b];B.end-B.start>0&&(v.splice(B.start,B.end-B.start+1,""),B.start===0&&v.unshift(""),B.end===7&&v.push(""))}return v.join(":")},r.estimateCores=function(a,v){if(typeof a=="function"&&(v=a,a={}),a=a||{},"cores"in r&&!a.update)return v(null,r.cores);if(typeof navigator<"u"&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return r.cores=navigator.hardwareConcurrency,v(null,r.cores);if(typeof Worker>"u")return r.cores=1,v(null,r.cores);if(typeof Blob>"u")return r.cores=2,v(null,r.cores);var E=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(h){var l=Date.now(),B=l+4;self.postMessage({st:l,et:B})})}.toString(),")()"],{type:"application/javascript"}));b([],5,16);function b(h,l,B){if(l===0){var N=Math.floor(h.reduce(function(F,L){return F+L},0)/h.length);return r.cores=Math.max(1,N),URL.revokeObjectURL(E),v(null,r.cores)}R(B,function(F,L){h.push(T(B,L)),b(h,l-1,B)})}function R(h,l){for(var B=[],N=[],F=0;F<h;++F){var L=new Worker(E);L.addEventListener("message",function(q){if(N.push(q.data),N.length===h){for(var j=0;j<h;++j)B[j].terminate();l(null,N)}}),B.push(L)}for(var F=0;F<h;++F)B[F].postMessage(F)}function T(h,l){for(var B=[],N=0;N<h;++N)for(var F=l[N],L=B[N]=[],q=0;q<h;++q)if(N!==q){var j=l[q];(F.st>j.st&&F.st<j.et||j.st>F.st&&j.st<F.et)&&L.push(q)}return B.reduce(function(H,Q){return Math.max(H,Q.length)},0)}},Li.exports}var Fi,co;function ps(){if(co)return Fi;co=1;var t=me();Ae(),Fi=t.cipher=t.cipher||{},t.cipher.algorithms=t.cipher.algorithms||{},t.cipher.createCipher=function(r,n){var s=r;if(typeof s=="string"&&(s=t.cipher.getAlgorithm(s),s&&(s=s())),!s)throw new Error("Unsupported algorithm: "+r);return new t.cipher.BlockCipher({algorithm:s,key:n,decrypt:!1})},t.cipher.createDecipher=function(r,n){var s=r;if(typeof s=="string"&&(s=t.cipher.getAlgorithm(s),s&&(s=s())),!s)throw new Error("Unsupported algorithm: "+r);return new t.cipher.BlockCipher({algorithm:s,key:n,decrypt:!0})},t.cipher.registerAlgorithm=function(r,n){r=r.toUpperCase(),t.cipher.algorithms[r]=n},t.cipher.getAlgorithm=function(r){return r=r.toUpperCase(),r in t.cipher.algorithms?t.cipher.algorithms[r]:null};var e=t.cipher.BlockCipher=function(r){this.algorithm=r.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=r.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=r.decrypt,this.algorithm.initialize(r)};return e.prototype.start=function(r){r=r||{};var n={};for(var s in r)n[s]=r[s];n.decrypt=this._decrypt,this._finish=!1,this._input=t.util.createBuffer(),this.output=r.output||t.util.createBuffer(),this.mode.start(n)},e.prototype.update=function(r){for(r&&this._input.putBuffer(r);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()},e.prototype.finish=function(r){r&&(this.mode.name==="ECB"||this.mode.name==="CBC")&&(this.mode.pad=function(s){return r(this.blockSize,s,!1)},this.mode.unpad=function(s){return r(this.blockSize,s,!0)});var n={};return n.decrypt=this._decrypt,n.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,n)||(this._finish=!0,this.update(),this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,n))||this.mode.afterFinish&&!this.mode.afterFinish(this.output,n))},Fi}var Mi={exports:{}},lo;function xc(){if(lo)return Mi.exports;lo=1;var t=me();Ae(),t.cipher=t.cipher||{};var e=Mi.exports=t.cipher.modes=t.cipher.modes||{};e.ecb=function(u){u=u||{},this.name="ECB",this.cipher=u.cipher,this.blockSize=u.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)},e.ecb.prototype.start=function(u){},e.ecb.prototype.encrypt=function(u,c,i){if(u.length()<this.blockSize&&!(i&&u.length()>0))return!0;for(var y=0;y<this._ints;++y)this._inBlock[y]=u.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var y=0;y<this._ints;++y)c.putInt32(this._outBlock[y])},e.ecb.prototype.decrypt=function(u,c,i){if(u.length()<this.blockSize&&!(i&&u.length()>0))return!0;for(var y=0;y<this._ints;++y)this._inBlock[y]=u.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var y=0;y<this._ints;++y)c.putInt32(this._outBlock[y])},e.ecb.prototype.pad=function(u,c){var i=u.length()===this.blockSize?this.blockSize:this.blockSize-u.length();return u.fillWithByte(i,i),!0},e.ecb.prototype.unpad=function(u,c){if(c.overflow>0)return!1;var i=u.length(),y=u.at(i-1);return y>this.blockSize<<2?!1:(u.truncate(y),!0)},e.cbc=function(u){u=u||{},this.name="CBC",this.cipher=u.cipher,this.blockSize=u.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)},e.cbc.prototype.start=function(u){if(u.iv===null){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else if("iv"in u)this._iv=r(u.iv,this.blockSize),this._prev=this._iv.slice(0);else throw new Error("Invalid IV parameter.")},e.cbc.prototype.encrypt=function(u,c,i){if(u.length()<this.blockSize&&!(i&&u.length()>0))return!0;for(var y=0;y<this._ints;++y)this._inBlock[y]=this._prev[y]^u.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var y=0;y<this._ints;++y)c.putInt32(this._outBlock[y]);this._prev=this._outBlock},e.cbc.prototype.decrypt=function(u,c,i){if(u.length()<this.blockSize&&!(i&&u.length()>0))return!0;for(var y=0;y<this._ints;++y)this._inBlock[y]=u.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var y=0;y<this._ints;++y)c.putInt32(this._prev[y]^this._outBlock[y]);this._prev=this._inBlock.slice(0)},e.cbc.prototype.pad=function(u,c){var i=u.length()===this.blockSize?this.blockSize:this.blockSize-u.length();return u.fillWithByte(i,i),!0},e.cbc.prototype.unpad=function(u,c){if(c.overflow>0)return!1;var i=u.length(),y=u.at(i-1);return y>this.blockSize<<2?!1:(u.truncate(y),!0)},e.cfb=function(u){u=u||{},this.name="CFB",this.cipher=u.cipher,this.blockSize=u.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=t.util.createBuffer(),this._partialBytes=0},e.cfb.prototype.start=function(u){if(!("iv"in u))throw new Error("Invalid IV parameter.");this._iv=r(u.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},e.cfb.prototype.encrypt=function(u,c,i){var y=u.length();if(y===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&y>=this.blockSize){for(var f=0;f<this._ints;++f)this._inBlock[f]=u.getInt32()^this._outBlock[f],c.putInt32(this._inBlock[f]);return}var A=(this.blockSize-y)%this.blockSize;A>0&&(A=this.blockSize-A),this._partialOutput.clear();for(var f=0;f<this._ints;++f)this._partialBlock[f]=u.getInt32()^this._outBlock[f],this._partialOutput.putInt32(this._partialBlock[f]);if(A>0)u.read-=this.blockSize;else for(var f=0;f<this._ints;++f)this._inBlock[f]=this._partialBlock[f];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),A>0&&!i)return c.putBytes(this._partialOutput.getBytes(A-this._partialBytes)),this._partialBytes=A,!0;c.putBytes(this._partialOutput.getBytes(y-this._partialBytes)),this._partialBytes=0},e.cfb.prototype.decrypt=function(u,c,i){var y=u.length();if(y===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&y>=this.blockSize){for(var f=0;f<this._ints;++f)this._inBlock[f]=u.getInt32(),c.putInt32(this._inBlock[f]^this._outBlock[f]);return}var A=(this.blockSize-y)%this.blockSize;A>0&&(A=this.blockSize-A),this._partialOutput.clear();for(var f=0;f<this._ints;++f)this._partialBlock[f]=u.getInt32(),this._partialOutput.putInt32(this._partialBlock[f]^this._outBlock[f]);if(A>0)u.read-=this.blockSize;else for(var f=0;f<this._ints;++f)this._inBlock[f]=this._partialBlock[f];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),A>0&&!i)return c.putBytes(this._partialOutput.getBytes(A-this._partialBytes)),this._partialBytes=A,!0;c.putBytes(this._partialOutput.getBytes(y-this._partialBytes)),this._partialBytes=0},e.ofb=function(u){u=u||{},this.name="OFB",this.cipher=u.cipher,this.blockSize=u.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=t.util.createBuffer(),this._partialBytes=0},e.ofb.prototype.start=function(u){if(!("iv"in u))throw new Error("Invalid IV parameter.");this._iv=r(u.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},e.ofb.prototype.encrypt=function(u,c,i){var y=u.length();if(u.length()===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&y>=this.blockSize){for(var f=0;f<this._ints;++f)c.putInt32(u.getInt32()^this._outBlock[f]),this._inBlock[f]=this._outBlock[f];return}var A=(this.blockSize-y)%this.blockSize;A>0&&(A=this.blockSize-A),this._partialOutput.clear();for(var f=0;f<this._ints;++f)this._partialOutput.putInt32(u.getInt32()^this._outBlock[f]);if(A>0)u.read-=this.blockSize;else for(var f=0;f<this._ints;++f)this._inBlock[f]=this._outBlock[f];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),A>0&&!i)return c.putBytes(this._partialOutput.getBytes(A-this._partialBytes)),this._partialBytes=A,!0;c.putBytes(this._partialOutput.getBytes(y-this._partialBytes)),this._partialBytes=0},e.ofb.prototype.decrypt=e.ofb.prototype.encrypt,e.ctr=function(u){u=u||{},this.name="CTR",this.cipher=u.cipher,this.blockSize=u.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=t.util.createBuffer(),this._partialBytes=0},e.ctr.prototype.start=function(u){if(!("iv"in u))throw new Error("Invalid IV parameter.");this._iv=r(u.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},e.ctr.prototype.encrypt=function(u,c,i){var y=u.length();if(y===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&y>=this.blockSize)for(var f=0;f<this._ints;++f)c.putInt32(u.getInt32()^this._outBlock[f]);else{var A=(this.blockSize-y)%this.blockSize;A>0&&(A=this.blockSize-A),this._partialOutput.clear();for(var f=0;f<this._ints;++f)this._partialOutput.putInt32(u.getInt32()^this._outBlock[f]);if(A>0&&(u.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),A>0&&!i)return c.putBytes(this._partialOutput.getBytes(A-this._partialBytes)),this._partialBytes=A,!0;c.putBytes(this._partialOutput.getBytes(y-this._partialBytes)),this._partialBytes=0}n(this._inBlock)},e.ctr.prototype.decrypt=e.ctr.prototype.encrypt,e.gcm=function(u){u=u||{},this.name="GCM",this.cipher=u.cipher,this.blockSize=u.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=t.util.createBuffer(),this._partialBytes=0,this._R=3774873600},e.gcm.prototype.start=function(u){if(!("iv"in u))throw new Error("Invalid IV parameter.");var c=t.util.createBuffer(u.iv);this._cipherLength=0;var i;if("additionalData"in u?i=t.util.createBuffer(u.additionalData):i=t.util.createBuffer(),"tagLength"in u?this._tagLength=u.tagLength:this._tagLength=128,this._tag=null,u.decrypt&&(this._tag=t.util.createBuffer(u.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var y=c.length();if(y===12)this._j0=[c.getInt32(),c.getInt32(),c.getInt32(),1];else{for(this._j0=[0,0,0,0];c.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[c.getInt32(),c.getInt32(),c.getInt32(),c.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(s(y*8)))}this._inBlock=this._j0.slice(0),n(this._inBlock),this._partialBytes=0,i=t.util.createBuffer(i),this._aDataLength=s(i.length()*8);var f=i.length()%this.blockSize;for(f&&i.fillWithByte(0,this.blockSize-f),this._s=[0,0,0,0];i.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[i.getInt32(),i.getInt32(),i.getInt32(),i.getInt32()])},e.gcm.prototype.encrypt=function(u,c,i){var y=u.length();if(y===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&y>=this.blockSize){for(var f=0;f<this._ints;++f)c.putInt32(this._outBlock[f]^=u.getInt32());this._cipherLength+=this.blockSize}else{var A=(this.blockSize-y)%this.blockSize;A>0&&(A=this.blockSize-A),this._partialOutput.clear();for(var f=0;f<this._ints;++f)this._partialOutput.putInt32(u.getInt32()^this._outBlock[f]);if(A<=0||i){if(i){var C=y%this.blockSize;this._cipherLength+=C,this._partialOutput.truncate(this.blockSize-C)}else this._cipherLength+=this.blockSize;for(var f=0;f<this._ints;++f)this._outBlock[f]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),A>0&&!i)return u.read-=this.blockSize,c.putBytes(this._partialOutput.getBytes(A-this._partialBytes)),this._partialBytes=A,!0;c.putBytes(this._partialOutput.getBytes(y-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),n(this._inBlock)},e.gcm.prototype.decrypt=function(u,c,i){var y=u.length();if(y<this.blockSize&&!(i&&y>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),n(this._inBlock),this._hashBlock[0]=u.getInt32(),this._hashBlock[1]=u.getInt32(),this._hashBlock[2]=u.getInt32(),this._hashBlock[3]=u.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var f=0;f<this._ints;++f)c.putInt32(this._outBlock[f]^this._hashBlock[f]);y<this.blockSize?this._cipherLength+=y%this.blockSize:this._cipherLength+=this.blockSize},e.gcm.prototype.afterFinish=function(u,c){var i=!0;c.decrypt&&c.overflow&&u.truncate(this.blockSize-c.overflow),this.tag=t.util.createBuffer();var y=this._aDataLength.concat(s(this._cipherLength*8));this._s=this.ghash(this._hashSubkey,this._s,y);var f=[];this.cipher.encrypt(this._j0,f);for(var A=0;A<this._ints;++A)this.tag.putInt32(this._s[A]^f[A]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),c.decrypt&&this.tag.bytes()!==this._tag&&(i=!1),i},e.gcm.prototype.multiply=function(u,c){for(var i=[0,0,0,0],y=c.slice(0),f=0;f<128;++f){var A=u[f/32|0]&1<<31-f%32;A&&(i[0]^=y[0],i[1]^=y[1],i[2]^=y[2],i[3]^=y[3]),this.pow(y,y)}return i},e.gcm.prototype.pow=function(u,c){for(var i=u[3]&1,y=3;y>0;--y)c[y]=u[y]>>>1|(u[y-1]&1)<<31;c[0]=u[0]>>>1,i&&(c[0]^=this._R)},e.gcm.prototype.tableMultiply=function(u){for(var c=[0,0,0,0],i=0;i<32;++i){var y=i/8|0,f=u[y]>>>(7-i%8)*4&15,A=this._m[i][f];c[0]^=A[0],c[1]^=A[1],c[2]^=A[2],c[3]^=A[3]}return c},e.gcm.prototype.ghash=function(u,c,i){return c[0]^=i[0],c[1]^=i[1],c[2]^=i[2],c[3]^=i[3],this.tableMultiply(c)},e.gcm.prototype.generateHashTable=function(u,c){for(var i=8/c,y=4*i,f=16*i,A=new Array(f),C=0;C<f;++C){var p=[0,0,0,0],o=C/y|0,m=(y-1-C%y)*c;p[o]=1<<c-1<<m,A[C]=this.generateSubHashTable(this.multiply(p,u),c)}return A},e.gcm.prototype.generateSubHashTable=function(u,c){var i=1<<c,y=i>>>1,f=new Array(i);f[y]=u.slice(0);for(var A=y>>>1;A>0;)this.pow(f[2*A],f[A]=[]),A>>=1;for(A=2;A<y;){for(var C=1;C<A;++C){var p=f[A],o=f[C];f[A+C]=[p[0]^o[0],p[1]^o[1],p[2]^o[2],p[3]^o[3]]}A*=2}for(f[0]=[0,0,0,0],A=y+1;A<i;++A){var m=f[A^y];f[A]=[u[0]^m[0],u[1]^m[1],u[2]^m[2],u[3]^m[3]]}return f};function r(u,c){if(typeof u=="string"&&(u=t.util.createBuffer(u)),t.util.isArray(u)&&u.length>4){var i=u;u=t.util.createBuffer();for(var y=0;y<i.length;++y)u.putByte(i[y])}if(u.length()<c)throw new Error("Invalid IV length; got "+u.length()+" bytes and expected "+c+" bytes.");if(!t.util.isArray(u)){for(var f=[],A=c/4,y=0;y<A;++y)f.push(u.getInt32());u=f}return u}function n(u){u[u.length-1]=u[u.length-1]+1&4294967295}function s(u){return[u/4294967296|0,u&4294967295]}return Mi.exports}var qi,fo;function sr(){if(fo)return qi;fo=1;var t=me();ps(),xc(),Ae(),qi=t.aes=t.aes||{},t.aes.startEncrypting=function(o,m,g,S){var a=p({key:o,output:g,decrypt:!1,mode:S});return a.start(m),a},t.aes.createEncryptionCipher=function(o,m){return p({key:o,output:null,decrypt:!1,mode:m})},t.aes.startDecrypting=function(o,m,g,S){var a=p({key:o,output:g,decrypt:!0,mode:S});return a.start(m),a},t.aes.createDecryptionCipher=function(o,m){return p({key:o,output:null,decrypt:!0,mode:m})},t.aes.Algorithm=function(o,m){r||f();var g=this;g.name=o,g.mode=new m({blockSize:16,cipher:{encrypt:function(S,a){return C(g._w,S,a,!1)},decrypt:function(S,a){return C(g._w,S,a,!0)}}}),g._init=!1},t.aes.Algorithm.prototype.initialize=function(o){if(!this._init){var m=o.key,g;if(typeof m=="string"&&(m.length===16||m.length===24||m.length===32))m=t.util.createBuffer(m);else if(t.util.isArray(m)&&(m.length===16||m.length===24||m.length===32)){g=m,m=t.util.createBuffer();for(var S=0;S<g.length;++S)m.putByte(g[S])}if(!t.util.isArray(m)){g=m,m=[];var a=g.length();if(a===16||a===24||a===32){a=a>>>2;for(var S=0;S<a;++S)m.push(g.getInt32())}}if(!t.util.isArray(m)||!(m.length===4||m.length===6||m.length===8))throw new Error("Invalid key parameter.");var v=this.mode.name,E=["CFB","OFB","CTR","GCM"].indexOf(v)!==-1;this._w=A(m,o.decrypt&&!E),this._init=!0}},t.aes._expandKey=function(o,m){return r||f(),A(o,m)},t.aes._updateBlock=C,e("AES-ECB",t.cipher.modes.ecb),e("AES-CBC",t.cipher.modes.cbc),e("AES-CFB",t.cipher.modes.cfb),e("AES-OFB",t.cipher.modes.ofb),e("AES-CTR",t.cipher.modes.ctr),e("AES-GCM",t.cipher.modes.gcm);function e(o,m){var g=function(){return new t.aes.Algorithm(o,m)};t.cipher.registerAlgorithm(o,g)}var r=!1,n=4,s,u,c,i,y;function f(){r=!0,c=[0,1,2,4,8,16,32,64,128,27,54];for(var o=new Array(256),m=0;m<128;++m)o[m]=m<<1,o[m+128]=m+128<<1^283;s=new Array(256),u=new Array(256),i=new Array(4),y=new Array(4);for(var m=0;m<4;++m)i[m]=new Array(256),y[m]=new Array(256);for(var g=0,S=0,a,v,E,b,R,T,h,m=0;m<256;++m){b=S^S<<1^S<<2^S<<3^S<<4,b=b>>8^b&255^99,s[g]=b,u[b]=g,R=o[b],a=o[g],v=o[a],E=o[v],T=R<<24^b<<16^b<<8^(b^R),h=(a^v^E)<<24^(g^E)<<16^(g^v^E)<<8^(g^a^E);for(var l=0;l<4;++l)i[l][g]=T,y[l][b]=h,T=T<<24|T>>>8,h=h<<24|h>>>8;g===0?g=S=1:(g=a^o[o[o[a^E]]],S^=o[o[S]])}}function A(o,m){for(var g=o.slice(0),S,a=1,v=g.length,E=v+6+1,b=n*E,R=v;R<b;++R)S=g[R-1],R%v===0?(S=s[S>>>16&255]<<24^s[S>>>8&255]<<16^s[S&255]<<8^s[S>>>24]^c[a]<<24,a++):v>6&&R%v===4&&(S=s[S>>>24]<<24^s[S>>>16&255]<<16^s[S>>>8&255]<<8^s[S&255]),g[R]=g[R-v]^S;if(m){var T,h=y[0],l=y[1],B=y[2],N=y[3],F=g.slice(0);b=g.length;for(var R=0,L=b-n;R<b;R+=n,L-=n)if(R===0||R===b-n)F[R]=g[L],F[R+1]=g[L+3],F[R+2]=g[L+2],F[R+3]=g[L+1];else for(var q=0;q<n;++q)T=g[L+q],F[R+(3&-q)]=h[s[T>>>24]]^l[s[T>>>16&255]]^B[s[T>>>8&255]]^N[s[T&255]];g=F}return g}function C(o,m,g,S){var a=o.length/4-1,v,E,b,R,T;S?(v=y[0],E=y[1],b=y[2],R=y[3],T=u):(v=i[0],E=i[1],b=i[2],R=i[3],T=s);var h,l,B,N,F,L,q;h=m[0]^o[0],l=m[S?3:1]^o[1],B=m[2]^o[2],N=m[S?1:3]^o[3];for(var j=3,H=1;H<a;++H)F=v[h>>>24]^E[l>>>16&255]^b[B>>>8&255]^R[N&255]^o[++j],L=v[l>>>24]^E[B>>>16&255]^b[N>>>8&255]^R[h&255]^o[++j],q=v[B>>>24]^E[N>>>16&255]^b[h>>>8&255]^R[l&255]^o[++j],N=v[N>>>24]^E[h>>>16&255]^b[l>>>8&255]^R[B&255]^o[++j],h=F,l=L,B=q;g[0]=T[h>>>24]<<24^T[l>>>16&255]<<16^T[B>>>8&255]<<8^T[N&255]^o[++j],g[S?3:1]=T[l>>>24]<<24^T[B>>>16&255]<<16^T[N>>>8&255]<<8^T[h&255]^o[++j],g[2]=T[B>>>24]<<24^T[N>>>16&255]<<16^T[h>>>8&255]<<8^T[l&255]^o[++j],g[S?1:3]=T[N>>>24]<<24^T[h>>>16&255]<<16^T[l>>>8&255]<<8^T[B&255]^o[++j]}function p(o){o=o||{};var m=(o.mode||"CBC").toUpperCase(),g="AES-"+m,S;o.decrypt?S=t.cipher.createDecipher(g,o.key):S=t.cipher.createCipher(g,o.key);var a=S.start;return S.start=function(v,E){var b=null;E instanceof t.util.ByteBuffer&&(b=E,E={}),E=E||{},E.output=b,E.iv=v,a.call(S,E)},S}return qi}var Vi={exports:{}},Ki={exports:{}},$i={exports:{}},ho;function or(){if(ho)return $i.exports;ho=1;var t=me();t.pki=t.pki||{};var e=$i.exports=t.pki.oids=t.oids=t.oids||{};function r(s,u){e[s]=u,e[u]=s}function n(s,u){e[s]=u}return r("1.2.840.113549.1.1.1","rsaEncryption"),r("1.2.840.113549.1.1.4","md5WithRSAEncryption"),r("1.2.840.113549.1.1.5","sha1WithRSAEncryption"),r("1.2.840.113549.1.1.7","RSAES-OAEP"),r("1.2.840.113549.1.1.8","mgf1"),r("1.2.840.113549.1.1.9","pSpecified"),r("1.2.840.113549.1.1.10","RSASSA-PSS"),r("1.2.840.113549.1.1.11","sha256WithRSAEncryption"),r("1.2.840.113549.1.1.12","sha384WithRSAEncryption"),r("1.2.840.113549.1.1.13","sha512WithRSAEncryption"),r("1.3.101.112","EdDSA25519"),r("1.2.840.10040.4.3","dsa-with-sha1"),r("1.3.14.3.2.7","desCBC"),r("1.3.14.3.2.26","sha1"),r("1.3.14.3.2.29","sha1WithRSASignature"),r("2.16.840.1.101.3.4.2.1","sha256"),r("2.16.840.1.101.3.4.2.2","sha384"),r("2.16.840.1.101.3.4.2.3","sha512"),r("2.16.840.1.101.3.4.2.4","sha224"),r("2.16.840.1.101.3.4.2.5","sha512-224"),r("2.16.840.1.101.3.4.2.6","sha512-256"),r("1.2.840.113549.2.2","md2"),r("1.2.840.113549.2.5","md5"),r("1.2.840.113549.1.7.1","data"),r("1.2.840.113549.1.7.2","signedData"),r("1.2.840.113549.1.7.3","envelopedData"),r("1.2.840.113549.1.7.4","signedAndEnvelopedData"),r("1.2.840.113549.1.7.5","digestedData"),r("1.2.840.113549.1.7.6","encryptedData"),r("1.2.840.113549.1.9.1","emailAddress"),r("1.2.840.113549.1.9.2","unstructuredName"),r("1.2.840.113549.1.9.3","contentType"),r("1.2.840.113549.1.9.4","messageDigest"),r("1.2.840.113549.1.9.5","signingTime"),r("1.2.840.113549.1.9.6","counterSignature"),r("1.2.840.113549.1.9.7","challengePassword"),r("1.2.840.113549.1.9.8","unstructuredAddress"),r("1.2.840.113549.1.9.14","extensionRequest"),r("1.2.840.113549.1.9.20","friendlyName"),r("1.2.840.113549.1.9.21","localKeyId"),r("1.2.840.113549.1.9.22.1","x509Certificate"),r("1.2.840.113549.1.12.10.1.1","keyBag"),r("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag"),r("1.2.840.113549.1.12.10.1.3","certBag"),r("1.2.840.113549.1.12.10.1.4","crlBag"),r("1.2.840.113549.1.12.10.1.5","secretBag"),r("1.2.840.113549.1.12.10.1.6","safeContentsBag"),r("1.2.840.113549.1.5.13","pkcs5PBES2"),r("1.2.840.113549.1.5.12","pkcs5PBKDF2"),r("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4"),r("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4"),r("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC"),r("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC"),r("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC"),r("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC"),r("1.2.840.113549.2.7","hmacWithSHA1"),r("1.2.840.113549.2.8","hmacWithSHA224"),r("1.2.840.113549.2.9","hmacWithSHA256"),r("1.2.840.113549.2.10","hmacWithSHA384"),r("1.2.840.113549.2.11","hmacWithSHA512"),r("1.2.840.113549.3.7","des-EDE3-CBC"),r("2.16.840.1.101.3.4.1.2","aes128-CBC"),r("2.16.840.1.101.3.4.1.22","aes192-CBC"),r("2.16.840.1.101.3.4.1.42","aes256-CBC"),r("2.5.4.3","commonName"),r("2.5.4.4","surname"),r("2.5.4.5","serialNumber"),r("2.5.4.6","countryName"),r("2.5.4.7","localityName"),r("2.5.4.8","stateOrProvinceName"),r("2.5.4.9","streetAddress"),r("2.5.4.10","organizationName"),r("2.5.4.11","organizationalUnitName"),r("2.5.4.12","title"),r("2.5.4.13","description"),r("2.5.4.15","businessCategory"),r("2.5.4.17","postalCode"),r("2.5.4.42","givenName"),r("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName"),r("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName"),r("2.16.840.1.113730.1.1","nsCertType"),r("2.16.840.1.113730.1.13","nsComment"),n("2.5.29.1","authorityKeyIdentifier"),n("2.5.29.2","keyAttributes"),n("2.5.29.3","certificatePolicies"),n("2.5.29.4","keyUsageRestriction"),n("2.5.29.5","policyMapping"),n("2.5.29.6","subtreesConstraint"),n("2.5.29.7","subjectAltName"),n("2.5.29.8","issuerAltName"),n("2.5.29.9","subjectDirectoryAttributes"),n("2.5.29.10","basicConstraints"),n("2.5.29.11","nameConstraints"),n("2.5.29.12","policyConstraints"),n("2.5.29.13","basicConstraints"),r("2.5.29.14","subjectKeyIdentifier"),r("2.5.29.15","keyUsage"),n("2.5.29.16","privateKeyUsagePeriod"),r("2.5.29.17","subjectAltName"),r("2.5.29.18","issuerAltName"),r("2.5.29.19","basicConstraints"),n("2.5.29.20","cRLNumber"),n("2.5.29.21","cRLReason"),n("2.5.29.22","expirationDate"),n("2.5.29.23","instructionCode"),n("2.5.29.24","invalidityDate"),n("2.5.29.25","cRLDistributionPoints"),n("2.5.29.26","issuingDistributionPoint"),n("2.5.29.27","deltaCRLIndicator"),n("2.5.29.28","issuingDistributionPoint"),n("2.5.29.29","certificateIssuer"),n("2.5.29.30","nameConstraints"),r("2.5.29.31","cRLDistributionPoints"),r("2.5.29.32","certificatePolicies"),n("2.5.29.33","policyMappings"),n("2.5.29.34","policyConstraints"),r("2.5.29.35","authorityKeyIdentifier"),n("2.5.29.36","policyConstraints"),r("2.5.29.37","extKeyUsage"),n("2.5.29.46","freshestCRL"),n("2.5.29.54","inhibitAnyPolicy"),r("1.3.6.1.4.1.11129.2.4.2","timestampList"),r("1.3.6.1.5.5.7.1.1","authorityInfoAccess"),r("1.3.6.1.5.5.7.3.1","serverAuth"),r("1.3.6.1.5.5.7.3.2","clientAuth"),r("1.3.6.1.5.5.7.3.3","codeSigning"),r("1.3.6.1.5.5.7.3.4","emailProtection"),r("1.3.6.1.5.5.7.3.8","timeStamping"),$i.exports}var po;function Tt(){if(po)return Ki.exports;po=1;var t=me();Ae(),or();var e=Ki.exports=t.asn1=t.asn1||{};e.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192},e.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30},e.create=function(c,i,y,f,A){if(t.util.isArray(f)){for(var C=[],p=0;p<f.length;++p)f[p]!==void 0&&C.push(f[p]);f=C}var o={tagClass:c,type:i,constructed:y,composed:y||t.util.isArray(f),value:f};return A&&"bitStringContents"in A&&(o.bitStringContents=A.bitStringContents,o.original=e.copy(o)),o},e.copy=function(c,i){var y;if(t.util.isArray(c)){y=[];for(var f=0;f<c.length;++f)y.push(e.copy(c[f],i));return y}return typeof c=="string"?c:(y={tagClass:c.tagClass,type:c.type,constructed:c.constructed,composed:c.composed,value:e.copy(c.value,i)},i&&!i.excludeBitStringContents&&(y.bitStringContents=c.bitStringContents),y)},e.equals=function(c,i,y){if(t.util.isArray(c)){if(!t.util.isArray(i)||c.length!==i.length)return!1;for(var f=0;f<c.length;++f)if(!e.equals(c[f],i[f]))return!1;return!0}if(typeof c!=typeof i)return!1;if(typeof c=="string")return c===i;var A=c.tagClass===i.tagClass&&c.type===i.type&&c.constructed===i.constructed&&c.composed===i.composed&&e.equals(c.value,i.value);return y&&y.includeBitStringContents&&(A=A&&c.bitStringContents===i.bitStringContents),A},e.getBerValueLength=function(c){var i=c.getByte();if(i!==128){var y,f=i&128;return f?y=c.getInt((i&127)<<3):y=i,y}};function r(c,i,y){if(y>i){var f=new Error("Too few bytes to parse DER.");throw f.available=c.length(),f.remaining=i,f.requested=y,f}}var n=function(c,i){var y=c.getByte();if(i--,y!==128){var f,A=y&128;if(!A)f=y;else{var C=y&127;r(c,i,C),f=c.getInt(C<<3)}if(f<0)throw new Error("Negative length: "+f);return f}};e.fromDer=function(c,i){i===void 0&&(i={strict:!0,parseAllBytes:!0,decodeBitStrings:!0}),typeof i=="boolean"&&(i={strict:i,parseAllBytes:!0,decodeBitStrings:!0}),"strict"in i||(i.strict=!0),"parseAllBytes"in i||(i.parseAllBytes=!0),"decodeBitStrings"in i||(i.decodeBitStrings=!0),typeof c=="string"&&(c=t.util.createBuffer(c));var y=c.length(),f=s(c,c.length(),0,i);if(i.parseAllBytes&&c.length()!==0){var A=new Error("Unparsed DER bytes remain after ASN.1 parsing.");throw A.byteCount=y,A.remaining=c.length(),A}return f};function s(c,i,y,f){var A;r(c,i,2);var C=c.getByte();i--;var p=C&192,o=C&31;A=c.length();var m=n(c,i);if(i-=A-c.length(),m!==void 0&&m>i){if(f.strict){var g=new Error("Too few bytes to read ASN.1 value.");throw g.available=c.length(),g.remaining=i,g.requested=m,g}m=i}var S,a,v=(C&32)===32;if(v)if(S=[],m===void 0)for(;;){if(r(c,i,2),c.bytes(2)===String.fromCharCode(0,0)){c.getBytes(2),i-=2;break}A=c.length(),S.push(s(c,i,y+1,f)),i-=A-c.length()}else for(;m>0;)A=c.length(),S.push(s(c,m,y+1,f)),i-=A-c.length(),m-=A-c.length();if(S===void 0&&p===e.Class.UNIVERSAL&&o===e.Type.BITSTRING&&(a=c.bytes(m)),S===void 0&&f.decodeBitStrings&&p===e.Class.UNIVERSAL&&o===e.Type.BITSTRING&&m>1){var E=c.read,b=i,R=0;if(o===e.Type.BITSTRING&&(r(c,i,1),R=c.getByte(),i--),R===0)try{A=c.length();var T={strict:!0,decodeBitStrings:!0},h=s(c,i,y+1,T),l=A-c.length();i-=l,o==e.Type.BITSTRING&&l++;var B=h.tagClass;l===m&&(B===e.Class.UNIVERSAL||B===e.Class.CONTEXT_SPECIFIC)&&(S=[h])}catch{}S===void 0&&(c.read=E,i=b)}if(S===void 0){if(m===void 0){if(f.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");m=i}if(o===e.Type.BMPSTRING)for(S="";m>0;m-=2)r(c,i,2),S+=String.fromCharCode(c.getInt16()),i-=2;else S=c.getBytes(m),i-=m}var N=a===void 0?null:{bitStringContents:a};return e.create(p,o,v,S,N)}e.toDer=function(c){var i=t.util.createBuffer(),y=c.tagClass|c.type,f=t.util.createBuffer(),A=!1;if("bitStringContents"in c&&(A=!0,c.original&&(A=e.equals(c,c.original))),A)f.putBytes(c.bitStringContents);else if(c.composed){c.constructed?y|=32:f.putByte(0);for(var C=0;C<c.value.length;++C)c.value[C]!==void 0&&f.putBuffer(e.toDer(c.value[C]))}else if(c.type===e.Type.BMPSTRING)for(var C=0;C<c.value.length;++C)f.putInt16(c.value.charCodeAt(C));else c.type===e.Type.INTEGER&&c.value.length>1&&(c.value.charCodeAt(0)===0&&!(c.value.charCodeAt(1)&128)||c.value.charCodeAt(0)===255&&(c.value.charCodeAt(1)&128)===128)?f.putBytes(c.value.substr(1)):f.putBytes(c.value);if(i.putByte(y),f.length()<=127)i.putByte(f.length()&127);else{var p=f.length(),o="";do o+=String.fromCharCode(p&255),p=p>>>8;while(p>0);i.putByte(o.length|128);for(var C=o.length-1;C>=0;--C)i.putByte(o.charCodeAt(C))}return i.putBuffer(f),i},e.oidToDer=function(c){var i=c.split("."),y=t.util.createBuffer();y.putByte(40*parseInt(i[0],10)+parseInt(i[1],10));for(var f,A,C,p,o=2;o<i.length;++o){f=!0,A=[],C=parseInt(i[o],10);do p=C&127,C=C>>>7,f||(p|=128),A.push(p),f=!1;while(C>0);for(var m=A.length-1;m>=0;--m)y.putByte(A[m])}return y},e.derToOid=function(c){var i;typeof c=="string"&&(c=t.util.createBuffer(c));var y=c.getByte();i=Math.floor(y/40)+"."+y%40;for(var f=0;c.length()>0;)y=c.getByte(),f=f<<7,y&128?f+=y&127:(i+="."+(f+y),f=0);return i},e.utcTimeToDate=function(c){var i=new Date,y=parseInt(c.substr(0,2),10);y=y>=50?1900+y:2e3+y;var f=parseInt(c.substr(2,2),10)-1,A=parseInt(c.substr(4,2),10),C=parseInt(c.substr(6,2),10),p=parseInt(c.substr(8,2),10),o=0;if(c.length>11){var m=c.charAt(10),g=10;m!=="+"&&m!=="-"&&(o=parseInt(c.substr(10,2),10),g+=2)}if(i.setUTCFullYear(y,f,A),i.setUTCHours(C,p,o,0),g&&(m=c.charAt(g),m==="+"||m==="-")){var S=parseInt(c.substr(g+1,2),10),a=parseInt(c.substr(g+4,2),10),v=S*60+a;v*=6e4,m==="+"?i.setTime(+i-v):i.setTime(+i+v)}return i},e.generalizedTimeToDate=function(c){var i=new Date,y=parseInt(c.substr(0,4),10),f=parseInt(c.substr(4,2),10)-1,A=parseInt(c.substr(6,2),10),C=parseInt(c.substr(8,2),10),p=parseInt(c.substr(10,2),10),o=parseInt(c.substr(12,2),10),m=0,g=0,S=!1;c.charAt(c.length-1)==="Z"&&(S=!0);var a=c.length-5,v=c.charAt(a);if(v==="+"||v==="-"){var E=parseInt(c.substr(a+1,2),10),b=parseInt(c.substr(a+4,2),10);g=E*60+b,g*=6e4,v==="+"&&(g*=-1),S=!0}return c.charAt(14)==="."&&(m=parseFloat(c.substr(14),10)*1e3),S?(i.setUTCFullYear(y,f,A),i.setUTCHours(C,p,o,m),i.setTime(+i+g)):(i.setFullYear(y,f,A),i.setHours(C,p,o,m)),i},e.dateToUtcTime=function(c){if(typeof c=="string")return c;var i="",y=[];y.push((""+c.getUTCFullYear()).substr(2)),y.push(""+(c.getUTCMonth()+1)),y.push(""+c.getUTCDate()),y.push(""+c.getUTCHours()),y.push(""+c.getUTCMinutes()),y.push(""+c.getUTCSeconds());for(var f=0;f<y.length;++f)y[f].length<2&&(i+="0"),i+=y[f];return i+="Z",i},e.dateToGeneralizedTime=function(c){if(typeof c=="string")return c;var i="",y=[];y.push(""+c.getUTCFullYear()),y.push(""+(c.getUTCMonth()+1)),y.push(""+c.getUTCDate()),y.push(""+c.getUTCHours()),y.push(""+c.getUTCMinutes()),y.push(""+c.getUTCSeconds());for(var f=0;f<y.length;++f)y[f].length<2&&(i+="0"),i+=y[f];return i+="Z",i},e.integerToDer=function(c){var i=t.util.createBuffer();if(c>=-128&&c<128)return i.putSignedInt(c,8);if(c>=-32768&&c<32768)return i.putSignedInt(c,16);if(c>=-8388608&&c<8388608)return i.putSignedInt(c,24);if(c>=-2147483648&&c<2147483648)return i.putSignedInt(c,32);var y=new Error("Integer too large; max is 32-bits.");throw y.integer=c,y},e.derToInteger=function(c){typeof c=="string"&&(c=t.util.createBuffer(c));var i=c.length()*8;if(i>32)throw new Error("Integer too large; max is 32-bits.");return c.getSignedInt(i)},e.validate=function(c,i,y,f){var A=!1;if((c.tagClass===i.tagClass||typeof i.tagClass>"u")&&(c.type===i.type||typeof i.type>"u"))if(c.constructed===i.constructed||typeof i.constructed>"u"){if(A=!0,i.value&&t.util.isArray(i.value))for(var C=0,p=0;A&&p<i.value.length;++p)A=i.value[p].optional||!1,c.value[C]&&(A=e.validate(c.value[C],i.value[p],y,f),A?++C:i.value[p].optional&&(A=!0)),!A&&f&&f.push("["+i.name+'] Tag class "'+i.tagClass+'", type "'+i.type+'" expected value length "'+i.value.length+'", got "'+c.value.length+'"');if(A&&y&&(i.capture&&(y[i.capture]=c.value),i.captureAsn1&&(y[i.captureAsn1]=c),i.captureBitStringContents&&"bitStringContents"in c&&(y[i.captureBitStringContents]=c.bitStringContents),i.captureBitStringValue&&"bitStringContents"in c))if(c.bitStringContents.length<2)y[i.captureBitStringValue]="";else{var o=c.bitStringContents.charCodeAt(0);if(o!==0)throw new Error("captureBitStringValue only supported for zero unused bits");y[i.captureBitStringValue]=c.bitStringContents.slice(1)}}else f&&f.push("["+i.name+'] Expected constructed "'+i.constructed+'", got "'+c.constructed+'"');else f&&(c.tagClass!==i.tagClass&&f.push("["+i.name+'] Expected tag class "'+i.tagClass+'", got "'+c.tagClass+'"'),c.type!==i.type&&f.push("["+i.name+'] Expected type "'+i.type+'", got "'+c.type+'"'));return A};var u=/[^\\u0000-\\u00ff]/;return e.prettyPrint=function(c,i,y){var f="";i=i||0,y=y||2,i>0&&(f+=`
`);for(var A="",C=0;C<i*y;++C)A+=" ";switch(f+=A+"Tag: ",c.tagClass){case e.Class.UNIVERSAL:f+="Universal:";break;case e.Class.APPLICATION:f+="Application:";break;case e.Class.CONTEXT_SPECIFIC:f+="Context-Specific:";break;case e.Class.PRIVATE:f+="Private:";break}if(c.tagClass===e.Class.UNIVERSAL)switch(f+=c.type,c.type){case e.Type.NONE:f+=" (None)";break;case e.Type.BOOLEAN:f+=" (Boolean)";break;case e.Type.INTEGER:f+=" (Integer)";break;case e.Type.BITSTRING:f+=" (Bit string)";break;case e.Type.OCTETSTRING:f+=" (Octet string)";break;case e.Type.NULL:f+=" (Null)";break;case e.Type.OID:f+=" (Object Identifier)";break;case e.Type.ODESC:f+=" (Object Descriptor)";break;case e.Type.EXTERNAL:f+=" (External or Instance of)";break;case e.Type.REAL:f+=" (Real)";break;case e.Type.ENUMERATED:f+=" (Enumerated)";break;case e.Type.EMBEDDED:f+=" (Embedded PDV)";break;case e.Type.UTF8:f+=" (UTF8)";break;case e.Type.ROID:f+=" (Relative Object Identifier)";break;case e.Type.SEQUENCE:f+=" (Sequence)";break;case e.Type.SET:f+=" (Set)";break;case e.Type.PRINTABLESTRING:f+=" (Printable String)";break;case e.Type.IA5String:f+=" (IA5String (ASCII))";break;case e.Type.UTCTIME:f+=" (UTC time)";break;case e.Type.GENERALIZEDTIME:f+=" (Generalized time)";break;case e.Type.BMPSTRING:f+=" (BMP String)";break}else f+=c.type;if(f+=`
`,f+=A+"Constructed: "+c.constructed+`
`,c.composed){for(var p=0,o="",C=0;C<c.value.length;++C)c.value[C]!==void 0&&(p+=1,o+=e.prettyPrint(c.value[C],i+1,y),C+1<c.value.length&&(o+=","));f+=A+"Sub values: "+p+o}else{if(f+=A+"Value: ",c.type===e.Type.OID){var m=e.derToOid(c.value);f+=m,t.pki&&t.pki.oids&&m in t.pki.oids&&(f+=" ("+t.pki.oids[m]+") ")}if(c.type===e.Type.INTEGER)try{f+=e.derToInteger(c.value)}catch{f+="0x"+t.util.bytesToHex(c.value)}else if(c.type===e.Type.BITSTRING){if(c.value.length>1?f+="0x"+t.util.bytesToHex(c.value.slice(1)):f+="(none)",c.value.length>0){var g=c.value.charCodeAt(0);g==1?f+=" (1 unused bit shown)":g>1&&(f+=" ("+g+" unused bits shown)")}}else if(c.type===e.Type.OCTETSTRING)u.test(c.value)||(f+="("+c.value+") "),f+="0x"+t.util.bytesToHex(c.value);else if(c.type===e.Type.UTF8)try{f+=t.util.decodeUtf8(c.value)}catch(S){if(S.message==="URI malformed")f+="0x"+t.util.bytesToHex(c.value)+" (malformed UTF8)";else throw S}else c.type===e.Type.PRINTABLESTRING||c.type===e.Type.IA5String?f+=c.value:u.test(c.value)?f+="0x"+t.util.bytesToHex(c.value):c.value.length===0?f+="[null]":f+=c.value}return f},Ki.exports}var Gi={exports:{}},ji,yo;function Ot(){if(yo)return ji;yo=1;var t=me();return ji=t.md=t.md||{},t.md.algorithms=t.md.algorithms||{},ji}var go;function an(){if(go)return Gi.exports;go=1;var t=me();Ot(),Ae();var e=Gi.exports=t.hmac=t.hmac||{};return e.create=function(){var r=null,n=null,s=null,u=null,c={};return c.start=function(i,y){if(i!==null)if(typeof i=="string")if(i=i.toLowerCase(),i in t.md.algorithms)n=t.md.algorithms[i].create();else throw new Error('Unknown hash algorithm "'+i+'"');else n=i;if(y===null)y=r;else{if(typeof y=="string")y=t.util.createBuffer(y);else if(t.util.isArray(y)){var f=y;y=t.util.createBuffer();for(var A=0;A<f.length;++A)y.putByte(f[A])}var C=y.length();C>n.blockLength&&(n.start(),n.update(y.bytes()),y=n.digest()),s=t.util.createBuffer(),u=t.util.createBuffer(),C=y.length();for(var A=0;A<C;++A){var f=y.at(A);s.putByte(54^f),u.putByte(92^f)}if(C<n.blockLength)for(var f=n.blockLength-C,A=0;A<f;++A)s.putByte(54),u.putByte(92);r=y,s=s.bytes(),u=u.bytes()}n.start(),n.update(s)},c.update=function(i){n.update(i)},c.getMac=function(){var i=n.digest().bytes();return n.start(),n.update(u),n.update(i),n.digest()},c.digest=c.getMac,c},Gi.exports}var Hi={exports:{}},vo;function ys(){if(vo)return Hi.exports;vo=1;var t=me();Ot(),Ae();var e=Hi.exports=t.md5=t.md5||{};t.md.md5=t.md.algorithms.md5=e,e.create=function(){c||i();var f=null,A=t.util.createBuffer(),C=new Array(16),p={algorithm:"md5",blockLength:64,digestLength:16,messageLength:0,fullMessageLength:null,messageLengthSize:8};return p.start=function(){p.messageLength=0,p.fullMessageLength=p.messageLength64=[];for(var o=p.messageLengthSize/4,m=0;m<o;++m)p.fullMessageLength.push(0);return A=t.util.createBuffer(),f={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878},p},p.start(),p.update=function(o,m){m==="utf8"&&(o=t.util.encodeUtf8(o));var g=o.length;p.messageLength+=g,g=[g/4294967296>>>0,g>>>0];for(var S=p.fullMessageLength.length-1;S>=0;--S)p.fullMessageLength[S]+=g[1],g[1]=g[0]+(p.fullMessageLength[S]/4294967296>>>0),p.fullMessageLength[S]=p.fullMessageLength[S]>>>0,g[0]=g[1]/4294967296>>>0;return A.putBytes(o),y(f,C,A),(A.read>2048||A.length()===0)&&A.compact(),p},p.digest=function(){var o=t.util.createBuffer();o.putBytes(A.bytes());var m=p.fullMessageLength[p.fullMessageLength.length-1]+p.messageLengthSize,g=m&p.blockLength-1;o.putBytes(r.substr(0,p.blockLength-g));for(var S,a=0,v=p.fullMessageLength.length-1;v>=0;--v)S=p.fullMessageLength[v]*8+a,a=S/4294967296>>>0,o.putInt32Le(S>>>0);var E={h0:f.h0,h1:f.h1,h2:f.h2,h3:f.h3};y(E,C,o);var b=t.util.createBuffer();return b.putInt32Le(E.h0),b.putInt32Le(E.h1),b.putInt32Le(E.h2),b.putInt32Le(E.h3),b},p};var r=null,n=null,s=null,u=null,c=!1;function i(){r=String.fromCharCode(128),r+=t.util.fillString(String.fromCharCode(0),64),n=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,1,6,11,0,5,10,15,4,9,14,3,8,13,2,7,12,5,8,11,14,1,4,7,10,13,0,3,6,9,12,15,2,0,7,14,5,12,3,10,1,8,15,6,13,4,11,2,9],s=[7,12,17,22,7,12,17,22,7,12,17,22,7,12,17,22,5,9,14,20,5,9,14,20,5,9,14,20,5,9,14,20,4,11,16,23,4,11,16,23,4,11,16,23,4,11,16,23,6,10,15,21,6,10,15,21,6,10,15,21,6,10,15,21],u=new Array(64);for(var f=0;f<64;++f)u[f]=Math.floor(Math.abs(Math.sin(f+1))*4294967296);c=!0}function y(f,A,C){for(var p,o,m,g,S,a,v,E,b=C.length();b>=64;){for(o=f.h0,m=f.h1,g=f.h2,S=f.h3,E=0;E<16;++E)A[E]=C.getInt32Le(),a=S^m&(g^S),p=o+a+u[E]+A[E],v=s[E],o=S,S=g,g=m,m+=p<<v|p>>>32-v;for(;E<32;++E)a=g^S&(m^g),p=o+a+u[E]+A[n[E]],v=s[E],o=S,S=g,g=m,m+=p<<v|p>>>32-v;for(;E<48;++E)a=m^g^S,p=o+a+u[E]+A[n[E]],v=s[E],o=S,S=g,g=m,m+=p<<v|p>>>32-v;for(;E<64;++E)a=g^(m|~S),p=o+a+u[E]+A[n[E]],v=s[E],o=S,S=g,g=m,m+=p<<v|p>>>32-v;f.h0=f.h0+o|0,f.h1=f.h1+m|0,f.h2=f.h2+g|0,f.h3=f.h3+S|0,b-=64}}return Hi.exports}var zi={exports:{}},mo;function Rr(){if(mo)return zi.exports;mo=1;var t=me();Ae();var e=zi.exports=t.pem=t.pem||{};e.encode=function(s,u){u=u||{};var c="-----BEGIN "+s.type+`-----\r
`,i;if(s.procType&&(i={name:"Proc-Type",values:[String(s.procType.version),s.procType.type]},c+=r(i)),s.contentDomain&&(i={name:"Content-Domain",values:[s.contentDomain]},c+=r(i)),s.dekInfo&&(i={name:"DEK-Info",values:[s.dekInfo.algorithm]},s.dekInfo.parameters&&i.values.push(s.dekInfo.parameters),c+=r(i)),s.headers)for(var y=0;y<s.headers.length;++y)c+=r(s.headers[y]);return s.procType&&(c+=`\r
`),c+=t.util.encode64(s.body,u.maxline||64)+`\r
`,c+="-----END "+s.type+`-----\r
`,c},e.decode=function(s){for(var u=[],c=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,i=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,y=/\r?\n/,f;f=c.exec(s),!!f;){var A=f[1];A==="NEW CERTIFICATE REQUEST"&&(A="CERTIFICATE REQUEST");var C={type:A,procType:null,contentDomain:null,dekInfo:null,headers:[],body:t.util.decode64(f[3])};if(u.push(C),!!f[2]){for(var p=f[2].split(y),o=0;f&&o<p.length;){for(var m=p[o].replace(/\s+$/,""),g=o+1;g<p.length;++g){var S=p[g];if(!/\s/.test(S[0]))break;m+=S,o=g}if(f=m.match(i),f){for(var a={name:f[1],values:[]},v=f[2].split(","),E=0;E<v.length;++E)a.values.push(n(v[E]));if(C.procType)if(!C.contentDomain&&a.name==="Content-Domain")C.contentDomain=v[0]||"";else if(!C.dekInfo&&a.name==="DEK-Info"){if(a.values.length===0)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');C.dekInfo={algorithm:v[0],parameters:v[1]||null}}else C.headers.push(a);else{if(a.name!=="Proc-Type")throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(a.values.length!==2)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');C.procType={version:v[0],type:v[1]}}}++o}if(C.procType==="ENCRYPTED"&&!C.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(u.length===0)throw new Error("Invalid PEM formatted message.");return u};function r(s){for(var u=s.name+": ",c=[],i=function(p,o){return" "+o},y=0;y<s.values.length;++y)c.push(s.values[y].replace(/^(\S+\r\n)/,i));u+=c.join(",")+`\r
`;for(var f=0,A=-1,y=0;y<u.length;++y,++f)if(f>65&&A!==-1){var C=u[A];C===","?(++A,u=u.substr(0,A)+`\r
 `+u.substr(A)):u=u.substr(0,A)+`\r
`+C+u.substr(A+1),f=y-A-1,A=-1,++y}else(u[y]===" "||u[y]==="	"||u[y]===",")&&(A=y);return u}function n(s){return s.replace(/^\s+/,"")}return zi.exports}var Wi={exports:{}},Qi,Eo;function oi(){if(Eo)return Qi;Eo=1;var t=me();ps(),xc(),Ae(),Qi=t.des=t.des||{},t.des.startEncrypting=function(o,m,g,S){var a=p({key:o,output:g,decrypt:!1,mode:S||(m===null?"ECB":"CBC")});return a.start(m),a},t.des.createEncryptionCipher=function(o,m){return p({key:o,output:null,decrypt:!1,mode:m})},t.des.startDecrypting=function(o,m,g,S){var a=p({key:o,output:g,decrypt:!0,mode:S||(m===null?"ECB":"CBC")});return a.start(m),a},t.des.createDecryptionCipher=function(o,m){return p({key:o,output:null,decrypt:!0,mode:m})},t.des.Algorithm=function(o,m){var g=this;g.name=o,g.mode=new m({blockSize:8,cipher:{encrypt:function(S,a){return C(g._keys,S,a,!1)},decrypt:function(S,a){return C(g._keys,S,a,!0)}}}),g._init=!1},t.des.Algorithm.prototype.initialize=function(o){if(!this._init){var m=t.util.createBuffer(o.key);if(this.name.indexOf("3DES")===0&&m.length()!==24)throw new Error("Invalid Triple-DES key size: "+m.length()*8);this._keys=A(m),this._init=!0}},e("DES-ECB",t.cipher.modes.ecb),e("DES-CBC",t.cipher.modes.cbc),e("DES-CFB",t.cipher.modes.cfb),e("DES-OFB",t.cipher.modes.ofb),e("DES-CTR",t.cipher.modes.ctr),e("3DES-ECB",t.cipher.modes.ecb),e("3DES-CBC",t.cipher.modes.cbc),e("3DES-CFB",t.cipher.modes.cfb),e("3DES-OFB",t.cipher.modes.ofb),e("3DES-CTR",t.cipher.modes.ctr);function e(o,m){var g=function(){return new t.des.Algorithm(o,m)};t.cipher.registerAlgorithm(o,g)}var r=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],n=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],s=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],u=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],c=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],i=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],y=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],f=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function A(o){for(var m=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],g=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],S=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],a=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],v=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],E=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],b=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],R=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],T=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],h=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],l=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],B=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],N=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],F=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],L=o.length()>8?3:1,q=[],j=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],H=0,Q,J=0;J<L;J++){var X=o.getInt32(),re=o.getInt32();Q=(X>>>4^re)&252645135,re^=Q,X^=Q<<4,Q=(re>>>-16^X)&65535,X^=Q,re^=Q<<-16,Q=(X>>>2^re)&858993459,re^=Q,X^=Q<<2,Q=(re>>>-16^X)&65535,X^=Q,re^=Q<<-16,Q=(X>>>1^re)&1431655765,re^=Q,X^=Q<<1,Q=(re>>>8^X)&16711935,X^=Q,re^=Q<<8,Q=(X>>>1^re)&1431655765,re^=Q,X^=Q<<1,Q=X<<8|re>>>20&240,X=re<<24|re<<8&16711680|re>>>8&65280|re>>>24&240,re=Q;for(var se=0;se<j.length;++se){j[se]?(X=X<<2|X>>>26,re=re<<2|re>>>26):(X=X<<1|X>>>27,re=re<<1|re>>>27),X&=-15,re&=-15;var de=m[X>>>28]|g[X>>>24&15]|S[X>>>20&15]|a[X>>>16&15]|v[X>>>12&15]|E[X>>>8&15]|b[X>>>4&15],ye=R[re>>>28]|T[re>>>24&15]|h[re>>>20&15]|l[re>>>16&15]|B[re>>>12&15]|N[re>>>8&15]|F[re>>>4&15];Q=(ye>>>16^de)&65535,q[H++]=de^Q,q[H++]=ye^Q<<16}}return q}function C(o,m,g,S){var a=o.length===32?3:9,v;a===3?v=S?[30,-2,-2]:[0,32,2]:v=S?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var E,b=m[0],R=m[1];E=(b>>>4^R)&252645135,R^=E,b^=E<<4,E=(b>>>16^R)&65535,R^=E,b^=E<<16,E=(R>>>2^b)&858993459,b^=E,R^=E<<2,E=(R>>>8^b)&16711935,b^=E,R^=E<<8,E=(b>>>1^R)&1431655765,R^=E,b^=E<<1,b=b<<1|b>>>31,R=R<<1|R>>>31;for(var T=0;T<a;T+=3){for(var h=v[T+1],l=v[T+2],B=v[T];B!=h;B+=l){var N=R^o[B],F=(R>>>4|R<<28)^o[B+1];E=b,b=R,R=E^(n[N>>>24&63]|u[N>>>16&63]|i[N>>>8&63]|f[N&63]|r[F>>>24&63]|s[F>>>16&63]|c[F>>>8&63]|y[F&63])}E=b,b=R,R=E}b=b>>>1|b<<31,R=R>>>1|R<<31,E=(b>>>1^R)&1431655765,R^=E,b^=E<<1,E=(R>>>8^b)&16711935,b^=E,R^=E<<8,E=(R>>>2^b)&858993459,b^=E,R^=E<<2,E=(b>>>16^R)&65535,R^=E,b^=E<<16,E=(b>>>4^R)&252645135,R^=E,b^=E<<4,g[0]=b,g[1]=R}function p(o){o=o||{};var m=(o.mode||"CBC").toUpperCase(),g="DES-"+m,S;o.decrypt?S=t.cipher.createDecipher(g,o.key):S=t.cipher.createCipher(g,o.key);var a=S.start;return S.start=function(v,E){var b=null;E instanceof t.util.ByteBuffer&&(b=E,E={}),E=E||{},E.output=b,E.iv=v,a.call(S,E)},S}return Qi}var Yi,Co;function gs(){if(Co)return Yi;Co=1;var t=me();an(),Ot(),Ae();var e=t.pkcs5=t.pkcs5||{},r;return t.util.isNodejs&&!t.options.usePureJavaScript&&(r=Qr),Yi=t.pbkdf2=e.pbkdf2=function(n,s,u,c,i,y){if(typeof i=="function"&&(y=i,i=null),t.util.isNodejs&&!t.options.usePureJavaScript&&r.pbkdf2&&(i===null||typeof i!="object")&&(r.pbkdf2Sync.length>4||!i||i==="sha1"))return typeof i!="string"&&(i="sha1"),n=Buffer.from(n,"binary"),s=Buffer.from(s,"binary"),y?r.pbkdf2Sync.length===4?r.pbkdf2(n,s,u,c,function(T,h){if(T)return y(T);y(null,h.toString("binary"))}):r.pbkdf2(n,s,u,c,i,function(T,h){if(T)return y(T);y(null,h.toString("binary"))}):r.pbkdf2Sync.length===4?r.pbkdf2Sync(n,s,u,c).toString("binary"):r.pbkdf2Sync(n,s,u,c,i).toString("binary");if((typeof i>"u"||i===null)&&(i="sha1"),typeof i=="string"){if(!(i in t.md.algorithms))throw new Error("Unknown hash algorithm: "+i);i=t.md[i].create()}var f=i.digestLength;if(c>4294967295*f){var A=new Error("Derived key is too long.");if(y)return y(A);throw A}var C=Math.ceil(c/f),p=c-(C-1)*f,o=t.hmac.create();o.start(i,n);var m="",g,S,a;if(!y){for(var v=1;v<=C;++v){o.start(null,null),o.update(s),o.update(t.util.int32ToBytes(v)),g=a=o.digest().getBytes();for(var E=2;E<=u;++E)o.start(null,null),o.update(a),S=o.digest().getBytes(),g=t.util.xorBytes(g,S,f),a=S;m+=v<C?g:g.substr(0,p)}return m}var v=1,E;function b(){if(v>C)return y(null,m);o.start(null,null),o.update(s),o.update(t.util.int32ToBytes(v)),g=a=o.digest().getBytes(),E=2,R()}function R(){if(E<=u)return o.start(null,null),o.update(a),S=o.digest().getBytes(),g=t.util.xorBytes(g,S,f),a=S,++E,t.util.setImmediate(R);m+=v<C?g:g.substr(0,p),++v,b()}b()},Yi}var Tn={exports:{}},Ji={exports:{}},So;function _c(){if(So)return Ji.exports;So=1;var t=me();Ot(),Ae();var e=Ji.exports=t.sha256=t.sha256||{};t.md.sha256=t.md.algorithms.sha256=e,e.create=function(){n||u();var i=null,y=t.util.createBuffer(),f=new Array(64),A={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8};return A.start=function(){A.messageLength=0,A.fullMessageLength=A.messageLength64=[];for(var C=A.messageLengthSize/4,p=0;p<C;++p)A.fullMessageLength.push(0);return y=t.util.createBuffer(),i={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},A},A.start(),A.update=function(C,p){p==="utf8"&&(C=t.util.encodeUtf8(C));var o=C.length;A.messageLength+=o,o=[o/4294967296>>>0,o>>>0];for(var m=A.fullMessageLength.length-1;m>=0;--m)A.fullMessageLength[m]+=o[1],o[1]=o[0]+(A.fullMessageLength[m]/4294967296>>>0),A.fullMessageLength[m]=A.fullMessageLength[m]>>>0,o[0]=o[1]/4294967296>>>0;return y.putBytes(C),c(i,f,y),(y.read>2048||y.length()===0)&&y.compact(),A},A.digest=function(){var C=t.util.createBuffer();C.putBytes(y.bytes());var p=A.fullMessageLength[A.fullMessageLength.length-1]+A.messageLengthSize,o=p&A.blockLength-1;C.putBytes(r.substr(0,A.blockLength-o));for(var m,g,S=A.fullMessageLength[0]*8,a=0;a<A.fullMessageLength.length-1;++a)m=A.fullMessageLength[a+1]*8,g=m/4294967296>>>0,S+=g,C.putInt32(S>>>0),S=m>>>0;C.putInt32(S);var v={h0:i.h0,h1:i.h1,h2:i.h2,h3:i.h3,h4:i.h4,h5:i.h5,h6:i.h6,h7:i.h7};c(v,f,C);var E=t.util.createBuffer();return E.putInt32(v.h0),E.putInt32(v.h1),E.putInt32(v.h2),E.putInt32(v.h3),E.putInt32(v.h4),E.putInt32(v.h5),E.putInt32(v.h6),E.putInt32(v.h7),E},A};var r=null,n=!1,s=null;function u(){r=String.fromCharCode(128),r+=t.util.fillString(String.fromCharCode(0),64),s=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],n=!0}function c(i,y,f){for(var A,C,p,o,m,g,S,a,v,E,b,R,T,h,l,B=f.length();B>=64;){for(S=0;S<16;++S)y[S]=f.getInt32();for(;S<64;++S)A=y[S-2],A=(A>>>17|A<<15)^(A>>>19|A<<13)^A>>>10,C=y[S-15],C=(C>>>7|C<<25)^(C>>>18|C<<14)^C>>>3,y[S]=A+y[S-7]+C+y[S-16]|0;for(a=i.h0,v=i.h1,E=i.h2,b=i.h3,R=i.h4,T=i.h5,h=i.h6,l=i.h7,S=0;S<64;++S)o=(R>>>6|R<<26)^(R>>>11|R<<21)^(R>>>25|R<<7),m=h^R&(T^h),p=(a>>>2|a<<30)^(a>>>13|a<<19)^(a>>>22|a<<10),g=a&v|E&(a^v),A=l+o+m+s[S]+y[S],C=p+g,l=h,h=T,T=R,R=b+A>>>0,b=E,E=v,v=a,a=A+C>>>0;i.h0=i.h0+a|0,i.h1=i.h1+v|0,i.h2=i.h2+E|0,i.h3=i.h3+b|0,i.h4=i.h4+R|0,i.h5=i.h5+T|0,i.h6=i.h6+h|0,i.h7=i.h7+l|0,B-=64}}return Ji.exports}var Xi={exports:{}},Ao;function wc(){if(Ao)return Xi.exports;Ao=1;var t=me();Ae();var e=null;t.util.isNodejs&&!t.options.usePureJavaScript&&!process.versions["node-webkit"]&&(e=Qr);var r=Xi.exports=t.prng=t.prng||{};return r.create=function(n){for(var s={plugin:n,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},u=n.md,c=new Array(32),i=0;i<32;++i)c[i]=u.create();s.pools=c,s.pool=0,s.generate=function(p,o){if(!o)return s.generateSync(p);var m=s.plugin.cipher,g=s.plugin.increment,S=s.plugin.formatKey,a=s.plugin.formatSeed,v=t.util.createBuffer();s.key=null,E();function E(b){if(b)return o(b);if(v.length()>=p)return o(null,v.getBytes(p));if(s.generated>1048575&&(s.key=null),s.key===null)return t.util.nextTick(function(){y(E)});var R=m(s.key,s.seed);s.generated+=R.length,v.putBytes(R),s.key=S(m(s.key,g(s.seed))),s.seed=a(m(s.key,s.seed)),t.util.setImmediate(E)}},s.generateSync=function(p){var o=s.plugin.cipher,m=s.plugin.increment,g=s.plugin.formatKey,S=s.plugin.formatSeed;s.key=null;for(var a=t.util.createBuffer();a.length()<p;){s.generated>1048575&&(s.key=null),s.key===null&&f();var v=o(s.key,s.seed);s.generated+=v.length,a.putBytes(v),s.key=g(o(s.key,m(s.seed))),s.seed=S(o(s.key,s.seed))}return a.getBytes(p)};function y(p){if(s.pools[0].messageLength>=32)return A(),p();var o=32-s.pools[0].messageLength<<5;s.seedFile(o,function(m,g){if(m)return p(m);s.collect(g),A(),p()})}function f(){if(s.pools[0].messageLength>=32)return A();var p=32-s.pools[0].messageLength<<5;s.collect(s.seedFileSync(p)),A()}function A(){s.reseeds=s.reseeds===4294967295?0:s.reseeds+1;var p=s.plugin.md.create();p.update(s.keyBytes);for(var o=1,m=0;m<32;++m)s.reseeds%o===0&&(p.update(s.pools[m].digest().getBytes()),s.pools[m].start()),o=o<<1;s.keyBytes=p.digest().getBytes(),p.start(),p.update(s.keyBytes);var g=p.digest().getBytes();s.key=s.plugin.formatKey(s.keyBytes),s.seed=s.plugin.formatSeed(g),s.generated=0}function C(p){var o=null,m=t.util.globalScope,g=m.crypto||m.msCrypto;g&&g.getRandomValues&&(o=function(l){return g.getRandomValues(l)});var S=t.util.createBuffer();if(o)for(;S.length()<p;){var a=Math.max(1,Math.min(p-S.length(),65536)/4),v=new Uint32Array(Math.floor(a));try{o(v);for(var E=0;E<v.length;++E)S.putInt32(v[E])}catch(l){if(!(typeof QuotaExceededError<"u"&&l instanceof QuotaExceededError))throw l}}if(S.length()<p)for(var b,R,T,h=Math.floor(Math.random()*65536);S.length()<p;){R=16807*(h&65535),b=16807*(h>>16),R+=(b&32767)<<16,R+=b>>15,R=(R&2147483647)+(R>>31),h=R&4294967295;for(var E=0;E<3;++E)T=h>>>(E<<3),T^=Math.floor(Math.random()*256),S.putByte(T&255)}return S.getBytes(p)}return e?(s.seedFile=function(p,o){e.randomBytes(p,function(m,g){if(m)return o(m);o(null,g.toString())})},s.seedFileSync=function(p){return e.randomBytes(p).toString()}):(s.seedFile=function(p,o){try{o(null,C(p))}catch(m){o(m)}},s.seedFileSync=C),s.collect=function(p){for(var o=p.length,m=0;m<o;++m)s.pools[s.pool].update(p.substr(m,1)),s.pool=s.pool===31?0:s.pool+1},s.collectInt=function(p,o){for(var m="",g=0;g<o;g+=8)m+=String.fromCharCode(p>>g&255);s.collect(m)},s.registerWorker=function(p){if(p===self)s.seedFile=function(m,g){function S(a){var v=a.data;v.forge&&v.forge.prng&&(self.removeEventListener("message",S),g(v.forge.prng.err,v.forge.prng.bytes))}self.addEventListener("message",S),self.postMessage({forge:{prng:{needed:m}}})};else{var o=function(m){var g=m.data;g.forge&&g.forge.prng&&s.seedFile(g.forge.prng.needed,function(S,a){p.postMessage({forge:{prng:{err:S,bytes:a}}})})};p.addEventListener("message",o)}},s},Xi.exports}var To;function yt(){if(To)return Tn.exports;To=1;var t=me();return sr(),_c(),wc(),Ae(),function(){if(t.random&&t.random.getBytes){Tn.exports=t.random;return}(function(e){var r={},n=new Array(4),s=t.util.createBuffer();r.formatKey=function(p){var o=t.util.createBuffer(p);return p=new Array(4),p[0]=o.getInt32(),p[1]=o.getInt32(),p[2]=o.getInt32(),p[3]=o.getInt32(),t.aes._expandKey(p,!1)},r.formatSeed=function(p){var o=t.util.createBuffer(p);return p=new Array(4),p[0]=o.getInt32(),p[1]=o.getInt32(),p[2]=o.getInt32(),p[3]=o.getInt32(),p},r.cipher=function(p,o){return t.aes._updateBlock(p,o,n,!1),s.putInt32(n[0]),s.putInt32(n[1]),s.putInt32(n[2]),s.putInt32(n[3]),s.getBytes()},r.increment=function(p){return++p[3],p},r.md=t.md.sha256;function u(){var p=t.prng.create(r);return p.getBytes=function(o,m){return p.generate(o,m)},p.getBytesSync=function(o){return p.generate(o)},p}var c=u(),i=null,y=t.util.globalScope,f=y.crypto||y.msCrypto;if(f&&f.getRandomValues&&(i=function(p){return f.getRandomValues(p)}),t.options.usePureJavaScript||!t.util.isNodejs&&!i){if(c.collectInt(+new Date,32),typeof navigator<"u"){var A="";for(var C in navigator)try{typeof navigator[C]=="string"&&(A+=navigator[C])}catch{}c.collect(A),A=null}e&&(e().mousemove(function(p){c.collectInt(p.clientX,16),c.collectInt(p.clientY,16)}),e().keypress(function(p){c.collectInt(p.charCode,8)}))}if(!t.random)t.random=c;else for(var C in c)t.random[C]=c[C];t.random.createInstance=u,Tn.exports=t.random})(typeof jQuery<"u"?jQuery:null)}(),Tn.exports}var Zi,xo;function Ic(){if(xo)return Zi;xo=1;var t=me();Ae();var e=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],r=[1,2,3,5],n=function(c,i){return c<<i&65535|(c&65535)>>16-i},s=function(c,i){return(c&65535)>>i|c<<16-i&65535};Zi=t.rc2=t.rc2||{},t.rc2.expandKey=function(c,i){typeof c=="string"&&(c=t.util.createBuffer(c)),i=i||128;var y=c,f=c.length(),A=i,C=Math.ceil(A/8),p=255>>(A&7),o;for(o=f;o<128;o++)y.putByte(e[y.at(o-1)+y.at(o-f)&255]);for(y.setAt(128-C,e[y.at(128-C)&p]),o=127-C;o>=0;o--)y.setAt(o,e[y.at(o+1)^y.at(o+C)]);return y};var u=function(c,i,y){var f=!1,A=null,C=null,p=null,o,m,g,S,a=[];for(c=t.rc2.expandKey(c,i),g=0;g<64;g++)a.push(c.getInt16Le());y?(o=function(b){for(g=0;g<4;g++)b[g]+=a[S]+(b[(g+3)%4]&b[(g+2)%4])+(~b[(g+3)%4]&b[(g+1)%4]),b[g]=n(b[g],r[g]),S++},m=function(b){for(g=0;g<4;g++)b[g]+=a[b[(g+3)%4]&63]}):(o=function(b){for(g=3;g>=0;g--)b[g]=s(b[g],r[g]),b[g]-=a[S]+(b[(g+3)%4]&b[(g+2)%4])+(~b[(g+3)%4]&b[(g+1)%4]),S--},m=function(b){for(g=3;g>=0;g--)b[g]-=a[b[(g+3)%4]&63]});var v=function(b){var R=[];for(g=0;g<4;g++){var T=A.getInt16Le();p!==null&&(y?T^=p.getInt16Le():p.putInt16Le(T)),R.push(T&65535)}S=y?0:63;for(var h=0;h<b.length;h++)for(var l=0;l<b[h][0];l++)b[h][1](R);for(g=0;g<4;g++)p!==null&&(y?p.putInt16Le(R[g]):R[g]^=p.getInt16Le()),C.putInt16Le(R[g])},E=null;return E={start:function(b,R){b&&typeof b=="string"&&(b=t.util.createBuffer(b)),f=!1,A=t.util.createBuffer(),C=R||new t.util.createBuffer,p=b,E.output=C},update:function(b){for(f||A.putBuffer(b);A.length()>=8;)v([[5,o],[1,m],[6,o],[1,m],[5,o]])},finish:function(b){var R=!0;if(y)if(b)R=b(8,A,!y);else{var T=A.length()===8?8:8-A.length();A.fillWithByte(T,T)}if(R&&(f=!0,E.update()),!y&&(R=A.length()===0,R))if(b)R=b(8,C,!y);else{var h=C.length(),l=C.at(h-1);l>h?R=!1:C.truncate(l)}return R}},E};return t.rc2.startEncrypting=function(c,i,y){var f=t.rc2.createEncryptionCipher(c,128);return f.start(i,y),f},t.rc2.createEncryptionCipher=function(c,i){return u(c,i,!0)},t.rc2.startDecrypting=function(c,i,y){var f=t.rc2.createDecryptionCipher(c,128);return f.start(i,y),f},t.rc2.createDecryptionCipher=function(c,i){return u(c,i,!1)},Zi}var ea,_o;function ui(){if(_o)return ea;_o=1;var t=me();ea=t.jsbn=t.jsbn||{};var e;function r(U,k,D){this.data=[],U!=null&&(typeof U=="number"?this.fromNumber(U,k,D):k==null&&typeof U!="string"?this.fromString(U,256):this.fromString(U,k))}t.jsbn.BigInteger=r;function n(){return new r(null)}function s(U,k,D,z,Z,ee){for(;--ee>=0;){var oe=k*this.data[U++]+D.data[z]+Z;Z=Math.floor(oe/67108864),D.data[z++]=oe&67108863}return Z}function u(U,k,D,z,Z,ee){for(var oe=k&32767,ae=k>>15;--ee>=0;){var xe=this.data[U]&32767,Je=this.data[U++]>>15,ut=ae*xe+Je*oe;xe=oe*xe+((ut&32767)<<15)+D.data[z]+(Z&1073741823),Z=(xe>>>30)+(ut>>>15)+ae*Je+(Z>>>30),D.data[z++]=xe&1073741823}return Z}function c(U,k,D,z,Z,ee){for(var oe=k&16383,ae=k>>14;--ee>=0;){var xe=this.data[U]&16383,Je=this.data[U++]>>14,ut=ae*xe+Je*oe;xe=oe*xe+((ut&16383)<<14)+D.data[z]+Z,Z=(xe>>28)+(ut>>14)+ae*Je,D.data[z++]=xe&268435455}return Z}typeof navigator>"u"?(r.prototype.am=c,e=28):navigator.appName=="Microsoft Internet Explorer"?(r.prototype.am=u,e=30):navigator.appName!="Netscape"?(r.prototype.am=s,e=26):(r.prototype.am=c,e=28),r.prototype.DB=e,r.prototype.DM=(1<<e)-1,r.prototype.DV=1<<e;var i=52;r.prototype.FV=Math.pow(2,i),r.prototype.F1=i-e,r.prototype.F2=2*e-i;var y="0123456789abcdefghijklmnopqrstuvwxyz",f=new Array,A,C;for(A="0".charCodeAt(0),C=0;C<=9;++C)f[A++]=C;for(A="a".charCodeAt(0),C=10;C<36;++C)f[A++]=C;for(A="A".charCodeAt(0),C=10;C<36;++C)f[A++]=C;function p(U){return y.charAt(U)}function o(U,k){var D=f[U.charCodeAt(k)];return D??-1}function m(U){for(var k=this.t-1;k>=0;--k)U.data[k]=this.data[k];U.t=this.t,U.s=this.s}function g(U){this.t=1,this.s=U<0?-1:0,U>0?this.data[0]=U:U<-1?this.data[0]=U+this.DV:this.t=0}function S(U){var k=n();return k.fromInt(U),k}function a(U,k){var D;if(k==16)D=4;else if(k==8)D=3;else if(k==256)D=8;else if(k==2)D=1;else if(k==32)D=5;else if(k==4)D=2;else{this.fromRadix(U,k);return}this.t=0,this.s=0;for(var z=U.length,Z=!1,ee=0;--z>=0;){var oe=D==8?U[z]&255:o(U,z);if(oe<0){U.charAt(z)=="-"&&(Z=!0);continue}Z=!1,ee==0?this.data[this.t++]=oe:ee+D>this.DB?(this.data[this.t-1]|=(oe&(1<<this.DB-ee)-1)<<ee,this.data[this.t++]=oe>>this.DB-ee):this.data[this.t-1]|=oe<<ee,ee+=D,ee>=this.DB&&(ee-=this.DB)}D==8&&U[0]&128&&(this.s=-1,ee>0&&(this.data[this.t-1]|=(1<<this.DB-ee)-1<<ee)),this.clamp(),Z&&r.ZERO.subTo(this,this)}function v(){for(var U=this.s&this.DM;this.t>0&&this.data[this.t-1]==U;)--this.t}function E(U){if(this.s<0)return"-"+this.negate().toString(U);var k;if(U==16)k=4;else if(U==8)k=3;else if(U==2)k=1;else if(U==32)k=5;else if(U==4)k=2;else return this.toRadix(U);var D=(1<<k)-1,z,Z=!1,ee="",oe=this.t,ae=this.DB-oe*this.DB%k;if(oe-- >0)for(ae<this.DB&&(z=this.data[oe]>>ae)>0&&(Z=!0,ee=p(z));oe>=0;)ae<k?(z=(this.data[oe]&(1<<ae)-1)<<k-ae,z|=this.data[--oe]>>(ae+=this.DB-k)):(z=this.data[oe]>>(ae-=k)&D,ae<=0&&(ae+=this.DB,--oe)),z>0&&(Z=!0),Z&&(ee+=p(z));return Z?ee:"0"}function b(){var U=n();return r.ZERO.subTo(this,U),U}function R(){return this.s<0?this.negate():this}function T(U){var k=this.s-U.s;if(k!=0)return k;var D=this.t;if(k=D-U.t,k!=0)return this.s<0?-k:k;for(;--D>=0;)if((k=this.data[D]-U.data[D])!=0)return k;return 0}function h(U){var k=1,D;return(D=U>>>16)!=0&&(U=D,k+=16),(D=U>>8)!=0&&(U=D,k+=8),(D=U>>4)!=0&&(U=D,k+=4),(D=U>>2)!=0&&(U=D,k+=2),(D=U>>1)!=0&&(U=D,k+=1),k}function l(){return this.t<=0?0:this.DB*(this.t-1)+h(this.data[this.t-1]^this.s&this.DM)}function B(U,k){var D;for(D=this.t-1;D>=0;--D)k.data[D+U]=this.data[D];for(D=U-1;D>=0;--D)k.data[D]=0;k.t=this.t+U,k.s=this.s}function N(U,k){for(var D=U;D<this.t;++D)k.data[D-U]=this.data[D];k.t=Math.max(this.t-U,0),k.s=this.s}function F(U,k){var D=U%this.DB,z=this.DB-D,Z=(1<<z)-1,ee=Math.floor(U/this.DB),oe=this.s<<D&this.DM,ae;for(ae=this.t-1;ae>=0;--ae)k.data[ae+ee+1]=this.data[ae]>>z|oe,oe=(this.data[ae]&Z)<<D;for(ae=ee-1;ae>=0;--ae)k.data[ae]=0;k.data[ee]=oe,k.t=this.t+ee+1,k.s=this.s,k.clamp()}function L(U,k){k.s=this.s;var D=Math.floor(U/this.DB);if(D>=this.t){k.t=0;return}var z=U%this.DB,Z=this.DB-z,ee=(1<<z)-1;k.data[0]=this.data[D]>>z;for(var oe=D+1;oe<this.t;++oe)k.data[oe-D-1]|=(this.data[oe]&ee)<<Z,k.data[oe-D]=this.data[oe]>>z;z>0&&(k.data[this.t-D-1]|=(this.s&ee)<<Z),k.t=this.t-D,k.clamp()}function q(U,k){for(var D=0,z=0,Z=Math.min(U.t,this.t);D<Z;)z+=this.data[D]-U.data[D],k.data[D++]=z&this.DM,z>>=this.DB;if(U.t<this.t){for(z-=U.s;D<this.t;)z+=this.data[D],k.data[D++]=z&this.DM,z>>=this.DB;z+=this.s}else{for(z+=this.s;D<U.t;)z-=U.data[D],k.data[D++]=z&this.DM,z>>=this.DB;z-=U.s}k.s=z<0?-1:0,z<-1?k.data[D++]=this.DV+z:z>0&&(k.data[D++]=z),k.t=D,k.clamp()}function j(U,k){var D=this.abs(),z=U.abs(),Z=D.t;for(k.t=Z+z.t;--Z>=0;)k.data[Z]=0;for(Z=0;Z<z.t;++Z)k.data[Z+D.t]=D.am(0,z.data[Z],k,Z,0,D.t);k.s=0,k.clamp(),this.s!=U.s&&r.ZERO.subTo(k,k)}function H(U){for(var k=this.abs(),D=U.t=2*k.t;--D>=0;)U.data[D]=0;for(D=0;D<k.t-1;++D){var z=k.am(D,k.data[D],U,2*D,0,1);(U.data[D+k.t]+=k.am(D+1,2*k.data[D],U,2*D+1,z,k.t-D-1))>=k.DV&&(U.data[D+k.t]-=k.DV,U.data[D+k.t+1]=1)}U.t>0&&(U.data[U.t-1]+=k.am(D,k.data[D],U,2*D,0,1)),U.s=0,U.clamp()}function Q(U,k,D){var z=U.abs();if(!(z.t<=0)){var Z=this.abs();if(Z.t<z.t){k!=null&&k.fromInt(0),D!=null&&this.copyTo(D);return}D==null&&(D=n());var ee=n(),oe=this.s,ae=U.s,xe=this.DB-h(z.data[z.t-1]);xe>0?(z.lShiftTo(xe,ee),Z.lShiftTo(xe,D)):(z.copyTo(ee),Z.copyTo(D));var Je=ee.t,ut=ee.data[Je-1];if(ut!=0){var ot=ut*(1<<this.F1)+(Je>1?ee.data[Je-2]>>this.F2:0),_t=this.FV/ot,gn=(1<<this.F1)/ot,ft=1<<this.F2,dt=D.t,vn=dt-Je,Lt=k??n();for(ee.dlShiftTo(vn,Lt),D.compareTo(Lt)>=0&&(D.data[D.t++]=1,D.subTo(Lt,D)),r.ONE.dlShiftTo(Je,Lt),Lt.subTo(ee,ee);ee.t<Je;)ee.data[ee.t++]=0;for(;--vn>=0;){var bi=D.data[--dt]==ut?this.DM:Math.floor(D.data[dt]*_t+(D.data[dt-1]+ft)*gn);if((D.data[dt]+=ee.am(0,bi,D,vn,0,Je))<bi)for(ee.dlShiftTo(vn,Lt),D.subTo(Lt,D);D.data[dt]<--bi;)D.subTo(Lt,D)}k!=null&&(D.drShiftTo(Je,k),oe!=ae&&r.ZERO.subTo(k,k)),D.t=Je,D.clamp(),xe>0&&D.rShiftTo(xe,D),oe<0&&r.ZERO.subTo(D,D)}}}function J(U){var k=n();return this.abs().divRemTo(U,null,k),this.s<0&&k.compareTo(r.ZERO)>0&&U.subTo(k,k),k}function X(U){this.m=U}function re(U){return U.s<0||U.compareTo(this.m)>=0?U.mod(this.m):U}function se(U){return U}function de(U){U.divRemTo(this.m,null,U)}function ye(U,k,D){U.multiplyTo(k,D),this.reduce(D)}function _e(U,k){U.squareTo(k),this.reduce(k)}X.prototype.convert=re,X.prototype.revert=se,X.prototype.reduce=de,X.prototype.mulTo=ye,X.prototype.sqrTo=_e;function W(){if(this.t<1)return 0;var U=this.data[0];if(!(U&1))return 0;var k=U&3;return k=k*(2-(U&15)*k)&15,k=k*(2-(U&255)*k)&255,k=k*(2-((U&65535)*k&65535))&65535,k=k*(2-U*k%this.DV)%this.DV,k>0?this.DV-k:-k}function he(U){this.m=U,this.mp=U.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<U.DB-15)-1,this.mt2=2*U.t}function ie(U){var k=n();return U.abs().dlShiftTo(this.m.t,k),k.divRemTo(this.m,null,k),U.s<0&&k.compareTo(r.ZERO)>0&&this.m.subTo(k,k),k}function ke(U){var k=n();return U.copyTo(k),this.reduce(k),k}function fe(U){for(;U.t<=this.mt2;)U.data[U.t++]=0;for(var k=0;k<this.m.t;++k){var D=U.data[k]&32767,z=D*this.mpl+((D*this.mph+(U.data[k]>>15)*this.mpl&this.um)<<15)&U.DM;for(D=k+this.m.t,U.data[D]+=this.m.am(0,z,U,k,0,this.m.t);U.data[D]>=U.DV;)U.data[D]-=U.DV,U.data[++D]++}U.clamp(),U.drShiftTo(this.m.t,U),U.compareTo(this.m)>=0&&U.subTo(this.m,U)}function _(U,k){U.squareTo(k),this.reduce(k)}function x(U,k,D){U.multiplyTo(k,D),this.reduce(D)}he.prototype.convert=ie,he.prototype.revert=ke,he.prototype.reduce=fe,he.prototype.mulTo=x,he.prototype.sqrTo=_;function w(){return(this.t>0?this.data[0]&1:this.s)==0}function d(U,k){if(U>4294967295||U<1)return r.ONE;var D=n(),z=n(),Z=k.convert(this),ee=h(U)-1;for(Z.copyTo(D);--ee>=0;)if(k.sqrTo(D,z),(U&1<<ee)>0)k.mulTo(z,Z,D);else{var oe=D;D=z,z=oe}return k.revert(D)}function I(U,k){var D;return U<256||k.isEven()?D=new X(k):D=new he(k),this.exp(U,D)}r.prototype.copyTo=m,r.prototype.fromInt=g,r.prototype.fromString=a,r.prototype.clamp=v,r.prototype.dlShiftTo=B,r.prototype.drShiftTo=N,r.prototype.lShiftTo=F,r.prototype.rShiftTo=L,r.prototype.subTo=q,r.prototype.multiplyTo=j,r.prototype.squareTo=H,r.prototype.divRemTo=Q,r.prototype.invDigit=W,r.prototype.isEven=w,r.prototype.exp=d,r.prototype.toString=E,r.prototype.negate=b,r.prototype.abs=R,r.prototype.compareTo=T,r.prototype.bitLength=l,r.prototype.mod=J,r.prototype.modPowInt=I,r.ZERO=S(0),r.ONE=S(1);function O(){var U=n();return this.copyTo(U),U}function P(){if(this.s<0){if(this.t==1)return this.data[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this.data[0];if(this.t==0)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function K(){return this.t==0?this.s:this.data[0]<<24>>24}function V(){return this.t==0?this.s:this.data[0]<<16>>16}function $(U){return Math.floor(Math.LN2*this.DB/Math.log(U))}function M(){return this.s<0?-1:this.t<=0||this.t==1&&this.data[0]<=0?0:1}function G(U){if(U==null&&(U=10),this.signum()==0||U<2||U>36)return"0";var k=this.chunkSize(U),D=Math.pow(U,k),z=S(D),Z=n(),ee=n(),oe="";for(this.divRemTo(z,Z,ee);Z.signum()>0;)oe=(D+ee.intValue()).toString(U).substr(1)+oe,Z.divRemTo(z,Z,ee);return ee.intValue().toString(U)+oe}function Y(U,k){this.fromInt(0),k==null&&(k=10);for(var D=this.chunkSize(k),z=Math.pow(k,D),Z=!1,ee=0,oe=0,ae=0;ae<U.length;++ae){var xe=o(U,ae);if(xe<0){U.charAt(ae)=="-"&&this.signum()==0&&(Z=!0);continue}oe=k*oe+xe,++ee>=D&&(this.dMultiply(z),this.dAddOffset(oe,0),ee=0,oe=0)}ee>0&&(this.dMultiply(Math.pow(k,ee)),this.dAddOffset(oe,0)),Z&&r.ZERO.subTo(this,this)}function ne(U,k,D){if(typeof k=="number")if(U<2)this.fromInt(1);else for(this.fromNumber(U,D),this.testBit(U-1)||this.bitwiseTo(r.ONE.shiftLeft(U-1),be,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(k);)this.dAddOffset(2,0),this.bitLength()>U&&this.subTo(r.ONE.shiftLeft(U-1),this);else{var z=new Array,Z=U&7;z.length=(U>>3)+1,k.nextBytes(z),Z>0?z[0]&=(1<<Z)-1:z[0]=0,this.fromString(z,256)}}function te(){var U=this.t,k=new Array;k[0]=this.s;var D=this.DB-U*this.DB%8,z,Z=0;if(U-- >0)for(D<this.DB&&(z=this.data[U]>>D)!=(this.s&this.DM)>>D&&(k[Z++]=z|this.s<<this.DB-D);U>=0;)D<8?(z=(this.data[U]&(1<<D)-1)<<8-D,z|=this.data[--U]>>(D+=this.DB-8)):(z=this.data[U]>>(D-=8)&255,D<=0&&(D+=this.DB,--U)),z&128&&(z|=-256),Z==0&&(this.s&128)!=(z&128)&&++Z,(Z>0||z!=this.s)&&(k[Z++]=z);return k}function ce(U){return this.compareTo(U)==0}function pe(U){return this.compareTo(U)<0?this:U}function ge(U){return this.compareTo(U)>0?this:U}function ue(U,k,D){var z,Z,ee=Math.min(U.t,this.t);for(z=0;z<ee;++z)D.data[z]=k(this.data[z],U.data[z]);if(U.t<this.t){for(Z=U.s&this.DM,z=ee;z<this.t;++z)D.data[z]=k(this.data[z],Z);D.t=this.t}else{for(Z=this.s&this.DM,z=ee;z<U.t;++z)D.data[z]=k(Z,U.data[z]);D.t=U.t}D.s=k(this.s,U.s),D.clamp()}function le(U,k){return U&k}function ve(U){var k=n();return this.bitwiseTo(U,le,k),k}function be(U,k){return U|k}function Ne(U){var k=n();return this.bitwiseTo(U,be,k),k}function Pe(U,k){return U^k}function we(U){var k=n();return this.bitwiseTo(U,Pe,k),k}function Ue(U,k){return U&~k}function Ie(U){var k=n();return this.bitwiseTo(U,Ue,k),k}function Te(){for(var U=n(),k=0;k<this.t;++k)U.data[k]=this.DM&~this.data[k];return U.t=this.t,U.s=~this.s,U}function Ee(U){var k=n();return U<0?this.rShiftTo(-U,k):this.lShiftTo(U,k),k}function gt(U){var k=n();return U<0?this.lShiftTo(-U,k):this.rShiftTo(U,k),k}function xt(U){if(U==0)return-1;var k=0;return U&65535||(U>>=16,k+=16),U&255||(U>>=8,k+=8),U&15||(U>>=4,k+=4),U&3||(U>>=2,k+=2),U&1||++k,k}function kt(){for(var U=0;U<this.t;++U)if(this.data[U]!=0)return U*this.DB+xt(this.data[U]);return this.s<0?this.t*this.DB:-1}function zt(U){for(var k=0;U!=0;)U&=U-1,++k;return k}function cr(){for(var U=0,k=this.s&this.DM,D=0;D<this.t;++D)U+=zt(this.data[D]^k);return U}function Pr(U){var k=Math.floor(U/this.DB);return k>=this.t?this.s!=0:(this.data[k]&1<<U%this.DB)!=0}function yn(U,k){var D=r.ONE.shiftLeft(U);return this.bitwiseTo(D,k,D),D}function De(U){return this.changeBit(U,be)}function Fe(U){return this.changeBit(U,Ue)}function Me(U){return this.changeBit(U,Pe)}function qe(U,k){for(var D=0,z=0,Z=Math.min(U.t,this.t);D<Z;)z+=this.data[D]+U.data[D],k.data[D++]=z&this.DM,z>>=this.DB;if(U.t<this.t){for(z+=U.s;D<this.t;)z+=this.data[D],k.data[D++]=z&this.DM,z>>=this.DB;z+=this.s}else{for(z+=this.s;D<U.t;)z+=U.data[D],k.data[D++]=z&this.DM,z>>=this.DB;z+=U.s}k.s=z<0?-1:0,z>0?k.data[D++]=z:z<-1&&(k.data[D++]=this.DV+z),k.t=D,k.clamp()}function Ve(U){var k=n();return this.addTo(U,k),k}function Ke(U){var k=n();return this.subTo(U,k),k}function $e(U){var k=n();return this.multiplyTo(U,k),k}function Ge(U){var k=n();return this.divRemTo(U,k,null),k}function je(U){var k=n();return this.divRemTo(U,null,k),k}function He(U){var k=n(),D=n();return this.divRemTo(U,k,D),new Array(k,D)}function ze(U){this.data[this.t]=this.am(0,U-1,this,0,0,this.t),++this.t,this.clamp()}function We(U,k){if(U!=0){for(;this.t<=k;)this.data[this.t++]=0;for(this.data[k]+=U;this.data[k]>=this.DV;)this.data[k]-=this.DV,++k>=this.t&&(this.data[this.t++]=0),++this.data[k]}}function Be(){}function Le(U){return U}function Qe(U,k,D){U.multiplyTo(k,D)}function Ye(U,k){U.squareTo(k)}Be.prototype.convert=Le,Be.prototype.revert=Le,Be.prototype.mulTo=Qe,Be.prototype.sqrTo=Ye;function Al(U){return this.exp(U,new Be)}function Tl(U,k,D){var z=Math.min(this.t+U.t,k);for(D.s=0,D.t=z;z>0;)D.data[--z]=0;var Z;for(Z=D.t-this.t;z<Z;++z)D.data[z+this.t]=this.am(0,U.data[z],D,z,0,this.t);for(Z=Math.min(U.t,k);z<Z;++z)this.am(0,U.data[z],D,z,0,k-z);D.clamp()}function xl(U,k,D){--k;var z=D.t=this.t+U.t-k;for(D.s=0;--z>=0;)D.data[z]=0;for(z=Math.max(k-this.t,0);z<U.t;++z)D.data[this.t+z-k]=this.am(k-z,U.data[z],D,0,0,this.t+z-k);D.clamp(),D.drShiftTo(1,D)}function lr(U){this.r2=n(),this.q3=n(),r.ONE.dlShiftTo(2*U.t,this.r2),this.mu=this.r2.divide(U),this.m=U}function _l(U){if(U.s<0||U.t>2*this.m.t)return U.mod(this.m);if(U.compareTo(this.m)<0)return U;var k=n();return U.copyTo(k),this.reduce(k),k}function wl(U){return U}function Il(U){for(U.drShiftTo(this.m.t-1,this.r2),U.t>this.m.t+1&&(U.t=this.m.t+1,U.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);U.compareTo(this.r2)<0;)U.dAddOffset(1,this.m.t+1);for(U.subTo(this.r2,U);U.compareTo(this.m)>=0;)U.subTo(this.m,U)}function bl(U,k){U.squareTo(k),this.reduce(k)}function Rl(U,k,D){U.multiplyTo(k,D),this.reduce(D)}lr.prototype.convert=_l,lr.prototype.revert=wl,lr.prototype.reduce=Il,lr.prototype.mulTo=Rl,lr.prototype.sqrTo=bl;function Bl(U,k){var D=U.bitLength(),z,Z=S(1),ee;if(D<=0)return Z;D<18?z=1:D<48?z=3:D<144?z=4:D<768?z=5:z=6,D<8?ee=new X(k):k.isEven()?ee=new lr(k):ee=new he(k);var oe=new Array,ae=3,xe=z-1,Je=(1<<z)-1;if(oe[1]=ee.convert(this),z>1){var ut=n();for(ee.sqrTo(oe[1],ut);ae<=Je;)oe[ae]=n(),ee.mulTo(ut,oe[ae-2],oe[ae]),ae+=2}var ot=U.t-1,_t,gn=!0,ft=n(),dt;for(D=h(U.data[ot])-1;ot>=0;){for(D>=xe?_t=U.data[ot]>>D-xe&Je:(_t=(U.data[ot]&(1<<D+1)-1)<<xe-D,ot>0&&(_t|=U.data[ot-1]>>this.DB+D-xe)),ae=z;!(_t&1);)_t>>=1,--ae;if((D-=ae)<0&&(D+=this.DB,--ot),gn)oe[_t].copyTo(Z),gn=!1;else{for(;ae>1;)ee.sqrTo(Z,ft),ee.sqrTo(ft,Z),ae-=2;ae>0?ee.sqrTo(Z,ft):(dt=Z,Z=ft,ft=dt),ee.mulTo(ft,oe[_t],Z)}for(;ot>=0&&!(U.data[ot]&1<<D);)ee.sqrTo(Z,ft),dt=Z,Z=ft,ft=dt,--D<0&&(D=this.DB-1,--ot)}return ee.revert(Z)}function Nl(U){var k=this.s<0?this.negate():this.clone(),D=U.s<0?U.negate():U.clone();if(k.compareTo(D)<0){var z=k;k=D,D=z}var Z=k.getLowestSetBit(),ee=D.getLowestSetBit();if(ee<0)return k;for(Z<ee&&(ee=Z),ee>0&&(k.rShiftTo(ee,k),D.rShiftTo(ee,D));k.signum()>0;)(Z=k.getLowestSetBit())>0&&k.rShiftTo(Z,k),(Z=D.getLowestSetBit())>0&&D.rShiftTo(Z,D),k.compareTo(D)>=0?(k.subTo(D,k),k.rShiftTo(1,k)):(D.subTo(k,D),D.rShiftTo(1,D));return ee>0&&D.lShiftTo(ee,D),D}function Pl(U){if(U<=0)return 0;var k=this.DV%U,D=this.s<0?U-1:0;if(this.t>0)if(k==0)D=this.data[0]%U;else for(var z=this.t-1;z>=0;--z)D=(k*D+this.data[z])%U;return D}function Ul(U){var k=U.isEven();if(this.isEven()&&k||U.signum()==0)return r.ZERO;for(var D=U.clone(),z=this.clone(),Z=S(1),ee=S(0),oe=S(0),ae=S(1);D.signum()!=0;){for(;D.isEven();)D.rShiftTo(1,D),k?((!Z.isEven()||!ee.isEven())&&(Z.addTo(this,Z),ee.subTo(U,ee)),Z.rShiftTo(1,Z)):ee.isEven()||ee.subTo(U,ee),ee.rShiftTo(1,ee);for(;z.isEven();)z.rShiftTo(1,z),k?((!oe.isEven()||!ae.isEven())&&(oe.addTo(this,oe),ae.subTo(U,ae)),oe.rShiftTo(1,oe)):ae.isEven()||ae.subTo(U,ae),ae.rShiftTo(1,ae);D.compareTo(z)>=0?(D.subTo(z,D),k&&Z.subTo(oe,Z),ee.subTo(ae,ee)):(z.subTo(D,z),k&&oe.subTo(Z,oe),ae.subTo(ee,ae))}if(z.compareTo(r.ONE)!=0)return r.ZERO;if(ae.compareTo(U)>=0)return ae.subtract(U);if(ae.signum()<0)ae.addTo(U,ae);else return ae;return ae.signum()<0?ae.add(U):ae}var lt=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],Ol=(1<<26)/lt[lt.length-1];function kl(U){var k,D=this.abs();if(D.t==1&&D.data[0]<=lt[lt.length-1]){for(k=0;k<lt.length;++k)if(D.data[0]==lt[k])return!0;return!1}if(D.isEven())return!1;for(k=1;k<lt.length;){for(var z=lt[k],Z=k+1;Z<lt.length&&z<Ol;)z*=lt[Z++];for(z=D.modInt(z);k<Z;)if(z%lt[k++]==0)return!1}return D.millerRabin(U)}function Ll(U){var k=this.subtract(r.ONE),D=k.getLowestSetBit();if(D<=0)return!1;for(var z=k.shiftRight(D),Z=Dl(),ee,oe=0;oe<U;++oe){do ee=new r(this.bitLength(),Z);while(ee.compareTo(r.ONE)<=0||ee.compareTo(k)>=0);var ae=ee.modPow(z,this);if(ae.compareTo(r.ONE)!=0&&ae.compareTo(k)!=0){for(var xe=1;xe++<D&&ae.compareTo(k)!=0;)if(ae=ae.modPowInt(2,this),ae.compareTo(r.ONE)==0)return!1;if(ae.compareTo(k)!=0)return!1}}return!0}function Dl(){return{nextBytes:function(U){for(var k=0;k<U.length;++k)U[k]=Math.floor(Math.random()*256)}}}return r.prototype.chunkSize=$,r.prototype.toRadix=G,r.prototype.fromRadix=Y,r.prototype.fromNumber=ne,r.prototype.bitwiseTo=ue,r.prototype.changeBit=yn,r.prototype.addTo=qe,r.prototype.dMultiply=ze,r.prototype.dAddOffset=We,r.prototype.multiplyLowerTo=Tl,r.prototype.multiplyUpperTo=xl,r.prototype.modInt=Pl,r.prototype.millerRabin=Ll,r.prototype.clone=O,r.prototype.intValue=P,r.prototype.byteValue=K,r.prototype.shortValue=V,r.prototype.signum=M,r.prototype.toByteArray=te,r.prototype.equals=ce,r.prototype.min=pe,r.prototype.max=ge,r.prototype.and=ve,r.prototype.or=Ne,r.prototype.xor=we,r.prototype.andNot=Ie,r.prototype.not=Te,r.prototype.shiftLeft=Ee,r.prototype.shiftRight=gt,r.prototype.getLowestSetBit=kt,r.prototype.bitCount=cr,r.prototype.testBit=Pr,r.prototype.setBit=De,r.prototype.clearBit=Fe,r.prototype.flipBit=Me,r.prototype.add=Ve,r.prototype.subtract=Ke,r.prototype.multiply=$e,r.prototype.divide=Ge,r.prototype.remainder=je,r.prototype.divideAndRemainder=He,r.prototype.modPow=Bl,r.prototype.modInverse=Ul,r.prototype.pow=Al,r.prototype.gcd=Nl,r.prototype.isProbablePrime=kl,ea}var ta={exports:{}},ra={exports:{}},wo;function sn(){if(wo)return ra.exports;wo=1;var t=me();Ot(),Ae();var e=ra.exports=t.sha1=t.sha1||{};t.md.sha1=t.md.algorithms.sha1=e,e.create=function(){n||s();var c=null,i=t.util.createBuffer(),y=new Array(80),f={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8};return f.start=function(){f.messageLength=0,f.fullMessageLength=f.messageLength64=[];for(var A=f.messageLengthSize/4,C=0;C<A;++C)f.fullMessageLength.push(0);return i=t.util.createBuffer(),c={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},f},f.start(),f.update=function(A,C){C==="utf8"&&(A=t.util.encodeUtf8(A));var p=A.length;f.messageLength+=p,p=[p/4294967296>>>0,p>>>0];for(var o=f.fullMessageLength.length-1;o>=0;--o)f.fullMessageLength[o]+=p[1],p[1]=p[0]+(f.fullMessageLength[o]/4294967296>>>0),f.fullMessageLength[o]=f.fullMessageLength[o]>>>0,p[0]=p[1]/4294967296>>>0;return i.putBytes(A),u(c,y,i),(i.read>2048||i.length()===0)&&i.compact(),f},f.digest=function(){var A=t.util.createBuffer();A.putBytes(i.bytes());var C=f.fullMessageLength[f.fullMessageLength.length-1]+f.messageLengthSize,p=C&f.blockLength-1;A.putBytes(r.substr(0,f.blockLength-p));for(var o,m,g=f.fullMessageLength[0]*8,S=0;S<f.fullMessageLength.length-1;++S)o=f.fullMessageLength[S+1]*8,m=o/4294967296>>>0,g+=m,A.putInt32(g>>>0),g=o>>>0;A.putInt32(g);var a={h0:c.h0,h1:c.h1,h2:c.h2,h3:c.h3,h4:c.h4};u(a,y,A);var v=t.util.createBuffer();return v.putInt32(a.h0),v.putInt32(a.h1),v.putInt32(a.h2),v.putInt32(a.h3),v.putInt32(a.h4),v},f};var r=null,n=!1;function s(){r=String.fromCharCode(128),r+=t.util.fillString(String.fromCharCode(0),64),n=!0}function u(c,i,y){for(var f,A,C,p,o,m,g,S,a=y.length();a>=64;){for(A=c.h0,C=c.h1,p=c.h2,o=c.h3,m=c.h4,S=0;S<16;++S)f=y.getInt32(),i[S]=f,g=o^C&(p^o),f=(A<<5|A>>>27)+g+m+1518500249+f,m=o,o=p,p=(C<<30|C>>>2)>>>0,C=A,A=f;for(;S<20;++S)f=i[S-3]^i[S-8]^i[S-14]^i[S-16],f=f<<1|f>>>31,i[S]=f,g=o^C&(p^o),f=(A<<5|A>>>27)+g+m+1518500249+f,m=o,o=p,p=(C<<30|C>>>2)>>>0,C=A,A=f;for(;S<32;++S)f=i[S-3]^i[S-8]^i[S-14]^i[S-16],f=f<<1|f>>>31,i[S]=f,g=C^p^o,f=(A<<5|A>>>27)+g+m+1859775393+f,m=o,o=p,p=(C<<30|C>>>2)>>>0,C=A,A=f;for(;S<40;++S)f=i[S-6]^i[S-16]^i[S-28]^i[S-32],f=f<<2|f>>>30,i[S]=f,g=C^p^o,f=(A<<5|A>>>27)+g+m+1859775393+f,m=o,o=p,p=(C<<30|C>>>2)>>>0,C=A,A=f;for(;S<60;++S)f=i[S-6]^i[S-16]^i[S-28]^i[S-32],f=f<<2|f>>>30,i[S]=f,g=C&p|o&(C^p),f=(A<<5|A>>>27)+g+m+2400959708+f,m=o,o=p,p=(C<<30|C>>>2)>>>0,C=A,A=f;for(;S<80;++S)f=i[S-6]^i[S-16]^i[S-28]^i[S-32],f=f<<2|f>>>30,i[S]=f,g=C^p^o,f=(A<<5|A>>>27)+g+m+3395469782+f,m=o,o=p,p=(C<<30|C>>>2)>>>0,C=A,A=f;c.h0=c.h0+A|0,c.h1=c.h1+C|0,c.h2=c.h2+p|0,c.h3=c.h3+o|0,c.h4=c.h4+m|0,a-=64}}return ra.exports}var Io;function bc(){if(Io)return ta.exports;Io=1;var t=me();Ae(),yt(),sn();var e=ta.exports=t.pkcs1=t.pkcs1||{};e.encode_rsa_oaep=function(n,s,u){var c,i,y,f;typeof u=="string"?(c=u,i=arguments[3]||void 0,y=arguments[4]||void 0):u&&(c=u.label||void 0,i=u.seed||void 0,y=u.md||void 0,u.mgf1&&u.mgf1.md&&(f=u.mgf1.md)),y?y.start():y=t.md.sha1.create(),f||(f=y);var A=Math.ceil(n.n.bitLength()/8),C=A-2*y.digestLength-2;if(s.length>C){var p=new Error("RSAES-OAEP input message length is too long.");throw p.length=s.length,p.maxLength=C,p}c||(c=""),y.update(c,"raw");for(var o=y.digest(),m="",g=C-s.length,S=0;S<g;S++)m+="\0";var a=o.getBytes()+m+""+s;if(!i)i=t.random.getBytes(y.digestLength);else if(i.length!==y.digestLength){var p=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw p.seedLength=i.length,p.digestLength=y.digestLength,p}var v=r(i,A-y.digestLength-1,f),E=t.util.xorBytes(a,v,a.length),b=r(E,y.digestLength,f),R=t.util.xorBytes(i,b,i.length);return"\0"+R+E},e.decode_rsa_oaep=function(n,s,u){var c,i,y;typeof u=="string"?(c=u,i=arguments[3]||void 0):u&&(c=u.label||void 0,i=u.md||void 0,u.mgf1&&u.mgf1.md&&(y=u.mgf1.md));var f=Math.ceil(n.n.bitLength()/8);if(s.length!==f){var E=new Error("RSAES-OAEP encoded message length is invalid.");throw E.length=s.length,E.expectedLength=f,E}if(i===void 0?i=t.md.sha1.create():i.start(),y||(y=i),f<2*i.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");c||(c=""),i.update(c,"raw");for(var A=i.digest().getBytes(),C=s.charAt(0),p=s.substring(1,i.digestLength+1),o=s.substring(1+i.digestLength),m=r(o,i.digestLength,y),g=t.util.xorBytes(p,m,p.length),S=r(g,f-i.digestLength-1,y),a=t.util.xorBytes(o,S,o.length),v=a.substring(0,i.digestLength),E=C!=="\0",b=0;b<i.digestLength;++b)E|=A.charAt(b)!==v.charAt(b);for(var R=1,T=i.digestLength,h=i.digestLength;h<a.length;h++){var l=a.charCodeAt(h),B=l&1^1,N=R?65534:0;E|=l&N,R=R&B,T+=R}if(E||a.charCodeAt(T)!==1)throw new Error("Invalid RSAES-OAEP padding.");return a.substring(T+1)};function r(n,s,u){u||(u=t.md.sha1.create());for(var c="",i=Math.ceil(s/u.digestLength),y=0;y<i;++y){var f=String.fromCharCode(y>>24&255,y>>16&255,y>>8&255,y&255);u.start(),u.update(n+f),c+=u.digest().getBytes()}return c.substring(0,s)}return ta.exports}var xn={exports:{}},bo;function Rc(){if(bo)return xn.exports;bo=1;var t=me();return Ae(),ui(),yt(),function(){if(t.prime){xn.exports=t.prime;return}var e=xn.exports=t.prime=t.prime||{},r=t.jsbn.BigInteger,n=[6,4,2,4,2,4,6,2],s=new r(null);s.fromInt(30);var u=function(p,o){return p|o};e.generateProbablePrime=function(p,o,m){typeof o=="function"&&(m=o,o={}),o=o||{};var g=o.algorithm||"PRIMEINC";typeof g=="string"&&(g={name:g}),g.options=g.options||{};var S=o.prng||t.random,a={nextBytes:function(v){for(var E=S.getBytesSync(v.length),b=0;b<v.length;++b)v[b]=E.charCodeAt(b)}};if(g.name==="PRIMEINC")return c(p,a,g.options,m);throw new Error("Invalid prime generation algorithm: "+g.name)};function c(p,o,m,g){return"workers"in m?f(p,o,m,g):i(p,o,m,g)}function i(p,o,m,g){var S=A(p,o),a=0,v=C(S.bitLength());"millerRabinTests"in m&&(v=m.millerRabinTests);var E=10;"maxBlockTime"in m&&(E=m.maxBlockTime),y(S,p,o,a,v,E,g)}function y(p,o,m,g,S,a,v){var E=+new Date;do{if(p.bitLength()>o&&(p=A(o,m)),p.isProbablePrime(S))return v(null,p);p.dAddOffset(n[g++%8],0)}while(a<0||+new Date-E<a);t.util.setImmediate(function(){y(p,o,m,g,S,a,v)})}function f(p,o,m,g){if(typeof Worker>"u")return i(p,o,m,g);var S=A(p,o),a=m.workers,v=m.workLoad||100,E=v*30/8,b=m.workerScript||"forge/prime.worker.js";if(a===-1)return t.util.estimateCores(function(T,h){T&&(h=2),a=h-1,R()});R();function R(){a=Math.max(1,a);for(var T=[],h=0;h<a;++h)T[h]=new Worker(b);for(var h=0;h<a;++h)T[h].addEventListener("message",B);var l=!1;function B(N){if(!l){var F=N.data;if(F.found){for(var L=0;L<T.length;++L)T[L].terminate();return l=!0,g(null,new r(F.prime,16))}S.bitLength()>p&&(S=A(p,o));var q=S.toString(16);N.target.postMessage({hex:q,workLoad:v}),S.dAddOffset(E,0)}}}}function A(p,o){var m=new r(p,o),g=p-1;return m.testBit(g)||m.bitwiseTo(r.ONE.shiftLeft(g),u,m),m.dAddOffset(31-m.mod(s).byteValue(),0),m}function C(p){return p<=100?27:p<=150?18:p<=200?15:p<=250?12:p<=300?9:p<=350?8:p<=400?7:p<=500?6:p<=600?5:p<=800?4:p<=1250?3:2}}(),xn.exports}var na,Ro;function ci(){if(Ro)return na;Ro=1;var t=me();if(Tt(),ui(),or(),bc(),Rc(),yt(),Ae(),typeof e>"u")var e=t.jsbn.BigInteger;var r=t.util.isNodejs?Qr:null,n=t.asn1,s=t.util;t.pki=t.pki||{},na=t.pki.rsa=t.rsa=t.rsa||{};var u=t.pki,c=[6,4,2,4,2,4,6,2],i={name:"PrivateKeyInfo",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:n.Class.UNIVERSAL,type:n.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:n.Class.UNIVERSAL,type:n.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:n.Class.UNIVERSAL,type:n.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},y={name:"RSAPrivateKey",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:n.Class.UNIVERSAL,type:n.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:n.Class.UNIVERSAL,type:n.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:n.Class.UNIVERSAL,type:n.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:n.Class.UNIVERSAL,type:n.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:n.Class.UNIVERSAL,type:n.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:n.Class.UNIVERSAL,type:n.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:n.Class.UNIVERSAL,type:n.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:n.Class.UNIVERSAL,type:n.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:n.Class.UNIVERSAL,type:n.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},f={name:"RSAPublicKey",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:n.Class.UNIVERSAL,type:n.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:n.Class.UNIVERSAL,type:n.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},A=t.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:n.Class.UNIVERSAL,type:n.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:n.Class.UNIVERSAL,type:n.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},C={name:"DigestInfo",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm.algorithmIdentifier",tagClass:n.Class.UNIVERSAL,type:n.Type.OID,constructed:!1,capture:"algorithmIdentifier"},{name:"DigestInfo.DigestAlgorithm.parameters",tagClass:n.Class.UNIVERSAL,type:n.Type.NULL,capture:"parameters",optional:!0,constructed:!1}]},{name:"DigestInfo.digest",tagClass:n.Class.UNIVERSAL,type:n.Type.OCTETSTRING,constructed:!1,capture:"digest"}]},p=function(h){var l;if(h.algorithm in u.oids)l=u.oids[h.algorithm];else{var B=new Error("Unknown message digest algorithm.");throw B.algorithm=h.algorithm,B}var N=n.oidToDer(l).getBytes(),F=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[]),L=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[]);L.value.push(n.create(n.Class.UNIVERSAL,n.Type.OID,!1,N)),L.value.push(n.create(n.Class.UNIVERSAL,n.Type.NULL,!1,""));var q=n.create(n.Class.UNIVERSAL,n.Type.OCTETSTRING,!1,h.digest().getBytes());return F.value.push(L),F.value.push(q),n.toDer(F).getBytes()},o=function(h,l,B){if(B)return h.modPow(l.e,l.n);if(!l.p||!l.q)return h.modPow(l.d,l.n);l.dP||(l.dP=l.d.mod(l.p.subtract(e.ONE))),l.dQ||(l.dQ=l.d.mod(l.q.subtract(e.ONE))),l.qInv||(l.qInv=l.q.modInverse(l.p));var N;do N=new e(t.util.bytesToHex(t.random.getBytes(l.n.bitLength()/8)),16);while(N.compareTo(l.n)>=0||!N.gcd(l.n).equals(e.ONE));h=h.multiply(N.modPow(l.e,l.n)).mod(l.n);for(var F=h.mod(l.p).modPow(l.dP,l.p),L=h.mod(l.q).modPow(l.dQ,l.q);F.compareTo(L)<0;)F=F.add(l.p);var q=F.subtract(L).multiply(l.qInv).mod(l.p).multiply(l.q).add(L);return q=q.multiply(N.modInverse(l.n)).mod(l.n),q};u.rsa.encrypt=function(h,l,B){var N=B,F,L=Math.ceil(l.n.bitLength()/8);B!==!1&&B!==!0?(N=B===2,F=m(h,l,B)):(F=t.util.createBuffer(),F.putBytes(h));for(var q=new e(F.toHex(),16),j=o(q,l,N),H=j.toString(16),Q=t.util.createBuffer(),J=L-Math.ceil(H.length/2);J>0;)Q.putByte(0),--J;return Q.putBytes(t.util.hexToBytes(H)),Q.getBytes()},u.rsa.decrypt=function(h,l,B,N){var F=Math.ceil(l.n.bitLength()/8);if(h.length!==F){var L=new Error("Encrypted message length is invalid.");throw L.length=h.length,L.expected=F,L}var q=new e(t.util.createBuffer(h).toHex(),16);if(q.compareTo(l.n)>=0)throw new Error("Encrypted message is invalid.");for(var j=o(q,l,B),H=j.toString(16),Q=t.util.createBuffer(),J=F-Math.ceil(H.length/2);J>0;)Q.putByte(0),--J;return Q.putBytes(t.util.hexToBytes(H)),N!==!1?g(Q.getBytes(),l,B):Q.getBytes()},u.rsa.createKeyPairGenerationState=function(h,l,B){typeof h=="string"&&(h=parseInt(h,10)),h=h||2048,B=B||{};var N=B.prng||t.random,F={nextBytes:function(j){for(var H=N.getBytesSync(j.length),Q=0;Q<j.length;++Q)j[Q]=H.charCodeAt(Q)}},L=B.algorithm||"PRIMEINC",q;if(L==="PRIMEINC")q={algorithm:L,state:0,bits:h,rng:F,eInt:l||65537,e:new e(null),p:null,q:null,qBits:h>>1,pBits:h-(h>>1),pqState:0,num:null,keys:null},q.e.fromInt(q.eInt);else throw new Error("Invalid key generation algorithm: "+L);return q},u.rsa.stepKeyPairGenerationState=function(h,l){"algorithm"in h||(h.algorithm="PRIMEINC");var B=new e(null);B.fromInt(30);for(var N=0,F=function(X,re){return X|re},L=+new Date,q,j=0;h.keys===null&&(l<=0||j<l);){if(h.state===0){var H=h.p===null?h.pBits:h.qBits,Q=H-1;h.pqState===0?(h.num=new e(H,h.rng),h.num.testBit(Q)||h.num.bitwiseTo(e.ONE.shiftLeft(Q),F,h.num),h.num.dAddOffset(31-h.num.mod(B).byteValue(),0),N=0,++h.pqState):h.pqState===1?h.num.bitLength()>H?h.pqState=0:h.num.isProbablePrime(v(h.num.bitLength()))?++h.pqState:h.num.dAddOffset(c[N++%8],0):h.pqState===2?h.pqState=h.num.subtract(e.ONE).gcd(h.e).compareTo(e.ONE)===0?3:0:h.pqState===3&&(h.pqState=0,h.p===null?h.p=h.num:h.q=h.num,h.p!==null&&h.q!==null&&++h.state,h.num=null)}else if(h.state===1)h.p.compareTo(h.q)<0&&(h.num=h.p,h.p=h.q,h.q=h.num),++h.state;else if(h.state===2)h.p1=h.p.subtract(e.ONE),h.q1=h.q.subtract(e.ONE),h.phi=h.p1.multiply(h.q1),++h.state;else if(h.state===3)h.phi.gcd(h.e).compareTo(e.ONE)===0?++h.state:(h.p=null,h.q=null,h.state=0);else if(h.state===4)h.n=h.p.multiply(h.q),h.n.bitLength()===h.bits?++h.state:(h.q=null,h.state=0);else if(h.state===5){var J=h.e.modInverse(h.phi);h.keys={privateKey:u.rsa.setPrivateKey(h.n,h.e,J,h.p,h.q,J.mod(h.p1),J.mod(h.q1),h.q.modInverse(h.p)),publicKey:u.rsa.setPublicKey(h.n,h.e)}}q=+new Date,j+=q-L,L=q}return h.keys!==null},u.rsa.generateKeyPair=function(h,l,B,N){if(arguments.length===1?typeof h=="object"?(B=h,h=void 0):typeof h=="function"&&(N=h,h=void 0):arguments.length===2?typeof h=="number"?typeof l=="function"?(N=l,l=void 0):typeof l!="number"&&(B=l,l=void 0):(B=h,N=l,h=void 0,l=void 0):arguments.length===3&&(typeof l=="number"?typeof B=="function"&&(N=B,B=void 0):(N=B,B=l,l=void 0)),B=B||{},h===void 0&&(h=B.bits||2048),l===void 0&&(l=B.e||65537),!t.options.usePureJavaScript&&!B.prng&&h>=256&&h<=16384&&(l===65537||l===3)){if(N){if(E("generateKeyPair"))return r.generateKeyPair("rsa",{modulusLength:h,publicExponent:l,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},function(j,H,Q){if(j)return N(j);N(null,{privateKey:u.privateKeyFromPem(Q),publicKey:u.publicKeyFromPem(H)})});if(b("generateKey")&&b("exportKey"))return s.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:h,publicExponent:T(l),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(function(j){return s.globalScope.crypto.subtle.exportKey("pkcs8",j.privateKey)}).then(void 0,function(j){N(j)}).then(function(j){if(j){var H=u.privateKeyFromAsn1(n.fromDer(t.util.createBuffer(j)));N(null,{privateKey:H,publicKey:u.setRsaPublicKey(H.n,H.e)})}});if(R("generateKey")&&R("exportKey")){var F=s.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:h,publicExponent:T(l),hash:{name:"SHA-256"}},!0,["sign","verify"]);F.oncomplete=function(j){var H=j.target.result,Q=s.globalScope.msCrypto.subtle.exportKey("pkcs8",H.privateKey);Q.oncomplete=function(J){var X=J.target.result,re=u.privateKeyFromAsn1(n.fromDer(t.util.createBuffer(X)));N(null,{privateKey:re,publicKey:u.setRsaPublicKey(re.n,re.e)})},Q.onerror=function(J){N(J)}},F.onerror=function(j){N(j)};return}}else if(E("generateKeyPairSync")){var L=r.generateKeyPairSync("rsa",{modulusLength:h,publicExponent:l,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:u.privateKeyFromPem(L.privateKey),publicKey:u.publicKeyFromPem(L.publicKey)}}}var q=u.rsa.createKeyPairGenerationState(h,l,B);if(!N)return u.rsa.stepKeyPairGenerationState(q,0),q.keys;S(q,B,N)},u.setRsaPublicKey=u.rsa.setPublicKey=function(h,l){var B={n:h,e:l};return B.encrypt=function(N,F,L){if(typeof F=="string"?F=F.toUpperCase():F===void 0&&(F="RSAES-PKCS1-V1_5"),F==="RSAES-PKCS1-V1_5")F={encode:function(j,H,Q){return m(j,H,2).getBytes()}};else if(F==="RSA-OAEP"||F==="RSAES-OAEP")F={encode:function(j,H){return t.pkcs1.encode_rsa_oaep(H,j,L)}};else if(["RAW","NONE","NULL",null].indexOf(F)!==-1)F={encode:function(j){return j}};else if(typeof F=="string")throw new Error('Unsupported encryption scheme: "'+F+'".');var q=F.encode(N,B,!0);return u.rsa.encrypt(q,B,!0)},B.verify=function(N,F,L,q){typeof L=="string"?L=L.toUpperCase():L===void 0&&(L="RSASSA-PKCS1-V1_5"),q===void 0&&(q={_parseAllDigestBytes:!0}),"_parseAllDigestBytes"in q||(q._parseAllDigestBytes=!0),L==="RSASSA-PKCS1-V1_5"?L={verify:function(H,Q){Q=g(Q,B,!0);var J=n.fromDer(Q,{parseAllBytes:q._parseAllDigestBytes}),X={},re=[];if(!n.validate(J,C,X,re)){var se=new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value.");throw se.errors=re,se}var de=n.derToOid(X.algorithmIdentifier);if(!(de===t.oids.md2||de===t.oids.md5||de===t.oids.sha1||de===t.oids.sha224||de===t.oids.sha256||de===t.oids.sha384||de===t.oids.sha512||de===t.oids["sha512-224"]||de===t.oids["sha512-256"])){var se=new Error("Unknown RSASSA-PKCS1-v1_5 DigestAlgorithm identifier.");throw se.oid=de,se}if((de===t.oids.md2||de===t.oids.md5)&&!("parameters"in X))throw new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value. Missing algorithm identifer NULL parameters.");return H===X.digest}}:(L==="NONE"||L==="NULL"||L===null)&&(L={verify:function(H,Q){return Q=g(Q,B,!0),H===Q}});var j=u.rsa.decrypt(F,B,!0,!1);return L.verify(N,j,B.n.bitLength())},B},u.setRsaPrivateKey=u.rsa.setPrivateKey=function(h,l,B,N,F,L,q,j){var H={n:h,e:l,d:B,p:N,q:F,dP:L,dQ:q,qInv:j};return H.decrypt=function(Q,J,X){typeof J=="string"?J=J.toUpperCase():J===void 0&&(J="RSAES-PKCS1-V1_5");var re=u.rsa.decrypt(Q,H,!1,!1);if(J==="RSAES-PKCS1-V1_5")J={decode:g};else if(J==="RSA-OAEP"||J==="RSAES-OAEP")J={decode:function(se,de){return t.pkcs1.decode_rsa_oaep(de,se,X)}};else if(["RAW","NONE","NULL",null].indexOf(J)!==-1)J={decode:function(se){return se}};else throw new Error('Unsupported encryption scheme: "'+J+'".');return J.decode(re,H,!1)},H.sign=function(Q,J){var X=!1;typeof J=="string"&&(J=J.toUpperCase()),J===void 0||J==="RSASSA-PKCS1-V1_5"?(J={encode:p},X=1):(J==="NONE"||J==="NULL"||J===null)&&(J={encode:function(){return Q}},X=1);var re=J.encode(Q,H.n.bitLength());return u.rsa.encrypt(re,H,X)},H},u.wrapRsaPrivateKey=function(h){return n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.INTEGER,!1,n.integerToDer(0).getBytes()),n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.OID,!1,n.oidToDer(u.oids.rsaEncryption).getBytes()),n.create(n.Class.UNIVERSAL,n.Type.NULL,!1,"")]),n.create(n.Class.UNIVERSAL,n.Type.OCTETSTRING,!1,n.toDer(h).getBytes())])},u.privateKeyFromAsn1=function(h){var l={},B=[];if(n.validate(h,i,l,B)&&(h=n.fromDer(t.util.createBuffer(l.privateKey))),l={},B=[],!n.validate(h,y,l,B)){var N=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw N.errors=B,N}var F,L,q,j,H,Q,J,X;return F=t.util.createBuffer(l.privateKeyModulus).toHex(),L=t.util.createBuffer(l.privateKeyPublicExponent).toHex(),q=t.util.createBuffer(l.privateKeyPrivateExponent).toHex(),j=t.util.createBuffer(l.privateKeyPrime1).toHex(),H=t.util.createBuffer(l.privateKeyPrime2).toHex(),Q=t.util.createBuffer(l.privateKeyExponent1).toHex(),J=t.util.createBuffer(l.privateKeyExponent2).toHex(),X=t.util.createBuffer(l.privateKeyCoefficient).toHex(),u.setRsaPrivateKey(new e(F,16),new e(L,16),new e(q,16),new e(j,16),new e(H,16),new e(Q,16),new e(J,16),new e(X,16))},u.privateKeyToAsn1=u.privateKeyToRSAPrivateKey=function(h){return n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.INTEGER,!1,n.integerToDer(0).getBytes()),n.create(n.Class.UNIVERSAL,n.Type.INTEGER,!1,a(h.n)),n.create(n.Class.UNIVERSAL,n.Type.INTEGER,!1,a(h.e)),n.create(n.Class.UNIVERSAL,n.Type.INTEGER,!1,a(h.d)),n.create(n.Class.UNIVERSAL,n.Type.INTEGER,!1,a(h.p)),n.create(n.Class.UNIVERSAL,n.Type.INTEGER,!1,a(h.q)),n.create(n.Class.UNIVERSAL,n.Type.INTEGER,!1,a(h.dP)),n.create(n.Class.UNIVERSAL,n.Type.INTEGER,!1,a(h.dQ)),n.create(n.Class.UNIVERSAL,n.Type.INTEGER,!1,a(h.qInv))])},u.publicKeyFromAsn1=function(h){var l={},B=[];if(n.validate(h,A,l,B)){var N=n.derToOid(l.publicKeyOid);if(N!==u.oids.rsaEncryption){var F=new Error("Cannot read public key. Unknown OID.");throw F.oid=N,F}h=l.rsaPublicKey}if(B=[],!n.validate(h,f,l,B)){var F=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw F.errors=B,F}var L=t.util.createBuffer(l.publicKeyModulus).toHex(),q=t.util.createBuffer(l.publicKeyExponent).toHex();return u.setRsaPublicKey(new e(L,16),new e(q,16))},u.publicKeyToAsn1=u.publicKeyToSubjectPublicKeyInfo=function(h){return n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.OID,!1,n.oidToDer(u.oids.rsaEncryption).getBytes()),n.create(n.Class.UNIVERSAL,n.Type.NULL,!1,"")]),n.create(n.Class.UNIVERSAL,n.Type.BITSTRING,!1,[u.publicKeyToRSAPublicKey(h)])])},u.publicKeyToRSAPublicKey=function(h){return n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.INTEGER,!1,a(h.n)),n.create(n.Class.UNIVERSAL,n.Type.INTEGER,!1,a(h.e))])};function m(h,l,B){var N=t.util.createBuffer(),F=Math.ceil(l.n.bitLength()/8);if(h.length>F-11){var L=new Error("Message is too long for PKCS#1 v1.5 padding.");throw L.length=h.length,L.max=F-11,L}N.putByte(0),N.putByte(B);var q=F-3-h.length,j;if(B===0||B===1){j=B===0?0:255;for(var H=0;H<q;++H)N.putByte(j)}else for(;q>0;){for(var Q=0,J=t.random.getBytes(q),H=0;H<q;++H)j=J.charCodeAt(H),j===0?++Q:N.putByte(j);q=Q}return N.putByte(0),N.putBytes(h),N}function g(h,l,B,N){var F=Math.ceil(l.n.bitLength()/8),L=t.util.createBuffer(h),q=L.getByte(),j=L.getByte();if(q!==0||B&&j!==0&&j!==1||!B&&j!=2||B&&j===0&&typeof N>"u")throw new Error("Encryption block is invalid.");var H=0;if(j===0){H=F-3-N;for(var Q=0;Q<H;++Q)if(L.getByte()!==0)throw new Error("Encryption block is invalid.")}else if(j===1)for(H=0;L.length()>1;){if(L.getByte()!==255){--L.read;break}++H}else if(j===2)for(H=0;L.length()>1;){if(L.getByte()===0){--L.read;break}++H}var J=L.getByte();if(J!==0||H!==F-3-L.length())throw new Error("Encryption block is invalid.");return L.getBytes()}function S(h,l,B){typeof l=="function"&&(B=l,l={}),l=l||{};var N={algorithm:{name:l.algorithm||"PRIMEINC",options:{workers:l.workers||2,workLoad:l.workLoad||100,workerScript:l.workerScript}}};"prng"in l&&(N.prng=l.prng),F();function F(){L(h.pBits,function(j,H){if(j)return B(j);if(h.p=H,h.q!==null)return q(j,h.q);L(h.qBits,q)})}function L(j,H){t.prime.generateProbablePrime(j,N,H)}function q(j,H){if(j)return B(j);if(h.q=H,h.p.compareTo(h.q)<0){var Q=h.p;h.p=h.q,h.q=Q}if(h.p.subtract(e.ONE).gcd(h.e).compareTo(e.ONE)!==0){h.p=null,F();return}if(h.q.subtract(e.ONE).gcd(h.e).compareTo(e.ONE)!==0){h.q=null,L(h.qBits,q);return}if(h.p1=h.p.subtract(e.ONE),h.q1=h.q.subtract(e.ONE),h.phi=h.p1.multiply(h.q1),h.phi.gcd(h.e).compareTo(e.ONE)!==0){h.p=h.q=null,F();return}if(h.n=h.p.multiply(h.q),h.n.bitLength()!==h.bits){h.q=null,L(h.qBits,q);return}var J=h.e.modInverse(h.phi);h.keys={privateKey:u.rsa.setPrivateKey(h.n,h.e,J,h.p,h.q,J.mod(h.p1),J.mod(h.q1),h.q.modInverse(h.p)),publicKey:u.rsa.setPublicKey(h.n,h.e)},B(null,h.keys)}}function a(h){var l=h.toString(16);l[0]>="8"&&(l="00"+l);var B=t.util.hexToBytes(l);return B.length>1&&(B.charCodeAt(0)===0&&!(B.charCodeAt(1)&128)||B.charCodeAt(0)===255&&(B.charCodeAt(1)&128)===128)?B.substr(1):B}function v(h){return h<=100?27:h<=150?18:h<=200?15:h<=250?12:h<=300?9:h<=350?8:h<=400?7:h<=500?6:h<=600?5:h<=800?4:h<=1250?3:2}function E(h){return t.util.isNodejs&&typeof r[h]=="function"}function b(h){return typeof s.globalScope<"u"&&typeof s.globalScope.crypto=="object"&&typeof s.globalScope.crypto.subtle=="object"&&typeof s.globalScope.crypto.subtle[h]=="function"}function R(h){return typeof s.globalScope<"u"&&typeof s.globalScope.msCrypto=="object"&&typeof s.globalScope.msCrypto.subtle=="object"&&typeof s.globalScope.msCrypto.subtle[h]=="function"}function T(h){for(var l=t.util.hexToBytes(h.toString(16)),B=new Uint8Array(l.length),N=0;N<l.length;++N)B[N]=l.charCodeAt(N);return B}return na}var ia,Bo;function Bc(){if(Bo)return ia;Bo=1;var t=me();if(sr(),Tt(),oi(),Ot(),or(),gs(),Rr(),yt(),Ic(),ci(),Ae(),typeof e>"u")var e=t.jsbn.BigInteger;var r=t.asn1,n=t.pki=t.pki||{};ia=n.pbe=t.pbe=t.pbe||{};var s=n.oids,u={name:"EncryptedPrivateKeyInfo",tagClass:r.Class.UNIVERSAL,type:r.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:r.Class.UNIVERSAL,type:r.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:r.Class.UNIVERSAL,type:r.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:r.Class.UNIVERSAL,type:r.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:r.Class.UNIVERSAL,type:r.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},c={name:"PBES2Algorithms",tagClass:r.Class.UNIVERSAL,type:r.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:r.Class.UNIVERSAL,type:r.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:r.Class.UNIVERSAL,type:r.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:r.Class.UNIVERSAL,type:r.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:r.Class.UNIVERSAL,type:r.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:r.Class.UNIVERSAL,type:r.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:r.Class.UNIVERSAL,type:r.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:r.Class.UNIVERSAL,type:r.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:r.Class.UNIVERSAL,type:r.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:r.Class.UNIVERSAL,type:r.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:r.Class.UNIVERSAL,type:r.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:r.Class.UNIVERSAL,type:r.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},i={name:"pkcs-12PbeParams",tagClass:r.Class.UNIVERSAL,type:r.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:r.Class.UNIVERSAL,type:r.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:r.Class.UNIVERSAL,type:r.Type.INTEGER,constructed:!1,capture:"iterations"}]};n.encryptPrivateKeyInfo=function(p,o,m){m=m||{},m.saltSize=m.saltSize||8,m.count=m.count||2048,m.algorithm=m.algorithm||"aes128",m.prfAlgorithm=m.prfAlgorithm||"sha1";var g=t.random.getBytesSync(m.saltSize),S=m.count,a=r.integerToDer(S),v,E,b;if(m.algorithm.indexOf("aes")===0||m.algorithm==="des"){var R,T,h;switch(m.algorithm){case"aes128":v=16,R=16,T=s["aes128-CBC"],h=t.aes.createEncryptionCipher;break;case"aes192":v=24,R=16,T=s["aes192-CBC"],h=t.aes.createEncryptionCipher;break;case"aes256":v=32,R=16,T=s["aes256-CBC"],h=t.aes.createEncryptionCipher;break;case"des":v=8,R=8,T=s.desCBC,h=t.des.createEncryptionCipher;break;default:var l=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw l.algorithm=m.algorithm,l}var B="hmacWith"+m.prfAlgorithm.toUpperCase(),N=A(B),F=t.pkcs5.pbkdf2(o,g,S,v,N),L=t.random.getBytesSync(R),q=h(F);q.start(L),q.update(r.toDer(p)),q.finish(),b=q.output.getBytes();var j=C(g,a,v,B);E=r.create(r.Class.UNIVERSAL,r.Type.SEQUENCE,!0,[r.create(r.Class.UNIVERSAL,r.Type.OID,!1,r.oidToDer(s.pkcs5PBES2).getBytes()),r.create(r.Class.UNIVERSAL,r.Type.SEQUENCE,!0,[r.create(r.Class.UNIVERSAL,r.Type.SEQUENCE,!0,[r.create(r.Class.UNIVERSAL,r.Type.OID,!1,r.oidToDer(s.pkcs5PBKDF2).getBytes()),j]),r.create(r.Class.UNIVERSAL,r.Type.SEQUENCE,!0,[r.create(r.Class.UNIVERSAL,r.Type.OID,!1,r.oidToDer(T).getBytes()),r.create(r.Class.UNIVERSAL,r.Type.OCTETSTRING,!1,L)])])])}else if(m.algorithm==="3des"){v=24;var H=new t.util.ByteBuffer(g),F=n.pbe.generatePkcs12Key(o,H,1,S,v),L=n.pbe.generatePkcs12Key(o,H,2,S,v),q=t.des.createEncryptionCipher(F);q.start(L),q.update(r.toDer(p)),q.finish(),b=q.output.getBytes(),E=r.create(r.Class.UNIVERSAL,r.Type.SEQUENCE,!0,[r.create(r.Class.UNIVERSAL,r.Type.OID,!1,r.oidToDer(s["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),r.create(r.Class.UNIVERSAL,r.Type.SEQUENCE,!0,[r.create(r.Class.UNIVERSAL,r.Type.OCTETSTRING,!1,g),r.create(r.Class.UNIVERSAL,r.Type.INTEGER,!1,a.getBytes())])])}else{var l=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw l.algorithm=m.algorithm,l}var Q=r.create(r.Class.UNIVERSAL,r.Type.SEQUENCE,!0,[E,r.create(r.Class.UNIVERSAL,r.Type.OCTETSTRING,!1,b)]);return Q},n.decryptPrivateKeyInfo=function(p,o){var m=null,g={},S=[];if(!r.validate(p,u,g,S)){var a=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw a.errors=S,a}var v=r.derToOid(g.encryptionOid),E=n.pbe.getCipher(v,g.encryptionParams,o),b=t.util.createBuffer(g.encryptedData);return E.update(b),E.finish()&&(m=r.fromDer(E.output)),m},n.encryptedPrivateKeyToPem=function(p,o){var m={type:"ENCRYPTED PRIVATE KEY",body:r.toDer(p).getBytes()};return t.pem.encode(m,{maxline:o})},n.encryptedPrivateKeyFromPem=function(p){var o=t.pem.decode(p)[0];if(o.type!=="ENCRYPTED PRIVATE KEY"){var m=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw m.headerType=o.type,m}if(o.procType&&o.procType.type==="ENCRYPTED")throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return r.fromDer(o.body)},n.encryptRsaPrivateKey=function(p,o,m){if(m=m||{},!m.legacy){var g=n.wrapRsaPrivateKey(n.privateKeyToAsn1(p));return g=n.encryptPrivateKeyInfo(g,o,m),n.encryptedPrivateKeyToPem(g)}var S,a,v,E;switch(m.algorithm){case"aes128":S="AES-128-CBC",v=16,a=t.random.getBytesSync(16),E=t.aes.createEncryptionCipher;break;case"aes192":S="AES-192-CBC",v=24,a=t.random.getBytesSync(16),E=t.aes.createEncryptionCipher;break;case"aes256":S="AES-256-CBC",v=32,a=t.random.getBytesSync(16),E=t.aes.createEncryptionCipher;break;case"3des":S="DES-EDE3-CBC",v=24,a=t.random.getBytesSync(8),E=t.des.createEncryptionCipher;break;case"des":S="DES-CBC",v=8,a=t.random.getBytesSync(8),E=t.des.createEncryptionCipher;break;default:var b=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+m.algorithm+'".');throw b.algorithm=m.algorithm,b}var R=t.pbe.opensslDeriveBytes(o,a.substr(0,8),v),T=E(R);T.start(a),T.update(r.toDer(n.privateKeyToAsn1(p))),T.finish();var h={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:S,parameters:t.util.bytesToHex(a).toUpperCase()},body:T.output.getBytes()};return t.pem.encode(h)},n.decryptRsaPrivateKey=function(p,o){var m=null,g=t.pem.decode(p)[0];if(g.type!=="ENCRYPTED PRIVATE KEY"&&g.type!=="PRIVATE KEY"&&g.type!=="RSA PRIVATE KEY"){var S=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');throw S.headerType=S,S}if(g.procType&&g.procType.type==="ENCRYPTED"){var a,v;switch(g.dekInfo.algorithm){case"DES-CBC":a=8,v=t.des.createDecryptionCipher;break;case"DES-EDE3-CBC":a=24,v=t.des.createDecryptionCipher;break;case"AES-128-CBC":a=16,v=t.aes.createDecryptionCipher;break;case"AES-192-CBC":a=24,v=t.aes.createDecryptionCipher;break;case"AES-256-CBC":a=32,v=t.aes.createDecryptionCipher;break;case"RC2-40-CBC":a=5,v=function(h){return t.rc2.createDecryptionCipher(h,40)};break;case"RC2-64-CBC":a=8,v=function(h){return t.rc2.createDecryptionCipher(h,64)};break;case"RC2-128-CBC":a=16,v=function(h){return t.rc2.createDecryptionCipher(h,128)};break;default:var S=new Error('Could not decrypt private key; unsupported encryption algorithm "'+g.dekInfo.algorithm+'".');throw S.algorithm=g.dekInfo.algorithm,S}var E=t.util.hexToBytes(g.dekInfo.parameters),b=t.pbe.opensslDeriveBytes(o,E.substr(0,8),a),R=v(b);if(R.start(E),R.update(t.util.createBuffer(g.body)),R.finish())m=R.output.getBytes();else return m}else m=g.body;return g.type==="ENCRYPTED PRIVATE KEY"?m=n.decryptPrivateKeyInfo(r.fromDer(m),o):m=r.fromDer(m),m!==null&&(m=n.privateKeyFromAsn1(m)),m},n.pbe.generatePkcs12Key=function(p,o,m,g,S,a){var v,E;if(typeof a>"u"||a===null){if(!("sha1"in t.md))throw new Error('"sha1" hash algorithm unavailable.');a=t.md.sha1.create()}var b=a.digestLength,R=a.blockLength,T=new t.util.ByteBuffer,h=new t.util.ByteBuffer;if(p!=null){for(E=0;E<p.length;E++)h.putInt16(p.charCodeAt(E));h.putInt16(0)}var l=h.length(),B=o.length(),N=new t.util.ByteBuffer;N.fillWithByte(m,R);var F=R*Math.ceil(B/R),L=new t.util.ByteBuffer;for(E=0;E<F;E++)L.putByte(o.at(E%B));var q=R*Math.ceil(l/R),j=new t.util.ByteBuffer;for(E=0;E<q;E++)j.putByte(h.at(E%l));var H=L;H.putBuffer(j);for(var Q=Math.ceil(S/b),J=1;J<=Q;J++){var X=new t.util.ByteBuffer;X.putBytes(N.bytes()),X.putBytes(H.bytes());for(var re=0;re<g;re++)a.start(),a.update(X.getBytes()),X=a.digest();var se=new t.util.ByteBuffer;for(E=0;E<R;E++)se.putByte(X.at(E%b));var de=Math.ceil(B/R)+Math.ceil(l/R),ye=new t.util.ByteBuffer;for(v=0;v<de;v++){var _e=new t.util.ByteBuffer(H.getBytes(R)),W=511;for(E=se.length()-1;E>=0;E--)W=W>>8,W+=se.at(E)+_e.at(E),_e.setAt(E,W&255);ye.putBuffer(_e)}H=ye,T.putBuffer(X)}return T.truncate(T.length()-S),T},n.pbe.getCipher=function(p,o,m){switch(p){case n.oids.pkcs5PBES2:return n.pbe.getCipherForPBES2(p,o,m);case n.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case n.oids["pbewithSHAAnd40BitRC2-CBC"]:return n.pbe.getCipherForPKCS12PBE(p,o,m);default:var g=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw g.oid=p,g.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],g}},n.pbe.getCipherForPBES2=function(p,o,m){var g={},S=[];if(!r.validate(o,c,g,S)){var a=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw a.errors=S,a}if(p=r.derToOid(g.kdfOid),p!==n.oids.pkcs5PBKDF2){var a=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw a.oid=p,a.supportedOids=["pkcs5PBKDF2"],a}if(p=r.derToOid(g.encOid),p!==n.oids["aes128-CBC"]&&p!==n.oids["aes192-CBC"]&&p!==n.oids["aes256-CBC"]&&p!==n.oids["des-EDE3-CBC"]&&p!==n.oids.desCBC){var a=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw a.oid=p,a.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],a}var v=g.kdfSalt,E=t.util.createBuffer(g.kdfIterationCount);E=E.getInt(E.length()<<3);var b,R;switch(n.oids[p]){case"aes128-CBC":b=16,R=t.aes.createDecryptionCipher;break;case"aes192-CBC":b=24,R=t.aes.createDecryptionCipher;break;case"aes256-CBC":b=32,R=t.aes.createDecryptionCipher;break;case"des-EDE3-CBC":b=24,R=t.des.createDecryptionCipher;break;case"desCBC":b=8,R=t.des.createDecryptionCipher;break}var T=f(g.prfOid),h=t.pkcs5.pbkdf2(m,v,E,b,T),l=g.encIv,B=R(h);return B.start(l),B},n.pbe.getCipherForPKCS12PBE=function(p,o,m){var g={},S=[];if(!r.validate(o,i,g,S)){var a=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw a.errors=S,a}var v=t.util.createBuffer(g.salt),E=t.util.createBuffer(g.iterations);E=E.getInt(E.length()<<3);var b,R,T;switch(p){case n.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:b=24,R=8,T=t.des.startDecrypting;break;case n.oids["pbewithSHAAnd40BitRC2-CBC"]:b=5,R=8,T=function(F,L){var q=t.rc2.createDecryptionCipher(F,40);return q.start(L,null),q};break;default:var a=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw a.oid=p,a}var h=f(g.prfOid),l=n.pbe.generatePkcs12Key(m,v,1,E,b,h);h.start();var B=n.pbe.generatePkcs12Key(m,v,2,E,R,h);return T(l,B)},n.pbe.opensslDeriveBytes=function(p,o,m,g){if(typeof g>"u"||g===null){if(!("md5"in t.md))throw new Error('"md5" hash algorithm unavailable.');g=t.md.md5.create()}o===null&&(o="");for(var S=[y(g,p+o)],a=16,v=1;a<m;++v,a+=16)S.push(y(g,S[v-1]+p+o));return S.join("").substr(0,m)};function y(p,o){return p.start().update(o).digest().getBytes()}function f(p){var o;if(!p)o="hmacWithSHA1";else if(o=n.oids[r.derToOid(p)],!o){var m=new Error("Unsupported PRF OID.");throw m.oid=p,m.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],m}return A(o)}function A(p){var o=t.md;switch(p){case"hmacWithSHA224":o=t.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":p=p.substr(8).toLowerCase();break;default:var m=new Error("Unsupported PRF algorithm.");throw m.algorithm=p,m.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],m}if(!o||!(p in o))throw new Error("Unknown hash algorithm: "+p);return o[p].create()}function C(p,o,m,g){var S=r.create(r.Class.UNIVERSAL,r.Type.SEQUENCE,!0,[r.create(r.Class.UNIVERSAL,r.Type.OCTETSTRING,!1,p),r.create(r.Class.UNIVERSAL,r.Type.INTEGER,!1,o.getBytes())]);return g!=="hmacWithSHA1"&&S.value.push(r.create(r.Class.UNIVERSAL,r.Type.INTEGER,!1,t.util.hexToBytes(m.toString(16))),r.create(r.Class.UNIVERSAL,r.Type.SEQUENCE,!0,[r.create(r.Class.UNIVERSAL,r.Type.OID,!1,r.oidToDer(n.oids[g]).getBytes()),r.create(r.Class.UNIVERSAL,r.Type.NULL,!1,"")])),S}return ia}var aa={exports:{}},sa={exports:{}},No;function Nc(){if(No)return sa.exports;No=1;var t=me();Tt(),Ae();var e=t.asn1,r=sa.exports=t.pkcs7asn1=t.pkcs7asn1||{};t.pkcs7=t.pkcs7||{},t.pkcs7.asn1=r;var n={name:"ContentInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.ContentType",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,captureAsn1:"content"}]};r.contentInfoValidator=n;var s={name:"EncryptedContentInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentType",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"contentType"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentEncryptionAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm.parameter",tagClass:e.Class.UNIVERSAL,captureAsn1:"encParameter"}]},{name:"EncryptedContentInfo.encryptedContent",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,capture:"encryptedContent",captureAsn1:"encryptedContentAsn1"}]};r.envelopedDataValidator={name:"EnvelopedData",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"EnvelopedData.Version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"version"},{name:"EnvelopedData.RecipientInfos",tagClass:e.Class.UNIVERSAL,type:e.Type.SET,constructed:!0,captureAsn1:"recipientInfos"}].concat(s)},r.encryptedDataValidator={name:"EncryptedData",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedData.Version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"version"}].concat(s)};var u={name:"SignerInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1},{name:"SignerInfo.issuerAndSerialNumber",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.issuerAndSerialNumber.issuer",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"SignerInfo.issuerAndSerialNumber.serialNumber",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"SignerInfo.digestAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.digestAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"digestAlgorithm"},{name:"SignerInfo.digestAlgorithm.parameter",tagClass:e.Class.UNIVERSAL,constructed:!1,captureAsn1:"digestParameter",optional:!0}]},{name:"SignerInfo.authenticatedAttributes",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"authenticatedAttributes"},{name:"SignerInfo.digestEncryptionAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,capture:"signatureAlgorithm"},{name:"SignerInfo.encryptedDigest",tagClass:e.Class.UNIVERSAL,type:e.Type.OCTETSTRING,constructed:!1,capture:"signature"},{name:"SignerInfo.unauthenticatedAttributes",tagClass:e.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,capture:"unauthenticatedAttributes"}]};return r.signedDataValidator={name:"SignedData",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"SignedData.Version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"version"},{name:"SignedData.DigestAlgorithms",tagClass:e.Class.UNIVERSAL,type:e.Type.SET,constructed:!0,captureAsn1:"digestAlgorithms"},n,{name:"SignedData.Certificates",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,optional:!0,captureAsn1:"certificates"},{name:"SignedData.CertificateRevocationLists",tagClass:e.Class.CONTEXT_SPECIFIC,type:1,optional:!0,captureAsn1:"crls"},{name:"SignedData.SignerInfos",tagClass:e.Class.UNIVERSAL,type:e.Type.SET,capture:"signerInfos",optional:!0,value:[u]}]},r.recipientInfoValidator={name:"RecipientInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"version"},{name:"RecipientInfo.issuerAndSerial",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.issuerAndSerial.issuer",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"RecipientInfo.issuerAndSerial.serialNumber",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"RecipientInfo.keyEncryptionAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.keyEncryptionAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"RecipientInfo.keyEncryptionAlgorithm.parameter",tagClass:e.Class.UNIVERSAL,constructed:!1,captureAsn1:"encParameter",optional:!0}]},{name:"RecipientInfo.encryptedKey",tagClass:e.Class.UNIVERSAL,type:e.Type.OCTETSTRING,constructed:!1,capture:"encKey"}]},sa.exports}var oa={exports:{}},ua={exports:{}},Po;function Pc(){if(Po)return ua.exports;Po=1;var t=me();Ae(),t.mgf=t.mgf||{};var e=ua.exports=t.mgf.mgf1=t.mgf1=t.mgf1||{};return e.create=function(r){var n={generate:function(s,u){for(var c=new t.util.ByteBuffer,i=Math.ceil(u/r.digestLength),y=0;y<i;y++){var f=new t.util.ByteBuffer;f.putInt32(y),r.start(),r.update(s+f.getBytes()),c.putBuffer(r.digest())}return c.truncate(c.length()-u),c.getBytes()}};return n},ua.exports}var ca,Uo;function nd(){if(Uo)return ca;Uo=1;var t=me();return Pc(),ca=t.mgf=t.mgf||{},t.mgf.mgf1=t.mgf1,ca}var la={exports:{}},Oo;function vs(){if(Oo)return la.exports;Oo=1;var t=me();yt(),Ae();var e=la.exports=t.pss=t.pss||{};return e.create=function(r){arguments.length===3&&(r={md:arguments[0],mgf:arguments[1],saltLength:arguments[2]});var n=r.md,s=r.mgf,u=n.digestLength,c=r.salt||null;typeof c=="string"&&(c=t.util.createBuffer(c));var i;if("saltLength"in r)i=r.saltLength;else if(c!==null)i=c.length();else throw new Error("Salt length not specified or specific salt not given.");if(c!==null&&c.length()!==i)throw new Error("Given salt length does not match length of given salt.");var y=r.prng||t.random,f={};return f.encode=function(A,C){var p,o=C-1,m=Math.ceil(o/8),g=A.digest().getBytes();if(m<u+i+2)throw new Error("Message is too long to encrypt.");var S;c===null?S=y.getBytesSync(i):S=c.bytes();var a=new t.util.ByteBuffer;a.fillWithByte(0,8),a.putBytes(g),a.putBytes(S),n.start(),n.update(a.getBytes());var v=n.digest().getBytes(),E=new t.util.ByteBuffer;E.fillWithByte(0,m-i-u-2),E.putByte(1),E.putBytes(S);var b=E.getBytes(),R=m-u-1,T=s.generate(v,R),h="";for(p=0;p<R;p++)h+=String.fromCharCode(b.charCodeAt(p)^T.charCodeAt(p));var l=65280>>8*m-o&255;return h=String.fromCharCode(h.charCodeAt(0)&~l)+h.substr(1),h+v+String.fromCharCode(188)},f.verify=function(A,C,p){var o,m=p-1,g=Math.ceil(m/8);if(C=C.substr(-g),g<u+i+2)throw new Error("Inconsistent parameters to PSS signature verification.");if(C.charCodeAt(g-1)!==188)throw new Error("Encoded message does not end in 0xBC.");var S=g-u-1,a=C.substr(0,S),v=C.substr(S,u),E=65280>>8*g-m&255;if(a.charCodeAt(0)&E)throw new Error("Bits beyond keysize not zero as expected.");var b=s.generate(v,S),R="";for(o=0;o<S;o++)R+=String.fromCharCode(a.charCodeAt(o)^b.charCodeAt(o));R=String.fromCharCode(R.charCodeAt(0)&~E)+R.substr(1);var T=g-u-i-2;for(o=0;o<T;o++)if(R.charCodeAt(o)!==0)throw new Error("Leftmost octets not zero as expected");if(R.charCodeAt(T)!==1)throw new Error("Inconsistent PSS signature, 0x01 marker not found");var h=R.substr(-i),l=new t.util.ByteBuffer;l.fillWithByte(0,8),l.putBytes(A),l.putBytes(h),n.start(),n.update(l.getBytes());var B=n.digest().getBytes();return v===B},f},la.exports}var ko;function ms(){if(ko)return oa.exports;ko=1;var t=me();sr(),Tt(),oi(),Ot(),nd(),or(),Rr(),vs(),ci(),Ae();var e=t.asn1,r=oa.exports=t.pki=t.pki||{},n=r.oids,s={};s.CN=n.commonName,s.commonName="CN",s.C=n.countryName,s.countryName="C",s.L=n.localityName,s.localityName="L",s.ST=n.stateOrProvinceName,s.stateOrProvinceName="ST",s.O=n.organizationName,s.organizationName="O",s.OU=n.organizationalUnitName,s.organizationalUnitName="OU",s.E=n.emailAddress,s.emailAddress="E";var u=t.pki.rsa.publicKeyValidator,c={name:"Certificate",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"tbsCertificate",value:[{name:"Certificate.TBSCertificate.version",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.version.integer",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"certVersion"}]},{name:"Certificate.TBSCertificate.serialNumber",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"certSerialNumber"},{name:"Certificate.TBSCertificate.signature",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.signature.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"certinfoSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:e.Class.UNIVERSAL,optional:!0,captureAsn1:"certinfoSignatureParams"}]},{name:"Certificate.TBSCertificate.issuer",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"certIssuer"},{name:"Certificate.TBSCertificate.validity",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.validity.notBefore (utc)",tagClass:e.Class.UNIVERSAL,type:e.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity1UTCTime"},{name:"Certificate.TBSCertificate.validity.notBefore (generalized)",tagClass:e.Class.UNIVERSAL,type:e.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity2GeneralizedTime"},{name:"Certificate.TBSCertificate.validity.notAfter (utc)",tagClass:e.Class.UNIVERSAL,type:e.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity3UTCTime"},{name:"Certificate.TBSCertificate.validity.notAfter (generalized)",tagClass:e.Class.UNIVERSAL,type:e.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity4GeneralizedTime"}]},{name:"Certificate.TBSCertificate.subject",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"certSubject"},u,{name:"Certificate.TBSCertificate.issuerUniqueID",tagClass:e.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.issuerUniqueID.id",tagClass:e.Class.UNIVERSAL,type:e.Type.BITSTRING,constructed:!1,captureBitStringValue:"certIssuerUniqueId"}]},{name:"Certificate.TBSCertificate.subjectUniqueID",tagClass:e.Class.CONTEXT_SPECIFIC,type:2,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.subjectUniqueID.id",tagClass:e.Class.UNIVERSAL,type:e.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSubjectUniqueId"}]},{name:"Certificate.TBSCertificate.extensions",tagClass:e.Class.CONTEXT_SPECIFIC,type:3,constructed:!0,captureAsn1:"certExtensions",optional:!0}]},{name:"Certificate.signatureAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.signatureAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"certSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:e.Class.UNIVERSAL,optional:!0,captureAsn1:"certSignatureParams"}]},{name:"Certificate.signatureValue",tagClass:e.Class.UNIVERSAL,type:e.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSignature"}]},i={name:"rsapss",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.hashAlgorithm",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier",tagClass:e.Class.UNIVERSAL,type:e.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"hashOid"}]}]},{name:"rsapss.maskGenAlgorithm",tagClass:e.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier",tagClass:e.Class.UNIVERSAL,type:e.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"maskGenOid"},{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"maskGenHashOid"}]}]}]},{name:"rsapss.saltLength",tagClass:e.Class.CONTEXT_SPECIFIC,type:2,optional:!0,value:[{name:"rsapss.saltLength.saltLength",tagClass:e.Class.UNIVERSAL,type:e.Class.INTEGER,constructed:!1,capture:"saltLength"}]},{name:"rsapss.trailerField",tagClass:e.Class.CONTEXT_SPECIFIC,type:3,optional:!0,value:[{name:"rsapss.trailer.trailer",tagClass:e.Class.UNIVERSAL,type:e.Class.INTEGER,constructed:!1,capture:"trailer"}]}]},y={name:"CertificationRequestInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfo",value:[{name:"CertificationRequestInfo.integer",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"certificationRequestInfoVersion"},{name:"CertificationRequestInfo.subject",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfoSubject"},u,{name:"CertificationRequestInfo.attributes",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"certificationRequestInfoAttributes",value:[{name:"CertificationRequestInfo.attributes",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequestInfo.attributes.type",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1},{name:"CertificationRequestInfo.attributes.value",tagClass:e.Class.UNIVERSAL,type:e.Type.SET,constructed:!0}]}]}]},f={name:"CertificationRequest",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"csr",value:[y,{name:"CertificationRequest.signatureAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequest.signatureAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"csrSignatureOid"},{name:"CertificationRequest.signatureAlgorithm.parameters",tagClass:e.Class.UNIVERSAL,optional:!0,captureAsn1:"csrSignatureParams"}]},{name:"CertificationRequest.signature",tagClass:e.Class.UNIVERSAL,type:e.Type.BITSTRING,constructed:!1,captureBitStringValue:"csrSignature"}]};r.RDNAttributesAsArray=function(T,h){for(var l=[],B,N,F,L=0;L<T.value.length;++L){B=T.value[L];for(var q=0;q<B.value.length;++q)F={},N=B.value[q],F.type=e.derToOid(N.value[0].value),F.value=N.value[1].value,F.valueTagClass=N.value[1].type,F.type in n&&(F.name=n[F.type],F.name in s&&(F.shortName=s[F.name])),h&&(h.update(F.type),h.update(F.value)),l.push(F)}return l},r.CRIAttributesAsArray=function(T){for(var h=[],l=0;l<T.length;++l)for(var B=T[l],N=e.derToOid(B.value[0].value),F=B.value[1].value,L=0;L<F.length;++L){var q={};if(q.type=N,q.value=F[L].value,q.valueTagClass=F[L].type,q.type in n&&(q.name=n[q.type],q.name in s&&(q.shortName=s[q.name])),q.type===n.extensionRequest){q.extensions=[];for(var j=0;j<q.value.length;++j)q.extensions.push(r.certificateExtensionFromAsn1(q.value[j]))}h.push(q)}return h};function A(T,h){typeof h=="string"&&(h={shortName:h});for(var l=null,B,N=0;l===null&&N<T.attributes.length;++N)B=T.attributes[N],(h.type&&h.type===B.type||h.name&&h.name===B.name||h.shortName&&h.shortName===B.shortName)&&(l=B);return l}var C=function(T,h,l){var B={};if(T!==n["RSASSA-PSS"])return B;l&&(B={hash:{algorithmOid:n.sha1},mgf:{algorithmOid:n.mgf1,hash:{algorithmOid:n.sha1}},saltLength:20});var N={},F=[];if(!e.validate(h,i,N,F)){var L=new Error("Cannot read RSASSA-PSS parameter block.");throw L.errors=F,L}return N.hashOid!==void 0&&(B.hash=B.hash||{},B.hash.algorithmOid=e.derToOid(N.hashOid)),N.maskGenOid!==void 0&&(B.mgf=B.mgf||{},B.mgf.algorithmOid=e.derToOid(N.maskGenOid),B.mgf.hash=B.mgf.hash||{},B.mgf.hash.algorithmOid=e.derToOid(N.maskGenHashOid)),N.saltLength!==void 0&&(B.saltLength=N.saltLength.charCodeAt(0)),B},p=function(T){switch(n[T.signatureOid]){case"sha1WithRSAEncryption":case"sha1WithRSASignature":return t.md.sha1.create();case"md5WithRSAEncryption":return t.md.md5.create();case"sha256WithRSAEncryption":return t.md.sha256.create();case"sha384WithRSAEncryption":return t.md.sha384.create();case"sha512WithRSAEncryption":return t.md.sha512.create();case"RSASSA-PSS":return t.md.sha256.create();default:var h=new Error("Could not compute "+T.type+" digest. Unknown signature OID.");throw h.signatureOid=T.signatureOid,h}},o=function(T){var h=T.certificate,l;switch(h.signatureOid){case n.sha1WithRSAEncryption:case n.sha1WithRSASignature:break;case n["RSASSA-PSS"]:var B,N;if(B=n[h.signatureParameters.mgf.hash.algorithmOid],B===void 0||t.md[B]===void 0){var F=new Error("Unsupported MGF hash function.");throw F.oid=h.signatureParameters.mgf.hash.algorithmOid,F.name=B,F}if(N=n[h.signatureParameters.mgf.algorithmOid],N===void 0||t.mgf[N]===void 0){var F=new Error("Unsupported MGF function.");throw F.oid=h.signatureParameters.mgf.algorithmOid,F.name=N,F}if(N=t.mgf[N].create(t.md[B].create()),B=n[h.signatureParameters.hash.algorithmOid],B===void 0||t.md[B]===void 0){var F=new Error("Unsupported RSASSA-PSS hash function.");throw F.oid=h.signatureParameters.hash.algorithmOid,F.name=B,F}l=t.pss.create(t.md[B].create(),N,h.signatureParameters.saltLength);break}return h.publicKey.verify(T.md.digest().getBytes(),T.signature,l)};r.certificateFromPem=function(T,h,l){var B=t.pem.decode(T)[0];if(B.type!=="CERTIFICATE"&&B.type!=="X509 CERTIFICATE"&&B.type!=="TRUSTED CERTIFICATE"){var N=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw N.headerType=B.type,N}if(B.procType&&B.procType.type==="ENCRYPTED")throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var F=e.fromDer(B.body,l);return r.certificateFromAsn1(F,h)},r.certificateToPem=function(T,h){var l={type:"CERTIFICATE",body:e.toDer(r.certificateToAsn1(T)).getBytes()};return t.pem.encode(l,{maxline:h})},r.publicKeyFromPem=function(T){var h=t.pem.decode(T)[0];if(h.type!=="PUBLIC KEY"&&h.type!=="RSA PUBLIC KEY"){var l=new Error('Could not convert public key from PEM; PEM header type is not "PUBLIC KEY" or "RSA PUBLIC KEY".');throw l.headerType=h.type,l}if(h.procType&&h.procType.type==="ENCRYPTED")throw new Error("Could not convert public key from PEM; PEM is encrypted.");var B=e.fromDer(h.body);return r.publicKeyFromAsn1(B)},r.publicKeyToPem=function(T,h){var l={type:"PUBLIC KEY",body:e.toDer(r.publicKeyToAsn1(T)).getBytes()};return t.pem.encode(l,{maxline:h})},r.publicKeyToRSAPublicKeyPem=function(T,h){var l={type:"RSA PUBLIC KEY",body:e.toDer(r.publicKeyToRSAPublicKey(T)).getBytes()};return t.pem.encode(l,{maxline:h})},r.getPublicKeyFingerprint=function(T,h){h=h||{};var l=h.md||t.md.sha1.create(),B=h.type||"RSAPublicKey",N;switch(B){case"RSAPublicKey":N=e.toDer(r.publicKeyToRSAPublicKey(T)).getBytes();break;case"SubjectPublicKeyInfo":N=e.toDer(r.publicKeyToAsn1(T)).getBytes();break;default:throw new Error('Unknown fingerprint type "'+h.type+'".')}l.start(),l.update(N);var F=l.digest();if(h.encoding==="hex"){var L=F.toHex();return h.delimiter?L.match(/.{2}/g).join(h.delimiter):L}else{if(h.encoding==="binary")return F.getBytes();if(h.encoding)throw new Error('Unknown encoding "'+h.encoding+'".')}return F},r.certificationRequestFromPem=function(T,h,l){var B=t.pem.decode(T)[0];if(B.type!=="CERTIFICATE REQUEST"){var N=new Error('Could not convert certification request from PEM; PEM header type is not "CERTIFICATE REQUEST".');throw N.headerType=B.type,N}if(B.procType&&B.procType.type==="ENCRYPTED")throw new Error("Could not convert certification request from PEM; PEM is encrypted.");var F=e.fromDer(B.body,l);return r.certificationRequestFromAsn1(F,h)},r.certificationRequestToPem=function(T,h){var l={type:"CERTIFICATE REQUEST",body:e.toDer(r.certificationRequestToAsn1(T)).getBytes()};return t.pem.encode(l,{maxline:h})},r.createCertificate=function(){var T={};return T.version=2,T.serialNumber="00",T.signatureOid=null,T.signature=null,T.siginfo={},T.siginfo.algorithmOid=null,T.validity={},T.validity.notBefore=new Date,T.validity.notAfter=new Date,T.issuer={},T.issuer.getField=function(h){return A(T.issuer,h)},T.issuer.addField=function(h){g([h]),T.issuer.attributes.push(h)},T.issuer.attributes=[],T.issuer.hash=null,T.subject={},T.subject.getField=function(h){return A(T.subject,h)},T.subject.addField=function(h){g([h]),T.subject.attributes.push(h)},T.subject.attributes=[],T.subject.hash=null,T.extensions=[],T.publicKey=null,T.md=null,T.setSubject=function(h,l){g(h),T.subject.attributes=h,delete T.subject.uniqueId,l&&(T.subject.uniqueId=l),T.subject.hash=null},T.setIssuer=function(h,l){g(h),T.issuer.attributes=h,delete T.issuer.uniqueId,l&&(T.issuer.uniqueId=l),T.issuer.hash=null},T.setExtensions=function(h){for(var l=0;l<h.length;++l)S(h[l],{cert:T});T.extensions=h},T.getExtension=function(h){typeof h=="string"&&(h={name:h});for(var l=null,B,N=0;l===null&&N<T.extensions.length;++N)B=T.extensions[N],(h.id&&B.id===h.id||h.name&&B.name===h.name)&&(l=B);return l},T.sign=function(h,l){T.md=l||t.md.sha1.create();var B=n[T.md.algorithm+"WithRSAEncryption"];if(!B){var N=new Error("Could not compute certificate digest. Unknown message digest algorithm OID.");throw N.algorithm=T.md.algorithm,N}T.signatureOid=T.siginfo.algorithmOid=B,T.tbsCertificate=r.getTBSCertificate(T);var F=e.toDer(T.tbsCertificate);T.md.update(F.getBytes()),T.signature=h.sign(T.md)},T.verify=function(h){var l=!1;if(!T.issued(h)){var B=h.issuer,N=T.subject,F=new Error("The parent certificate did not issue the given child certificate; the child certificate's issuer does not match the parent's subject.");throw F.expectedIssuer=N.attributes,F.actualIssuer=B.attributes,F}var L=h.md;if(L===null){L=p({signatureOid:h.signatureOid,type:"certificate"});var q=h.tbsCertificate||r.getTBSCertificate(h),j=e.toDer(q);L.update(j.getBytes())}return L!==null&&(l=o({certificate:T,md:L,signature:h.signature})),l},T.isIssuer=function(h){var l=!1,B=T.issuer,N=h.subject;if(B.hash&&N.hash)l=B.hash===N.hash;else if(B.attributes.length===N.attributes.length){l=!0;for(var F,L,q=0;l&&q<B.attributes.length;++q)F=B.attributes[q],L=N.attributes[q],(F.type!==L.type||F.value!==L.value)&&(l=!1)}return l},T.issued=function(h){return h.isIssuer(T)},T.generateSubjectKeyIdentifier=function(){return r.getPublicKeyFingerprint(T.publicKey,{type:"RSAPublicKey"})},T.verifySubjectKeyIdentifier=function(){for(var h=n.subjectKeyIdentifier,l=0;l<T.extensions.length;++l){var B=T.extensions[l];if(B.id===h){var N=T.generateSubjectKeyIdentifier().getBytes();return t.util.hexToBytes(B.subjectKeyIdentifier)===N}}return!1},T},r.certificateFromAsn1=function(T,h){var l={},B=[];if(!e.validate(T,c,l,B)){var N=new Error("Cannot read X.509 certificate. ASN.1 object is not an X509v3 Certificate.");throw N.errors=B,N}var F=e.derToOid(l.publicKeyOid);if(F!==r.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var L=r.createCertificate();L.version=l.certVersion?l.certVersion.charCodeAt(0):0;var q=t.util.createBuffer(l.certSerialNumber);L.serialNumber=q.toHex(),L.signatureOid=t.asn1.derToOid(l.certSignatureOid),L.signatureParameters=C(L.signatureOid,l.certSignatureParams,!0),L.siginfo.algorithmOid=t.asn1.derToOid(l.certinfoSignatureOid),L.siginfo.parameters=C(L.siginfo.algorithmOid,l.certinfoSignatureParams,!1),L.signature=l.certSignature;var j=[];if(l.certValidity1UTCTime!==void 0&&j.push(e.utcTimeToDate(l.certValidity1UTCTime)),l.certValidity2GeneralizedTime!==void 0&&j.push(e.generalizedTimeToDate(l.certValidity2GeneralizedTime)),l.certValidity3UTCTime!==void 0&&j.push(e.utcTimeToDate(l.certValidity3UTCTime)),l.certValidity4GeneralizedTime!==void 0&&j.push(e.generalizedTimeToDate(l.certValidity4GeneralizedTime)),j.length>2)throw new Error("Cannot read notBefore/notAfter validity times; more than two times were provided in the certificate.");if(j.length<2)throw new Error("Cannot read notBefore/notAfter validity times; they were not provided as either UTCTime or GeneralizedTime.");if(L.validity.notBefore=j[0],L.validity.notAfter=j[1],L.tbsCertificate=l.tbsCertificate,h){L.md=p({signatureOid:L.signatureOid,type:"certificate"});var H=e.toDer(L.tbsCertificate);L.md.update(H.getBytes())}var Q=t.md.sha1.create(),J=e.toDer(l.certIssuer);Q.update(J.getBytes()),L.issuer.getField=function(se){return A(L.issuer,se)},L.issuer.addField=function(se){g([se]),L.issuer.attributes.push(se)},L.issuer.attributes=r.RDNAttributesAsArray(l.certIssuer),l.certIssuerUniqueId&&(L.issuer.uniqueId=l.certIssuerUniqueId),L.issuer.hash=Q.digest().toHex();var X=t.md.sha1.create(),re=e.toDer(l.certSubject);return X.update(re.getBytes()),L.subject.getField=function(se){return A(L.subject,se)},L.subject.addField=function(se){g([se]),L.subject.attributes.push(se)},L.subject.attributes=r.RDNAttributesAsArray(l.certSubject),l.certSubjectUniqueId&&(L.subject.uniqueId=l.certSubjectUniqueId),L.subject.hash=X.digest().toHex(),l.certExtensions?L.extensions=r.certificateExtensionsFromAsn1(l.certExtensions):L.extensions=[],L.publicKey=r.publicKeyFromAsn1(l.subjectPublicKeyInfo),L},r.certificateExtensionsFromAsn1=function(T){for(var h=[],l=0;l<T.value.length;++l)for(var B=T.value[l],N=0;N<B.value.length;++N)h.push(r.certificateExtensionFromAsn1(B.value[N]));return h},r.certificateExtensionFromAsn1=function(T){var h={};if(h.id=e.derToOid(T.value[0].value),h.critical=!1,T.value[1].type===e.Type.BOOLEAN?(h.critical=T.value[1].value.charCodeAt(0)!==0,h.value=T.value[2].value):h.value=T.value[1].value,h.id in n){if(h.name=n[h.id],h.name==="keyUsage"){var l=e.fromDer(h.value),B=0,N=0;l.value.length>1&&(B=l.value.charCodeAt(1),N=l.value.length>2?l.value.charCodeAt(2):0),h.digitalSignature=(B&128)===128,h.nonRepudiation=(B&64)===64,h.keyEncipherment=(B&32)===32,h.dataEncipherment=(B&16)===16,h.keyAgreement=(B&8)===8,h.keyCertSign=(B&4)===4,h.cRLSign=(B&2)===2,h.encipherOnly=(B&1)===1,h.decipherOnly=(N&128)===128}else if(h.name==="basicConstraints"){var l=e.fromDer(h.value);l.value.length>0&&l.value[0].type===e.Type.BOOLEAN?h.cA=l.value[0].value.charCodeAt(0)!==0:h.cA=!1;var F=null;l.value.length>0&&l.value[0].type===e.Type.INTEGER?F=l.value[0].value:l.value.length>1&&(F=l.value[1].value),F!==null&&(h.pathLenConstraint=e.derToInteger(F))}else if(h.name==="extKeyUsage")for(var l=e.fromDer(h.value),L=0;L<l.value.length;++L){var q=e.derToOid(l.value[L].value);q in n?h[n[q]]=!0:h[q]=!0}else if(h.name==="nsCertType"){var l=e.fromDer(h.value),B=0;l.value.length>1&&(B=l.value.charCodeAt(1)),h.client=(B&128)===128,h.server=(B&64)===64,h.email=(B&32)===32,h.objsign=(B&16)===16,h.reserved=(B&8)===8,h.sslCA=(B&4)===4,h.emailCA=(B&2)===2,h.objCA=(B&1)===1}else if(h.name==="subjectAltName"||h.name==="issuerAltName"){h.altNames=[];for(var j,l=e.fromDer(h.value),H=0;H<l.value.length;++H){j=l.value[H];var Q={type:j.type,value:j.value};switch(h.altNames.push(Q),j.type){case 1:case 2:case 6:break;case 7:Q.ip=t.util.bytesToIP(j.value);break;case 8:Q.oid=e.derToOid(j.value);break}}}else if(h.name==="subjectKeyIdentifier"){var l=e.fromDer(h.value);h.subjectKeyIdentifier=t.util.bytesToHex(l.value)}}return h},r.certificationRequestFromAsn1=function(T,h){var l={},B=[];if(!e.validate(T,f,l,B)){var N=new Error("Cannot read PKCS#10 certificate request. ASN.1 object is not a PKCS#10 CertificationRequest.");throw N.errors=B,N}var F=e.derToOid(l.publicKeyOid);if(F!==r.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var L=r.createCertificationRequest();if(L.version=l.csrVersion?l.csrVersion.charCodeAt(0):0,L.signatureOid=t.asn1.derToOid(l.csrSignatureOid),L.signatureParameters=C(L.signatureOid,l.csrSignatureParams,!0),L.siginfo.algorithmOid=t.asn1.derToOid(l.csrSignatureOid),L.siginfo.parameters=C(L.siginfo.algorithmOid,l.csrSignatureParams,!1),L.signature=l.csrSignature,L.certificationRequestInfo=l.certificationRequestInfo,h){L.md=p({signatureOid:L.signatureOid,type:"certification request"});var q=e.toDer(L.certificationRequestInfo);L.md.update(q.getBytes())}var j=t.md.sha1.create();return L.subject.getField=function(H){return A(L.subject,H)},L.subject.addField=function(H){g([H]),L.subject.attributes.push(H)},L.subject.attributes=r.RDNAttributesAsArray(l.certificationRequestInfoSubject,j),L.subject.hash=j.digest().toHex(),L.publicKey=r.publicKeyFromAsn1(l.subjectPublicKeyInfo),L.getAttribute=function(H){return A(L,H)},L.addAttribute=function(H){g([H]),L.attributes.push(H)},L.attributes=r.CRIAttributesAsArray(l.certificationRequestInfoAttributes||[]),L},r.createCertificationRequest=function(){var T={};return T.version=0,T.signatureOid=null,T.signature=null,T.siginfo={},T.siginfo.algorithmOid=null,T.subject={},T.subject.getField=function(h){return A(T.subject,h)},T.subject.addField=function(h){g([h]),T.subject.attributes.push(h)},T.subject.attributes=[],T.subject.hash=null,T.publicKey=null,T.attributes=[],T.getAttribute=function(h){return A(T,h)},T.addAttribute=function(h){g([h]),T.attributes.push(h)},T.md=null,T.setSubject=function(h){g(h),T.subject.attributes=h,T.subject.hash=null},T.setAttributes=function(h){g(h),T.attributes=h},T.sign=function(h,l){T.md=l||t.md.sha1.create();var B=n[T.md.algorithm+"WithRSAEncryption"];if(!B){var N=new Error("Could not compute certification request digest. Unknown message digest algorithm OID.");throw N.algorithm=T.md.algorithm,N}T.signatureOid=T.siginfo.algorithmOid=B,T.certificationRequestInfo=r.getCertificationRequestInfo(T);var F=e.toDer(T.certificationRequestInfo);T.md.update(F.getBytes()),T.signature=h.sign(T.md)},T.verify=function(){var h=!1,l=T.md;if(l===null){l=p({signatureOid:T.signatureOid,type:"certification request"});var B=T.certificationRequestInfo||r.getCertificationRequestInfo(T),N=e.toDer(B);l.update(N.getBytes())}return l!==null&&(h=o({certificate:T,md:l,signature:T.signature})),h},T};function m(T){for(var h=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]),l,B,N=T.attributes,F=0;F<N.length;++F){l=N[F];var L=l.value,q=e.Type.PRINTABLESTRING;"valueTagClass"in l&&(q=l.valueTagClass,q===e.Type.UTF8&&(L=t.util.encodeUtf8(L))),B=e.create(e.Class.UNIVERSAL,e.Type.SET,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(l.type).getBytes()),e.create(e.Class.UNIVERSAL,q,!1,L)])]),h.value.push(B)}return h}function g(T){for(var h,l=0;l<T.length;++l){if(h=T[l],typeof h.name>"u"&&(h.type&&h.type in r.oids?h.name=r.oids[h.type]:h.shortName&&h.shortName in s&&(h.name=r.oids[s[h.shortName]])),typeof h.type>"u")if(h.name&&h.name in r.oids)h.type=r.oids[h.name];else{var B=new Error("Attribute type not specified.");throw B.attribute=h,B}if(typeof h.shortName>"u"&&h.name&&h.name in s&&(h.shortName=s[h.name]),h.type===n.extensionRequest&&(h.valueConstructed=!0,h.valueTagClass=e.Type.SEQUENCE,!h.value&&h.extensions)){h.value=[];for(var N=0;N<h.extensions.length;++N)h.value.push(r.certificateExtensionToAsn1(S(h.extensions[N])))}if(typeof h.value>"u"){var B=new Error("Attribute value not specified.");throw B.attribute=h,B}}}function S(T,h){if(h=h||{},typeof T.name>"u"&&T.id&&T.id in r.oids&&(T.name=r.oids[T.id]),typeof T.id>"u")if(T.name&&T.name in r.oids)T.id=r.oids[T.name];else{var l=new Error("Extension ID not specified.");throw l.extension=T,l}if(typeof T.value<"u")return T;if(T.name==="keyUsage"){var B=0,N=0,F=0;T.digitalSignature&&(N|=128,B=7),T.nonRepudiation&&(N|=64,B=6),T.keyEncipherment&&(N|=32,B=5),T.dataEncipherment&&(N|=16,B=4),T.keyAgreement&&(N|=8,B=3),T.keyCertSign&&(N|=4,B=2),T.cRLSign&&(N|=2,B=1),T.encipherOnly&&(N|=1,B=0),T.decipherOnly&&(F|=128,B=7);var L=String.fromCharCode(B);F!==0?L+=String.fromCharCode(N)+String.fromCharCode(F):N!==0&&(L+=String.fromCharCode(N)),T.value=e.create(e.Class.UNIVERSAL,e.Type.BITSTRING,!1,L)}else if(T.name==="basicConstraints")T.value=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]),T.cA&&T.value.value.push(e.create(e.Class.UNIVERSAL,e.Type.BOOLEAN,!1,String.fromCharCode(255))),"pathLenConstraint"in T&&T.value.value.push(e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(T.pathLenConstraint).getBytes()));else if(T.name==="extKeyUsage"){T.value=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]);var q=T.value.value;for(var j in T)T[j]===!0&&(j in n?q.push(e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(n[j]).getBytes())):j.indexOf(".")!==-1&&q.push(e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(j).getBytes())))}else if(T.name==="nsCertType"){var B=0,N=0;T.client&&(N|=128,B=7),T.server&&(N|=64,B=6),T.email&&(N|=32,B=5),T.objsign&&(N|=16,B=4),T.reserved&&(N|=8,B=3),T.sslCA&&(N|=4,B=2),T.emailCA&&(N|=2,B=1),T.objCA&&(N|=1,B=0);var L=String.fromCharCode(B);N!==0&&(L+=String.fromCharCode(N)),T.value=e.create(e.Class.UNIVERSAL,e.Type.BITSTRING,!1,L)}else if(T.name==="subjectAltName"||T.name==="issuerAltName"){T.value=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]);for(var H,Q=0;Q<T.altNames.length;++Q){H=T.altNames[Q];var L=H.value;if(H.type===7&&H.ip){if(L=t.util.bytesFromIP(H.ip),L===null){var l=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw l.extension=T,l}}else H.type===8&&(H.oid?L=e.oidToDer(e.oidToDer(H.oid)):L=e.oidToDer(L));T.value.value.push(e.create(e.Class.CONTEXT_SPECIFIC,H.type,!1,L))}}else if(T.name==="nsComment"&&h.cert){if(!/^[\x00-\x7F]*$/.test(T.comment)||T.comment.length<1||T.comment.length>128)throw new Error('Invalid "nsComment" content.');T.value=e.create(e.Class.UNIVERSAL,e.Type.IA5STRING,!1,T.comment)}else if(T.name==="subjectKeyIdentifier"&&h.cert){var J=h.cert.generateSubjectKeyIdentifier();T.subjectKeyIdentifier=J.toHex(),T.value=e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,J.getBytes())}else if(T.name==="authorityKeyIdentifier"&&h.cert){T.value=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]);var q=T.value.value;if(T.keyIdentifier){var X=T.keyIdentifier===!0?h.cert.generateSubjectKeyIdentifier().getBytes():T.keyIdentifier;q.push(e.create(e.Class.CONTEXT_SPECIFIC,0,!1,X))}if(T.authorityCertIssuer){var re=[e.create(e.Class.CONTEXT_SPECIFIC,4,!0,[m(T.authorityCertIssuer===!0?h.cert.issuer:T.authorityCertIssuer)])];q.push(e.create(e.Class.CONTEXT_SPECIFIC,1,!0,re))}if(T.serialNumber){var se=t.util.hexToBytes(T.serialNumber===!0?h.cert.serialNumber:T.serialNumber);q.push(e.create(e.Class.CONTEXT_SPECIFIC,2,!1,se))}}else if(T.name==="cRLDistributionPoints"){T.value=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]);for(var q=T.value.value,de=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]),ye=e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[]),H,Q=0;Q<T.altNames.length;++Q){H=T.altNames[Q];var L=H.value;if(H.type===7&&H.ip){if(L=t.util.bytesFromIP(H.ip),L===null){var l=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw l.extension=T,l}}else H.type===8&&(H.oid?L=e.oidToDer(e.oidToDer(H.oid)):L=e.oidToDer(L));ye.value.push(e.create(e.Class.CONTEXT_SPECIFIC,H.type,!1,L))}de.value.push(e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[ye])),q.push(de)}if(typeof T.value>"u"){var l=new Error("Extension value not specified.");throw l.extension=T,l}return T}function a(T,h){switch(T){case n["RSASSA-PSS"]:var l=[];return h.hash.algorithmOid!==void 0&&l.push(e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(h.hash.algorithmOid).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")])])),h.mgf.algorithmOid!==void 0&&l.push(e.create(e.Class.CONTEXT_SPECIFIC,1,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(h.mgf.algorithmOid).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(h.mgf.hash.algorithmOid).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")])])])),h.saltLength!==void 0&&l.push(e.create(e.Class.CONTEXT_SPECIFIC,2,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(h.saltLength).getBytes())])),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,l);default:return e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")}}function v(T){var h=e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[]);if(T.attributes.length===0)return h;for(var l=T.attributes,B=0;B<l.length;++B){var N=l[B],F=N.value,L=e.Type.UTF8;"valueTagClass"in N&&(L=N.valueTagClass),L===e.Type.UTF8&&(F=t.util.encodeUtf8(F));var q=!1;"valueConstructed"in N&&(q=N.valueConstructed);var j=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(N.type).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SET,!0,[e.create(e.Class.UNIVERSAL,L,q,F)])]);h.value.push(j)}return h}var E=new Date("1950-01-01T00:00:00Z"),b=new Date("2050-01-01T00:00:00Z");function R(T){return T>=E&&T<b?e.create(e.Class.UNIVERSAL,e.Type.UTCTIME,!1,e.dateToUtcTime(T)):e.create(e.Class.UNIVERSAL,e.Type.GENERALIZEDTIME,!1,e.dateToGeneralizedTime(T))}return r.getTBSCertificate=function(T){var h=R(T.validity.notBefore),l=R(T.validity.notAfter),B=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(T.version).getBytes())]),e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,t.util.hexToBytes(T.serialNumber)),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(T.siginfo.algorithmOid).getBytes()),a(T.siginfo.algorithmOid,T.siginfo.parameters)]),m(T.issuer),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[h,l]),m(T.subject),r.publicKeyToAsn1(T.publicKey)]);return T.issuer.uniqueId&&B.value.push(e.create(e.Class.CONTEXT_SPECIFIC,1,!0,[e.create(e.Class.UNIVERSAL,e.Type.BITSTRING,!1,String.fromCharCode(0)+T.issuer.uniqueId)])),T.subject.uniqueId&&B.value.push(e.create(e.Class.CONTEXT_SPECIFIC,2,!0,[e.create(e.Class.UNIVERSAL,e.Type.BITSTRING,!1,String.fromCharCode(0)+T.subject.uniqueId)])),T.extensions.length>0&&B.value.push(r.certificateExtensionsToAsn1(T.extensions)),B},r.getCertificationRequestInfo=function(T){var h=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(T.version).getBytes()),m(T.subject),r.publicKeyToAsn1(T.publicKey),v(T)]);return h},r.distinguishedNameToAsn1=function(T){return m(T)},r.certificateToAsn1=function(T){var h=T.tbsCertificate||r.getTBSCertificate(T);return e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[h,e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(T.signatureOid).getBytes()),a(T.signatureOid,T.signatureParameters)]),e.create(e.Class.UNIVERSAL,e.Type.BITSTRING,!1,String.fromCharCode(0)+T.signature)])},r.certificateExtensionsToAsn1=function(T){var h=e.create(e.Class.CONTEXT_SPECIFIC,3,!0,[]),l=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]);h.value.push(l);for(var B=0;B<T.length;++B)l.value.push(r.certificateExtensionToAsn1(T[B]));return h},r.certificateExtensionToAsn1=function(T){var h=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]);h.value.push(e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(T.id).getBytes())),T.critical&&h.value.push(e.create(e.Class.UNIVERSAL,e.Type.BOOLEAN,!1,String.fromCharCode(255)));var l=T.value;return typeof T.value!="string"&&(l=e.toDer(l).getBytes()),h.value.push(e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,l)),h},r.certificationRequestToAsn1=function(T){var h=T.certificationRequestInfo||r.getCertificationRequestInfo(T);return e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[h,e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(T.signatureOid).getBytes()),a(T.signatureOid,T.signatureParameters)]),e.create(e.Class.UNIVERSAL,e.Type.BITSTRING,!1,String.fromCharCode(0)+T.signature)])},r.createCaStore=function(T){var h={certs:{}};h.getIssuer=function(L){var q=l(L.issuer);return q},h.addCertificate=function(L){if(typeof L=="string"&&(L=t.pki.certificateFromPem(L)),B(L.subject),!h.hasCertificate(L))if(L.subject.hash in h.certs){var q=h.certs[L.subject.hash];t.util.isArray(q)||(q=[q]),q.push(L),h.certs[L.subject.hash]=q}else h.certs[L.subject.hash]=L},h.hasCertificate=function(L){typeof L=="string"&&(L=t.pki.certificateFromPem(L));var q=l(L.subject);if(!q)return!1;t.util.isArray(q)||(q=[q]);for(var j=e.toDer(r.certificateToAsn1(L)).getBytes(),H=0;H<q.length;++H){var Q=e.toDer(r.certificateToAsn1(q[H])).getBytes();if(j===Q)return!0}return!1},h.listAllCertificates=function(){var L=[];for(var q in h.certs)if(h.certs.hasOwnProperty(q)){var j=h.certs[q];if(!t.util.isArray(j))L.push(j);else for(var H=0;H<j.length;++H)L.push(j[H])}return L},h.removeCertificate=function(L){var q;if(typeof L=="string"&&(L=t.pki.certificateFromPem(L)),B(L.subject),!h.hasCertificate(L))return null;var j=l(L.subject);if(!t.util.isArray(j))return q=h.certs[L.subject.hash],delete h.certs[L.subject.hash],q;for(var H=e.toDer(r.certificateToAsn1(L)).getBytes(),Q=0;Q<j.length;++Q){var J=e.toDer(r.certificateToAsn1(j[Q])).getBytes();H===J&&(q=j[Q],j.splice(Q,1))}return j.length===0&&delete h.certs[L.subject.hash],q};function l(L){return B(L),h.certs[L.hash]||null}function B(L){if(!L.hash){var q=t.md.sha1.create();L.attributes=r.RDNAttributesAsArray(m(L),q),L.hash=q.digest().toHex()}}if(T)for(var N=0;N<T.length;++N){var F=T[N];h.addCertificate(F)}return h},r.certificateError={bad_certificate:"forge.pki.BadCertificate",unsupported_certificate:"forge.pki.UnsupportedCertificate",certificate_revoked:"forge.pki.CertificateRevoked",certificate_expired:"forge.pki.CertificateExpired",certificate_unknown:"forge.pki.CertificateUnknown",unknown_ca:"forge.pki.UnknownCertificateAuthority"},r.verifyCertificateChain=function(T,h,l){typeof l=="function"&&(l={verify:l}),l=l||{},h=h.slice(0);var B=h.slice(0),N=l.validityCheckDate;typeof N>"u"&&(N=new Date);var F=!0,L=null,q=0;do{var j=h.shift(),H=null,Q=!1;if(N&&(N<j.validity.notBefore||N>j.validity.notAfter)&&(L={message:"Certificate is not valid yet or has expired.",error:r.certificateError.certificate_expired,notBefore:j.validity.notBefore,notAfter:j.validity.notAfter,now:N}),L===null){if(H=h[0]||T.getIssuer(j),H===null&&j.isIssuer(j)&&(Q=!0,H=j),H){var J=H;t.util.isArray(J)||(J=[J]);for(var X=!1;!X&&J.length>0;){H=J.shift();try{X=H.verify(j)}catch{}}X||(L={message:"Certificate signature is invalid.",error:r.certificateError.bad_certificate})}L===null&&(!H||Q)&&!T.hasCertificate(j)&&(L={message:"Certificate is not trusted.",error:r.certificateError.unknown_ca})}if(L===null&&H&&!j.isIssuer(H)&&(L={message:"Certificate issuer is invalid.",error:r.certificateError.bad_certificate}),L===null)for(var re={keyUsage:!0,basicConstraints:!0},se=0;L===null&&se<j.extensions.length;++se){var de=j.extensions[se];de.critical&&!(de.name in re)&&(L={message:"Certificate has an unsupported critical extension.",error:r.certificateError.unsupported_certificate})}if(L===null&&(!F||h.length===0&&(!H||Q))){var ye=j.getExtension("basicConstraints"),_e=j.getExtension("keyUsage");if(_e!==null&&(!_e.keyCertSign||ye===null)&&(L={message:"Certificate keyUsage or basicConstraints conflict or indicate that the certificate is not a CA. If the certificate is the only one in the chain or isn't the first then the certificate must be a valid CA.",error:r.certificateError.bad_certificate}),L===null&&ye!==null&&!ye.cA&&(L={message:"Certificate basicConstraints indicates the certificate is not a CA.",error:r.certificateError.bad_certificate}),L===null&&_e!==null&&"pathLenConstraint"in ye){var W=q-1;W>ye.pathLenConstraint&&(L={message:"Certificate basicConstraints pathLenConstraint violated.",error:r.certificateError.bad_certificate})}}var he=L===null?!0:L.error,ie=l.verify?l.verify(he,q,B):he;if(ie===!0)L=null;else throw he===!0&&(L={message:"The application rejected the certificate.",error:r.certificateError.bad_certificate}),(ie||ie===0)&&(typeof ie=="object"&&!t.util.isArray(ie)?(ie.message&&(L.message=ie.message),ie.error&&(L.error=ie.error)):typeof ie=="string"&&(L.error=ie)),L;F=!1,++q}while(h.length>0);return!0},oa.exports}var Lo;function Uc(){if(Lo)return aa.exports;Lo=1;var t=me();Tt(),an(),or(),Nc(),Bc(),yt(),ci(),sn(),Ae(),ms();var e=t.asn1,r=t.pki,n=aa.exports=t.pkcs12=t.pkcs12||{},s={name:"ContentInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.contentType",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:e.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"content"}]},u={name:"PFX",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"version"},s,{name:"PFX.macData",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"mac",value:[{name:"PFX.macData.mac",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"macAlgorithm"},{name:"PFX.macData.mac.digestAlgorithm.parameters",tagClass:e.Class.UNIVERSAL,captureAsn1:"macAlgorithmParameters"}]},{name:"PFX.macData.mac.digest",tagClass:e.Class.UNIVERSAL,type:e.Type.OCTETSTRING,constructed:!1,capture:"macDigest"}]},{name:"PFX.macData.macSalt",tagClass:e.Class.UNIVERSAL,type:e.Type.OCTETSTRING,constructed:!1,capture:"macSalt"},{name:"PFX.macData.iterations",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,optional:!0,capture:"macIterations"}]}]},c={name:"SafeBag",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"SafeBag.bagId",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"bagId"},{name:"SafeBag.bagValue",tagClass:e.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"bagValue"},{name:"SafeBag.bagAttributes",tagClass:e.Class.UNIVERSAL,type:e.Type.SET,constructed:!0,optional:!0,capture:"bagAttributes"}]},i={name:"Attribute",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"Attribute.attrId",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"oid"},{name:"Attribute.attrValues",tagClass:e.Class.UNIVERSAL,type:e.Type.SET,constructed:!0,capture:"values"}]},y={name:"CertBag",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"CertBag.certId",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"certId"},{name:"CertBag.certValue",tagClass:e.Class.CONTEXT_SPECIFIC,constructed:!0,value:[{name:"CertBag.certValue[0]",tagClass:e.Class.UNIVERSAL,type:e.Class.OCTETSTRING,constructed:!1,capture:"cert"}]}]};function f(g,S,a,v){for(var E=[],b=0;b<g.length;b++)for(var R=0;R<g[b].safeBags.length;R++){var T=g[b].safeBags[R];if(!(v!==void 0&&T.type!==v)){if(S===null){E.push(T);continue}T.attributes[S]!==void 0&&T.attributes[S].indexOf(a)>=0&&E.push(T)}}return E}n.pkcs12FromAsn1=function(g,S,a){typeof S=="string"?(a=S,S=!0):S===void 0&&(S=!0);var v={},E=[];if(!e.validate(g,u,v,E)){var b=new Error("Cannot read PKCS#12 PFX. ASN.1 object is not an PKCS#12 PFX.");throw b.errors=b,b}var R={version:v.version.charCodeAt(0),safeContents:[],getBags:function(H){var Q={},J;return"localKeyId"in H?J=H.localKeyId:"localKeyIdHex"in H&&(J=t.util.hexToBytes(H.localKeyIdHex)),J===void 0&&!("friendlyName"in H)&&"bagType"in H&&(Q[H.bagType]=f(R.safeContents,null,null,H.bagType)),J!==void 0&&(Q.localKeyId=f(R.safeContents,"localKeyId",J,H.bagType)),"friendlyName"in H&&(Q.friendlyName=f(R.safeContents,"friendlyName",H.friendlyName,H.bagType)),Q},getBagsByFriendlyName:function(H,Q){return f(R.safeContents,"friendlyName",H,Q)},getBagsByLocalKeyId:function(H,Q){return f(R.safeContents,"localKeyId",H,Q)}};if(v.version.charCodeAt(0)!==3){var b=new Error("PKCS#12 PFX of version other than 3 not supported.");throw b.version=v.version.charCodeAt(0),b}if(e.derToOid(v.contentType)!==r.oids.data){var b=new Error("Only PKCS#12 PFX in password integrity mode supported.");throw b.oid=e.derToOid(v.contentType),b}var T=v.content.value[0];if(T.tagClass!==e.Class.UNIVERSAL||T.type!==e.Type.OCTETSTRING)throw new Error("PKCS#12 authSafe content data is not an OCTET STRING.");if(T=A(T),v.mac){var h=null,l=0,B=e.derToOid(v.macAlgorithm);switch(B){case r.oids.sha1:h=t.md.sha1.create(),l=20;break;case r.oids.sha256:h=t.md.sha256.create(),l=32;break;case r.oids.sha384:h=t.md.sha384.create(),l=48;break;case r.oids.sha512:h=t.md.sha512.create(),l=64;break;case r.oids.md5:h=t.md.md5.create(),l=16;break}if(h===null)throw new Error("PKCS#12 uses unsupported MAC algorithm: "+B);var N=new t.util.ByteBuffer(v.macSalt),F="macIterations"in v?parseInt(t.util.bytesToHex(v.macIterations),16):1,L=n.generateKey(a,N,3,F,l,h),q=t.hmac.create();q.start(h,L),q.update(T.value);var j=q.getMac();if(j.getBytes()!==v.macDigest)throw new Error("PKCS#12 MAC could not be verified. Invalid password?")}return C(R,T.value,S,a),R};function A(g){if(g.composed||g.constructed){for(var S=t.util.createBuffer(),a=0;a<g.value.length;++a)S.putBytes(g.value[a].value);g.composed=g.constructed=!1,g.value=S.getBytes()}return g}function C(g,S,a,v){if(S=e.fromDer(S,a),S.tagClass!==e.Class.UNIVERSAL||S.type!==e.Type.SEQUENCE||S.constructed!==!0)throw new Error("PKCS#12 AuthenticatedSafe expected to be a SEQUENCE OF ContentInfo");for(var E=0;E<S.value.length;E++){var b=S.value[E],R={},T=[];if(!e.validate(b,s,R,T)){var h=new Error("Cannot read ContentInfo.");throw h.errors=T,h}var l={encrypted:!1},B=null,N=R.content.value[0];switch(e.derToOid(R.contentType)){case r.oids.data:if(N.tagClass!==e.Class.UNIVERSAL||N.type!==e.Type.OCTETSTRING)throw new Error("PKCS#12 SafeContents Data is not an OCTET STRING.");B=A(N).value;break;case r.oids.encryptedData:B=p(N,v),l.encrypted=!0;break;default:var h=new Error("Unsupported PKCS#12 contentType.");throw h.contentType=e.derToOid(R.contentType),h}l.safeBags=o(B,a,v),g.safeContents.push(l)}}function p(g,S){var a={},v=[];if(!e.validate(g,t.pkcs7.asn1.encryptedDataValidator,a,v)){var E=new Error("Cannot read EncryptedContentInfo.");throw E.errors=v,E}var b=e.derToOid(a.contentType);if(b!==r.oids.data){var E=new Error("PKCS#12 EncryptedContentInfo ContentType is not Data.");throw E.oid=b,E}b=e.derToOid(a.encAlgorithm);var R=r.pbe.getCipher(b,a.encParameter,S),T=A(a.encryptedContentAsn1),h=t.util.createBuffer(T.value);if(R.update(h),!R.finish())throw new Error("Failed to decrypt PKCS#12 SafeContents.");return R.output.getBytes()}function o(g,S,a){if(!S&&g.length===0)return[];if(g=e.fromDer(g,S),g.tagClass!==e.Class.UNIVERSAL||g.type!==e.Type.SEQUENCE||g.constructed!==!0)throw new Error("PKCS#12 SafeContents expected to be a SEQUENCE OF SafeBag.");for(var v=[],E=0;E<g.value.length;E++){var b=g.value[E],R={},T=[];if(!e.validate(b,c,R,T)){var h=new Error("Cannot read SafeBag.");throw h.errors=T,h}var l={type:e.derToOid(R.bagId),attributes:m(R.bagAttributes)};v.push(l);var B,N,F=R.bagValue.value[0];switch(l.type){case r.oids.pkcs8ShroudedKeyBag:if(F=r.decryptPrivateKeyInfo(F,a),F===null)throw new Error("Unable to decrypt PKCS#8 ShroudedKeyBag, wrong password?");case r.oids.keyBag:try{l.key=r.privateKeyFromAsn1(F)}catch{l.key=null,l.asn1=F}continue;case r.oids.certBag:B=y,N=function(){if(e.derToOid(R.certId)!==r.oids.x509Certificate){var q=new Error("Unsupported certificate type, only X.509 supported.");throw q.oid=e.derToOid(R.certId),q}var j=e.fromDer(R.cert,S);try{l.cert=r.certificateFromAsn1(j,!0)}catch{l.cert=null,l.asn1=j}};break;default:var h=new Error("Unsupported PKCS#12 SafeBag type.");throw h.oid=l.type,h}if(B!==void 0&&!e.validate(F,B,R,T)){var h=new Error("Cannot read PKCS#12 "+B.name);throw h.errors=T,h}N()}return v}function m(g){var S={};if(g!==void 0)for(var a=0;a<g.length;++a){var v={},E=[];if(!e.validate(g[a],i,v,E)){var b=new Error("Cannot read PKCS#12 BagAttribute.");throw b.errors=E,b}var R=e.derToOid(v.oid);if(r.oids[R]!==void 0){S[r.oids[R]]=[];for(var T=0;T<v.values.length;++T)S[r.oids[R]].push(v.values[T].value)}}return S}return n.toPkcs12Asn1=function(g,S,a,v){v=v||{},v.saltSize=v.saltSize||8,v.count=v.count||2048,v.algorithm=v.algorithm||v.encAlgorithm||"aes128","useMac"in v||(v.useMac=!0),"localKeyId"in v||(v.localKeyId=null),"generateLocalKeyId"in v||(v.generateLocalKeyId=!0);var E=v.localKeyId,b;if(E!==null)E=t.util.hexToBytes(E);else if(v.generateLocalKeyId)if(S){var R=t.util.isArray(S)?S[0]:S;typeof R=="string"&&(R=r.certificateFromPem(R));var T=t.md.sha1.create();T.update(e.toDer(r.certificateToAsn1(R)).getBytes()),E=T.digest().getBytes()}else E=t.random.getBytes(20);var h=[];E!==null&&h.push(e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(r.oids.localKeyId).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SET,!0,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,E)])])),"friendlyName"in v&&h.push(e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(r.oids.friendlyName).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SET,!0,[e.create(e.Class.UNIVERSAL,e.Type.BMPSTRING,!1,v.friendlyName)])])),h.length>0&&(b=e.create(e.Class.UNIVERSAL,e.Type.SET,!0,h));var l=[],B=[];S!==null&&(t.util.isArray(S)?B=S:B=[S]);for(var N=[],F=0;F<B.length;++F){S=B[F],typeof S=="string"&&(S=r.certificateFromPem(S));var L=F===0?b:void 0,q=r.certificateToAsn1(S),j=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(r.oids.certBag).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(r.oids.x509Certificate).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,e.toDer(q).getBytes())])])]),L]);N.push(j)}if(N.length>0){var H=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,N),Q=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(r.oids.data).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,e.toDer(H).getBytes())])]);l.push(Q)}var J=null;if(g!==null){var X=r.wrapRsaPrivateKey(r.privateKeyToAsn1(g));a===null?J=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(r.oids.keyBag).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[X]),b]):J=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(r.oids.pkcs8ShroudedKeyBag).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[r.encryptPrivateKeyInfo(X,a,v)]),b]);var re=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[J]),se=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(r.oids.data).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,e.toDer(re).getBytes())])]);l.push(se)}var de=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,l),ye;if(v.useMac){var T=t.md.sha1.create(),_e=new t.util.ByteBuffer(t.random.getBytes(v.saltSize)),W=v.count,g=n.generateKey(a,_e,3,W,20),he=t.hmac.create();he.start(T,g),he.update(e.toDer(de).getBytes());var ie=he.getMac();ye=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(r.oids.sha1).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")]),e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,ie.getBytes())]),e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,_e.getBytes()),e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(W).getBytes())])}return e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(3).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(r.oids.data).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,e.toDer(de).getBytes())])]),ye])},n.generateKey=t.pbe.generatePkcs12Key,aa.exports}var Do;function Oc(){if(Do)return Wi.exports;Do=1;var t=me();Tt(),or(),Bc(),Rr(),gs(),Uc(),vs(),ci(),Ae(),ms();var e=t.asn1,r=Wi.exports=t.pki=t.pki||{};return r.pemToDer=function(n){var s=t.pem.decode(n)[0];if(s.procType&&s.procType.type==="ENCRYPTED")throw new Error("Could not convert PEM to DER; PEM is encrypted.");return t.util.createBuffer(s.body)},r.privateKeyFromPem=function(n){var s=t.pem.decode(n)[0];if(s.type!=="PRIVATE KEY"&&s.type!=="RSA PRIVATE KEY"){var u=new Error('Could not convert private key from PEM; PEM header type is not "PRIVATE KEY" or "RSA PRIVATE KEY".');throw u.headerType=s.type,u}if(s.procType&&s.procType.type==="ENCRYPTED")throw new Error("Could not convert private key from PEM; PEM is encrypted.");var c=e.fromDer(s.body);return r.privateKeyFromAsn1(c)},r.privateKeyToPem=function(n,s){var u={type:"RSA PRIVATE KEY",body:e.toDer(r.privateKeyToAsn1(n)).getBytes()};return t.pem.encode(u,{maxline:s})},r.privateKeyInfoToPem=function(n,s){var u={type:"PRIVATE KEY",body:e.toDer(n).getBytes()};return t.pem.encode(u,{maxline:s})},Wi.exports}var fa,Fo;function kc(){if(Fo)return fa;Fo=1;var t=me();Tt(),an(),ys(),Rr(),Oc(),yt(),sn(),Ae();var e=function(_,x,w,d){var I=t.util.createBuffer(),O=_.length>>1,P=O+(_.length&1),K=_.substr(0,P),V=_.substr(O,P),$=t.util.createBuffer(),M=t.hmac.create();w=x+w;var G=Math.ceil(d/16),Y=Math.ceil(d/20);M.start("MD5",K);var ne=t.util.createBuffer();$.putBytes(w);for(var te=0;te<G;++te)M.start(null,null),M.update($.getBytes()),$.putBuffer(M.digest()),M.start(null,null),M.update($.bytes()+w),ne.putBuffer(M.digest());M.start("SHA1",V);var ce=t.util.createBuffer();$.clear(),$.putBytes(w);for(var te=0;te<Y;++te)M.start(null,null),M.update($.getBytes()),$.putBuffer(M.digest()),M.start(null,null),M.update($.bytes()+w),ce.putBuffer(M.digest());return I.putBytes(t.util.xorBytes(ne.getBytes(),ce.getBytes(),d)),I},r=function(_,x,w){var d=t.hmac.create();d.start("SHA1",_);var I=t.util.createBuffer();return I.putInt32(x[0]),I.putInt32(x[1]),I.putByte(w.type),I.putByte(w.version.major),I.putByte(w.version.minor),I.putInt16(w.length),I.putBytes(w.fragment.bytes()),d.update(I.getBytes()),d.digest().getBytes()},n=function(_,x,w){var d=!1;try{var I=_.deflate(x.fragment.getBytes());x.fragment=t.util.createBuffer(I),x.length=I.length,d=!0}catch{}return d},s=function(_,x,w){var d=!1;try{var I=_.inflate(x.fragment.getBytes());x.fragment=t.util.createBuffer(I),x.length=I.length,d=!0}catch{}return d},u=function(_,x){var w=0;switch(x){case 1:w=_.getByte();break;case 2:w=_.getInt16();break;case 3:w=_.getInt24();break;case 4:w=_.getInt32();break}return t.util.createBuffer(_.getBytes(w))},c=function(_,x,w){_.putInt(w.length(),x<<3),_.putBuffer(w)},i={};i.Versions={TLS_1_0:{major:3,minor:1},TLS_1_1:{major:3,minor:2},TLS_1_2:{major:3,minor:3}},i.SupportedVersions=[i.Versions.TLS_1_1,i.Versions.TLS_1_0],i.Version=i.SupportedVersions[0],i.MaxFragment=16384-1024,i.ConnectionEnd={server:0,client:1},i.PRFAlgorithm={tls_prf_sha256:0},i.BulkCipherAlgorithm={none:null,rc4:0,des3:1,aes:2},i.CipherType={stream:0,block:1,aead:2},i.MACAlgorithm={none:null,hmac_md5:0,hmac_sha1:1,hmac_sha256:2,hmac_sha384:3,hmac_sha512:4},i.CompressionMethod={none:0,deflate:1},i.ContentType={change_cipher_spec:20,alert:21,handshake:22,application_data:23,heartbeat:24},i.HandshakeType={hello_request:0,client_hello:1,server_hello:2,certificate:11,server_key_exchange:12,certificate_request:13,server_hello_done:14,certificate_verify:15,client_key_exchange:16,finished:20},i.Alert={},i.Alert.Level={warning:1,fatal:2},i.Alert.Description={close_notify:0,unexpected_message:10,bad_record_mac:20,decryption_failed:21,record_overflow:22,decompression_failure:30,handshake_failure:40,bad_certificate:42,unsupported_certificate:43,certificate_revoked:44,certificate_expired:45,certificate_unknown:46,illegal_parameter:47,unknown_ca:48,access_denied:49,decode_error:50,decrypt_error:51,export_restriction:60,protocol_version:70,insufficient_security:71,internal_error:80,user_canceled:90,no_renegotiation:100},i.HeartbeatMessageType={heartbeat_request:1,heartbeat_response:2},i.CipherSuites={},i.getCipherSuite=function(_){var x=null;for(var w in i.CipherSuites){var d=i.CipherSuites[w];if(d.id[0]===_.charCodeAt(0)&&d.id[1]===_.charCodeAt(1)){x=d;break}}return x},i.handleUnexpected=function(_,x){var w=!_.open&&_.entity===i.ConnectionEnd.client;w||_.error(_,{message:"Unexpected message. Received TLS record out of order.",send:!0,alert:{level:i.Alert.Level.fatal,description:i.Alert.Description.unexpected_message}})},i.handleHelloRequest=function(_,x,w){!_.handshaking&&_.handshakes>0&&(i.queue(_,i.createAlert(_,{level:i.Alert.Level.warning,description:i.Alert.Description.no_renegotiation})),i.flush(_)),_.process()},i.parseHelloMessage=function(_,x,w){var d=null,I=_.entity===i.ConnectionEnd.client;if(w<38)_.error(_,{message:I?"Invalid ServerHello message. Message too short.":"Invalid ClientHello message. Message too short.",send:!0,alert:{level:i.Alert.Level.fatal,description:i.Alert.Description.illegal_parameter}});else{var O=x.fragment,P=O.length();if(d={version:{major:O.getByte(),minor:O.getByte()},random:t.util.createBuffer(O.getBytes(32)),session_id:u(O,1),extensions:[]},I?(d.cipher_suite=O.getBytes(2),d.compression_method=O.getByte()):(d.cipher_suites=u(O,2),d.compression_methods=u(O,1)),P=w-(P-O.length()),P>0){for(var K=u(O,2);K.length()>0;)d.extensions.push({type:[K.getByte(),K.getByte()],data:u(K,2)});if(!I)for(var V=0;V<d.extensions.length;++V){var $=d.extensions[V];if($.type[0]===0&&$.type[1]===0)for(var M=u($.data,2);M.length()>0;){var G=M.getByte();if(G!==0)break;_.session.extensions.server_name.serverNameList.push(u(M,2).getBytes())}}}if(_.session.version&&(d.version.major!==_.session.version.major||d.version.minor!==_.session.version.minor))return _.error(_,{message:"TLS version change is disallowed during renegotiation.",send:!0,alert:{level:i.Alert.Level.fatal,description:i.Alert.Description.protocol_version}});if(I)_.session.cipherSuite=i.getCipherSuite(d.cipher_suite);else for(var Y=t.util.createBuffer(d.cipher_suites.bytes());Y.length()>0&&(_.session.cipherSuite=i.getCipherSuite(Y.getBytes(2)),_.session.cipherSuite===null););if(_.session.cipherSuite===null)return _.error(_,{message:"No cipher suites in common.",send:!0,alert:{level:i.Alert.Level.fatal,description:i.Alert.Description.handshake_failure},cipherSuite:t.util.bytesToHex(d.cipher_suite)});I?_.session.compressionMethod=d.compression_method:_.session.compressionMethod=i.CompressionMethod.none}return d},i.createSecurityParameters=function(_,x){var w=_.entity===i.ConnectionEnd.client,d=x.random.bytes(),I=w?_.session.sp.client_random:d,O=w?d:i.createRandom().getBytes();_.session.sp={entity:_.entity,prf_algorithm:i.PRFAlgorithm.tls_prf_sha256,bulk_cipher_algorithm:null,cipher_type:null,enc_key_length:null,block_length:null,fixed_iv_length:null,record_iv_length:null,mac_algorithm:null,mac_length:null,mac_key_length:null,compression_algorithm:_.session.compressionMethod,pre_master_secret:null,master_secret:null,client_random:I,server_random:O}},i.handleServerHello=function(_,x,w){var d=i.parseHelloMessage(_,x,w);if(!_.fail){if(d.version.minor<=_.version.minor)_.version.minor=d.version.minor;else return _.error(_,{message:"Incompatible TLS version.",send:!0,alert:{level:i.Alert.Level.fatal,description:i.Alert.Description.protocol_version}});_.session.version=_.version;var I=d.session_id.bytes();I.length>0&&I===_.session.id?(_.expect=o,_.session.resuming=!0,_.session.sp.server_random=d.random.bytes()):(_.expect=f,_.session.resuming=!1,i.createSecurityParameters(_,d)),_.session.id=I,_.process()}},i.handleClientHello=function(_,x,w){var d=i.parseHelloMessage(_,x,w);if(!_.fail){var I=d.session_id.bytes(),O=null;if(_.sessionCache&&(O=_.sessionCache.getSession(I),O===null?I="":(O.version.major!==d.version.major||O.version.minor>d.version.minor)&&(O=null,I="")),I.length===0&&(I=t.random.getBytes(32)),_.session.id=I,_.session.clientHelloVersion=d.version,_.session.sp={},O)_.version=_.session.version=O.version,_.session.sp=O.sp;else{for(var P,K=1;K<i.SupportedVersions.length&&(P=i.SupportedVersions[K],!(P.minor<=d.version.minor));++K);_.version={major:P.major,minor:P.minor},_.session.version=_.version}O!==null?(_.expect=R,_.session.resuming=!0,_.session.sp.client_random=d.random.bytes()):(_.expect=_.verifyClient!==!1?v:E,_.session.resuming=!1,i.createSecurityParameters(_,d)),_.open=!0,i.queue(_,i.createRecord(_,{type:i.ContentType.handshake,data:i.createServerHello(_)})),_.session.resuming?(i.queue(_,i.createRecord(_,{type:i.ContentType.change_cipher_spec,data:i.createChangeCipherSpec()})),_.state.pending=i.createConnectionState(_),_.state.current.write=_.state.pending.write,i.queue(_,i.createRecord(_,{type:i.ContentType.handshake,data:i.createFinished(_)}))):(i.queue(_,i.createRecord(_,{type:i.ContentType.handshake,data:i.createCertificate(_)})),_.fail||(i.queue(_,i.createRecord(_,{type:i.ContentType.handshake,data:i.createServerKeyExchange(_)})),_.verifyClient!==!1&&i.queue(_,i.createRecord(_,{type:i.ContentType.handshake,data:i.createCertificateRequest(_)})),i.queue(_,i.createRecord(_,{type:i.ContentType.handshake,data:i.createServerHelloDone(_)})))),i.flush(_),_.process()}},i.handleCertificate=function(_,x,w){if(w<3)return _.error(_,{message:"Invalid Certificate message. Message too short.",send:!0,alert:{level:i.Alert.Level.fatal,description:i.Alert.Description.illegal_parameter}});var d=x.fragment,I={certificate_list:u(d,3)},O,P,K=[];try{for(;I.certificate_list.length()>0;)O=u(I.certificate_list,3),P=t.asn1.fromDer(O),O=t.pki.certificateFromAsn1(P,!0),K.push(O)}catch($){return _.error(_,{message:"Could not parse certificate list.",cause:$,send:!0,alert:{level:i.Alert.Level.fatal,description:i.Alert.Description.bad_certificate}})}var V=_.entity===i.ConnectionEnd.client;(V||_.verifyClient===!0)&&K.length===0?_.error(_,{message:V?"No server certificate provided.":"No client certificate provided.",send:!0,alert:{level:i.Alert.Level.fatal,description:i.Alert.Description.illegal_parameter}}):K.length===0?_.expect=V?A:E:(V?_.session.serverCertificate=K[0]:_.session.clientCertificate=K[0],i.verifyCertificateChain(_,K)&&(_.expect=V?A:E)),_.process()},i.handleServerKeyExchange=function(_,x,w){if(w>0)return _.error(_,{message:"Invalid key parameters. Only RSA is supported.",send:!0,alert:{level:i.Alert.Level.fatal,description:i.Alert.Description.unsupported_certificate}});_.expect=C,_.process()},i.handleClientKeyExchange=function(_,x,w){if(w<48)return _.error(_,{message:"Invalid key parameters. Only RSA is supported.",send:!0,alert:{level:i.Alert.Level.fatal,description:i.Alert.Description.unsupported_certificate}});var d=x.fragment,I={enc_pre_master_secret:u(d,2).getBytes()},O=null;if(_.getPrivateKey)try{O=_.getPrivateKey(_,_.session.serverCertificate),O=t.pki.privateKeyFromPem(O)}catch(V){_.error(_,{message:"Could not get private key.",cause:V,send:!0,alert:{level:i.Alert.Level.fatal,description:i.Alert.Description.internal_error}})}if(O===null)return _.error(_,{message:"No private key set.",send:!0,alert:{level:i.Alert.Level.fatal,description:i.Alert.Description.internal_error}});try{var P=_.session.sp;P.pre_master_secret=O.decrypt(I.enc_pre_master_secret);var K=_.session.clientHelloVersion;if(K.major!==P.pre_master_secret.charCodeAt(0)||K.minor!==P.pre_master_secret.charCodeAt(1))throw new Error("TLS version rollback attack detected.")}catch{P.pre_master_secret=t.random.getBytes(48)}_.expect=R,_.session.clientCertificate!==null&&(_.expect=b),_.process()},i.handleCertificateRequest=function(_,x,w){if(w<3)return _.error(_,{message:"Invalid CertificateRequest. Message too short.",send:!0,alert:{level:i.Alert.Level.fatal,description:i.Alert.Description.illegal_parameter}});var d=x.fragment,I={certificate_types:u(d,1),certificate_authorities:u(d,2)};_.session.certificateRequest=I,_.expect=p,_.process()},i.handleCertificateVerify=function(_,x,w){if(w<2)return _.error(_,{message:"Invalid CertificateVerify. Message too short.",send:!0,alert:{level:i.Alert.Level.fatal,description:i.Alert.Description.illegal_parameter}});var d=x.fragment;d.read-=4;var I=d.bytes();d.read+=4;var O={signature:u(d,2).getBytes()},P=t.util.createBuffer();P.putBuffer(_.session.md5.digest()),P.putBuffer(_.session.sha1.digest()),P=P.getBytes();try{var K=_.session.clientCertificate;if(!K.publicKey.verify(P,O.signature,"NONE"))throw new Error("CertificateVerify signature does not match.");_.session.md5.update(I),_.session.sha1.update(I)}catch{return _.error(_,{message:"Bad signature in CertificateVerify.",send:!0,alert:{level:i.Alert.Level.fatal,description:i.Alert.Description.handshake_failure}})}_.expect=R,_.process()},i.handleServerHelloDone=function(_,x,w){if(w>0)return _.error(_,{message:"Invalid ServerHelloDone message. Invalid length.",send:!0,alert:{level:i.Alert.Level.fatal,description:i.Alert.Description.record_overflow}});if(_.serverCertificate===null){var d={message:"No server certificate provided. Not enough security.",send:!0,alert:{level:i.Alert.Level.fatal,description:i.Alert.Description.insufficient_security}},I=0,O=_.verify(_,d.alert.description,I,[]);if(O!==!0)return(O||O===0)&&(typeof O=="object"&&!t.util.isArray(O)?(O.message&&(d.message=O.message),O.alert&&(d.alert.description=O.alert)):typeof O=="number"&&(d.alert.description=O)),_.error(_,d)}_.session.certificateRequest!==null&&(x=i.createRecord(_,{type:i.ContentType.handshake,data:i.createCertificate(_)}),i.queue(_,x)),x=i.createRecord(_,{type:i.ContentType.handshake,data:i.createClientKeyExchange(_)}),i.queue(_,x),_.expect=S;var P=function(K,V){K.session.certificateRequest!==null&&K.session.clientCertificate!==null&&i.queue(K,i.createRecord(K,{type:i.ContentType.handshake,data:i.createCertificateVerify(K,V)})),i.queue(K,i.createRecord(K,{type:i.ContentType.change_cipher_spec,data:i.createChangeCipherSpec()})),K.state.pending=i.createConnectionState(K),K.state.current.write=K.state.pending.write,i.queue(K,i.createRecord(K,{type:i.ContentType.handshake,data:i.createFinished(K)})),K.expect=o,i.flush(K),K.process()};if(_.session.certificateRequest===null||_.session.clientCertificate===null)return P(_,null);i.getClientSignature(_,P)},i.handleChangeCipherSpec=function(_,x){if(x.fragment.getByte()!==1)return _.error(_,{message:"Invalid ChangeCipherSpec message received.",send:!0,alert:{level:i.Alert.Level.fatal,description:i.Alert.Description.illegal_parameter}});var w=_.entity===i.ConnectionEnd.client;(_.session.resuming&&w||!_.session.resuming&&!w)&&(_.state.pending=i.createConnectionState(_)),_.state.current.read=_.state.pending.read,(!_.session.resuming&&w||_.session.resuming&&!w)&&(_.state.pending=null),_.expect=w?m:T,_.process()},i.handleFinished=function(_,x,w){var d=x.fragment;d.read-=4;var I=d.bytes();d.read+=4;var O=x.fragment.getBytes();d=t.util.createBuffer(),d.putBuffer(_.session.md5.digest()),d.putBuffer(_.session.sha1.digest());var P=_.entity===i.ConnectionEnd.client,K=P?"server finished":"client finished",V=_.session.sp,$=12,M=e;if(d=M(V.master_secret,K,d.getBytes(),$),d.getBytes()!==O)return _.error(_,{message:"Invalid verify_data in Finished message.",send:!0,alert:{level:i.Alert.Level.fatal,description:i.Alert.Description.decrypt_error}});_.session.md5.update(I),_.session.sha1.update(I),(_.session.resuming&&P||!_.session.resuming&&!P)&&(i.queue(_,i.createRecord(_,{type:i.ContentType.change_cipher_spec,data:i.createChangeCipherSpec()})),_.state.current.write=_.state.pending.write,_.state.pending=null,i.queue(_,i.createRecord(_,{type:i.ContentType.handshake,data:i.createFinished(_)}))),_.expect=P?g:h,_.handshaking=!1,++_.handshakes,_.peerCertificate=P?_.session.serverCertificate:_.session.clientCertificate,i.flush(_),_.isConnected=!0,_.connected(_),_.process()},i.handleAlert=function(_,x){var w=x.fragment,d={level:w.getByte(),description:w.getByte()},I;switch(d.description){case i.Alert.Description.close_notify:I="Connection closed.";break;case i.Alert.Description.unexpected_message:I="Unexpected message.";break;case i.Alert.Description.bad_record_mac:I="Bad record MAC.";break;case i.Alert.Description.decryption_failed:I="Decryption failed.";break;case i.Alert.Description.record_overflow:I="Record overflow.";break;case i.Alert.Description.decompression_failure:I="Decompression failed.";break;case i.Alert.Description.handshake_failure:I="Handshake failure.";break;case i.Alert.Description.bad_certificate:I="Bad certificate.";break;case i.Alert.Description.unsupported_certificate:I="Unsupported certificate.";break;case i.Alert.Description.certificate_revoked:I="Certificate revoked.";break;case i.Alert.Description.certificate_expired:I="Certificate expired.";break;case i.Alert.Description.certificate_unknown:I="Certificate unknown.";break;case i.Alert.Description.illegal_parameter:I="Illegal parameter.";break;case i.Alert.Description.unknown_ca:I="Unknown certificate authority.";break;case i.Alert.Description.access_denied:I="Access denied.";break;case i.Alert.Description.decode_error:I="Decode error.";break;case i.Alert.Description.decrypt_error:I="Decrypt error.";break;case i.Alert.Description.export_restriction:I="Export restriction.";break;case i.Alert.Description.protocol_version:I="Unsupported protocol version.";break;case i.Alert.Description.insufficient_security:I="Insufficient security.";break;case i.Alert.Description.internal_error:I="Internal error.";break;case i.Alert.Description.user_canceled:I="User canceled.";break;case i.Alert.Description.no_renegotiation:I="Renegotiation not supported.";break;default:I="Unknown error.";break}if(d.description===i.Alert.Description.close_notify)return _.close();_.error(_,{message:I,send:!1,origin:_.entity===i.ConnectionEnd.client?"server":"client",alert:d}),_.process()},i.handleHandshake=function(_,x){var w=x.fragment,d=w.getByte(),I=w.getInt24();if(I>w.length())return _.fragmented=x,x.fragment=t.util.createBuffer(),w.read-=4,_.process();_.fragmented=null,w.read-=4;var O=w.bytes(I+4);w.read+=4,d in ye[_.entity][_.expect]?(_.entity===i.ConnectionEnd.server&&!_.open&&!_.fail&&(_.handshaking=!0,_.session={version:null,extensions:{server_name:{serverNameList:[]}},cipherSuite:null,compressionMethod:null,serverCertificate:null,clientCertificate:null,md5:t.md.md5.create(),sha1:t.md.sha1.create()}),d!==i.HandshakeType.hello_request&&d!==i.HandshakeType.certificate_verify&&d!==i.HandshakeType.finished&&(_.session.md5.update(O),_.session.sha1.update(O)),ye[_.entity][_.expect][d](_,x,I)):i.handleUnexpected(_,x)},i.handleApplicationData=function(_,x){_.data.putBuffer(x.fragment),_.dataReady(_),_.process()},i.handleHeartbeat=function(_,x){var w=x.fragment,d=w.getByte(),I=w.getInt16(),O=w.getBytes(I);if(d===i.HeartbeatMessageType.heartbeat_request){if(_.handshaking||I>O.length)return _.process();i.queue(_,i.createRecord(_,{type:i.ContentType.heartbeat,data:i.createHeartbeat(i.HeartbeatMessageType.heartbeat_response,O)})),i.flush(_)}else if(d===i.HeartbeatMessageType.heartbeat_response){if(O!==_.expectedHeartbeatPayload)return _.process();_.heartbeatReceived&&_.heartbeatReceived(_,t.util.createBuffer(O))}_.process()};var y=0,f=1,A=2,C=3,p=4,o=5,m=6,g=7,S=8,a=0,v=1,E=2,b=3,R=4,T=5,h=6,l=i.handleUnexpected,B=i.handleChangeCipherSpec,N=i.handleAlert,F=i.handleHandshake,L=i.handleApplicationData,q=i.handleHeartbeat,j=[];j[i.ConnectionEnd.client]=[[l,N,F,l,q],[l,N,F,l,q],[l,N,F,l,q],[l,N,F,l,q],[l,N,F,l,q],[B,N,l,l,q],[l,N,F,l,q],[l,N,F,L,q],[l,N,F,l,q]],j[i.ConnectionEnd.server]=[[l,N,F,l,q],[l,N,F,l,q],[l,N,F,l,q],[l,N,F,l,q],[B,N,l,l,q],[l,N,F,l,q],[l,N,F,L,q],[l,N,F,l,q]];var H=i.handleHelloRequest,Q=i.handleServerHello,J=i.handleCertificate,X=i.handleServerKeyExchange,re=i.handleCertificateRequest,se=i.handleServerHelloDone,de=i.handleFinished,ye=[];ye[i.ConnectionEnd.client]=[[l,l,Q,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l],[H,l,l,l,l,l,l,l,l,l,l,J,X,re,se,l,l,l,l,l,l],[H,l,l,l,l,l,l,l,l,l,l,l,X,re,se,l,l,l,l,l,l],[H,l,l,l,l,l,l,l,l,l,l,l,l,re,se,l,l,l,l,l,l],[H,l,l,l,l,l,l,l,l,l,l,l,l,l,se,l,l,l,l,l,l],[H,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l],[H,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,de],[H,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l],[H,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l]];var _e=i.handleClientHello,W=i.handleClientKeyExchange,he=i.handleCertificateVerify;ye[i.ConnectionEnd.server]=[[l,_e,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l],[l,l,l,l,l,l,l,l,l,l,l,J,l,l,l,l,l,l,l,l,l],[l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,W,l,l,l,l],[l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,he,l,l,l,l,l],[l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l],[l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,de],[l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l],[l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l]],i.generateKeys=function(_,x){var w=e,d=x.client_random+x.server_random;_.session.resuming||(x.master_secret=w(x.pre_master_secret,"master secret",d,48).bytes(),x.pre_master_secret=null),d=x.server_random+x.client_random;var I=2*x.mac_key_length+2*x.enc_key_length,O=_.version.major===i.Versions.TLS_1_0.major&&_.version.minor===i.Versions.TLS_1_0.minor;O&&(I+=2*x.fixed_iv_length);var P=w(x.master_secret,"key expansion",d,I),K={client_write_MAC_key:P.getBytes(x.mac_key_length),server_write_MAC_key:P.getBytes(x.mac_key_length),client_write_key:P.getBytes(x.enc_key_length),server_write_key:P.getBytes(x.enc_key_length)};return O&&(K.client_write_IV=P.getBytes(x.fixed_iv_length),K.server_write_IV=P.getBytes(x.fixed_iv_length)),K},i.createConnectionState=function(_){var x=_.entity===i.ConnectionEnd.client,w=function(){var O={sequenceNumber:[0,0],macKey:null,macLength:0,macFunction:null,cipherState:null,cipherFunction:function(P){return!0},compressionState:null,compressFunction:function(P){return!0},updateSequenceNumber:function(){O.sequenceNumber[1]===4294967295?(O.sequenceNumber[1]=0,++O.sequenceNumber[0]):++O.sequenceNumber[1]}};return O},d={read:w(),write:w()};if(d.read.update=function(O,P){return d.read.cipherFunction(P,d.read)?d.read.compressFunction(O,P,d.read)||O.error(O,{message:"Could not decompress record.",send:!0,alert:{level:i.Alert.Level.fatal,description:i.Alert.Description.decompression_failure}}):O.error(O,{message:"Could not decrypt record or bad MAC.",send:!0,alert:{level:i.Alert.Level.fatal,description:i.Alert.Description.bad_record_mac}}),!O.fail},d.write.update=function(O,P){return d.write.compressFunction(O,P,d.write)?d.write.cipherFunction(P,d.write)||O.error(O,{message:"Could not encrypt record.",send:!1,alert:{level:i.Alert.Level.fatal,description:i.Alert.Description.internal_error}}):O.error(O,{message:"Could not compress record.",send:!1,alert:{level:i.Alert.Level.fatal,description:i.Alert.Description.internal_error}}),!O.fail},_.session){var I=_.session.sp;switch(_.session.cipherSuite.initSecurityParameters(I),I.keys=i.generateKeys(_,I),d.read.macKey=x?I.keys.server_write_MAC_key:I.keys.client_write_MAC_key,d.write.macKey=x?I.keys.client_write_MAC_key:I.keys.server_write_MAC_key,_.session.cipherSuite.initConnectionState(d,_,I),I.compression_algorithm){case i.CompressionMethod.none:break;case i.CompressionMethod.deflate:d.read.compressFunction=s,d.write.compressFunction=n;break;default:throw new Error("Unsupported compression algorithm.")}}return d},i.createRandom=function(){var _=new Date,x=+_+_.getTimezoneOffset()*6e4,w=t.util.createBuffer();return w.putInt32(x),w.putBytes(t.random.getBytes(28)),w},i.createRecord=function(_,x){if(!x.data)return null;var w={type:x.type,version:{major:_.version.major,minor:_.version.minor},length:x.data.length(),fragment:x.data};return w},i.createAlert=function(_,x){var w=t.util.createBuffer();return w.putByte(x.level),w.putByte(x.description),i.createRecord(_,{type:i.ContentType.alert,data:w})},i.createClientHello=function(_){_.session.clientHelloVersion={major:_.version.major,minor:_.version.minor};for(var x=t.util.createBuffer(),w=0;w<_.cipherSuites.length;++w){var d=_.cipherSuites[w];x.putByte(d.id[0]),x.putByte(d.id[1])}var I=x.length(),O=t.util.createBuffer();O.putByte(i.CompressionMethod.none);var P=O.length(),K=t.util.createBuffer();if(_.virtualHost){var V=t.util.createBuffer();V.putByte(0),V.putByte(0);var $=t.util.createBuffer();$.putByte(0),c($,2,t.util.createBuffer(_.virtualHost));var M=t.util.createBuffer();c(M,2,$),c(V,2,M),K.putBuffer(V)}var G=K.length();G>0&&(G+=2);var Y=_.session.id,ne=Y.length+1+2+4+28+2+I+1+P+G,te=t.util.createBuffer();return te.putByte(i.HandshakeType.client_hello),te.putInt24(ne),te.putByte(_.version.major),te.putByte(_.version.minor),te.putBytes(_.session.sp.client_random),c(te,1,t.util.createBuffer(Y)),c(te,2,x),c(te,1,O),G>0&&c(te,2,K),te},i.createServerHello=function(_){var x=_.session.id,w=x.length+1+2+4+28+2+1,d=t.util.createBuffer();return d.putByte(i.HandshakeType.server_hello),d.putInt24(w),d.putByte(_.version.major),d.putByte(_.version.minor),d.putBytes(_.session.sp.server_random),c(d,1,t.util.createBuffer(x)),d.putByte(_.session.cipherSuite.id[0]),d.putByte(_.session.cipherSuite.id[1]),d.putByte(_.session.compressionMethod),d},i.createCertificate=function(_){var x=_.entity===i.ConnectionEnd.client,w=null;if(_.getCertificate){var d;x?d=_.session.certificateRequest:d=_.session.extensions.server_name.serverNameList,w=_.getCertificate(_,d)}var I=t.util.createBuffer();if(w!==null)try{t.util.isArray(w)||(w=[w]);for(var O=null,P=0;P<w.length;++P){var K=t.pem.decode(w[P])[0];if(K.type!=="CERTIFICATE"&&K.type!=="X509 CERTIFICATE"&&K.type!=="TRUSTED CERTIFICATE"){var V=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw V.headerType=K.type,V}if(K.procType&&K.procType.type==="ENCRYPTED")throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var $=t.util.createBuffer(K.body);O===null&&(O=t.asn1.fromDer($.bytes(),!1));var M=t.util.createBuffer();c(M,3,$),I.putBuffer(M)}w=t.pki.certificateFromAsn1(O),x?_.session.clientCertificate=w:_.session.serverCertificate=w}catch(ne){return _.error(_,{message:"Could not send certificate list.",cause:ne,send:!0,alert:{level:i.Alert.Level.fatal,description:i.Alert.Description.bad_certificate}})}var G=3+I.length(),Y=t.util.createBuffer();return Y.putByte(i.HandshakeType.certificate),Y.putInt24(G),c(Y,3,I),Y},i.createClientKeyExchange=function(_){var x=t.util.createBuffer();x.putByte(_.session.clientHelloVersion.major),x.putByte(_.session.clientHelloVersion.minor),x.putBytes(t.random.getBytes(46));var w=_.session.sp;w.pre_master_secret=x.getBytes();var d=_.session.serverCertificate.publicKey;x=d.encrypt(w.pre_master_secret);var I=x.length+2,O=t.util.createBuffer();return O.putByte(i.HandshakeType.client_key_exchange),O.putInt24(I),O.putInt16(x.length),O.putBytes(x),O},i.createServerKeyExchange=function(_){var x=t.util.createBuffer();return x},i.getClientSignature=function(_,x){var w=t.util.createBuffer();w.putBuffer(_.session.md5.digest()),w.putBuffer(_.session.sha1.digest()),w=w.getBytes(),_.getSignature=_.getSignature||function(d,I,O){var P=null;if(d.getPrivateKey)try{P=d.getPrivateKey(d,d.session.clientCertificate),P=t.pki.privateKeyFromPem(P)}catch(K){d.error(d,{message:"Could not get private key.",cause:K,send:!0,alert:{level:i.Alert.Level.fatal,description:i.Alert.Description.internal_error}})}P===null?d.error(d,{message:"No private key set.",send:!0,alert:{level:i.Alert.Level.fatal,description:i.Alert.Description.internal_error}}):I=P.sign(I,null),O(d,I)},_.getSignature(_,w,x)},i.createCertificateVerify=function(_,x){var w=x.length+2,d=t.util.createBuffer();return d.putByte(i.HandshakeType.certificate_verify),d.putInt24(w),d.putInt16(x.length),d.putBytes(x),d},i.createCertificateRequest=function(_){var x=t.util.createBuffer();x.putByte(1);var w=t.util.createBuffer();for(var d in _.caStore.certs){var I=_.caStore.certs[d],O=t.pki.distinguishedNameToAsn1(I.subject),P=t.asn1.toDer(O);w.putInt16(P.length()),w.putBuffer(P)}var K=1+x.length()+2+w.length(),V=t.util.createBuffer();return V.putByte(i.HandshakeType.certificate_request),V.putInt24(K),c(V,1,x),c(V,2,w),V},i.createServerHelloDone=function(_){var x=t.util.createBuffer();return x.putByte(i.HandshakeType.server_hello_done),x.putInt24(0),x},i.createChangeCipherSpec=function(){var _=t.util.createBuffer();return _.putByte(1),_},i.createFinished=function(_){var x=t.util.createBuffer();x.putBuffer(_.session.md5.digest()),x.putBuffer(_.session.sha1.digest());var w=_.entity===i.ConnectionEnd.client,d=_.session.sp,I=12,O=e,P=w?"client finished":"server finished";x=O(d.master_secret,P,x.getBytes(),I);var K=t.util.createBuffer();return K.putByte(i.HandshakeType.finished),K.putInt24(x.length()),K.putBuffer(x),K},i.createHeartbeat=function(_,x,w){typeof w>"u"&&(w=x.length);var d=t.util.createBuffer();d.putByte(_),d.putInt16(w),d.putBytes(x);var I=d.length(),O=Math.max(16,I-w-3);return d.putBytes(t.random.getBytes(O)),d},i.queue=function(_,x){if(x&&!(x.fragment.length()===0&&(x.type===i.ContentType.handshake||x.type===i.ContentType.alert||x.type===i.ContentType.change_cipher_spec))){if(x.type===i.ContentType.handshake){var w=x.fragment.bytes();_.session.md5.update(w),_.session.sha1.update(w),w=null}var d;if(x.fragment.length()<=i.MaxFragment)d=[x];else{d=[];for(var I=x.fragment.bytes();I.length>i.MaxFragment;)d.push(i.createRecord(_,{type:x.type,data:t.util.createBuffer(I.slice(0,i.MaxFragment))})),I=I.slice(i.MaxFragment);I.length>0&&d.push(i.createRecord(_,{type:x.type,data:t.util.createBuffer(I)}))}for(var O=0;O<d.length&&!_.fail;++O){var P=d[O],K=_.state.current.write;K.update(_,P)&&_.records.push(P)}}},i.flush=function(_){for(var x=0;x<_.records.length;++x){var w=_.records[x];_.tlsData.putByte(w.type),_.tlsData.putByte(w.version.major),_.tlsData.putByte(w.version.minor),_.tlsData.putInt16(w.fragment.length()),_.tlsData.putBuffer(_.records[x].fragment)}return _.records=[],_.tlsDataReady(_)};var ie=function(_){switch(_){case!0:return!0;case t.pki.certificateError.bad_certificate:return i.Alert.Description.bad_certificate;case t.pki.certificateError.unsupported_certificate:return i.Alert.Description.unsupported_certificate;case t.pki.certificateError.certificate_revoked:return i.Alert.Description.certificate_revoked;case t.pki.certificateError.certificate_expired:return i.Alert.Description.certificate_expired;case t.pki.certificateError.certificate_unknown:return i.Alert.Description.certificate_unknown;case t.pki.certificateError.unknown_ca:return i.Alert.Description.unknown_ca;default:return i.Alert.Description.bad_certificate}},ke=function(_){switch(_){case!0:return!0;case i.Alert.Description.bad_certificate:return t.pki.certificateError.bad_certificate;case i.Alert.Description.unsupported_certificate:return t.pki.certificateError.unsupported_certificate;case i.Alert.Description.certificate_revoked:return t.pki.certificateError.certificate_revoked;case i.Alert.Description.certificate_expired:return t.pki.certificateError.certificate_expired;case i.Alert.Description.certificate_unknown:return t.pki.certificateError.certificate_unknown;case i.Alert.Description.unknown_ca:return t.pki.certificateError.unknown_ca;default:return t.pki.certificateError.bad_certificate}};i.verifyCertificateChain=function(_,x){try{var w={};for(var d in _.verifyOptions)w[d]=_.verifyOptions[d];w.verify=function(O,P,K){var V=ie(O),$=_.verify(_,O,P,K);if($!==!0){if(typeof $=="object"&&!t.util.isArray($)){var M=new Error("The application rejected the certificate.");throw M.send=!0,M.alert={level:i.Alert.Level.fatal,description:i.Alert.Description.bad_certificate},$.message&&(M.message=$.message),$.alert&&(M.alert.description=$.alert),M}$!==O&&($=ke($))}return $},t.pki.verifyCertificateChain(_.caStore,x,w)}catch(O){var I=O;(typeof I!="object"||t.util.isArray(I))&&(I={send:!0,alert:{level:i.Alert.Level.fatal,description:ie(O)}}),"send"in I||(I.send=!0),"alert"in I||(I.alert={level:i.Alert.Level.fatal,description:ie(I.error)}),_.error(_,I)}return!_.fail},i.createSessionCache=function(_,x){var w=null;if(_&&_.getSession&&_.setSession&&_.order)w=_;else{w={},w.cache=_||{},w.capacity=Math.max(x||100,1),w.order=[];for(var d in _)w.order.length<=x?w.order.push(d):delete _[d];w.getSession=function(I){var O=null,P=null;if(I?P=t.util.bytesToHex(I):w.order.length>0&&(P=w.order[0]),P!==null&&P in w.cache){O=w.cache[P],delete w.cache[P];for(var K in w.order)if(w.order[K]===P){w.order.splice(K,1);break}}return O},w.setSession=function(I,O){if(w.order.length===w.capacity){var P=w.order.shift();delete w.cache[P]}var P=t.util.bytesToHex(I);w.order.push(P),w.cache[P]=O}}return w},i.createConnection=function(_){var x=null;_.caStore?t.util.isArray(_.caStore)?x=t.pki.createCaStore(_.caStore):x=_.caStore:x=t.pki.createCaStore();var w=_.cipherSuites||null;if(w===null){w=[];for(var d in i.CipherSuites)w.push(i.CipherSuites[d])}var I=_.server?i.ConnectionEnd.server:i.ConnectionEnd.client,O=_.sessionCache?i.createSessionCache(_.sessionCache):null,P={version:{major:i.Version.major,minor:i.Version.minor},entity:I,sessionId:_.sessionId,caStore:x,sessionCache:O,cipherSuites:w,connected:_.connected,virtualHost:_.virtualHost||null,verifyClient:_.verifyClient||!1,verify:_.verify||function(M,G,Y,ne){return G},verifyOptions:_.verifyOptions||{},getCertificate:_.getCertificate||null,getPrivateKey:_.getPrivateKey||null,getSignature:_.getSignature||null,input:t.util.createBuffer(),tlsData:t.util.createBuffer(),data:t.util.createBuffer(),tlsDataReady:_.tlsDataReady,dataReady:_.dataReady,heartbeatReceived:_.heartbeatReceived,closed:_.closed,error:function(M,G){G.origin=G.origin||(M.entity===i.ConnectionEnd.client?"client":"server"),G.send&&(i.queue(M,i.createAlert(M,G.alert)),i.flush(M));var Y=G.fatal!==!1;Y&&(M.fail=!0),_.error(M,G),Y&&M.close(!1)},deflate:_.deflate||null,inflate:_.inflate||null};P.reset=function(M){P.version={major:i.Version.major,minor:i.Version.minor},P.record=null,P.session=null,P.peerCertificate=null,P.state={pending:null,current:null},P.expect=P.entity===i.ConnectionEnd.client?y:a,P.fragmented=null,P.records=[],P.open=!1,P.handshakes=0,P.handshaking=!1,P.isConnected=!1,P.fail=!(M||typeof M>"u"),P.input.clear(),P.tlsData.clear(),P.data.clear(),P.state.current=i.createConnectionState(P)},P.reset();var K=function(M,G){var Y=G.type-i.ContentType.change_cipher_spec,ne=j[M.entity][M.expect];Y in ne?ne[Y](M,G):i.handleUnexpected(M,G)},V=function(M){var G=0,Y=M.input,ne=Y.length();if(ne<5)G=5-ne;else{M.record={type:Y.getByte(),version:{major:Y.getByte(),minor:Y.getByte()},length:Y.getInt16(),fragment:t.util.createBuffer(),ready:!1};var te=M.record.version.major===M.version.major;te&&M.session&&M.session.version&&(te=M.record.version.minor===M.version.minor),te||M.error(M,{message:"Incompatible TLS version.",send:!0,alert:{level:i.Alert.Level.fatal,description:i.Alert.Description.protocol_version}})}return G},$=function(M){var G=0,Y=M.input,ne=Y.length();if(ne<M.record.length)G=M.record.length-ne;else{M.record.fragment.putBytes(Y.getBytes(M.record.length)),Y.compact();var te=M.state.current.read;te.update(M,M.record)&&(M.fragmented!==null&&(M.fragmented.type===M.record.type?(M.fragmented.fragment.putBuffer(M.record.fragment),M.record=M.fragmented):M.error(M,{message:"Invalid fragmented record.",send:!0,alert:{level:i.Alert.Level.fatal,description:i.Alert.Description.unexpected_message}})),M.record.ready=!0)}return G};return P.handshake=function(M){if(P.entity!==i.ConnectionEnd.client)P.error(P,{message:"Cannot initiate handshake as a server.",fatal:!1});else if(P.handshaking)P.error(P,{message:"Handshake already in progress.",fatal:!1});else{P.fail&&!P.open&&P.handshakes===0&&(P.fail=!1),P.handshaking=!0,M=M||"";var G=null;M.length>0&&(P.sessionCache&&(G=P.sessionCache.getSession(M)),G===null&&(M="")),M.length===0&&P.sessionCache&&(G=P.sessionCache.getSession(),G!==null&&(M=G.id)),P.session={id:M,version:null,cipherSuite:null,compressionMethod:null,serverCertificate:null,certificateRequest:null,clientCertificate:null,sp:{},md5:t.md.md5.create(),sha1:t.md.sha1.create()},G&&(P.version=G.version,P.session.sp=G.sp),P.session.sp.client_random=i.createRandom().getBytes(),P.open=!0,i.queue(P,i.createRecord(P,{type:i.ContentType.handshake,data:i.createClientHello(P)})),i.flush(P)}},P.process=function(M){var G=0;return M&&P.input.putBytes(M),P.fail||(P.record!==null&&P.record.ready&&P.record.fragment.isEmpty()&&(P.record=null),P.record===null&&(G=V(P)),!P.fail&&P.record!==null&&!P.record.ready&&(G=$(P)),!P.fail&&P.record!==null&&P.record.ready&&K(P,P.record)),G},P.prepare=function(M){return i.queue(P,i.createRecord(P,{type:i.ContentType.application_data,data:t.util.createBuffer(M)})),i.flush(P)},P.prepareHeartbeatRequest=function(M,G){return M instanceof t.util.ByteBuffer&&(M=M.bytes()),typeof G>"u"&&(G=M.length),P.expectedHeartbeatPayload=M,i.queue(P,i.createRecord(P,{type:i.ContentType.heartbeat,data:i.createHeartbeat(i.HeartbeatMessageType.heartbeat_request,M,G)})),i.flush(P)},P.close=function(M){if(!P.fail&&P.sessionCache&&P.session){var G={id:P.session.id,version:P.session.version,sp:P.session.sp};G.sp.keys=null,P.sessionCache.setSession(G.id,G)}P.open&&(P.open=!1,P.input.clear(),(P.isConnected||P.handshaking)&&(P.isConnected=P.handshaking=!1,i.queue(P,i.createAlert(P,{level:i.Alert.Level.warning,description:i.Alert.Description.close_notify})),i.flush(P)),P.closed(P)),P.reset(M)},P},fa=t.tls=t.tls||{};for(var fe in i)typeof i[fe]!="function"&&(t.tls[fe]=i[fe]);return t.tls.prf_tls1=e,t.tls.hmac_sha1=r,t.tls.createSessionCache=i.createSessionCache,t.tls.createConnection=i.createConnection,fa}var Mo;function id(){if(Mo)return Vi.exports;Mo=1;var t=me();sr(),kc();var e=Vi.exports=t.tls;e.CipherSuites.TLS_RSA_WITH_AES_128_CBC_SHA={id:[0,47],name:"TLS_RSA_WITH_AES_128_CBC_SHA",initSecurityParameters:function(y){y.bulk_cipher_algorithm=e.BulkCipherAlgorithm.aes,y.cipher_type=e.CipherType.block,y.enc_key_length=16,y.block_length=16,y.fixed_iv_length=16,y.record_iv_length=16,y.mac_algorithm=e.MACAlgorithm.hmac_sha1,y.mac_length=20,y.mac_key_length=20},initConnectionState:r},e.CipherSuites.TLS_RSA_WITH_AES_256_CBC_SHA={id:[0,53],name:"TLS_RSA_WITH_AES_256_CBC_SHA",initSecurityParameters:function(y){y.bulk_cipher_algorithm=e.BulkCipherAlgorithm.aes,y.cipher_type=e.CipherType.block,y.enc_key_length=32,y.block_length=16,y.fixed_iv_length=16,y.record_iv_length=16,y.mac_algorithm=e.MACAlgorithm.hmac_sha1,y.mac_length=20,y.mac_key_length=20},initConnectionState:r};function r(y,f,A){var C=f.entity===t.tls.ConnectionEnd.client;y.read.cipherState={init:!1,cipher:t.cipher.createDecipher("AES-CBC",C?A.keys.server_write_key:A.keys.client_write_key),iv:C?A.keys.server_write_IV:A.keys.client_write_IV},y.write.cipherState={init:!1,cipher:t.cipher.createCipher("AES-CBC",C?A.keys.client_write_key:A.keys.server_write_key),iv:C?A.keys.client_write_IV:A.keys.server_write_IV},y.read.cipherFunction=c,y.write.cipherFunction=n,y.read.macLength=y.write.macLength=A.mac_length,y.read.macFunction=y.write.macFunction=e.hmac_sha1}function n(y,f){var A=!1,C=f.macFunction(f.macKey,f.sequenceNumber,y);y.fragment.putBytes(C),f.updateSequenceNumber();var p;y.version.minor===e.Versions.TLS_1_0.minor?p=f.cipherState.init?null:f.cipherState.iv:p=t.random.getBytesSync(16),f.cipherState.init=!0;var o=f.cipherState.cipher;return o.start({iv:p}),y.version.minor>=e.Versions.TLS_1_1.minor&&o.output.putBytes(p),o.update(y.fragment),o.finish(s)&&(y.fragment=o.output,y.length=y.fragment.length(),A=!0),A}function s(y,f,A){if(!A){var C=y-f.length()%y;f.fillWithByte(C-1,C)}return!0}function u(y,f,A){var C=!0;if(A){for(var p=f.length(),o=f.last(),m=p-1-o;m<p-1;++m)C=C&&f.at(m)==o;C&&f.truncate(o+1)}return C}function c(y,f){var A=!1,C;y.version.minor===e.Versions.TLS_1_0.minor?C=f.cipherState.init?null:f.cipherState.iv:C=y.fragment.getBytes(16),f.cipherState.init=!0;var p=f.cipherState.cipher;p.start({iv:C}),p.update(y.fragment),A=p.finish(u);var o=f.macLength,m=t.random.getBytesSync(o),g=p.output.length();g>=o?(y.fragment=p.output.getBytes(g-o),m=p.output.getBytes(o)):y.fragment=p.output.getBytes(),y.fragment=t.util.createBuffer(y.fragment),y.length=y.fragment.length();var S=f.macFunction(f.macKey,f.sequenceNumber,y);return f.updateSequenceNumber(),A=i(f.macKey,m,S)&&A,A}function i(y,f,A){var C=t.hmac.create();return C.start("SHA1",y),C.update(f),f=C.digest().getBytes(),C.start(null,null),C.update(A),A=C.digest().getBytes(),f===A}return Vi.exports}var da={exports:{}},qo;function Lc(){if(qo)return da.exports;qo=1;var t=me();Ot(),Ae();var e=da.exports=t.sha512=t.sha512||{};t.md.sha512=t.md.algorithms.sha512=e;var r=t.sha384=t.sha512.sha384=t.sha512.sha384||{};r.create=function(){return e.create("SHA-384")},t.md.sha384=t.md.algorithms.sha384=r,t.sha512.sha256=t.sha512.sha256||{create:function(){return e.create("SHA-512/256")}},t.md["sha512/256"]=t.md.algorithms["sha512/256"]=t.sha512.sha256,t.sha512.sha224=t.sha512.sha224||{create:function(){return e.create("SHA-512/224")}},t.md["sha512/224"]=t.md.algorithms["sha512/224"]=t.sha512.sha224,e.create=function(f){if(s||i(),typeof f>"u"&&(f="SHA-512"),!(f in c))throw new Error("Invalid SHA-512 algorithm: "+f);for(var A=c[f],C=null,p=t.util.createBuffer(),o=new Array(80),m=0;m<80;++m)o[m]=new Array(2);var g=64;switch(f){case"SHA-384":g=48;break;case"SHA-512/256":g=32;break;case"SHA-512/224":g=28;break}var S={algorithm:f.replace("-","").toLowerCase(),blockLength:128,digestLength:g,messageLength:0,fullMessageLength:null,messageLengthSize:16};return S.start=function(){S.messageLength=0,S.fullMessageLength=S.messageLength128=[];for(var a=S.messageLengthSize/4,v=0;v<a;++v)S.fullMessageLength.push(0);p=t.util.createBuffer(),C=new Array(A.length);for(var v=0;v<A.length;++v)C[v]=A[v].slice(0);return S},S.start(),S.update=function(a,v){v==="utf8"&&(a=t.util.encodeUtf8(a));var E=a.length;S.messageLength+=E,E=[E/4294967296>>>0,E>>>0];for(var b=S.fullMessageLength.length-1;b>=0;--b)S.fullMessageLength[b]+=E[1],E[1]=E[0]+(S.fullMessageLength[b]/4294967296>>>0),S.fullMessageLength[b]=S.fullMessageLength[b]>>>0,E[0]=E[1]/4294967296>>>0;return p.putBytes(a),y(C,o,p),(p.read>2048||p.length()===0)&&p.compact(),S},S.digest=function(){var a=t.util.createBuffer();a.putBytes(p.bytes());var v=S.fullMessageLength[S.fullMessageLength.length-1]+S.messageLengthSize,E=v&S.blockLength-1;a.putBytes(n.substr(0,S.blockLength-E));for(var b,R,T=S.fullMessageLength[0]*8,h=0;h<S.fullMessageLength.length-1;++h)b=S.fullMessageLength[h+1]*8,R=b/4294967296>>>0,T+=R,a.putInt32(T>>>0),T=b>>>0;a.putInt32(T);for(var l=new Array(C.length),h=0;h<C.length;++h)l[h]=C[h].slice(0);y(l,o,a);var B=t.util.createBuffer(),N;f==="SHA-512"?N=l.length:f==="SHA-384"?N=l.length-2:N=l.length-4;for(var h=0;h<N;++h)B.putInt32(l[h][0]),(h!==N-1||f!=="SHA-512/224")&&B.putInt32(l[h][1]);return B},S};var n=null,s=!1,u=null,c=null;function i(){n=String.fromCharCode(128),n+=t.util.fillString(String.fromCharCode(0),128),u=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],c={},c["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],c["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],c["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],c["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],s=!0}function y(f,A,C){for(var p,o,m,g,S,a,v,E,b,R,T,h,l,B,N,F,L,q,j,H,Q,J,X,re,se,de,ye,_e,W,he,ie,ke,fe,_,x,w=C.length();w>=128;){for(W=0;W<16;++W)A[W][0]=C.getInt32()>>>0,A[W][1]=C.getInt32()>>>0;for(;W<80;++W)ke=A[W-2],he=ke[0],ie=ke[1],p=((he>>>19|ie<<13)^(ie>>>29|he<<3)^he>>>6)>>>0,o=((he<<13|ie>>>19)^(ie<<3|he>>>29)^(he<<26|ie>>>6))>>>0,_=A[W-15],he=_[0],ie=_[1],m=((he>>>1|ie<<31)^(he>>>8|ie<<24)^he>>>7)>>>0,g=((he<<31|ie>>>1)^(he<<24|ie>>>8)^(he<<25|ie>>>7))>>>0,fe=A[W-7],x=A[W-16],ie=o+fe[1]+g+x[1],A[W][0]=p+fe[0]+m+x[0]+(ie/4294967296>>>0)>>>0,A[W][1]=ie>>>0;for(l=f[0][0],B=f[0][1],N=f[1][0],F=f[1][1],L=f[2][0],q=f[2][1],j=f[3][0],H=f[3][1],Q=f[4][0],J=f[4][1],X=f[5][0],re=f[5][1],se=f[6][0],de=f[6][1],ye=f[7][0],_e=f[7][1],W=0;W<80;++W)v=((Q>>>14|J<<18)^(Q>>>18|J<<14)^(J>>>9|Q<<23))>>>0,E=((Q<<18|J>>>14)^(Q<<14|J>>>18)^(J<<23|Q>>>9))>>>0,b=(se^Q&(X^se))>>>0,R=(de^J&(re^de))>>>0,S=((l>>>28|B<<4)^(B>>>2|l<<30)^(B>>>7|l<<25))>>>0,a=((l<<4|B>>>28)^(B<<30|l>>>2)^(B<<25|l>>>7))>>>0,T=(l&N|L&(l^N))>>>0,h=(B&F|q&(B^F))>>>0,ie=_e+E+R+u[W][1]+A[W][1],p=ye+v+b+u[W][0]+A[W][0]+(ie/4294967296>>>0)>>>0,o=ie>>>0,ie=a+h,m=S+T+(ie/4294967296>>>0)>>>0,g=ie>>>0,ye=se,_e=de,se=X,de=re,X=Q,re=J,ie=H+o,Q=j+p+(ie/4294967296>>>0)>>>0,J=ie>>>0,j=L,H=q,L=N,q=F,N=l,F=B,ie=o+g,l=p+m+(ie/4294967296>>>0)>>>0,B=ie>>>0;ie=f[0][1]+B,f[0][0]=f[0][0]+l+(ie/4294967296>>>0)>>>0,f[0][1]=ie>>>0,ie=f[1][1]+F,f[1][0]=f[1][0]+N+(ie/4294967296>>>0)>>>0,f[1][1]=ie>>>0,ie=f[2][1]+q,f[2][0]=f[2][0]+L+(ie/4294967296>>>0)>>>0,f[2][1]=ie>>>0,ie=f[3][1]+H,f[3][0]=f[3][0]+j+(ie/4294967296>>>0)>>>0,f[3][1]=ie>>>0,ie=f[4][1]+J,f[4][0]=f[4][0]+Q+(ie/4294967296>>>0)>>>0,f[4][1]=ie>>>0,ie=f[5][1]+re,f[5][0]=f[5][0]+X+(ie/4294967296>>>0)>>>0,f[5][1]=ie>>>0,ie=f[6][1]+de,f[6][0]=f[6][0]+se+(ie/4294967296>>>0)>>>0,f[6][1]=ie>>>0,ie=f[7][1]+_e,f[7][0]=f[7][0]+ye+(ie/4294967296>>>0)>>>0,f[7][1]=ie>>>0,w-=128}}return da.exports}var _n={},Vo;function ad(){if(Vo)return _n;Vo=1;var t=me();Tt();var e=t.asn1;return _n.privateKeyValidator={name:"PrivateKeyInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},_n.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{tagClass:e.Class.UNIVERSAL,type:e.Type.BITSTRING,constructed:!1,composed:!0,captureBitStringValue:"ed25519PublicKey"}]},_n}var ha,Ko;function sd(){if(Ko)return ha;Ko=1;var t=me();ui(),yt(),Lc(),Ae();var e=ad(),r=e.publicKeyValidator,n=e.privateKeyValidator;if(typeof s>"u")var s=t.jsbn.BigInteger;var u=t.util.ByteBuffer,c=typeof Buffer>"u"?Uint8Array:Buffer;t.pki=t.pki||{},ha=t.pki.ed25519=t.ed25519=t.ed25519||{};var i=t.ed25519;i.constants={},i.constants.PUBLIC_KEY_BYTE_LENGTH=32,i.constants.PRIVATE_KEY_BYTE_LENGTH=64,i.constants.SEED_BYTE_LENGTH=32,i.constants.SIGN_BYTE_LENGTH=64,i.constants.HASH_BYTE_LENGTH=64,i.generateKeyPair=function(_){_=_||{};var x=_.seed;if(x===void 0)x=t.random.getBytesSync(i.constants.SEED_BYTE_LENGTH);else if(typeof x=="string"){if(x.length!==i.constants.SEED_BYTE_LENGTH)throw new TypeError('"seed" must be '+i.constants.SEED_BYTE_LENGTH+" bytes in length.")}else if(!(x instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, Uint8Array, or a binary string.');x=y({message:x,encoding:"binary"});for(var w=new c(i.constants.PUBLIC_KEY_BYTE_LENGTH),d=new c(i.constants.PRIVATE_KEY_BYTE_LENGTH),I=0;I<32;++I)d[I]=x[I];return v(w,d),{publicKey:w,privateKey:d}},i.privateKeyFromAsn1=function(_){var x={},w=[],d=t.asn1.validate(_,n,x,w);if(!d){var I=new Error("Invalid Key.");throw I.errors=w,I}var O=t.asn1.derToOid(x.privateKeyOid),P=t.oids.EdDSA25519;if(O!==P)throw new Error('Invalid OID "'+O+'"; OID must be "'+P+'".');var K=x.privateKey,V=y({message:t.asn1.fromDer(K).value,encoding:"binary"});return{privateKeyBytes:V}},i.publicKeyFromAsn1=function(_){var x={},w=[],d=t.asn1.validate(_,r,x,w);if(!d){var I=new Error("Invalid Key.");throw I.errors=w,I}var O=t.asn1.derToOid(x.publicKeyOid),P=t.oids.EdDSA25519;if(O!==P)throw new Error('Invalid OID "'+O+'"; OID must be "'+P+'".');var K=x.ed25519PublicKey;if(K.length!==i.constants.PUBLIC_KEY_BYTE_LENGTH)throw new Error("Key length is invalid.");return y({message:K,encoding:"binary"})},i.publicKeyFromPrivateKey=function(_){_=_||{};var x=y({message:_.privateKey,encoding:"binary"});if(x.length!==i.constants.PRIVATE_KEY_BYTE_LENGTH)throw new TypeError('"options.privateKey" must have a byte length of '+i.constants.PRIVATE_KEY_BYTE_LENGTH);for(var w=new c(i.constants.PUBLIC_KEY_BYTE_LENGTH),d=0;d<w.length;++d)w[d]=x[32+d];return w},i.sign=function(_){_=_||{};var x=y(_),w=y({message:_.privateKey,encoding:"binary"});if(w.length===i.constants.SEED_BYTE_LENGTH){var d=i.generateKeyPair({seed:w});w=d.privateKey}else if(w.length!==i.constants.PRIVATE_KEY_BYTE_LENGTH)throw new TypeError('"options.privateKey" must have a byte length of '+i.constants.SEED_BYTE_LENGTH+" or "+i.constants.PRIVATE_KEY_BYTE_LENGTH);var I=new c(i.constants.SIGN_BYTE_LENGTH+x.length);E(I,x,x.length,w);for(var O=new c(i.constants.SIGN_BYTE_LENGTH),P=0;P<O.length;++P)O[P]=I[P];return O},i.verify=function(_){_=_||{};var x=y(_);if(_.signature===void 0)throw new TypeError('"options.signature" must be a node.js Buffer, a Uint8Array, a forge ByteBuffer, or a binary string.');var w=y({message:_.signature,encoding:"binary"});if(w.length!==i.constants.SIGN_BYTE_LENGTH)throw new TypeError('"options.signature" must have a byte length of '+i.constants.SIGN_BYTE_LENGTH);var d=y({message:_.publicKey,encoding:"binary"});if(d.length!==i.constants.PUBLIC_KEY_BYTE_LENGTH)throw new TypeError('"options.publicKey" must have a byte length of '+i.constants.PUBLIC_KEY_BYTE_LENGTH);var I=new c(i.constants.SIGN_BYTE_LENGTH+x.length),O=new c(i.constants.SIGN_BYTE_LENGTH+x.length),P;for(P=0;P<i.constants.SIGN_BYTE_LENGTH;++P)I[P]=w[P];for(P=0;P<x.length;++P)I[P+i.constants.SIGN_BYTE_LENGTH]=x[P];return b(O,I,I.length,d)>=0};function y(_){var x=_.message;if(x instanceof Uint8Array||x instanceof c)return x;var w=_.encoding;if(x===void 0)if(_.md)x=_.md.digest().getBytes(),w="binary";else throw new TypeError('"options.message" or "options.md" not specified.');if(typeof x=="string"&&!w)throw new TypeError('"options.encoding" must be "binary" or "utf8".');if(typeof x=="string"){if(typeof Buffer<"u")return Buffer.from(x,w);x=new u(x,w)}else if(!(x instanceof u))throw new TypeError('"options.message" must be a node.js Buffer, a Uint8Array, a forge ByteBuffer, or a string with "options.encoding" specifying its encoding.');for(var d=new c(x.length()),I=0;I<d.length;++I)d[I]=x.at(I);return d}var f=W(),A=W([1]),C=W([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),p=W([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),o=W([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),m=W([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),g=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]),S=W([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function a(_,x){var w=t.md.sha512.create(),d=new u(_);w.update(d.getBytes(x),"binary");var I=w.digest().getBytes();if(typeof Buffer<"u")return Buffer.from(I,"binary");for(var O=new c(i.constants.HASH_BYTE_LENGTH),P=0;P<64;++P)O[P]=I.charCodeAt(P);return O}function v(_,x){var w=[W(),W(),W(),W()],d,I=a(x,32);for(I[0]&=248,I[31]&=127,I[31]|=64,re(w,I),B(_,w),d=0;d<32;++d)x[d+32]=_[d];return 0}function E(_,x,w,d){var I,O,P=new Float64Array(64),K=[W(),W(),W(),W()],V=a(d,32);V[0]&=248,V[31]&=127,V[31]|=64;var $=w+64;for(I=0;I<w;++I)_[64+I]=x[I];for(I=0;I<32;++I)_[32+I]=V[32+I];var M=a(_.subarray(32),w+32);for(T(M),re(K,M),B(_,K),I=32;I<64;++I)_[I]=d[I];var G=a(_,w+64);for(T(G),I=32;I<64;++I)P[I]=0;for(I=0;I<32;++I)P[I]=M[I];for(I=0;I<32;++I)for(O=0;O<32;O++)P[I+O]+=G[I]*V[O];return R(_.subarray(32),P),$}function b(_,x,w,d){var I,O,P=new c(32),K=[W(),W(),W(),W()],V=[W(),W(),W(),W()];if(O=-1,w<64||F(V,d))return-1;for(I=0;I<w;++I)_[I]=x[I];for(I=0;I<32;++I)_[I+32]=d[I];var $=a(_,w);if(T($),X(K,V,$),re(V,x.subarray(32)),h(K,V),B(P,K),w-=64,H(x,0,P,0)){for(I=0;I<w;++I)_[I]=0;return-1}for(I=0;I<w;++I)_[I]=x[I+64];return O=w,O}function R(_,x){var w,d,I,O;for(d=63;d>=32;--d){for(w=0,I=d-32,O=d-12;I<O;++I)x[I]+=w-16*x[d]*g[I-(d-32)],w=x[I]+128>>8,x[I]-=w*256;x[I]+=w,x[d]=0}for(w=0,I=0;I<32;++I)x[I]+=w-(x[31]>>4)*g[I],w=x[I]>>8,x[I]&=255;for(I=0;I<32;++I)x[I]-=w*g[I];for(d=0;d<32;++d)x[d+1]+=x[d]>>8,_[d]=x[d]&255}function T(_){for(var x=new Float64Array(64),w=0;w<64;++w)x[w]=_[w],_[w]=0;R(_,x)}function h(_,x){var w=W(),d=W(),I=W(),O=W(),P=W(),K=W(),V=W(),$=W(),M=W();ie(w,_[1],_[0]),ie(M,x[1],x[0]),fe(w,w,M),he(d,_[0],_[1]),he(M,x[0],x[1]),fe(d,d,M),fe(I,_[3],x[3]),fe(I,I,p),fe(O,_[2],x[2]),he(O,O,O),ie(P,d,w),ie(K,O,I),he(V,O,I),he($,d,w),fe(_[0],P,K),fe(_[1],$,V),fe(_[2],V,K),fe(_[3],P,$)}function l(_,x,w){for(var d=0;d<4;++d)_e(_[d],x[d],w)}function B(_,x){var w=W(),d=W(),I=W();de(I,x[2]),fe(w,x[0],I),fe(d,x[1],I),N(_,d),_[31]^=J(w)<<7}function N(_,x){var w,d,I,O=W(),P=W();for(w=0;w<16;++w)P[w]=x[w];for(ye(P),ye(P),ye(P),d=0;d<2;++d){for(O[0]=P[0]-65517,w=1;w<15;++w)O[w]=P[w]-65535-(O[w-1]>>16&1),O[w-1]&=65535;O[15]=P[15]-32767-(O[14]>>16&1),I=O[15]>>16&1,O[14]&=65535,_e(P,O,1-I)}for(w=0;w<16;w++)_[2*w]=P[w]&255,_[2*w+1]=P[w]>>8}function F(_,x){var w=W(),d=W(),I=W(),O=W(),P=W(),K=W(),V=W();return se(_[2],A),L(_[1],x),ke(I,_[1]),fe(O,I,C),ie(I,I,_[2]),he(O,_[2],O),ke(P,O),ke(K,P),fe(V,K,P),fe(w,V,I),fe(w,w,O),q(w,w),fe(w,w,I),fe(w,w,O),fe(w,w,O),fe(_[0],w,O),ke(d,_[0]),fe(d,d,O),j(d,I)&&fe(_[0],_[0],S),ke(d,_[0]),fe(d,d,O),j(d,I)?-1:(J(_[0])===x[31]>>7&&ie(_[0],f,_[0]),fe(_[3],_[0],_[1]),0)}function L(_,x){var w;for(w=0;w<16;++w)_[w]=x[2*w]+(x[2*w+1]<<8);_[15]&=32767}function q(_,x){var w=W(),d;for(d=0;d<16;++d)w[d]=x[d];for(d=250;d>=0;--d)ke(w,w),d!==1&&fe(w,w,x);for(d=0;d<16;++d)_[d]=w[d]}function j(_,x){var w=new c(32),d=new c(32);return N(w,_),N(d,x),H(w,0,d,0)}function H(_,x,w,d){return Q(_,x,w,d,32)}function Q(_,x,w,d,I){var O,P=0;for(O=0;O<I;++O)P|=_[x+O]^w[d+O];return(1&P-1>>>8)-1}function J(_){var x=new c(32);return N(x,_),x[0]&1}function X(_,x,w){var d,I;for(se(_[0],f),se(_[1],A),se(_[2],A),se(_[3],f),I=255;I>=0;--I)d=w[I/8|0]>>(I&7)&1,l(_,x,d),h(x,_),h(_,_),l(_,x,d)}function re(_,x){var w=[W(),W(),W(),W()];se(w[0],o),se(w[1],m),se(w[2],A),fe(w[3],o,m),X(_,w,x)}function se(_,x){var w;for(w=0;w<16;w++)_[w]=x[w]|0}function de(_,x){var w=W(),d;for(d=0;d<16;++d)w[d]=x[d];for(d=253;d>=0;--d)ke(w,w),d!==2&&d!==4&&fe(w,w,x);for(d=0;d<16;++d)_[d]=w[d]}function ye(_){var x,w,d=1;for(x=0;x<16;++x)w=_[x]+d+65535,d=Math.floor(w/65536),_[x]=w-d*65536;_[0]+=d-1+37*(d-1)}function _e(_,x,w){for(var d,I=~(w-1),O=0;O<16;++O)d=I&(_[O]^x[O]),_[O]^=d,x[O]^=d}function W(_){var x,w=new Float64Array(16);if(_)for(x=0;x<_.length;++x)w[x]=_[x];return w}function he(_,x,w){for(var d=0;d<16;++d)_[d]=x[d]+w[d]}function ie(_,x,w){for(var d=0;d<16;++d)_[d]=x[d]-w[d]}function ke(_,x){fe(_,x,x)}function fe(_,x,w){var d,I,O=0,P=0,K=0,V=0,$=0,M=0,G=0,Y=0,ne=0,te=0,ce=0,pe=0,ge=0,ue=0,le=0,ve=0,be=0,Ne=0,Pe=0,we=0,Ue=0,Ie=0,Te=0,Ee=0,gt=0,xt=0,kt=0,zt=0,cr=0,Pr=0,yn=0,De=w[0],Fe=w[1],Me=w[2],qe=w[3],Ve=w[4],Ke=w[5],$e=w[6],Ge=w[7],je=w[8],He=w[9],ze=w[10],We=w[11],Be=w[12],Le=w[13],Qe=w[14],Ye=w[15];d=x[0],O+=d*De,P+=d*Fe,K+=d*Me,V+=d*qe,$+=d*Ve,M+=d*Ke,G+=d*$e,Y+=d*Ge,ne+=d*je,te+=d*He,ce+=d*ze,pe+=d*We,ge+=d*Be,ue+=d*Le,le+=d*Qe,ve+=d*Ye,d=x[1],P+=d*De,K+=d*Fe,V+=d*Me,$+=d*qe,M+=d*Ve,G+=d*Ke,Y+=d*$e,ne+=d*Ge,te+=d*je,ce+=d*He,pe+=d*ze,ge+=d*We,ue+=d*Be,le+=d*Le,ve+=d*Qe,be+=d*Ye,d=x[2],K+=d*De,V+=d*Fe,$+=d*Me,M+=d*qe,G+=d*Ve,Y+=d*Ke,ne+=d*$e,te+=d*Ge,ce+=d*je,pe+=d*He,ge+=d*ze,ue+=d*We,le+=d*Be,ve+=d*Le,be+=d*Qe,Ne+=d*Ye,d=x[3],V+=d*De,$+=d*Fe,M+=d*Me,G+=d*qe,Y+=d*Ve,ne+=d*Ke,te+=d*$e,ce+=d*Ge,pe+=d*je,ge+=d*He,ue+=d*ze,le+=d*We,ve+=d*Be,be+=d*Le,Ne+=d*Qe,Pe+=d*Ye,d=x[4],$+=d*De,M+=d*Fe,G+=d*Me,Y+=d*qe,ne+=d*Ve,te+=d*Ke,ce+=d*$e,pe+=d*Ge,ge+=d*je,ue+=d*He,le+=d*ze,ve+=d*We,be+=d*Be,Ne+=d*Le,Pe+=d*Qe,we+=d*Ye,d=x[5],M+=d*De,G+=d*Fe,Y+=d*Me,ne+=d*qe,te+=d*Ve,ce+=d*Ke,pe+=d*$e,ge+=d*Ge,ue+=d*je,le+=d*He,ve+=d*ze,be+=d*We,Ne+=d*Be,Pe+=d*Le,we+=d*Qe,Ue+=d*Ye,d=x[6],G+=d*De,Y+=d*Fe,ne+=d*Me,te+=d*qe,ce+=d*Ve,pe+=d*Ke,ge+=d*$e,ue+=d*Ge,le+=d*je,ve+=d*He,be+=d*ze,Ne+=d*We,Pe+=d*Be,we+=d*Le,Ue+=d*Qe,Ie+=d*Ye,d=x[7],Y+=d*De,ne+=d*Fe,te+=d*Me,ce+=d*qe,pe+=d*Ve,ge+=d*Ke,ue+=d*$e,le+=d*Ge,ve+=d*je,be+=d*He,Ne+=d*ze,Pe+=d*We,we+=d*Be,Ue+=d*Le,Ie+=d*Qe,Te+=d*Ye,d=x[8],ne+=d*De,te+=d*Fe,ce+=d*Me,pe+=d*qe,ge+=d*Ve,ue+=d*Ke,le+=d*$e,ve+=d*Ge,be+=d*je,Ne+=d*He,Pe+=d*ze,we+=d*We,Ue+=d*Be,Ie+=d*Le,Te+=d*Qe,Ee+=d*Ye,d=x[9],te+=d*De,ce+=d*Fe,pe+=d*Me,ge+=d*qe,ue+=d*Ve,le+=d*Ke,ve+=d*$e,be+=d*Ge,Ne+=d*je,Pe+=d*He,we+=d*ze,Ue+=d*We,Ie+=d*Be,Te+=d*Le,Ee+=d*Qe,gt+=d*Ye,d=x[10],ce+=d*De,pe+=d*Fe,ge+=d*Me,ue+=d*qe,le+=d*Ve,ve+=d*Ke,be+=d*$e,Ne+=d*Ge,Pe+=d*je,we+=d*He,Ue+=d*ze,Ie+=d*We,Te+=d*Be,Ee+=d*Le,gt+=d*Qe,xt+=d*Ye,d=x[11],pe+=d*De,ge+=d*Fe,ue+=d*Me,le+=d*qe,ve+=d*Ve,be+=d*Ke,Ne+=d*$e,Pe+=d*Ge,we+=d*je,Ue+=d*He,Ie+=d*ze,Te+=d*We,Ee+=d*Be,gt+=d*Le,xt+=d*Qe,kt+=d*Ye,d=x[12],ge+=d*De,ue+=d*Fe,le+=d*Me,ve+=d*qe,be+=d*Ve,Ne+=d*Ke,Pe+=d*$e,we+=d*Ge,Ue+=d*je,Ie+=d*He,Te+=d*ze,Ee+=d*We,gt+=d*Be,xt+=d*Le,kt+=d*Qe,zt+=d*Ye,d=x[13],ue+=d*De,le+=d*Fe,ve+=d*Me,be+=d*qe,Ne+=d*Ve,Pe+=d*Ke,we+=d*$e,Ue+=d*Ge,Ie+=d*je,Te+=d*He,Ee+=d*ze,gt+=d*We,xt+=d*Be,kt+=d*Le,zt+=d*Qe,cr+=d*Ye,d=x[14],le+=d*De,ve+=d*Fe,be+=d*Me,Ne+=d*qe,Pe+=d*Ve,we+=d*Ke,Ue+=d*$e,Ie+=d*Ge,Te+=d*je,Ee+=d*He,gt+=d*ze,xt+=d*We,kt+=d*Be,zt+=d*Le,cr+=d*Qe,Pr+=d*Ye,d=x[15],ve+=d*De,be+=d*Fe,Ne+=d*Me,Pe+=d*qe,we+=d*Ve,Ue+=d*Ke,Ie+=d*$e,Te+=d*Ge,Ee+=d*je,gt+=d*He,xt+=d*ze,kt+=d*We,zt+=d*Be,cr+=d*Le,Pr+=d*Qe,yn+=d*Ye,O+=38*be,P+=38*Ne,K+=38*Pe,V+=38*we,$+=38*Ue,M+=38*Ie,G+=38*Te,Y+=38*Ee,ne+=38*gt,te+=38*xt,ce+=38*kt,pe+=38*zt,ge+=38*cr,ue+=38*Pr,le+=38*yn,I=1,d=O+I+65535,I=Math.floor(d/65536),O=d-I*65536,d=P+I+65535,I=Math.floor(d/65536),P=d-I*65536,d=K+I+65535,I=Math.floor(d/65536),K=d-I*65536,d=V+I+65535,I=Math.floor(d/65536),V=d-I*65536,d=$+I+65535,I=Math.floor(d/65536),$=d-I*65536,d=M+I+65535,I=Math.floor(d/65536),M=d-I*65536,d=G+I+65535,I=Math.floor(d/65536),G=d-I*65536,d=Y+I+65535,I=Math.floor(d/65536),Y=d-I*65536,d=ne+I+65535,I=Math.floor(d/65536),ne=d-I*65536,d=te+I+65535,I=Math.floor(d/65536),te=d-I*65536,d=ce+I+65535,I=Math.floor(d/65536),ce=d-I*65536,d=pe+I+65535,I=Math.floor(d/65536),pe=d-I*65536,d=ge+I+65535,I=Math.floor(d/65536),ge=d-I*65536,d=ue+I+65535,I=Math.floor(d/65536),ue=d-I*65536,d=le+I+65535,I=Math.floor(d/65536),le=d-I*65536,d=ve+I+65535,I=Math.floor(d/65536),ve=d-I*65536,O+=I-1+37*(I-1),I=1,d=O+I+65535,I=Math.floor(d/65536),O=d-I*65536,d=P+I+65535,I=Math.floor(d/65536),P=d-I*65536,d=K+I+65535,I=Math.floor(d/65536),K=d-I*65536,d=V+I+65535,I=Math.floor(d/65536),V=d-I*65536,d=$+I+65535,I=Math.floor(d/65536),$=d-I*65536,d=M+I+65535,I=Math.floor(d/65536),M=d-I*65536,d=G+I+65535,I=Math.floor(d/65536),G=d-I*65536,d=Y+I+65535,I=Math.floor(d/65536),Y=d-I*65536,d=ne+I+65535,I=Math.floor(d/65536),ne=d-I*65536,d=te+I+65535,I=Math.floor(d/65536),te=d-I*65536,d=ce+I+65535,I=Math.floor(d/65536),ce=d-I*65536,d=pe+I+65535,I=Math.floor(d/65536),pe=d-I*65536,d=ge+I+65535,I=Math.floor(d/65536),ge=d-I*65536,d=ue+I+65535,I=Math.floor(d/65536),ue=d-I*65536,d=le+I+65535,I=Math.floor(d/65536),le=d-I*65536,d=ve+I+65535,I=Math.floor(d/65536),ve=d-I*65536,O+=I-1+37*(I-1),_[0]=O,_[1]=P,_[2]=K,_[3]=V,_[4]=$,_[5]=M,_[6]=G,_[7]=Y,_[8]=ne,_[9]=te,_[10]=ce,_[11]=pe,_[12]=ge,_[13]=ue,_[14]=le,_[15]=ve}return ha}var pa,$o;function od(){if($o)return pa;$o=1;var t=me();Ae(),yt(),ui(),pa=t.kem=t.kem||{};var e=t.jsbn.BigInteger;t.kem.rsa={},t.kem.rsa.create=function(n,s){s=s||{};var u=s.prng||t.random,c={};return c.encrypt=function(i,y){var f=Math.ceil(i.n.bitLength()/8),A;do A=new e(t.util.bytesToHex(u.getBytesSync(f)),16).mod(i.n);while(A.compareTo(e.ONE)<=0);A=t.util.hexToBytes(A.toString(16));var C=f-A.length;C>0&&(A=t.util.fillString(String.fromCharCode(0),C)+A);var p=i.encrypt(A,"NONE"),o=n.generate(A,y);return{encapsulation:p,key:o}},c.decrypt=function(i,y,f){var A=i.decrypt(y,"NONE");return n.generate(A,f)},c},t.kem.kdf1=function(n,s){r(this,n,0,s||n.digestLength)},t.kem.kdf2=function(n,s){r(this,n,1,s||n.digestLength)};function r(n,s,u,c){n.generate=function(i,y){for(var f=new t.util.ByteBuffer,A=Math.ceil(y/c)+u,C=new t.util.ByteBuffer,p=u;p<A;++p){C.putInt32(p),s.start(),s.update(i+C.getBytes());var o=s.digest();f.putBytes(o.getBytes(c))}return f.truncate(f.length()-y),f.getBytes()}}return pa}var ya,Go;function ud(){if(Go)return ya;Go=1;var t=me();Ae(),ya=t.log=t.log||{},t.log.levels=["none","error","warning","info","debug","verbose","max"];var e={},r=[],n=null;t.log.LEVEL_LOCKED=2,t.log.NO_LEVEL_CHECK=4,t.log.INTERPOLATE=8;for(var s=0;s<t.log.levels.length;++s){var u=t.log.levels[s];e[u]={index:s,name:u.toUpperCase()}}t.log.logMessage=function(p){for(var o=e[p.level].index,m=0;m<r.length;++m){var g=r[m];if(g.flags&t.log.NO_LEVEL_CHECK)g.f(p);else{var S=e[g.level].index;o<=S&&g.f(g,p)}}},t.log.prepareStandard=function(p){"standard"in p||(p.standard=e[p.level].name+" ["+p.category+"] "+p.message)},t.log.prepareFull=function(p){if(!("full"in p)){var o=[p.message];o=o.concat([]),p.full=t.util.format.apply(this,o)}},t.log.prepareStandardFull=function(p){"standardFull"in p||(t.log.prepareStandard(p),p.standardFull=p.standard)};for(var c=["error","warning","info","debug","verbose"],s=0;s<c.length;++s)(function(o){t.log[o]=function(m,g){var S=Array.prototype.slice.call(arguments).slice(2),a={timestamp:new Date,level:o,category:m,message:g,arguments:S};t.log.logMessage(a)}})(c[s]);if(t.log.makeLogger=function(p){var o={flags:0,f:p};return t.log.setLevel(o,"none"),o},t.log.setLevel=function(p,o){var m=!1;if(p&&!(p.flags&t.log.LEVEL_LOCKED))for(var g=0;g<t.log.levels.length;++g){var S=t.log.levels[g];if(o==S){p.level=o,m=!0;break}}return m},t.log.lock=function(p,o){typeof o>"u"||o?p.flags|=t.log.LEVEL_LOCKED:p.flags&=~t.log.LEVEL_LOCKED},t.log.addLogger=function(p){r.push(p)},typeof console<"u"&&"log"in console){var i;if(console.error&&console.warn&&console.info&&console.debug){var y={error:console.error,warning:console.warn,info:console.info,debug:console.debug,verbose:console.debug},f=function(p,o){t.log.prepareStandard(o);var m=y[o.level],g=[o.standard];g=g.concat(o.arguments.slice()),m.apply(console,g)};i=t.log.makeLogger(f)}else{var f=function(o,m){t.log.prepareStandardFull(m),console.log(m.standardFull)};i=t.log.makeLogger(f)}t.log.setLevel(i,"debug"),t.log.addLogger(i),n=i}else console={log:function(){}};if(n!==null&&typeof window<"u"&&window.location){var A=new URL(window.location.href).searchParams;if(A.has("console.level")&&t.log.setLevel(n,A.get("console.level").slice(-1)[0]),A.has("console.lock")){var C=A.get("console.lock").slice(-1)[0];C=="true"&&t.log.lock(n)}}return t.log.consoleLogger=n,ya}var ga,jo;function cd(){return jo||(jo=1,ga=Ot(),ys(),sn(),_c(),Lc()),ga}var va={exports:{}},Ho;function ld(){if(Ho)return va.exports;Ho=1;var t=me();sr(),Tt(),oi(),or(),Rr(),Nc(),yt(),Ae(),ms();var e=t.asn1,r=va.exports=t.pkcs7=t.pkcs7||{};r.messageFromPem=function(o){var m=t.pem.decode(o)[0];if(m.type!=="PKCS7"){var g=new Error('Could not convert PKCS#7 message from PEM; PEM header type is not "PKCS#7".');throw g.headerType=m.type,g}if(m.procType&&m.procType.type==="ENCRYPTED")throw new Error("Could not convert PKCS#7 message from PEM; PEM is encrypted.");var S=e.fromDer(m.body);return r.messageFromAsn1(S)},r.messageToPem=function(o,m){var g={type:"PKCS7",body:e.toDer(o.toAsn1()).getBytes()};return t.pem.encode(g,{maxline:m})},r.messageFromAsn1=function(o){var m={},g=[];if(!e.validate(o,r.asn1.contentInfoValidator,m,g)){var S=new Error("Cannot read PKCS#7 message. ASN.1 object is not an PKCS#7 ContentInfo.");throw S.errors=g,S}var a=e.derToOid(m.contentType),v;switch(a){case t.pki.oids.envelopedData:v=r.createEnvelopedData();break;case t.pki.oids.encryptedData:v=r.createEncryptedData();break;case t.pki.oids.signedData:v=r.createSignedData();break;default:throw new Error("Cannot read PKCS#7 message. ContentType with OID "+a+" is not (yet) supported.")}return v.fromAsn1(m.content.value[0]),v},r.createSignedData=function(){var o=null;return o={type:t.pki.oids.signedData,version:1,certificates:[],crls:[],signers:[],digestAlgorithmIdentifiers:[],contentInfo:null,signerInfos:[],fromAsn1:function(S){if(C(o,S,r.asn1.signedDataValidator),o.certificates=[],o.crls=[],o.digestAlgorithmIdentifiers=[],o.contentInfo=null,o.signerInfos=[],o.rawCapture.certificates)for(var a=o.rawCapture.certificates.value,v=0;v<a.length;++v)o.certificates.push(t.pki.certificateFromAsn1(a[v]))},toAsn1:function(){o.contentInfo||o.sign();for(var S=[],a=0;a<o.certificates.length;++a)S.push(t.pki.certificateToAsn1(o.certificates[a]));var v=[],E=e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(o.version).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SET,!0,o.digestAlgorithmIdentifiers),o.contentInfo])]);return S.length>0&&E.value[0].value.push(e.create(e.Class.CONTEXT_SPECIFIC,0,!0,S)),v.length>0&&E.value[0].value.push(e.create(e.Class.CONTEXT_SPECIFIC,1,!0,v)),E.value[0].value.push(e.create(e.Class.UNIVERSAL,e.Type.SET,!0,o.signerInfos)),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(o.type).getBytes()),E])},addSigner:function(S){var a=S.issuer,v=S.serialNumber;if(S.certificate){var E=S.certificate;typeof E=="string"&&(E=t.pki.certificateFromPem(E)),a=E.issuer.attributes,v=E.serialNumber}var b=S.key;if(!b)throw new Error("Could not add PKCS#7 signer; no private key specified.");typeof b=="string"&&(b=t.pki.privateKeyFromPem(b));var R=S.digestAlgorithm||t.pki.oids.sha1;switch(R){case t.pki.oids.sha1:case t.pki.oids.sha256:case t.pki.oids.sha384:case t.pki.oids.sha512:case t.pki.oids.md5:break;default:throw new Error("Could not add PKCS#7 signer; unknown message digest algorithm: "+R)}var T=S.authenticatedAttributes||[];if(T.length>0){for(var h=!1,l=!1,B=0;B<T.length;++B){var N=T[B];if(!h&&N.type===t.pki.oids.contentType){if(h=!0,l)break;continue}if(!l&&N.type===t.pki.oids.messageDigest){if(l=!0,h)break;continue}}if(!h||!l)throw new Error("Invalid signer.authenticatedAttributes. If signer.authenticatedAttributes is specified, then it must contain at least two attributes, PKCS #9 content-type and PKCS #9 message-digest.")}o.signers.push({key:b,version:1,issuer:a,serialNumber:v,digestAlgorithm:R,signatureAlgorithm:t.pki.oids.rsaEncryption,signature:null,authenticatedAttributes:T,unauthenticatedAttributes:[]})},sign:function(S){if(S=S||{},(typeof o.content!="object"||o.contentInfo===null)&&(o.contentInfo=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(t.pki.oids.data).getBytes())]),"content"in o)){var a;o.content instanceof t.util.ByteBuffer?a=o.content.bytes():typeof o.content=="string"&&(a=t.util.encodeUtf8(o.content)),S.detached?o.detachedContent=e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,a):o.contentInfo.value.push(e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,a)]))}if(o.signers.length!==0){var v=m();g(v)}},verify:function(){throw new Error("PKCS#7 signature verification not yet implemented.")},addCertificate:function(S){typeof S=="string"&&(S=t.pki.certificateFromPem(S)),o.certificates.push(S)},addCertificateRevokationList:function(S){throw new Error("PKCS#7 CRL support not yet implemented.")}},o;function m(){for(var S={},a=0;a<o.signers.length;++a){var v=o.signers[a],E=v.digestAlgorithm;E in S||(S[E]=t.md[t.pki.oids[E]].create()),v.authenticatedAttributes.length===0?v.md=S[E]:v.md=t.md[t.pki.oids[E]].create()}o.digestAlgorithmIdentifiers=[];for(var E in S)o.digestAlgorithmIdentifiers.push(e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(E).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")]));return S}function g(S){var a;if(o.detachedContent?a=o.detachedContent:(a=o.contentInfo.value[1],a=a.value[0]),!a)throw new Error("Could not sign PKCS#7 message; there is no content to sign.");var v=e.derToOid(o.contentInfo.value[0].value),E=e.toDer(a);E.getByte(),e.getBerValueLength(E),E=E.getBytes();for(var b in S)S[b].start().update(E);for(var R=new Date,T=0;T<o.signers.length;++T){var h=o.signers[T];if(h.authenticatedAttributes.length===0){if(v!==t.pki.oids.data)throw new Error("Invalid signer; authenticatedAttributes must be present when the ContentInfo content type is not PKCS#7 Data.")}else{h.authenticatedAttributesAsn1=e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[]);for(var l=e.create(e.Class.UNIVERSAL,e.Type.SET,!0,[]),B=0;B<h.authenticatedAttributes.length;++B){var N=h.authenticatedAttributes[B];N.type===t.pki.oids.messageDigest?N.value=S[h.digestAlgorithm].digest():N.type===t.pki.oids.signingTime&&(N.value||(N.value=R)),l.value.push(f(N)),h.authenticatedAttributesAsn1.value.push(f(N))}E=e.toDer(l).getBytes(),h.md.start().update(E)}h.signature=h.key.sign(h.md,"RSASSA-PKCS1-V1_5")}o.signerInfos=y(o.signers)}},r.createEncryptedData=function(){var o=null;return o={type:t.pki.oids.encryptedData,version:0,encryptedContent:{algorithm:t.pki.oids["aes256-CBC"]},fromAsn1:function(m){C(o,m,r.asn1.encryptedDataValidator)},decrypt:function(m){m!==void 0&&(o.encryptedContent.key=m),p(o)}},o},r.createEnvelopedData=function(){var o=null;return o={type:t.pki.oids.envelopedData,version:0,recipients:[],encryptedContent:{algorithm:t.pki.oids["aes256-CBC"]},fromAsn1:function(m){var g=C(o,m,r.asn1.envelopedDataValidator);o.recipients=u(g.recipientInfos.value)},toAsn1:function(){return e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(o.type).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(o.version).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SET,!0,c(o.recipients)),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,A(o.encryptedContent))])])])},findRecipient:function(m){for(var g=m.issuer.attributes,S=0;S<o.recipients.length;++S){var a=o.recipients[S],v=a.issuer;if(a.serialNumber===m.serialNumber&&v.length===g.length){for(var E=!0,b=0;b<g.length;++b)if(v[b].type!==g[b].type||v[b].value!==g[b].value){E=!1;break}if(E)return a}}return null},decrypt:function(m,g){if(o.encryptedContent.key===void 0&&m!==void 0&&g!==void 0)switch(m.encryptedContent.algorithm){case t.pki.oids.rsaEncryption:case t.pki.oids.desCBC:var S=g.decrypt(m.encryptedContent.content);o.encryptedContent.key=t.util.createBuffer(S);break;default:throw new Error("Unsupported asymmetric cipher, OID "+m.encryptedContent.algorithm)}p(o)},addRecipient:function(m){o.recipients.push({version:0,issuer:m.issuer.attributes,serialNumber:m.serialNumber,encryptedContent:{algorithm:t.pki.oids.rsaEncryption,key:m.publicKey}})},encrypt:function(m,g){if(o.encryptedContent.content===void 0){g=g||o.encryptedContent.algorithm,m=m||o.encryptedContent.key;var S,a,v;switch(g){case t.pki.oids["aes128-CBC"]:S=16,a=16,v=t.aes.createEncryptionCipher;break;case t.pki.oids["aes192-CBC"]:S=24,a=16,v=t.aes.createEncryptionCipher;break;case t.pki.oids["aes256-CBC"]:S=32,a=16,v=t.aes.createEncryptionCipher;break;case t.pki.oids["des-EDE3-CBC"]:S=24,a=8,v=t.des.createEncryptionCipher;break;default:throw new Error("Unsupported symmetric cipher, OID "+g)}if(m===void 0)m=t.util.createBuffer(t.random.getBytes(S));else if(m.length()!=S)throw new Error("Symmetric key has wrong length; got "+m.length()+" bytes, expected "+S+".");o.encryptedContent.algorithm=g,o.encryptedContent.key=m,o.encryptedContent.parameter=t.util.createBuffer(t.random.getBytes(a));var E=v(m);if(E.start(o.encryptedContent.parameter.copy()),E.update(o.content),!E.finish())throw new Error("Symmetric encryption failed.");o.encryptedContent.content=E.output}for(var b=0;b<o.recipients.length;++b){var R=o.recipients[b];if(R.encryptedContent.content===void 0)switch(R.encryptedContent.algorithm){case t.pki.oids.rsaEncryption:R.encryptedContent.content=R.encryptedContent.key.encrypt(o.encryptedContent.key.data);break;default:throw new Error("Unsupported asymmetric cipher, OID "+R.encryptedContent.algorithm)}}}},o};function n(o){var m={},g=[];if(!e.validate(o,r.asn1.recipientInfoValidator,m,g)){var S=new Error("Cannot read PKCS#7 RecipientInfo. ASN.1 object is not an PKCS#7 RecipientInfo.");throw S.errors=g,S}return{version:m.version.charCodeAt(0),issuer:t.pki.RDNAttributesAsArray(m.issuer),serialNumber:t.util.createBuffer(m.serial).toHex(),encryptedContent:{algorithm:e.derToOid(m.encAlgorithm),parameter:m.encParameter?m.encParameter.value:void 0,content:m.encKey}}}function s(o){return e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(o.version).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[t.pki.distinguishedNameToAsn1({attributes:o.issuer}),e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,t.util.hexToBytes(o.serialNumber))]),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(o.encryptedContent.algorithm).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")]),e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,o.encryptedContent.content)])}function u(o){for(var m=[],g=0;g<o.length;++g)m.push(n(o[g]));return m}function c(o){for(var m=[],g=0;g<o.length;++g)m.push(s(o[g]));return m}function i(o){var m=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(o.version).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[t.pki.distinguishedNameToAsn1({attributes:o.issuer}),e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,t.util.hexToBytes(o.serialNumber))]),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(o.digestAlgorithm).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")])]);if(o.authenticatedAttributesAsn1&&m.value.push(o.authenticatedAttributesAsn1),m.value.push(e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(o.signatureAlgorithm).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")])),m.value.push(e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,o.signature)),o.unauthenticatedAttributes.length>0){for(var g=e.create(e.Class.CONTEXT_SPECIFIC,1,!0,[]),S=0;S<o.unauthenticatedAttributes.length;++S){var a=o.unauthenticatedAttributes[S];g.values.push(f(a))}m.value.push(g)}return m}function y(o){for(var m=[],g=0;g<o.length;++g)m.push(i(o[g]));return m}function f(o){var m;if(o.type===t.pki.oids.contentType)m=e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(o.value).getBytes());else if(o.type===t.pki.oids.messageDigest)m=e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,o.value.bytes());else if(o.type===t.pki.oids.signingTime){var g=new Date("1950-01-01T00:00:00Z"),S=new Date("2050-01-01T00:00:00Z"),a=o.value;if(typeof a=="string"){var v=Date.parse(a);isNaN(v)?a.length===13?a=e.utcTimeToDate(a):a=e.generalizedTimeToDate(a):a=new Date(v)}a>=g&&a<S?m=e.create(e.Class.UNIVERSAL,e.Type.UTCTIME,!1,e.dateToUtcTime(a)):m=e.create(e.Class.UNIVERSAL,e.Type.GENERALIZEDTIME,!1,e.dateToGeneralizedTime(a))}return e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(o.type).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SET,!0,[m])])}function A(o){return[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(t.pki.oids.data).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(o.algorithm).getBytes()),o.parameter?e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,o.parameter.getBytes()):void 0]),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,o.content.getBytes())])]}function C(o,m,g){var S={},a=[];if(!e.validate(m,g,S,a)){var v=new Error("Cannot read PKCS#7 message. ASN.1 object is not a supported PKCS#7 message.");throw v.errors=v,v}var E=e.derToOid(S.contentType);if(E!==t.pki.oids.data)throw new Error("Unsupported PKCS#7 message. Only wrapped ContentType Data supported.");if(S.encryptedContent){var b="";if(t.util.isArray(S.encryptedContent))for(var R=0;R<S.encryptedContent.length;++R){if(S.encryptedContent[R].type!==e.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting encrypted content constructed of only OCTET STRING objects.");b+=S.encryptedContent[R].value}else b=S.encryptedContent;o.encryptedContent={algorithm:e.derToOid(S.encAlgorithm),parameter:t.util.createBuffer(S.encParameter.value),content:t.util.createBuffer(b)}}if(S.content){var b="";if(t.util.isArray(S.content))for(var R=0;R<S.content.length;++R){if(S.content[R].type!==e.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting content constructed of only OCTET STRING objects.");b+=S.content[R].value}else b=S.content;o.content=t.util.createBuffer(b)}return o.version=S.version.charCodeAt(0),o.rawCapture=S,S}function p(o){if(o.encryptedContent.key===void 0)throw new Error("Symmetric key not available.");if(o.content===void 0){var m;switch(o.encryptedContent.algorithm){case t.pki.oids["aes128-CBC"]:case t.pki.oids["aes192-CBC"]:case t.pki.oids["aes256-CBC"]:m=t.aes.createDecryptionCipher(o.encryptedContent.key);break;case t.pki.oids.desCBC:case t.pki.oids["des-EDE3-CBC"]:m=t.des.createDecryptionCipher(o.encryptedContent.key);break;default:throw new Error("Unsupported symmetric cipher, OID "+o.encryptedContent.algorithm)}if(m.start(o.encryptedContent.parameter),m.update(o.encryptedContent.content),!m.finish())throw new Error("Symmetric decryption failed.");o.content=m.output}}return va.exports}var ma={exports:{}},zo;function fd(){if(zo)return ma.exports;zo=1;var t=me();sr(),an(),ys(),sn(),Ae();var e=ma.exports=t.ssh=t.ssh||{};e.privateKeyToPutty=function(u,c,i){i=i||"",c=c||"";var y="ssh-rsa",f=c===""?"none":"aes256-cbc",A="PuTTY-User-Key-File-2: "+y+`\r
`;A+="Encryption: "+f+`\r
`,A+="Comment: "+i+`\r
`;var C=t.util.createBuffer();n(C,y),r(C,u.e),r(C,u.n);var p=t.util.encode64(C.bytes(),64),o=Math.floor(p.length/66)+1;A+="Public-Lines: "+o+`\r
`,A+=p;var m=t.util.createBuffer();r(m,u.d),r(m,u.p),r(m,u.q),r(m,u.qInv);var g;if(!c)g=t.util.encode64(m.bytes(),64);else{var S=m.length()+16-1;S-=S%16;var a=s(m.bytes());a.truncate(a.length()-S+m.length()),m.putBuffer(a);var v=t.util.createBuffer();v.putBuffer(s("\0\0\0\0",c)),v.putBuffer(s("\0\0\0",c));var E=t.aes.createEncryptionCipher(v.truncate(8),"CBC");E.start(t.util.createBuffer().fillWithByte(0,16)),E.update(m.copy()),E.finish();var b=E.output;b.truncate(16),g=t.util.encode64(b.bytes(),64)}o=Math.floor(g.length/66)+1,A+=`\r
Private-Lines: `+o+`\r
`,A+=g;var R=s("putty-private-key-file-mac-key",c),T=t.util.createBuffer();n(T,y),n(T,f),n(T,i),T.putInt32(C.length()),T.putBuffer(C),T.putInt32(m.length()),T.putBuffer(m);var h=t.hmac.create();return h.start("sha1",R),h.update(T.bytes()),A+=`\r
Private-MAC: `+h.digest().toHex()+`\r
`,A},e.publicKeyToOpenSSH=function(u,c){var i="ssh-rsa";c=c||"";var y=t.util.createBuffer();return n(y,i),r(y,u.e),r(y,u.n),i+" "+t.util.encode64(y.bytes())+" "+c},e.privateKeyToOpenSSH=function(u,c){return c?t.pki.encryptRsaPrivateKey(u,c,{legacy:!0,algorithm:"aes128"}):t.pki.privateKeyToPem(u)},e.getPublicKeyFingerprint=function(u,c){c=c||{};var i=c.md||t.md.md5.create(),y="ssh-rsa",f=t.util.createBuffer();n(f,y),r(f,u.e),r(f,u.n),i.start(),i.update(f.getBytes());var A=i.digest();if(c.encoding==="hex"){var C=A.toHex();return c.delimiter?C.match(/.{2}/g).join(c.delimiter):C}else{if(c.encoding==="binary")return A.getBytes();if(c.encoding)throw new Error('Unknown encoding "'+c.encoding+'".')}return A};function r(u,c){var i=c.toString(16);i[0]>="8"&&(i="00"+i);var y=t.util.hexToBytes(i);u.putInt32(y.length),u.putBytes(y)}function n(u,c){u.putInt32(c.length),u.putString(c)}function s(){for(var u=t.md.sha1.create(),c=arguments.length,i=0;i<c;++i)u.update(arguments[i]);return u.digest()}return ma.exports}var Ea,Wo;function dd(){return Wo||(Wo=1,Ea=me(),sr(),id(),Tt(),ps(),oi(),sd(),an(),od(),ud(),cd(),Pc(),gs(),Rr(),bc(),Uc(),ld(),Oc(),Rc(),wc(),vs(),yt(),Ic(),fd(),kc(),Ae()),Ea}var Qo;function hd(){if(Qo)return Or;Qo=1,Object.defineProperty(Or,"__esModule",{value:!0}),Or.getPem=void 0;const t=nr,e=dd(),n=(0,Pt.promisify)(t.readFile);function s(i,y){if(y)u(i).then(f=>y(null,f)).catch(f=>y(f,null));else return u(i)}Or.getPem=s;function u(i){return n(i,{encoding:"base64"}).then(y=>c(y))}function c(i){const y=e.util.decode64(i),f=e.asn1.fromDer(y),C=e.pkcs12.pkcs12FromAsn1(f,"notasecret").getBags({friendlyName:"privatekey"});if(C.friendlyName){const p=C.friendlyName[0].key;return e.pki.privateKeyToPem(p).replace(/\r\n/g,`
`)}else throw new Error("Unable to get friendly name.")}return Or}Object.defineProperty(ni,"__esModule",{value:!0});ni.GoogleToken=void 0;const Yo=nr,pd=At,yd=Ut,gd=Mu,vd=Pt,Jo=Yo.readFile?(0,vd.promisify)(Yo.readFile):async()=>{throw new On("use key rather than keyFile.","MISSING_CREDENTIALS")},Xo="https://www.googleapis.com/oauth2/v4/token",md="https://accounts.google.com/o/oauth2/revoke?token=";class On extends Error{constructor(e,r){super(e),this.code=r}}let Ca;class Ed{constructor(e){this.transporter={request:r=>(0,pd.request)(r)},this.configure(e)}get accessToken(){return this.rawToken?this.rawToken.access_token:void 0}get idToken(){return this.rawToken?this.rawToken.id_token:void 0}get tokenType(){return this.rawToken?this.rawToken.token_type:void 0}get refreshToken(){return this.rawToken?this.rawToken.refresh_token:void 0}hasExpired(){const e=new Date().getTime();return this.rawToken&&this.expiresAt?e>=this.expiresAt:!0}isTokenExpiring(){var e;const r=new Date().getTime(),n=(e=this.eagerRefreshThresholdMillis)!==null&&e!==void 0?e:0;return this.rawToken&&this.expiresAt?this.expiresAt<=r+n:!0}getToken(e,r={}){if(typeof e=="object"&&(r=e,e=void 0),r=Object.assign({forceRefresh:!1},r),e){const n=e;this.getTokenAsync(r).then(s=>n(null,s),e);return}return this.getTokenAsync(r)}async getCredentials(e){switch(gd.extname(e)){case".json":{const n=await Jo(e,"utf8"),s=JSON.parse(n),u=s.private_key,c=s.client_email;if(!u||!c)throw new On("private_key and client_email are required.","MISSING_CREDENTIALS");return{privateKey:u,clientEmail:c}}case".der":case".crt":case".pem":return{privateKey:await Jo(e,"utf8")};case".p12":case".pfx":return Ca||(Ca=(await Promise.resolve().then(()=>hd())).getPem),{privateKey:await Ca(e)};default:throw new On("Unknown certificate type. Type is determined based on file extension. Current supported extensions are *.json, *.pem, and *.p12.","UNKNOWN_CERTIFICATE_TYPE")}}async getTokenAsync(e){if(this.inFlightRequest&&!e.forceRefresh)return this.inFlightRequest;try{return await(this.inFlightRequest=this.getTokenAsyncInner(e))}finally{this.inFlightRequest=void 0}}async getTokenAsyncInner(e){if(this.isTokenExpiring()===!1&&e.forceRefresh===!1)return Promise.resolve(this.rawToken);if(!this.key&&!this.keyFile)throw new Error("No key or keyFile set.");if(!this.key&&this.keyFile){const r=await this.getCredentials(this.keyFile);this.key=r.privateKey,this.iss=r.clientEmail||this.iss,r.clientEmail||this.ensureEmail()}return this.requestToken()}ensureEmail(){if(!this.iss)throw new On("email is required.","MISSING_CREDENTIALS")}revokeToken(e){if(e){this.revokeTokenAsync().then(()=>e(),e);return}return this.revokeTokenAsync()}async revokeTokenAsync(){if(!this.accessToken)throw new Error("No token to revoke.");const e=md+this.accessToken;await this.transporter.request({url:e}),this.configure({email:this.iss,sub:this.sub,key:this.key,keyFile:this.keyFile,scope:this.scope,additionalClaims:this.additionalClaims})}configure(e={}){this.keyFile=e.keyFile,this.key=e.key,this.rawToken=void 0,this.iss=e.email||e.iss,this.sub=e.sub,this.additionalClaims=e.additionalClaims,typeof e.scope=="object"?this.scope=e.scope.join(" "):this.scope=e.scope,this.eagerRefreshThresholdMillis=e.eagerRefreshThresholdMillis,e.transporter&&(this.transporter=e.transporter)}async requestToken(){var e,r;const n=Math.floor(new Date().getTime()/1e3),s=this.additionalClaims||{},u=Object.assign({iss:this.iss,scope:this.scope,aud:Xo,exp:n+3600,iat:n,sub:this.sub},s),c=yd.sign({header:{alg:"RS256"},payload:u,secret:this.key});try{const i=await this.transporter.request({method:"POST",url:Xo,data:{grant_type:"urn:ietf:params:oauth:grant-type:jwt-bearer",assertion:c},headers:{"Content-Type":"application/x-www-form-urlencoded"},responseType:"json"});return this.rawToken=i.data,this.expiresAt=i.data.expires_in===null||i.data.expires_in===void 0?void 0:(n+i.data.expires_in)*1e3,this.rawToken}catch(i){this.rawToken=void 0,this.tokenExpires=void 0;const y=i.response&&(!((e=i.response)===null||e===void 0)&&e.data)?(r=i.response)===null||r===void 0?void 0:r.data:{};if(y.error){const f=y.error_description?`: ${y.error_description}`:"";i.message=`${y.error}${f}`}throw i}}}ni.GoogleToken=Ed;var on={},Sa,Zo;function Cd(){return Zo||(Zo=1,Sa=function(t){t.prototype[Symbol.iterator]=function*(){for(let e=this.head;e;e=e.next)yield e.value}}),Sa}var Sd=Se;Se.Node=Zt;Se.create=Se;function Se(t){var e=this;if(e instanceof Se||(e=new Se),e.tail=null,e.head=null,e.length=0,t&&typeof t.forEach=="function")t.forEach(function(s){e.push(s)});else if(arguments.length>0)for(var r=0,n=arguments.length;r<n;r++)e.push(arguments[r]);return e}Se.prototype.removeNode=function(t){if(t.list!==this)throw new Error("removing node which does not belong to this list");var e=t.next,r=t.prev;return e&&(e.prev=r),r&&(r.next=e),t===this.head&&(this.head=e),t===this.tail&&(this.tail=r),t.list.length--,t.next=null,t.prev=null,t.list=null,e};Se.prototype.unshiftNode=function(t){if(t!==this.head){t.list&&t.list.removeNode(t);var e=this.head;t.list=this,t.next=e,e&&(e.prev=t),this.head=t,this.tail||(this.tail=t),this.length++}};Se.prototype.pushNode=function(t){if(t!==this.tail){t.list&&t.list.removeNode(t);var e=this.tail;t.list=this,t.prev=e,e&&(e.next=t),this.tail=t,this.head||(this.head=t),this.length++}};Se.prototype.push=function(){for(var t=0,e=arguments.length;t<e;t++)Td(this,arguments[t]);return this.length};Se.prototype.unshift=function(){for(var t=0,e=arguments.length;t<e;t++)xd(this,arguments[t]);return this.length};Se.prototype.pop=function(){if(this.tail){var t=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,t}};Se.prototype.shift=function(){if(this.head){var t=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,t}};Se.prototype.forEach=function(t,e){e=e||this;for(var r=this.head,n=0;r!==null;n++)t.call(e,r.value,n,this),r=r.next};Se.prototype.forEachReverse=function(t,e){e=e||this;for(var r=this.tail,n=this.length-1;r!==null;n--)t.call(e,r.value,n,this),r=r.prev};Se.prototype.get=function(t){for(var e=0,r=this.head;r!==null&&e<t;e++)r=r.next;if(e===t&&r!==null)return r.value};Se.prototype.getReverse=function(t){for(var e=0,r=this.tail;r!==null&&e<t;e++)r=r.prev;if(e===t&&r!==null)return r.value};Se.prototype.map=function(t,e){e=e||this;for(var r=new Se,n=this.head;n!==null;)r.push(t.call(e,n.value,this)),n=n.next;return r};Se.prototype.mapReverse=function(t,e){e=e||this;for(var r=new Se,n=this.tail;n!==null;)r.push(t.call(e,n.value,this)),n=n.prev;return r};Se.prototype.reduce=function(t,e){var r,n=this.head;if(arguments.length>1)r=e;else if(this.head)n=this.head.next,r=this.head.value;else throw new TypeError("Reduce of empty list with no initial value");for(var s=0;n!==null;s++)r=t(r,n.value,s),n=n.next;return r};Se.prototype.reduceReverse=function(t,e){var r,n=this.tail;if(arguments.length>1)r=e;else if(this.tail)n=this.tail.prev,r=this.tail.value;else throw new TypeError("Reduce of empty list with no initial value");for(var s=this.length-1;n!==null;s--)r=t(r,n.value,s),n=n.prev;return r};Se.prototype.toArray=function(){for(var t=new Array(this.length),e=0,r=this.head;r!==null;e++)t[e]=r.value,r=r.next;return t};Se.prototype.toArrayReverse=function(){for(var t=new Array(this.length),e=0,r=this.tail;r!==null;e++)t[e]=r.value,r=r.prev;return t};Se.prototype.slice=function(t,e){e=e||this.length,e<0&&(e+=this.length),t=t||0,t<0&&(t+=this.length);var r=new Se;if(e<t||e<0)return r;t<0&&(t=0),e>this.length&&(e=this.length);for(var n=0,s=this.head;s!==null&&n<t;n++)s=s.next;for(;s!==null&&n<e;n++,s=s.next)r.push(s.value);return r};Se.prototype.sliceReverse=function(t,e){e=e||this.length,e<0&&(e+=this.length),t=t||0,t<0&&(t+=this.length);var r=new Se;if(e<t||e<0)return r;t<0&&(t=0),e>this.length&&(e=this.length);for(var n=this.length,s=this.tail;s!==null&&n>e;n--)s=s.prev;for(;s!==null&&n>t;n--,s=s.prev)r.push(s.value);return r};Se.prototype.splice=function(t,e,...r){t>this.length&&(t=this.length-1),t<0&&(t=this.length+t);for(var n=0,s=this.head;s!==null&&n<t;n++)s=s.next;for(var u=[],n=0;s&&n<e;n++)u.push(s.value),s=this.removeNode(s);s===null&&(s=this.tail),s!==this.head&&s!==this.tail&&(s=s.prev);for(var n=0;n<r.length;n++)s=Ad(this,s,r[n]);return u};Se.prototype.reverse=function(){for(var t=this.head,e=this.tail,r=t;r!==null;r=r.prev){var n=r.prev;r.prev=r.next,r.next=n}return this.head=e,this.tail=t,this};function Ad(t,e,r){var n=e===t.head?new Zt(r,null,e,t):new Zt(r,e,e.next,t);return n.next===null&&(t.tail=n),n.prev===null&&(t.head=n),t.length++,n}function Td(t,e){t.tail=new Zt(e,t.tail,null,t),t.head||(t.head=t.tail),t.length++}function xd(t,e){t.head=new Zt(e,null,t.head,t),t.tail||(t.tail=t.head),t.length++}function Zt(t,e,r,n){if(!(this instanceof Zt))return new Zt(t,e,r,n);this.list=n,this.value=t,e?(e.next=this,this.prev=e):this.prev=null,r?(r.prev=this,this.next=r):this.next=null}try{Cd()(Se)}catch{}const _d=Sd,Qt=Symbol("max"),Rt=Symbol("length"),hr=Symbol("lengthCalculator"),$r=Symbol("allowStale"),Jt=Symbol("maxAge"),bt=Symbol("dispose"),eu=Symbol("noDisposeOnSet"),Xe=Symbol("lruList"),ht=Symbol("cache"),Dc=Symbol("updateAgeOnGet"),Aa=()=>1;class wd{constructor(e){if(typeof e=="number"&&(e={max:e}),e||(e={}),e.max&&(typeof e.max!="number"||e.max<0))throw new TypeError("max must be a non-negative number");this[Qt]=e.max||1/0;const r=e.length||Aa;if(this[hr]=typeof r!="function"?Aa:r,this[$r]=e.stale||!1,e.maxAge&&typeof e.maxAge!="number")throw new TypeError("maxAge must be a number");this[Jt]=e.maxAge||0,this[bt]=e.dispose,this[eu]=e.noDisposeOnSet||!1,this[Dc]=e.updateAgeOnGet||!1,this.reset()}set max(e){if(typeof e!="number"||e<0)throw new TypeError("max must be a non-negative number");this[Qt]=e||1/0,kr(this)}get max(){return this[Qt]}set allowStale(e){this[$r]=!!e}get allowStale(){return this[$r]}set maxAge(e){if(typeof e!="number")throw new TypeError("maxAge must be a non-negative number");this[Jt]=e,kr(this)}get maxAge(){return this[Jt]}set lengthCalculator(e){typeof e!="function"&&(e=Aa),e!==this[hr]&&(this[hr]=e,this[Rt]=0,this[Xe].forEach(r=>{r.length=this[hr](r.value,r.key),this[Rt]+=r.length})),kr(this)}get lengthCalculator(){return this[hr]}get length(){return this[Rt]}get itemCount(){return this[Xe].length}rforEach(e,r){r=r||this;for(let n=this[Xe].tail;n!==null;){const s=n.prev;tu(this,e,n,r),n=s}}forEach(e,r){r=r||this;for(let n=this[Xe].head;n!==null;){const s=n.next;tu(this,e,n,r),n=s}}keys(){return this[Xe].toArray().map(e=>e.key)}values(){return this[Xe].toArray().map(e=>e.value)}reset(){this[bt]&&this[Xe]&&this[Xe].length&&this[Xe].forEach(e=>this[bt](e.key,e.value)),this[ht]=new Map,this[Xe]=new _d,this[Rt]=0}dump(){return this[Xe].map(e=>Vn(this,e)?!1:{k:e.key,v:e.value,e:e.now+(e.maxAge||0)}).toArray().filter(e=>e)}dumpLru(){return this[Xe]}set(e,r,n){if(n=n||this[Jt],n&&typeof n!="number")throw new TypeError("maxAge must be a number");const s=n?Date.now():0,u=this[hr](r,e);if(this[ht].has(e)){if(u>this[Qt])return mr(this,this[ht].get(e)),!1;const y=this[ht].get(e).value;return this[bt]&&(this[eu]||this[bt](e,y.value)),y.now=s,y.maxAge=n,y.value=r,this[Rt]+=u-y.length,y.length=u,this.get(e),kr(this),!0}const c=new Id(e,r,u,s,n);return c.length>this[Qt]?(this[bt]&&this[bt](e,r),!1):(this[Rt]+=c.length,this[Xe].unshift(c),this[ht].set(e,this[Xe].head),kr(this),!0)}has(e){if(!this[ht].has(e))return!1;const r=this[ht].get(e).value;return!Vn(this,r)}get(e){return Ta(this,e,!0)}peek(e){return Ta(this,e,!1)}pop(){const e=this[Xe].tail;return e?(mr(this,e),e.value):null}del(e){mr(this,this[ht].get(e))}load(e){this.reset();const r=Date.now();for(let n=e.length-1;n>=0;n--){const s=e[n],u=s.e||0;if(u===0)this.set(s.k,s.v);else{const c=u-r;c>0&&this.set(s.k,s.v,c)}}}prune(){this[ht].forEach((e,r)=>Ta(this,r,!1))}}const Ta=(t,e,r)=>{const n=t[ht].get(e);if(n){const s=n.value;if(Vn(t,s)){if(mr(t,n),!t[$r])return}else r&&(t[Dc]&&(n.value.now=Date.now()),t[Xe].unshiftNode(n));return s.value}},Vn=(t,e)=>{if(!e||!e.maxAge&&!t[Jt])return!1;const r=Date.now()-e.now;return e.maxAge?r>e.maxAge:t[Jt]&&r>t[Jt]},kr=t=>{if(t[Rt]>t[Qt])for(let e=t[Xe].tail;t[Rt]>t[Qt]&&e!==null;){const r=e.prev;mr(t,e),e=r}},mr=(t,e)=>{if(e){const r=e.value;t[bt]&&t[bt](r.key,r.value),t[Rt]-=r.length,t[ht].delete(r.key),t[Xe].removeNode(e)}};class Id{constructor(e,r,n,s,u){this.key=e,this.value=r,this.length=n,this.now=s,this.maxAge=u||0}}const tu=(t,e,r,n)=>{let s=r.value;Vn(t,s)&&(mr(t,r),t[$r]||(s=void 0)),s&&e.call(n,s.value,s.key,t)};var bd=wd;Object.defineProperty(on,"__esModule",{value:!0});on.JWTAccess=void 0;const Rd=Ut,Bd=bd,ru={alg:"RS256",typ:"JWT"};class Es{constructor(e,r,n,s){this.cache=new Bd({max:500,maxAge:60*60*1e3}),this.email=e,this.key=r,this.keyId=n,this.eagerRefreshThresholdMillis=s??5*60*1e3}getCachedKey(e,r){let n=e;if(r&&Array.isArray(r)&&r.length?n=e?`${e}_${r.join("_")}`:`${r.join("_")}`:typeof r=="string"&&(n=e?`${e}_${r}`:r),!n)throw Error("Scopes or url must be provided");return n}getRequestHeaders(e,r,n){const s=this.getCachedKey(e,n),u=this.cache.get(s),c=Date.now();if(u&&u.expiration-c>this.eagerRefreshThresholdMillis)return u.headers;const i=Math.floor(Date.now()/1e3),y=Es.getExpirationTime(i);let f;if(Array.isArray(n)&&(n=n.join(" ")),n?f={iss:this.email,sub:this.email,scope:n,exp:y,iat:i}:f={iss:this.email,sub:this.email,aud:e,exp:y,iat:i},r){for(const m in f)if(r[m])throw new Error(`The '${m}' property is not allowed when passing additionalClaims. This claim is included in the JWT by default.`)}const A=this.keyId?{...ru,kid:this.keyId}:ru,C=Object.assign(f,r),o={Authorization:`Bearer ${Rd.sign({header:A,payload:C,secret:this.key})}`};return this.cache.set(s,{expiration:y*1e3,headers:o}),o}static getExpirationTime(e){return e+3600}fromJSON(e){if(!e)throw new Error("Must pass in a JSON object containing the service account auth settings.");if(!e.client_email)throw new Error("The incoming JSON object does not contain a client_email field");if(!e.private_key)throw new Error("The incoming JSON object does not contain a private_key field");this.email=e.client_email,this.key=e.private_key,this.keyId=e.private_key_id,this.projectId=e.project_id}fromStream(e,r){if(r)this.fromStreamAsync(e).then(()=>r(),r);else return this.fromStreamAsync(e)}fromStreamAsync(e){return new Promise((r,n)=>{e||n(new Error("Must pass in a stream containing the service account auth settings."));let s="";e.setEncoding("utf8").on("data",u=>s+=u).on("error",n).on("end",()=>{try{const u=JSON.parse(s);this.fromJSON(u),r()}catch(u){n(u)}})})}}on.JWTAccess=Es;Object.defineProperty(rn,"__esModule",{value:!0});rn.JWT=void 0;const nu=ni,Nd=on,Pd=ar;class Cs extends Pd.OAuth2Client{constructor(e,r,n,s,u,c){const i=e&&typeof e=="object"?e:{email:e,keyFile:r,key:n,keyId:c,scopes:s,subject:u};super({eagerRefreshThresholdMillis:i.eagerRefreshThresholdMillis,forceRefreshOnFailure:i.forceRefreshOnFailure}),this.email=i.email,this.keyFile=i.keyFile,this.key=i.key,this.keyId=i.keyId,this.scopes=i.scopes,this.subject=i.subject,this.additionalClaims=i.additionalClaims,this.credentials={refresh_token:"jwt-placeholder",expiry_date:1}}createScoped(e){return new Cs({email:this.email,keyFile:this.keyFile,key:this.key,keyId:this.keyId,scopes:e,subject:this.subject,additionalClaims:this.additionalClaims})}async getRequestMetadataAsync(e){e=this.defaultServicePath?`https://${this.defaultServicePath}/`:e;const r=!this.hasUserScopes()&&e||this.useJWTAccessWithScope&&this.hasAnyScopes();if(!this.apiKey&&r)if(this.additionalClaims&&this.additionalClaims.target_audience){const{tokens:n}=await this.refreshToken();return{headers:this.addSharedMetadataHeaders({Authorization:`Bearer ${n.id_token}`})}}else{this.access||(this.access=new Nd.JWTAccess(this.email,this.key,this.keyId,this.eagerRefreshThresholdMillis));let n;this.hasUserScopes()?n=this.scopes:e||(n=this.defaultScopes);const s=await this.access.getRequestHeaders(e??void 0,this.additionalClaims,this.useJWTAccessWithScope?n:void 0);return{headers:this.addSharedMetadataHeaders(s)}}else return this.hasAnyScopes()||this.apiKey?super.getRequestMetadataAsync(e):{headers:{}}}async fetchIdToken(e){const r=new nu.GoogleToken({iss:this.email,sub:this.subject,scope:this.scopes||this.defaultScopes,keyFile:this.keyFile,key:this.key,additionalClaims:{target_audience:e},transporter:this.transporter});if(await r.getToken({forceRefresh:!0}),!r.idToken)throw new Error("Unknown error: Failed to fetch ID token");return r.idToken}hasUserScopes(){return this.scopes?this.scopes.length>0:!1}hasAnyScopes(){return!!(this.scopes&&this.scopes.length>0||this.defaultScopes&&this.defaultScopes.length>0)}authorize(e){if(e)this.authorizeAsync().then(r=>e(null,r),e);else return this.authorizeAsync()}async authorizeAsync(){const e=await this.refreshToken();if(!e)throw new Error("No result returned");return this.credentials=e.tokens,this.credentials.refresh_token="jwt-placeholder",this.key=this.gtoken.key,this.email=this.gtoken.iss,e.tokens}async refreshTokenNoCache(e){const r=this.createGToken(),s={access_token:(await r.getToken({forceRefresh:this.isTokenExpiring()})).access_token,token_type:"Bearer",expiry_date:r.expiresAt,id_token:r.idToken};return this.emit("tokens",s),{res:null,tokens:s}}createGToken(){return this.gtoken||(this.gtoken=new nu.GoogleToken({iss:this.email,sub:this.subject,scope:this.scopes||this.defaultScopes,keyFile:this.keyFile,key:this.key,additionalClaims:this.additionalClaims,transporter:this.transporter})),this.gtoken}fromJSON(e){if(!e)throw new Error("Must pass in a JSON object containing the service account auth settings.");if(!e.client_email)throw new Error("The incoming JSON object does not contain a client_email field");if(!e.private_key)throw new Error("The incoming JSON object does not contain a private_key field");this.email=e.client_email,this.key=e.private_key,this.keyId=e.private_key_id,this.projectId=e.project_id,this.quotaProjectId=e.quota_project_id}fromStream(e,r){if(r)this.fromStreamAsync(e).then(()=>r(),r);else return this.fromStreamAsync(e)}fromStreamAsync(e){return new Promise((r,n)=>{if(!e)throw new Error("Must pass in a stream containing the service account auth settings.");let s="";e.setEncoding("utf8").on("error",n).on("data",u=>s+=u).on("end",()=>{try{const u=JSON.parse(s);this.fromJSON(u),r()}catch(u){n(u)}})})}fromAPIKey(e){if(typeof e!="string")throw new Error("Must provide an API Key string.");this.apiKey=e}async getCredentials(){if(this.key)return{private_key:this.key,client_email:this.email};if(this.keyFile){const r=await this.createGToken().getCredentials(this.keyFile);return{private_key:r.privateKey,client_email:r.clientEmail}}throw new Error("A key or a keyFile must be provided to getCredentials.")}}rn.JWT=Cs;var er={};Object.defineProperty(er,"__esModule",{value:!0});er.UserRefreshClient=er.USER_REFRESH_ACCOUNT_TYPE=void 0;const Ud=ar;er.USER_REFRESH_ACCOUNT_TYPE="authorized_user";class Od extends Ud.OAuth2Client{constructor(e,r,n,s,u){const c=e&&typeof e=="object"?e:{clientId:e,clientSecret:r,refreshToken:n,eagerRefreshThresholdMillis:s,forceRefreshOnFailure:u};super({clientId:c.clientId,clientSecret:c.clientSecret,eagerRefreshThresholdMillis:c.eagerRefreshThresholdMillis,forceRefreshOnFailure:c.forceRefreshOnFailure}),this._refreshToken=c.refreshToken,this.credentials.refresh_token=c.refreshToken}async refreshTokenNoCache(e){return super.refreshTokenNoCache(this._refreshToken)}fromJSON(e){if(!e)throw new Error("Must pass in a JSON object containing the user refresh token");if(e.type!=="authorized_user")throw new Error('The incoming JSON object does not have the "authorized_user" type');if(!e.client_id)throw new Error("The incoming JSON object does not contain a client_id field");if(!e.client_secret)throw new Error("The incoming JSON object does not contain a client_secret field");if(!e.refresh_token)throw new Error("The incoming JSON object does not contain a refresh_token field");this._clientId=e.client_id,this._clientSecret=e.client_secret,this._refreshToken=e.refresh_token,this.credentials.refresh_token=e.refresh_token,this.quotaProjectId=e.quota_project_id}fromStream(e,r){if(r)this.fromStreamAsync(e).then(()=>r(),r);else return this.fromStreamAsync(e)}async fromStreamAsync(e){return new Promise((r,n)=>{if(!e)return n(new Error("Must pass in a stream containing the user refresh token."));let s="";e.setEncoding("utf8").on("error",n).on("data",u=>s+=u).on("end",()=>{try{const u=JSON.parse(s);return this.fromJSON(u),r()}catch(u){return n(u)}})})}}er.UserRefreshClient=Od;var tr={};Object.defineProperty(tr,"__esModule",{value:!0});tr.Impersonated=tr.IMPERSONATED_ACCOUNT_TYPE=void 0;const iu=ar,kd=At;tr.IMPERSONATED_ACCOUNT_TYPE="impersonated_service_account";class Ld extends iu.OAuth2Client{constructor(e={}){var r,n,s,u,c,i;super(e),this.credentials={expiry_date:1,refresh_token:"impersonated-placeholder"},this.sourceClient=(r=e.sourceClient)!==null&&r!==void 0?r:new iu.OAuth2Client,this.targetPrincipal=(n=e.targetPrincipal)!==null&&n!==void 0?n:"",this.delegates=(s=e.delegates)!==null&&s!==void 0?s:[],this.targetScopes=(u=e.targetScopes)!==null&&u!==void 0?u:[],this.lifetime=(c=e.lifetime)!==null&&c!==void 0?c:3600,this.endpoint=(i=e.endpoint)!==null&&i!==void 0?i:"https://iamcredentials.googleapis.com"}async refreshToken(e){var r,n,s,u,c,i;try{await this.sourceClient.getAccessToken();const y="projects/-/serviceAccounts/"+this.targetPrincipal,f=`${this.endpoint}/v1/${y}:generateAccessToken`,A={delegates:this.delegates,scope:this.targetScopes,lifetime:this.lifetime+"s"},C=await this.sourceClient.request({url:f,data:A,method:"POST"}),p=C.data;return this.credentials.access_token=p.accessToken,this.credentials.expiry_date=Date.parse(p.expireTime),{tokens:this.credentials,res:C}}catch(y){if(!(y instanceof Error))throw y;let f=0,A="";throw y instanceof kd.GaxiosError&&(f=(s=(n=(r=y==null?void 0:y.response)===null||r===void 0?void 0:r.data)===null||n===void 0?void 0:n.error)===null||s===void 0?void 0:s.status,A=(i=(c=(u=y==null?void 0:y.response)===null||u===void 0?void 0:u.data)===null||c===void 0?void 0:c.error)===null||i===void 0?void 0:i.message),f&&A?(y.message=`${f}: unable to impersonate: ${A}`,y):(y.message=`unable to impersonate: ${y}`,y)}}async fetchIdToken(e,r){var n;await this.sourceClient.getAccessToken();const s=`projects/-/serviceAccounts/${this.targetPrincipal}`,u=`${this.endpoint}/v1/${s}:generateIdToken`,c={delegates:this.delegates,audience:e,includeEmail:(n=r==null?void 0:r.includeEmail)!==null&&n!==void 0?n:!0};return(await this.sourceClient.request({url:u,data:c,method:"POST"})).data.token}}tr.Impersonated=Ld;var un={},$t={},cn={},rr={};Object.defineProperty(rr,"__esModule",{value:!0});rr.getErrorFromOAuthErrorResponse=rr.OAuthClientAuthHandler=void 0;const au=Hn,Dd=Jr(),Fd=["PUT","POST","PATCH"];class Md{constructor(e){this.clientAuthentication=e,this.crypto=(0,Dd.createCrypto)()}applyClientAuthenticationOptions(e,r){this.injectAuthenticatedHeaders(e,r),r||this.injectAuthenticatedRequestBody(e)}injectAuthenticatedHeaders(e,r){var n;if(r)e.headers=e.headers||{},Object.assign(e.headers,{Authorization:`Bearer ${r}}`});else if(((n=this.clientAuthentication)===null||n===void 0?void 0:n.confidentialClientType)==="basic"){e.headers=e.headers||{};const s=this.clientAuthentication.clientId,u=this.clientAuthentication.clientSecret||"",c=this.crypto.encodeBase64StringUtf8(`${s}:${u}`);Object.assign(e.headers,{Authorization:`Basic ${c}`})}}injectAuthenticatedRequestBody(e){var r;if(((r=this.clientAuthentication)===null||r===void 0?void 0:r.confidentialClientType)==="request-body"){const n=(e.method||"GET").toUpperCase();if(Fd.indexOf(n)!==-1){let s;const u=e.headers||{};for(const c in u)if(c.toLowerCase()==="content-type"&&u[c]){s=u[c].toLowerCase();break}if(s==="application/x-www-form-urlencoded"){e.data=e.data||"";const c=au.parse(e.data);Object.assign(c,{client_id:this.clientAuthentication.clientId,client_secret:this.clientAuthentication.clientSecret||""}),e.data=au.stringify(c)}else if(s==="application/json")e.data=e.data||{},Object.assign(e.data,{client_id:this.clientAuthentication.clientId,client_secret:this.clientAuthentication.clientSecret||""});else throw new Error(`${s} content-types are not supported with ${this.clientAuthentication.confidentialClientType} client authentication`)}else throw new Error(`${n} HTTP method does not support ${this.clientAuthentication.confidentialClientType} client authentication`)}}}rr.OAuthClientAuthHandler=Md;function qd(t,e){const r=t.error,n=t.error_description,s=t.error_uri;let u=`Error code ${r}`;typeof n<"u"&&(u+=`: ${n}`),typeof s<"u"&&(u+=` - ${s}`);const c=new Error(u);if(e){const i=Object.keys(e);e.stack&&i.push("stack"),i.forEach(y=>{y!=="message"&&Object.defineProperty(c,y,{value:e[y],writable:!1,enumerable:!0})})}return c}rr.getErrorFromOAuthErrorResponse=qd;Object.defineProperty(cn,"__esModule",{value:!0});cn.StsCredentials=void 0;const Vd=At,Kd=Hn,$d=ir,su=rr;class Gd extends su.OAuthClientAuthHandler{constructor(e,r){super(r),this.tokenExchangeEndpoint=e,this.transporter=new $d.DefaultTransporter}async exchangeToken(e,r,n){var s,u,c;const i={grant_type:e.grantType,resource:e.resource,audience:e.audience,scope:(s=e.scope)===null||s===void 0?void 0:s.join(" "),requested_token_type:e.requestedTokenType,subject_token:e.subjectToken,subject_token_type:e.subjectTokenType,actor_token:(u=e.actingParty)===null||u===void 0?void 0:u.actorToken,actor_token_type:(c=e.actingParty)===null||c===void 0?void 0:c.actorTokenType,options:n&&JSON.stringify(n)};Object.keys(i).forEach(A=>{typeof i[A]>"u"&&delete i[A]});const y={"Content-Type":"application/x-www-form-urlencoded"};Object.assign(y,r||{});const f={url:this.tokenExchangeEndpoint,method:"POST",headers:y,data:Kd.stringify(i),responseType:"json"};this.applyClientAuthenticationOptions(f);try{const A=await this.transporter.request(f),C=A.data;return C.res=A,C}catch(A){throw A instanceof Vd.GaxiosError&&A.response?(0,su.getErrorFromOAuthErrorResponse)(A.response.data,A):A}}}cn.StsCredentials=Gd;(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.BaseExternalAccountClient=t.CLOUD_RESOURCE_MANAGER=t.EXTERNAL_ACCOUNT_TYPE=t.EXPIRATION_TIME_OFFSET=void 0;const e=Nt,r=Kt,n=cn,s="urn:ietf:params:oauth:grant-type:token-exchange",u="urn:ietf:params:oauth:token-type:access_token",c="https://www.googleapis.com/auth/cloud-platform",i=3600;t.EXPIRATION_TIME_OFFSET=5*60*1e3,t.EXTERNAL_ACCOUNT_TYPE="external_account",t.CLOUD_RESOURCE_MANAGER="https://cloudresourcemanager.googleapis.com/v1/projects/";const y="//iam.googleapis.com/locations/[^/]+/workforcePools/[^/]+/providers/.+";class f extends r.AuthClient{constructor(C,p){var o,m;if(super(),C.type!==t.EXTERNAL_ACCOUNT_TYPE)throw new Error(`Expected "${t.EXTERNAL_ACCOUNT_TYPE}" type but received "${C.type}"`);this.clientAuth=C.client_id?{confidentialClientType:"basic",clientId:C.client_id,clientSecret:C.client_secret}:void 0,this.stsCredential=new n.StsCredentials(C.token_url,this.clientAuth),this.scopes=[c],this.cachedAccessToken=null,this.audience=C.audience,this.subjectTokenType=C.subject_token_type,this.quotaProjectId=C.quota_project_id,this.workforcePoolUserProject=C.workforce_pool_user_project;const g=new RegExp(y);if(this.workforcePoolUserProject&&!this.audience.match(g))throw new Error("workforcePoolUserProject should not be set for non-workforce pool credentials.");this.serviceAccountImpersonationUrl=C.service_account_impersonation_url,this.serviceAccountImpersonationLifetime=(m=(o=C.service_account_impersonation)===null||o===void 0?void 0:o.token_lifetime_seconds)!==null&&m!==void 0?m:i,typeof(p==null?void 0:p.eagerRefreshThresholdMillis)!="number"?this.eagerRefreshThresholdMillis=t.EXPIRATION_TIME_OFFSET:this.eagerRefreshThresholdMillis=p.eagerRefreshThresholdMillis,this.forceRefreshOnFailure=!!(p!=null&&p.forceRefreshOnFailure),this.projectId=null,this.projectNumber=this.getProjectNumber(this.audience)}getServiceAccountEmail(){var C;if(this.serviceAccountImpersonationUrl){const o=/serviceAccounts\/(?<email>[^:]+):generateAccessToken$/.exec(this.serviceAccountImpersonationUrl);return((C=o==null?void 0:o.groups)===null||C===void 0?void 0:C.email)||null}return null}setCredentials(C){super.setCredentials(C),this.cachedAccessToken=C}async getAccessToken(){return(!this.cachedAccessToken||this.isExpired(this.cachedAccessToken))&&await this.refreshAccessTokenAsync(),{token:this.cachedAccessToken.access_token,res:this.cachedAccessToken.res}}async getRequestHeaders(){const p={Authorization:`Bearer ${(await this.getAccessToken()).token}`};return this.addSharedMetadataHeaders(p)}request(C,p){if(p)this.requestAsync(C).then(o=>p(null,o),o=>p(o,o.response));else return this.requestAsync(C)}async getProjectId(){const C=this.projectNumber||this.workforcePoolUserProject;if(this.projectId)return this.projectId;if(C){const p=await this.getRequestHeaders(),o=await this.transporter.request({headers:p,url:`${t.CLOUD_RESOURCE_MANAGER}${C}`,responseType:"json"});return this.projectId=o.data.projectId,this.projectId}return null}async requestAsync(C,p=!1){let o;try{const m=await this.getRequestHeaders();C.headers=C.headers||{},m&&m["x-goog-user-project"]&&(C.headers["x-goog-user-project"]=m["x-goog-user-project"]),m&&m.Authorization&&(C.headers.Authorization=m.Authorization),o=await this.transporter.request(C)}catch(m){const g=m.response;if(g){const S=g.status,a=g.config.data instanceof e.Readable;if(!p&&(S===401||S===403)&&!a&&this.forceRefreshOnFailure)return await this.refreshAccessTokenAsync(),await this.requestAsync(C,!0)}throw m}return o}async refreshAccessTokenAsync(){const C=await this.retrieveSubjectToken(),p={grantType:s,audience:this.audience,requestedTokenType:u,subjectToken:C,subjectTokenType:this.subjectTokenType,scope:this.serviceAccountImpersonationUrl?[c]:this.getScopesArray()},o=!this.clientAuth&&this.workforcePoolUserProject?{userProject:this.workforcePoolUserProject}:void 0,m=await this.stsCredential.exchangeToken(p,void 0,o);return this.serviceAccountImpersonationUrl?this.cachedAccessToken=await this.getImpersonatedAccessToken(m.access_token):m.expires_in?this.cachedAccessToken={access_token:m.access_token,expiry_date:new Date().getTime()+m.expires_in*1e3,res:m.res}:this.cachedAccessToken={access_token:m.access_token,res:m.res},this.credentials={},Object.assign(this.credentials,this.cachedAccessToken),delete this.credentials.res,this.emit("tokens",{refresh_token:null,expiry_date:this.cachedAccessToken.expiry_date,access_token:this.cachedAccessToken.access_token,token_type:"Bearer",id_token:null}),this.cachedAccessToken}getProjectNumber(C){const p=C.match(/\/projects\/([^/]+)/);return p?p[1]:null}async getImpersonatedAccessToken(C){const p={url:this.serviceAccountImpersonationUrl,method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${C}`},data:{scope:this.getScopesArray(),lifetime:this.serviceAccountImpersonationLifetime+"s"},responseType:"json"},o=await this.transporter.request(p),m=o.data;return{access_token:m.accessToken,expiry_date:new Date(m.expireTime).getTime(),res:o}}isExpired(C){const p=new Date().getTime();return C.expiry_date?p>=C.expiry_date-this.eagerRefreshThresholdMillis:!1}getScopesArray(){return typeof this.scopes=="string"?[this.scopes]:typeof this.scopes>"u"?[c]:this.scopes}}t.BaseExternalAccountClient=f})($t);var ln={},xa,_a,wa;Object.defineProperty(ln,"__esModule",{value:!0});ln.IdentityPoolClient=void 0;const Ss=nr,As=Pt,jd=$t,Hd=(0,As.promisify)((xa=Ss.readFile)!==null&&xa!==void 0?xa:()=>{}),zd=(0,As.promisify)((_a=Ss.realpath)!==null&&_a!==void 0?_a:()=>{}),Wd=(0,As.promisify)((wa=Ss.lstat)!==null&&wa!==void 0?wa:()=>{});class Qd extends jd.BaseExternalAccountClient{constructor(e,r){var n,s;if(super(e,r),this.file=e.credential_source.file,this.url=e.credential_source.url,this.headers=e.credential_source.headers,!this.file&&!this.url)throw new Error('No valid Identity Pool "credential_source" provided');if(this.formatType=((n=e.credential_source.format)===null||n===void 0?void 0:n.type)||"text",this.formatSubjectTokenFieldName=(s=e.credential_source.format)===null||s===void 0?void 0:s.subject_token_field_name,this.formatType!=="json"&&this.formatType!=="text")throw new Error(`Invalid credential_source format "${this.formatType}"`);if(this.formatType==="json"&&!this.formatSubjectTokenFieldName)throw new Error("Missing subject_token_field_name for JSON credential_source format")}async retrieveSubjectToken(){return this.file?await this.getTokenFromFile(this.file,this.formatType,this.formatSubjectTokenFieldName):await this.getTokenFromUrl(this.url,this.formatType,this.formatSubjectTokenFieldName,this.headers)}async getTokenFromFile(e,r,n){try{if(e=await zd(e),!(await Wd(e)).isFile())throw new Error}catch(c){throw c instanceof Error&&(c.message=`The file at ${e} does not exist, or it is not a file. ${c.message}`),c}let s;const u=await Hd(e,{encoding:"utf8"});if(r==="text"?s=u:r==="json"&&n&&(s=JSON.parse(u)[n]),!s)throw new Error("Unable to parse the subject_token from the credential_source file");return s}async getTokenFromUrl(e,r,n,s){const u={url:e,method:"GET",headers:s,responseType:r};let c;if(r==="text"?c=(await this.transporter.request(u)).data:r==="json"&&n&&(c=(await this.transporter.request(u)).data[n]),!c)throw new Error("Unable to parse the subject_token from the credential_source URL");return c}}ln.IdentityPoolClient=Qd;var fn={},li={};Object.defineProperty(li,"__esModule",{value:!0});li.AwsRequestSigner=void 0;const Fc=Jr(),ou="AWS4-HMAC-SHA256",Yd="aws4_request";class Jd{constructor(e,r){this.getCredentials=e,this.region=r,this.crypto=(0,Fc.createCrypto)()}async getRequestOptions(e){if(!e.url)throw new Error('"url" is required in "amzOptions"');const r=typeof e.data=="object"?JSON.stringify(e.data):e.data,n=e.url,s=e.method||"GET",u=e.body||r,c=e.headers,i=await this.getCredentials(),y=new URL(n),f=await Zd({crypto:this.crypto,host:y.host,canonicalUri:y.pathname,canonicalQuerystring:y.search.substr(1),method:s,region:this.region,securityCredentials:i,requestPayload:u,additionalAmzHeaders:c}),A=Object.assign(f.amzDate?{"x-amz-date":f.amzDate}:{},{Authorization:f.authorizationHeader,host:y.host},c||{});i.token&&Object.assign(A,{"x-amz-security-token":i.token});const C={url:n,method:s,headers:A};return typeof u<"u"&&(C.body=u),C}}li.AwsRequestSigner=Jd;async function Kr(t,e,r){return await t.signWithHmacSha256(e,r)}async function Xd(t,e,r,n,s){const u=await Kr(t,`AWS4${e}`,r),c=await Kr(t,u,n),i=await Kr(t,c,s);return await Kr(t,i,"aws4_request")}async function Zd(t){const e=t.additionalAmzHeaders||{},r=t.requestPayload||"",n=t.host.split(".")[0],s=new Date,u=s.toISOString().replace(/[-:]/g,"").replace(/\.[0-9]+/,""),c=s.toISOString().replace(/[-]/g,"").replace(/T.*/,""),i={};Object.keys(e).forEach(E=>{i[E.toLowerCase()]=e[E]}),t.securityCredentials.token&&(i["x-amz-security-token"]=t.securityCredentials.token);const y=Object.assign({host:t.host},i.date?{}:{"x-amz-date":u},i);let f="";const A=Object.keys(y).sort();A.forEach(E=>{f+=`${E}:${y[E]}
`});const C=A.join(";"),p=await t.crypto.sha256DigestHex(r),o=`${t.method}
${t.canonicalUri}
${t.canonicalQuerystring}
${f}
${C}
${p}`,m=`${c}/${t.region}/${n}/${Yd}`,g=`${ou}
${u}
${m}
`+await t.crypto.sha256DigestHex(o),S=await Xd(t.crypto,t.securityCredentials.secretAccessKey,c,t.region,n),a=await Kr(t.crypto,S,g),v=`${ou} Credential=${t.securityCredentials.accessKeyId}/${m}, SignedHeaders=${C}, Signature=${(0,Fc.fromArrayBufferToHex)(a)}`;return{amzDate:i.date?void 0:u,authorizationHeader:v,canonicalQuerystring:t.canonicalQuerystring}}Object.defineProperty(fn,"__esModule",{value:!0});fn.AwsClient=void 0;const eh=li,th=$t;class Ts extends th.BaseExternalAccountClient{constructor(e,r){super(e,r),this.environmentId=e.credential_source.environment_id,this.regionUrl=e.credential_source.region_url,this.securityCredentialsUrl=e.credential_source.url,this.regionalCredVerificationUrl=e.credential_source.regional_cred_verification_url,this.imdsV2SessionTokenUrl=e.credential_source.imdsv2_session_token_url,this.awsRequestSigner=null,this.region="",this.validateEnvironmentId()}validateEnvironmentId(){var e;const r=(e=this.environmentId)===null||e===void 0?void 0:e.match(/^(aws)(\d+)$/);if(!r||!this.regionalCredVerificationUrl)throw new Error('No valid AWS "credential_source" provided');if(parseInt(r[2],10)!==1)throw new Error(`aws version "${r[2]}" is not supported in the current build.`)}async retrieveSubjectToken(){if(!this.awsRequestSigner){const s={};this.shouldUseMetadataServer()&&this.imdsV2SessionTokenUrl&&(s["x-aws-ec2-metadata-token"]=await this.getImdsV2SessionToken()),this.region=await this.getAwsRegion(s),this.awsRequestSigner=new eh.AwsRequestSigner(async()=>{if(this.securityCredentialsFromEnv)return this.securityCredentialsFromEnv;const u=await this.getAwsRoleName(s),c=await this.getAwsSecurityCredentials(u,s);return{accessKeyId:c.AccessKeyId,secretAccessKey:c.SecretAccessKey,token:c.Token}},this.region)}const e=await this.awsRequestSigner.getRequestOptions({url:this.regionalCredVerificationUrl.replace("{region}",this.region),method:"POST"}),r=[],n=Object.assign({"x-goog-cloud-target-resource":this.audience},e.headers);for(const s in n)r.push({key:s,value:n[s]});return encodeURIComponent(JSON.stringify({url:e.url,method:e.method,headers:r}))}async getImdsV2SessionToken(){const e={url:this.imdsV2SessionTokenUrl,method:"PUT",responseType:"text",headers:{"x-aws-ec2-metadata-token-ttl-seconds":"300"}};return(await this.transporter.request(e)).data}async getAwsRegion(e){if(this.regionFromEnv)return this.regionFromEnv;if(!this.regionUrl)throw new Error('Unable to determine AWS region due to missing "options.credential_source.region_url"');const r={url:this.regionUrl,method:"GET",responseType:"text",headers:e},n=await this.transporter.request(r);return n.data.substr(0,n.data.length-1)}async getAwsRoleName(e){if(!this.securityCredentialsUrl)throw new Error('Unable to determine AWS role name due to missing "options.credential_source.url"');const r={url:this.securityCredentialsUrl,method:"GET",responseType:"text",headers:e};return(await this.transporter.request(r)).data}async getAwsSecurityCredentials(e,r){return(await this.transporter.request({url:`${this.securityCredentialsUrl}/${e}`,responseType:"json",headers:r})).data}shouldUseMetadataServer(){return!this.regionFromEnv||!this.securityCredentialsFromEnv}get regionFromEnv(){return process.env.AWS_REGION||process.env.AWS_DEFAULT_REGION||null}get securityCredentialsFromEnv(){return process.env.AWS_ACCESS_KEY_ID&&process.env.AWS_SECRET_ACCESS_KEY?{accessKeyId:process.env.AWS_ACCESS_KEY_ID,secretAccessKey:process.env.AWS_SECRET_ACCESS_KEY,token:process.env.AWS_SESSION_TOKEN}:null}}fn.AwsClient=Ts;Ts.AWS_EC2_METADATA_IPV4_ADDRESS="169.254.169.254";Ts.AWS_EC2_METADATA_IPV6_ADDRESS="fd00:ec2::254";var Wt={},Oe={};Object.defineProperty(Oe,"__esModule",{value:!0});Oe.InvalidSubjectTokenError=Oe.InvalidMessageFieldError=Oe.InvalidCodeFieldError=Oe.InvalidTokenTypeFieldError=Oe.InvalidExpirationTimeFieldError=Oe.InvalidSuccessFieldError=Oe.InvalidVersionFieldError=Oe.ExecutableResponseError=Oe.ExecutableResponse=void 0;const wn="urn:ietf:params:oauth:token-type:saml2",Ia="urn:ietf:params:oauth:token-type:id_token",ba="urn:ietf:params:oauth:token-type:jwt";class rh{constructor(e){if(!e.version)throw new Mc("Executable response must contain a 'version' field.");if(e.success===void 0)throw new qc("Executable response must contain a 'success' field.");if(this.version=e.version,this.success=e.success,this.success){if(this.expirationTime=e.expiration_time,this.tokenType=e.token_type,this.tokenType!==wn&&this.tokenType!==Ia&&this.tokenType!==ba)throw new Vc(`Executable response must contain a 'token_type' field when successful and it must be one of ${Ia}, ${ba}, or ${wn}.`);if(this.tokenType===wn){if(!e.saml_response)throw new Xa(`Executable response must contain a 'saml_response' field when token_type=${wn}.`);this.subjectToken=e.saml_response}else{if(!e.id_token)throw new Xa(`Executable response must contain a 'id_token' field when token_type=${Ia} or ${ba}.`);this.subjectToken=e.id_token}}else{if(!e.code)throw new Kc("Executable response must contain a 'code' field when unsuccessful.");if(!e.message)throw new $c("Executable response must contain a 'message' field when unsuccessful.");this.errorCode=e.code,this.errorMessage=e.message}}isValid(){return!this.isExpired()&&this.success}isExpired(){return this.expirationTime!==void 0&&this.expirationTime<Math.round(Date.now()/1e3)}}Oe.ExecutableResponse=rh;class Gt extends Error{constructor(e){super(e),Object.setPrototypeOf(this,new.target.prototype)}}Oe.ExecutableResponseError=Gt;class Mc extends Gt{}Oe.InvalidVersionFieldError=Mc;class qc extends Gt{}Oe.InvalidSuccessFieldError=qc;class nh extends Gt{}Oe.InvalidExpirationTimeFieldError=nh;class Vc extends Gt{}Oe.InvalidTokenTypeFieldError=Vc;class Kc extends Gt{}Oe.InvalidCodeFieldError=Kc;class $c extends Gt{}Oe.InvalidMessageFieldError=$c;class Xa extends Gt{}Oe.InvalidSubjectTokenError=Xa;var Lr={},uu;function ih(){if(uu)return Lr;uu=1,Object.defineProperty(Lr,"__esModule",{value:!0}),Lr.PluggableAuthHandler=void 0;const t=xs(),e=Oe,r=Lu,n=nr;class s{constructor(c){if(!c.command)throw new Error("No command provided.");if(this.commandComponents=s.parseCommand(c.command),this.timeoutMillis=c.timeoutMillis,!this.timeoutMillis)throw new Error("No timeoutMillis provided.");this.outputFile=c.outputFile}retrieveResponseFromExecutable(c){return new Promise((i,y)=>{const f=r.spawn(this.commandComponents[0],this.commandComponents.slice(1),{env:{...process.env,...Object.fromEntries(c)}});let A="";f.stdout.on("data",p=>{A+=p}),f.stderr.on("data",p=>{A+=p});const C=setTimeout(()=>(f.removeAllListeners(),f.kill(),y(new Error("The executable failed to finish within the timeout specified."))),this.timeoutMillis);f.on("close",p=>{if(clearTimeout(C),p===0)try{const o=JSON.parse(A),m=new e.ExecutableResponse(o);return i(m)}catch(o){return o instanceof e.ExecutableResponseError?y(o):y(new e.ExecutableResponseError(`The executable returned an invalid response: ${A}`))}else return y(new t.ExecutableError(A,p.toString()))})})}async retrieveCachedResponse(){if(!this.outputFile||this.outputFile.length===0)return;let c;try{c=await n.promises.realpath(this.outputFile)}catch{return}if(!(await n.promises.lstat(c)).isFile())return;const i=await n.promises.readFile(c,{encoding:"utf8"});if(i!=="")try{const y=JSON.parse(i);return new e.ExecutableResponse(y).isValid()?new e.ExecutableResponse(y):void 0}catch(y){throw y instanceof e.ExecutableResponseError?y:new e.ExecutableResponseError(`The output file contained an invalid response: ${i}`)}}static parseCommand(c){const i=c.match(/(?:[^\s"]+|"[^"]*")+/g);if(!i)throw new Error(`Provided command: "${c}" could not be parsed.`);for(let y=0;y<i.length;y++)i[y][0]==='"'&&i[y].slice(-1)==='"'&&(i[y]=i[y].slice(1,-1));return i}}return Lr.PluggableAuthHandler=s,Lr}var cu;function xs(){if(cu)return Wt;cu=1,Object.defineProperty(Wt,"__esModule",{value:!0}),Wt.PluggableAuthClient=Wt.ExecutableError=void 0;const t=$t,e=Oe,r=ih();class n extends Error{constructor(C,p){super(`The executable failed with exit code: ${p} and error message: ${C}.`),this.code=p,Object.setPrototypeOf(this,new.target.prototype)}}Wt.ExecutableError=n;const s=30*1e3,u=5*1e3,c=120*1e3,i="GOOGLE_EXTERNAL_ACCOUNT_ALLOW_EXECUTABLES",y=1;class f extends t.BaseExternalAccountClient{constructor(C,p){if(super(C,p),!C.credential_source.executable)throw new Error('No valid Pluggable Auth "credential_source" provided.');if(this.command=C.credential_source.executable.command,!this.command)throw new Error('No valid Pluggable Auth "credential_source" provided.');if(C.credential_source.executable.timeout_millis===void 0)this.timeoutMillis=s;else if(this.timeoutMillis=C.credential_source.executable.timeout_millis,this.timeoutMillis<u||this.timeoutMillis>c)throw new Error(`Timeout must be between ${u} and ${c} milliseconds.`);this.outputFile=C.credential_source.executable.output_file,this.handler=new r.PluggableAuthHandler({command:this.command,timeoutMillis:this.timeoutMillis,outputFile:this.outputFile})}async retrieveSubjectToken(){if(process.env[i]!=="1")throw new Error("Pluggable Auth executables need to be explicitly allowed to run by setting the GOOGLE_EXTERNAL_ACCOUNT_ALLOW_EXECUTABLES environment Variable to 1.");let C;if(this.outputFile&&(C=await this.handler.retrieveCachedResponse()),!C){const p=new Map;p.set("GOOGLE_EXTERNAL_ACCOUNT_AUDIENCE",this.audience),p.set("GOOGLE_EXTERNAL_ACCOUNT_TOKEN_TYPE",this.subjectTokenType),p.set("GOOGLE_EXTERNAL_ACCOUNT_INTERACTIVE","0"),this.outputFile&&p.set("GOOGLE_EXTERNAL_ACCOUNT_OUTPUT_FILE",this.outputFile);const o=this.getServiceAccountEmail();o&&p.set("GOOGLE_EXTERNAL_ACCOUNT_IMPERSONATED_EMAIL",o),C=await this.handler.retrieveResponseFromExecutable(p)}if(C.version>y)throw new Error(`Version of executable is not currently supported, maximum supported version is ${y}.`);if(!C.success)throw new n(C.errorMessage,C.errorCode);if(this.outputFile&&!C.expirationTime)throw new e.InvalidExpirationTimeFieldError("The executable response must contain the `expiration_time` field for successful responses when an output_file has been specified in the configuration.");if(C.isExpired())throw new Error("Executable response is expired.");return C.subjectToken}}return Wt.PluggableAuthClient=f,Wt}Object.defineProperty(un,"__esModule",{value:!0});un.ExternalAccountClient=void 0;const ah=$t,sh=ln,oh=fn,uh=xs();class ch{constructor(){throw new Error("ExternalAccountClients should be initialized via: ExternalAccountClient.fromJSON(), directly via explicit constructors, eg. new AwsClient(options), new IdentityPoolClient(options), newPluggableAuthClientOptions, or via new GoogleAuth(options).getClient()")}static fromJSON(e,r){var n,s;return e&&e.type===ah.EXTERNAL_ACCOUNT_TYPE?!((n=e.credential_source)===null||n===void 0)&&n.environment_id?new oh.AwsClient(e,r):!((s=e.credential_source)===null||s===void 0)&&s.executable?new uh.PluggableAuthClient(e,r):new sh.IdentityPoolClient(e,r):null}}un.ExternalAccountClient=ch;var Tr={};Object.defineProperty(Tr,"__esModule",{value:!0});Tr.ExternalAccountAuthorizedUserClient=Tr.EXTERNAL_ACCOUNT_AUTHORIZED_USER_TYPE=void 0;const lh=Kt,lu=rr,fh=At,dh=Nt,hh=$t;Tr.EXTERNAL_ACCOUNT_AUTHORIZED_USER_TYPE="external_account_authorized_user";class ph extends lu.OAuthClientAuthHandler{constructor(e,r,n){super(n),this.url=e,this.transporter=r}async refreshToken(e,r){const n=new URLSearchParams({grant_type:"refresh_token",refresh_token:e}),s={"Content-Type":"application/x-www-form-urlencoded",...r},u={url:this.url,method:"POST",headers:s,data:n.toString(),responseType:"json"};this.applyClientAuthenticationOptions(u);try{const c=await this.transporter.request(u),i=c.data;return i.res=c,i}catch(c){throw c instanceof fh.GaxiosError&&c.response?(0,lu.getErrorFromOAuthErrorResponse)(c.response.data,c):c}}}class yh extends lh.AuthClient{constructor(e,r){super(),this.refreshToken=e.refresh_token;const n={confidentialClientType:"basic",clientId:e.client_id,clientSecret:e.client_secret};this.externalAccountAuthorizedUserHandler=new ph(e.token_url,this.transporter,n),this.cachedAccessToken=null,this.quotaProjectId=e.quota_project_id,typeof(r==null?void 0:r.eagerRefreshThresholdMillis)!="number"?this.eagerRefreshThresholdMillis=hh.EXPIRATION_TIME_OFFSET:this.eagerRefreshThresholdMillis=r.eagerRefreshThresholdMillis,this.forceRefreshOnFailure=!!(r!=null&&r.forceRefreshOnFailure)}async getAccessToken(){return(!this.cachedAccessToken||this.isExpired(this.cachedAccessToken))&&await this.refreshAccessTokenAsync(),{token:this.cachedAccessToken.access_token,res:this.cachedAccessToken.res}}async getRequestHeaders(){const r={Authorization:`Bearer ${(await this.getAccessToken()).token}`};return this.addSharedMetadataHeaders(r)}request(e,r){if(r)this.requestAsync(e).then(n=>r(null,n),n=>r(n,n.response));else return this.requestAsync(e)}async requestAsync(e,r=!1){let n;try{const s=await this.getRequestHeaders();e.headers=e.headers||{},s&&s["x-goog-user-project"]&&(e.headers["x-goog-user-project"]=s["x-goog-user-project"]),s&&s.Authorization&&(e.headers.Authorization=s.Authorization),n=await this.transporter.request(e)}catch(s){const u=s.response;if(u){const c=u.status,i=u.config.data instanceof dh.Readable;if(!r&&(c===401||c===403)&&!i&&this.forceRefreshOnFailure)return await this.refreshAccessTokenAsync(),await this.requestAsync(e,!0)}throw s}return n}async refreshAccessTokenAsync(){const e=await this.externalAccountAuthorizedUserHandler.refreshToken(this.refreshToken);return this.cachedAccessToken={access_token:e.access_token,expiry_date:new Date().getTime()+e.expires_in*1e3,res:e.res},e.refresh_token!==void 0&&(this.refreshToken=e.refresh_token),this.cachedAccessToken}isExpired(e){const r=new Date().getTime();return e.expiry_date?r>=e.expiry_date-this.eagerRefreshThresholdMillis:!1}}Tr.ExternalAccountAuthorizedUserClient=yh;Object.defineProperty(Sr,"__esModule",{value:!0});Sr.GoogleAuth=Sr.CLOUD_SDK_CLIENT_ID=void 0;const gh=Lu,Dr=nr,Ra=Qn,vh=Fu,Ba=Mu,mh=Jr(),Eh=ir,Ch=Xr,Sh=tn,Ah=cs,pr=rn,Na=er,In=tr,Th=un,Fr=$t,fu=Tr;Sr.CLOUD_SDK_CLIENT_ID="764086051850-6qr4p6gpi6hn506pt8ejuq83di341hur.apps.googleusercontent.com";const du={NO_PROJECT_ID_FOUND:`Unable to detect a Project Id in the current environment. 
To learn more about authentication and Google APIs, visit: 
https://cloud.google.com/docs/authentication/getting-started`};class Gc{get isGCE(){return this.checkIsGCE}constructor(e){this.checkIsGCE=void 0,this.jsonContent=null,this.cachedCredential=null,e=e||{},this._cachedProjectId=e.projectId||null,this.cachedCredential=e.authClient||null,this.keyFilename=e.keyFilename||e.keyFile,this.scopes=e.scopes,this.jsonContent=e.credentials||null,this.clientOptions=e.clientOptions}setGapicJWTValues(e){e.defaultServicePath=this.defaultServicePath,e.useJWTAccessWithScope=this.useJWTAccessWithScope,e.defaultScopes=this.defaultScopes}getProjectId(e){if(e)this.getProjectIdAsync().then(r=>e(null,r),e);else return this.getProjectIdAsync()}async getProjectIdOptional(){try{return await this.getProjectId()}catch(e){if(e instanceof Error&&e.message===du.NO_PROJECT_ID_FOUND)return null;throw e}}async findAndCacheProjectId(){let e=null;if(e||(e=await this.getProductionProjectId()),e||(e=await this.getFileProjectId()),e||(e=await this.getDefaultServiceProjectId()),e||(e=await this.getGCEProjectId()),e||(e=await this.getExternalAccountClientProjectId()),e)return this._cachedProjectId=e,e;throw new Error(du.NO_PROJECT_ID_FOUND)}async getProjectIdAsync(){return this._cachedProjectId?this._cachedProjectId:(this._findProjectIdPromise||(this._findProjectIdPromise=this.findAndCacheProjectId()),this._findProjectIdPromise)}getAnyScopes(){return this.scopes||this.defaultScopes}getApplicationDefault(e={},r){let n;if(typeof e=="function"?r=e:n=e,r)this.getApplicationDefaultAsync(n).then(s=>r(null,s.credential,s.projectId),r);else return this.getApplicationDefaultAsync(n)}async getApplicationDefaultAsync(e={}){if(this.cachedCredential)return await this.prepareAndCacheADC(this.cachedCredential);const r=process.env.GOOGLE_CLOUD_QUOTA_PROJECT;let n;if(n=await this._tryGetApplicationCredentialsFromEnvironmentVariable(e),n)return n instanceof pr.JWT?n.scopes=this.scopes:n instanceof Fr.BaseExternalAccountClient&&(n.scopes=this.getAnyScopes()),await this.prepareAndCacheADC(n,r);if(n=await this._tryGetApplicationCredentialsFromWellKnownFile(e),n)return n instanceof pr.JWT?n.scopes=this.scopes:n instanceof Fr.BaseExternalAccountClient&&(n.scopes=this.getAnyScopes()),await this.prepareAndCacheADC(n,r);let s;try{s=await this._checkIsGCE()}catch(u){throw u instanceof Error&&(u.message=`Unexpected error determining execution environment: ${u.message}`),u}if(!s)throw new Error("Could not load the default credentials. Browse to https://cloud.google.com/docs/authentication/getting-started for more information.");return e.scopes=this.getAnyScopes(),await this.prepareAndCacheADC(new Ch.Compute(e),r)}async prepareAndCacheADC(e,r){const n=await this.getProjectIdOptional();return r&&(e.quotaProjectId=r),this.cachedCredential=e,{credential:e,projectId:n}}async _checkIsGCE(){return this.checkIsGCE===void 0&&(this.checkIsGCE=await Ra.isAvailable()),this.checkIsGCE}async _tryGetApplicationCredentialsFromEnvironmentVariable(e){const r=process.env.GOOGLE_APPLICATION_CREDENTIALS||process.env.google_application_credentials;if(!r||r.length===0)return null;try{return this._getApplicationCredentialsFromFilePath(r,e)}catch(n){throw n instanceof Error&&(n.message=`Unable to read the credential file specified by the GOOGLE_APPLICATION_CREDENTIALS environment variable: ${n.message}`),n}}async _tryGetApplicationCredentialsFromWellKnownFile(e){let r=null;if(this._isWindows())r=process.env.APPDATA;else{const s=process.env.HOME;s&&(r=Ba.join(s,".config"))}return r&&(r=Ba.join(r,"gcloud","application_default_credentials.json"),Dr.existsSync(r)||(r=null)),r?await this._getApplicationCredentialsFromFilePath(r,e):null}async _getApplicationCredentialsFromFilePath(e,r={}){if(!e||e.length===0)throw new Error("The file path is invalid.");try{if(e=Dr.realpathSync(e),!Dr.lstatSync(e).isFile())throw new Error}catch(s){throw s instanceof Error&&(s.message=`The file at ${e} does not exist, or it is not a file. ${s.message}`),s}const n=Dr.createReadStream(e);return this.fromStream(n,r)}fromImpersonatedJSON(e){var r,n,s,u;if(!e)throw new Error("Must pass in a JSON object containing an  impersonated refresh token");if(e.type!==In.IMPERSONATED_ACCOUNT_TYPE)throw new Error(`The incoming JSON object does not have the "${In.IMPERSONATED_ACCOUNT_TYPE}" type`);if(!e.source_credentials)throw new Error("The incoming JSON object does not contain a source_credentials field");if(!e.service_account_impersonation_url)throw new Error("The incoming JSON object does not contain a service_account_impersonation_url field");const c=new Na.UserRefreshClient(e.source_credentials.client_id,e.source_credentials.client_secret,e.source_credentials.refresh_token),i=(n=(r=/(?<target>[^/]+):generateAccessToken$/.exec(e.service_account_impersonation_url))===null||r===void 0?void 0:r.groups)===null||n===void 0?void 0:n.target;if(!i)throw new RangeError(`Cannot extract target principal from ${e.service_account_impersonation_url}`);const y=(s=this.getAnyScopes())!==null&&s!==void 0?s:[];return new In.Impersonated({delegates:(u=e.delegates)!==null&&u!==void 0?u:[],sourceClient:c,targetPrincipal:i,targetScopes:Array.isArray(y)?y:[y]})}fromJSON(e,r={}){let n;return r=r||{},e.type===Na.USER_REFRESH_ACCOUNT_TYPE?(n=new Na.UserRefreshClient(r),n.fromJSON(e)):e.type===In.IMPERSONATED_ACCOUNT_TYPE?n=this.fromImpersonatedJSON(e):e.type===Fr.EXTERNAL_ACCOUNT_TYPE?(n=Th.ExternalAccountClient.fromJSON(e,r),n.scopes=this.getAnyScopes()):e.type===fu.EXTERNAL_ACCOUNT_AUTHORIZED_USER_TYPE?n=new fu.ExternalAccountAuthorizedUserClient(e,r):(r.scopes=this.scopes,n=new pr.JWT(r),this.setGapicJWTValues(n),n.fromJSON(e)),n}_cacheClientFromJSON(e,r){const n=this.fromJSON(e,r);return this.jsonContent=e,this.cachedCredential=n,n}fromStream(e,r={},n){let s={};if(typeof r=="function"?n=r:s=r,n)this.fromStreamAsync(e,s).then(u=>n(null,u),n);else return this.fromStreamAsync(e,s)}fromStreamAsync(e,r){return new Promise((n,s)=>{if(!e)throw new Error("Must pass in a stream containing the Google auth settings.");let u="";e.setEncoding("utf8").on("error",s).on("data",c=>u+=c).on("end",()=>{try{try{const c=JSON.parse(u),i=this._cacheClientFromJSON(c,r);return n(i)}catch(c){if(!this.keyFilename)throw c;const i=new pr.JWT({...this.clientOptions,keyFile:this.keyFilename});return this.cachedCredential=i,this.setGapicJWTValues(i),n(i)}}catch(c){return s(c)}})})}fromAPIKey(e,r){r=r||{};const n=new pr.JWT(r);return n.fromAPIKey(e),n}_isWindows(){const e=vh.platform();return!!(e&&e.length>=3&&e.substring(0,3).toLowerCase()==="win")}async getDefaultServiceProjectId(){return new Promise(e=>{(0,gh.exec)("gcloud config config-helper --format json",(r,n)=>{if(!r&&n)try{const s=JSON.parse(n).configuration.properties.core.project;e(s);return}catch{}e(null)})})}getProductionProjectId(){return process.env.GCLOUD_PROJECT||process.env.GOOGLE_CLOUD_PROJECT||process.env.gcloud_project||process.env.google_cloud_project}async getFileProjectId(){if(this.cachedCredential)return this.cachedCredential.projectId;if(this.keyFilename){const r=await this.getClient();if(r&&r.projectId)return r.projectId}const e=await this._tryGetApplicationCredentialsFromEnvironmentVariable();return e?e.projectId:null}async getExternalAccountClientProjectId(){return!this.jsonContent||this.jsonContent.type!==Fr.EXTERNAL_ACCOUNT_TYPE?null:await(await this.getClient()).getProjectId()}async getGCEProjectId(){try{return await Ra.project("project-id")}catch{return null}}getCredentials(e){if(e)this.getCredentialsAsync().then(r=>e(null,r),e);else return this.getCredentialsAsync()}async getCredentialsAsync(){const e=await this.getClient();if(e instanceof Fr.BaseExternalAccountClient){const s=e.getServiceAccountEmail();if(s)return{client_email:s}}if(this.jsonContent)return{client_email:this.jsonContent.client_email,private_key:this.jsonContent.private_key};if(!await this._checkIsGCE())throw new Error("Unknown error.");const n=await Ra.instance({property:"service-accounts/",params:{recursive:"true"}});if(!n||!n.default||!n.default.email)throw new Error("Failure from metadata server.");return{client_email:n.default.email}}async getClient(){if(!this.cachedCredential)if(this.jsonContent)this._cacheClientFromJSON(this.jsonContent,this.clientOptions);else if(this.keyFilename){const e=Ba.resolve(this.keyFilename),r=Dr.createReadStream(e);await this.fromStreamAsync(r,this.clientOptions)}else await this.getApplicationDefaultAsync(this.clientOptions);return this.cachedCredential}async getIdTokenClient(e){const r=await this.getClient();if(!("fetchIdToken"in r))throw new Error("Cannot fetch ID token in this environment, use GCE or set the GOOGLE_APPLICATION_CREDENTIALS environment variable to a service account credentials JSON file.");return new Sh.IdTokenClient({targetAudience:e,idTokenProvider:r})}async getAccessToken(){return(await(await this.getClient()).getAccessToken()).token}async getRequestHeaders(e){return(await this.getClient()).getRequestHeaders(e)}async authorizeRequest(e){e=e||{};const r=e.url||e.uri,s=await(await this.getClient()).getRequestHeaders(r);return e.headers=Object.assign(e.headers||{},s),e}async request(e){return(await this.getClient()).request(e)}getEnv(){return(0,Ah.getEnv)()}async sign(e){const r=await this.getClient(),n=(0,mh.createCrypto)();if(r instanceof pr.JWT&&r.key)return await n.sign(r.key,e);const s=await this.getCredentials();if(!s.client_email)throw new Error("Cannot sign data without `client_email`.");return this.signBlob(n,s.client_email,e)}async signBlob(e,r,n){const s=`https://iamcredentials.googleapis.com/v1/projects/-/serviceAccounts/${r}:signBlob`;return(await this.request({method:"POST",url:s,data:{payload:e.encodeBase64StringUtf8(n)}})).data.signedBlob}}Sr.GoogleAuth=Gc;Gc.DefaultTransporter=Eh.DefaultTransporter;var fi={};Object.defineProperty(fi,"__esModule",{value:!0});fi.IAMAuth=void 0;class xh{constructor(e,r){this.selector=e,this.token=r,this.selector=e,this.token=r}getRequestHeaders(){return{"x-goog-iam-authority-selector":this.selector,"x-goog-iam-authorization-token":this.token}}}fi.IAMAuth=xh;var jc={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.DownscopedClient=t.EXPIRATION_TIME_OFFSET=t.MAX_ACCESS_BOUNDARY_RULES_COUNT=void 0;const e=Nt,r=Kt,n=cn,s="urn:ietf:params:oauth:grant-type:token-exchange",u="urn:ietf:params:oauth:token-type:access_token",c="urn:ietf:params:oauth:token-type:access_token",i="https://sts.googleapis.com/v1/token";t.MAX_ACCESS_BOUNDARY_RULES_COUNT=10,t.EXPIRATION_TIME_OFFSET=5*60*1e3;class y extends r.AuthClient{constructor(A,C,p,o){if(super(),this.authClient=A,this.credentialAccessBoundary=C,C.accessBoundary.accessBoundaryRules.length===0)throw new Error("At least one access boundary rule needs to be defined.");if(C.accessBoundary.accessBoundaryRules.length>t.MAX_ACCESS_BOUNDARY_RULES_COUNT)throw new Error(`The provided access boundary has more than ${t.MAX_ACCESS_BOUNDARY_RULES_COUNT} access boundary rules.`);for(const m of C.accessBoundary.accessBoundaryRules)if(m.availablePermissions.length===0)throw new Error("At least one permission should be defined in access boundary rules.");this.stsCredential=new n.StsCredentials(i),this.cachedDownscopedAccessToken=null,typeof(p==null?void 0:p.eagerRefreshThresholdMillis)!="number"?this.eagerRefreshThresholdMillis=t.EXPIRATION_TIME_OFFSET:this.eagerRefreshThresholdMillis=p.eagerRefreshThresholdMillis,this.forceRefreshOnFailure=!!(p!=null&&p.forceRefreshOnFailure),this.quotaProjectId=o}setCredentials(A){if(!A.expiry_date)throw new Error("The access token expiry_date field is missing in the provided credentials.");super.setCredentials(A),this.cachedDownscopedAccessToken=A}async getAccessToken(){return(!this.cachedDownscopedAccessToken||this.isExpired(this.cachedDownscopedAccessToken))&&await this.refreshAccessTokenAsync(),{token:this.cachedDownscopedAccessToken.access_token,expirationTime:this.cachedDownscopedAccessToken.expiry_date,res:this.cachedDownscopedAccessToken.res}}async getRequestHeaders(){const C={Authorization:`Bearer ${(await this.getAccessToken()).token}`};return this.addSharedMetadataHeaders(C)}request(A,C){if(C)this.requestAsync(A).then(p=>C(null,p),p=>C(p,p.response));else return this.requestAsync(A)}async requestAsync(A,C=!1){let p;try{const o=await this.getRequestHeaders();A.headers=A.headers||{},o&&o["x-goog-user-project"]&&(A.headers["x-goog-user-project"]=o["x-goog-user-project"]),o&&o.Authorization&&(A.headers.Authorization=o.Authorization),p=await this.transporter.request(A)}catch(o){const m=o.response;if(m){const g=m.status,S=m.config.data instanceof e.Readable;if(!C&&(g===401||g===403)&&!S&&this.forceRefreshOnFailure)return await this.refreshAccessTokenAsync(),await this.requestAsync(A,!0)}throw o}return p}async refreshAccessTokenAsync(){var A;const C=(await this.authClient.getAccessToken()).token,p={grantType:s,requestedTokenType:u,subjectToken:C,subjectTokenType:c},o=await this.stsCredential.exchangeToken(p,void 0,this.credentialAccessBoundary),m=((A=this.authClient.credentials)===null||A===void 0?void 0:A.expiry_date)||null,g=o.expires_in?new Date().getTime()+o.expires_in*1e3:m;return this.cachedDownscopedAccessToken={access_token:o.access_token,expiry_date:g,res:o.res},this.credentials={},Object.assign(this.credentials,this.cachedDownscopedAccessToken),delete this.credentials.res,this.emit("tokens",{refresh_token:null,expiry_date:this.cachedDownscopedAccessToken.expiry_date,access_token:this.cachedDownscopedAccessToken.access_token,token_type:"Bearer",id_token:null}),this.cachedDownscopedAccessToken}isExpired(A){const C=new Date().getTime();return A.expiry_date?C>=A.expiry_date-this.eagerRefreshThresholdMillis:!1}}t.DownscopedClient=y})(jc);(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.GoogleAuth=t.auth=t.DefaultTransporter=t.PluggableAuthClient=t.DownscopedClient=t.BaseExternalAccountClient=t.ExternalAccountClient=t.IdentityPoolClient=t.AwsClient=t.UserRefreshClient=t.LoginTicket=t.OAuth2Client=t.CodeChallengeMethod=t.Impersonated=t.JWT=t.JWTAccess=t.IdTokenClient=t.IAMAuth=t.GCPEnv=t.Compute=t.AuthClient=void 0;const e=Sr;Object.defineProperty(t,"GoogleAuth",{enumerable:!0,get:function(){return e.GoogleAuth}});var r=Kt;Object.defineProperty(t,"AuthClient",{enumerable:!0,get:function(){return r.AuthClient}});var n=Xr;Object.defineProperty(t,"Compute",{enumerable:!0,get:function(){return n.Compute}});var s=cs;Object.defineProperty(t,"GCPEnv",{enumerable:!0,get:function(){return s.GCPEnv}});var u=fi;Object.defineProperty(t,"IAMAuth",{enumerable:!0,get:function(){return u.IAMAuth}});var c=tn;Object.defineProperty(t,"IdTokenClient",{enumerable:!0,get:function(){return c.IdTokenClient}});var i=on;Object.defineProperty(t,"JWTAccess",{enumerable:!0,get:function(){return i.JWTAccess}});var y=rn;Object.defineProperty(t,"JWT",{enumerable:!0,get:function(){return y.JWT}});var f=tr;Object.defineProperty(t,"Impersonated",{enumerable:!0,get:function(){return f.Impersonated}});var A=ar;Object.defineProperty(t,"CodeChallengeMethod",{enumerable:!0,get:function(){return A.CodeChallengeMethod}}),Object.defineProperty(t,"OAuth2Client",{enumerable:!0,get:function(){return A.OAuth2Client}});var C=en;Object.defineProperty(t,"LoginTicket",{enumerable:!0,get:function(){return C.LoginTicket}});var p=er;Object.defineProperty(t,"UserRefreshClient",{enumerable:!0,get:function(){return p.UserRefreshClient}});var o=fn;Object.defineProperty(t,"AwsClient",{enumerable:!0,get:function(){return o.AwsClient}});var m=ln;Object.defineProperty(t,"IdentityPoolClient",{enumerable:!0,get:function(){return m.IdentityPoolClient}});var g=un;Object.defineProperty(t,"ExternalAccountClient",{enumerable:!0,get:function(){return g.ExternalAccountClient}});var S=$t;Object.defineProperty(t,"BaseExternalAccountClient",{enumerable:!0,get:function(){return S.BaseExternalAccountClient}});var a=jc;Object.defineProperty(t,"DownscopedClient",{enumerable:!0,get:function(){return a.DownscopedClient}});var v=xs();Object.defineProperty(t,"PluggableAuthClient",{enumerable:!0,get:function(){return v.PluggableAuthClient}});var E=ir;Object.defineProperty(t,"DefaultTransporter",{enumerable:!0,get:function(){return E.DefaultTransporter}});const b=new e.GoogleAuth;t.auth=b})(Yr);var di={};Object.defineProperty(di,"__esModule",{value:!0});di.getAPI=void 0;function _h(t,e,r,n){let s;if(typeof e=="string")s=e,e={};else if(typeof e=="object")s=e.version,delete e.version;else throw new Error("Argument error: Accepts only string or object");try{const u=r[s],c=new u(e,n);return Object.freeze(c)}catch(u){throw new Error(`Unable to load endpoint ${t}("${s}"): ${u.message}`)}}di.getAPI=_h;var Br={},wh=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var e={},r=Symbol("test"),n=Object(r);if(typeof r=="string"||Object.prototype.toString.call(r)!=="[object Symbol]"||Object.prototype.toString.call(n)!=="[object Symbol]")return!1;var s=42;e[r]=s;for(r in e)return!1;if(typeof Object.keys=="function"&&Object.keys(e).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(e).length!==0)return!1;var u=Object.getOwnPropertySymbols(e);if(u.length!==1||u[0]!==r||!Object.prototype.propertyIsEnumerable.call(e,r))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var c=Object.getOwnPropertyDescriptor(e,r);if(c.value!==s||c.enumerable!==!0)return!1}return!0},hu=typeof Symbol<"u"&&Symbol,Ih=wh,bh=function(){return typeof hu!="function"||typeof Symbol!="function"||typeof hu("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:Ih()},Rh="Function.prototype.bind called on incompatible ",Pa=Array.prototype.slice,Bh=Object.prototype.toString,Nh="[object Function]",Ph=function(e){var r=this;if(typeof r!="function"||Bh.call(r)!==Nh)throw new TypeError(Rh+r);for(var n=Pa.call(arguments,1),s,u=function(){if(this instanceof s){var A=r.apply(this,n.concat(Pa.call(arguments)));return Object(A)===A?A:this}else return r.apply(e,n.concat(Pa.call(arguments)))},c=Math.max(0,r.length-n.length),i=[],y=0;y<c;y++)i.push("$"+y);if(s=Function("binder","return function ("+i.join(",")+"){ return binder.apply(this,arguments); }")(u),r.prototype){var f=function(){};f.prototype=r.prototype,s.prototype=new f,f.prototype=null}return s},Uh=Ph,_s=Function.prototype.bind||Uh,Oh=_s,kh=Oh.call(Function.call,Object.prototype.hasOwnProperty),Ce,xr=SyntaxError,Hc=Function,Er=TypeError,Ua=function(t){try{return Hc('"use strict"; return ('+t+").constructor;")()}catch{}},Xt=Object.getOwnPropertyDescriptor;if(Xt)try{Xt({},"")}catch{Xt=null}var Oa=function(){throw new Er},Lh=Xt?function(){try{return arguments.callee,Oa}catch{try{return Xt(arguments,"callee").get}catch{return Oa}}}():Oa,yr=bh(),Dt=Object.getPrototypeOf||function(t){return t.__proto__},vr={},Dh=typeof Uint8Array>"u"?Ce:Dt(Uint8Array),Cr={"%AggregateError%":typeof AggregateError>"u"?Ce:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?Ce:ArrayBuffer,"%ArrayIteratorPrototype%":yr?Dt([][Symbol.iterator]()):Ce,"%AsyncFromSyncIteratorPrototype%":Ce,"%AsyncFunction%":vr,"%AsyncGenerator%":vr,"%AsyncGeneratorFunction%":vr,"%AsyncIteratorPrototype%":vr,"%Atomics%":typeof Atomics>"u"?Ce:Atomics,"%BigInt%":typeof BigInt>"u"?Ce:BigInt,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?Ce:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":typeof Float32Array>"u"?Ce:Float32Array,"%Float64Array%":typeof Float64Array>"u"?Ce:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?Ce:FinalizationRegistry,"%Function%":Hc,"%GeneratorFunction%":vr,"%Int8Array%":typeof Int8Array>"u"?Ce:Int8Array,"%Int16Array%":typeof Int16Array>"u"?Ce:Int16Array,"%Int32Array%":typeof Int32Array>"u"?Ce:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":yr?Dt(Dt([][Symbol.iterator]())):Ce,"%JSON%":typeof JSON=="object"?JSON:Ce,"%Map%":typeof Map>"u"?Ce:Map,"%MapIteratorPrototype%":typeof Map>"u"||!yr?Ce:Dt(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?Ce:Promise,"%Proxy%":typeof Proxy>"u"?Ce:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":typeof Reflect>"u"?Ce:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?Ce:Set,"%SetIteratorPrototype%":typeof Set>"u"||!yr?Ce:Dt(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?Ce:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":yr?Dt(""[Symbol.iterator]()):Ce,"%Symbol%":yr?Symbol:Ce,"%SyntaxError%":xr,"%ThrowTypeError%":Lh,"%TypedArray%":Dh,"%TypeError%":Er,"%Uint8Array%":typeof Uint8Array>"u"?Ce:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?Ce:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?Ce:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?Ce:Uint32Array,"%URIError%":URIError,"%WeakMap%":typeof WeakMap>"u"?Ce:WeakMap,"%WeakRef%":typeof WeakRef>"u"?Ce:WeakRef,"%WeakSet%":typeof WeakSet>"u"?Ce:WeakSet},Fh=function t(e){var r;if(e==="%AsyncFunction%")r=Ua("async function () {}");else if(e==="%GeneratorFunction%")r=Ua("function* () {}");else if(e==="%AsyncGeneratorFunction%")r=Ua("async function* () {}");else if(e==="%AsyncGenerator%"){var n=t("%AsyncGeneratorFunction%");n&&(r=n.prototype)}else if(e==="%AsyncIteratorPrototype%"){var s=t("%AsyncGenerator%");s&&(r=Dt(s.prototype))}return Cr[e]=r,r},pu={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},dn=_s,Kn=kh,Mh=dn.call(Function.call,Array.prototype.concat),qh=dn.call(Function.apply,Array.prototype.splice),yu=dn.call(Function.call,String.prototype.replace),$n=dn.call(Function.call,String.prototype.slice),Vh=dn.call(Function.call,RegExp.prototype.exec),Kh=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,$h=/\\(\\)?/g,Gh=function(e){var r=$n(e,0,1),n=$n(e,-1);if(r==="%"&&n!=="%")throw new xr("invalid intrinsic syntax, expected closing `%`");if(n==="%"&&r!=="%")throw new xr("invalid intrinsic syntax, expected opening `%`");var s=[];return yu(e,Kh,function(u,c,i,y){s[s.length]=i?yu(y,$h,"$1"):c||u}),s},jh=function(e,r){var n=e,s;if(Kn(pu,n)&&(s=pu[n],n="%"+s[0]+"%"),Kn(Cr,n)){var u=Cr[n];if(u===vr&&(u=Fh(n)),typeof u>"u"&&!r)throw new Er("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:s,name:n,value:u}}throw new xr("intrinsic "+e+" does not exist!")},ws=function(e,r){if(typeof e!="string"||e.length===0)throw new Er("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof r!="boolean")throw new Er('"allowMissing" argument must be a boolean');if(Vh(/^%?[^%]*%?$/,e)===null)throw new xr("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var n=Gh(e),s=n.length>0?n[0]:"",u=jh("%"+s+"%",r),c=u.name,i=u.value,y=!1,f=u.alias;f&&(s=f[0],qh(n,Mh([0,1],f)));for(var A=1,C=!0;A<n.length;A+=1){var p=n[A],o=$n(p,0,1),m=$n(p,-1);if((o==='"'||o==="'"||o==="`"||m==='"'||m==="'"||m==="`")&&o!==m)throw new xr("property names with quotes must have matching quotes");if((p==="constructor"||!C)&&(y=!0),s+="."+p,c="%"+s+"%",Kn(Cr,c))i=Cr[c];else if(i!=null){if(!(p in i)){if(!r)throw new Er("base intrinsic for "+e+" exists, but the property is not available.");return}if(Xt&&A+1>=n.length){var g=Xt(i,p);C=!!g,C&&"get"in g&&!("originalValue"in g.get)?i=g.get:i=i[p]}else C=Kn(i,p),i=i[p];C&&!y&&(Cr[c]=i)}}return i},zc={exports:{}};(function(t){var e=_s,r=ws,n=r("%Function.prototype.apply%"),s=r("%Function.prototype.call%"),u=r("%Reflect.apply%",!0)||e.call(s,n),c=r("%Object.getOwnPropertyDescriptor%",!0),i=r("%Object.defineProperty%",!0),y=r("%Math.max%");if(i)try{i({},"a",{value:1})}catch{i=null}t.exports=function(C){var p=u(e,s,arguments);if(c&&i){var o=c(p,"length");o.configurable&&i(p,"length",{value:1+y(0,C.length-(arguments.length-1))})}return p};var f=function(){return u(e,n,arguments)};i?i(t.exports,"apply",{value:f}):t.exports.apply=f})(zc);var Hh=zc.exports,Wc=ws,Qc=Hh,zh=Qc(Wc("String.prototype.indexOf")),Wh=function(e,r){var n=Wc(e,!!r);return typeof n=="function"&&zh(e,".prototype.")>-1?Qc(n):n};const Qh={},Yh=Object.freeze(Object.defineProperty({__proto__:null,default:Qh},Symbol.toStringTag,{value:"Module"})),Jh=Hl(Yh);var Is=typeof Map=="function"&&Map.prototype,ka=Object.getOwnPropertyDescriptor&&Is?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,Gn=Is&&ka&&typeof ka.get=="function"?ka.get:null,Xh=Is&&Map.prototype.forEach,bs=typeof Set=="function"&&Set.prototype,La=Object.getOwnPropertyDescriptor&&bs?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,jn=bs&&La&&typeof La.get=="function"?La.get:null,Zh=bs&&Set.prototype.forEach,ep=typeof WeakMap=="function"&&WeakMap.prototype,Gr=ep?WeakMap.prototype.has:null,tp=typeof WeakSet=="function"&&WeakSet.prototype,jr=tp?WeakSet.prototype.has:null,rp=typeof WeakRef=="function"&&WeakRef.prototype,gu=rp?WeakRef.prototype.deref:null,np=Boolean.prototype.valueOf,ip=Object.prototype.toString,ap=Function.prototype.toString,sp=String.prototype.match,Rs=String.prototype.slice,Mt=String.prototype.replace,op=String.prototype.toUpperCase,vu=String.prototype.toLowerCase,Yc=RegExp.prototype.test,mu=Array.prototype.concat,mt=Array.prototype.join,up=Array.prototype.slice,Eu=Math.floor,Za=typeof BigInt=="function"?BigInt.prototype.valueOf:null,Da=Object.getOwnPropertySymbols,es=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol.prototype.toString:null,_r=typeof Symbol=="function"&&typeof Symbol.iterator=="object",st=typeof Symbol=="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===_r||"symbol")?Symbol.toStringTag:null,Jc=Object.prototype.propertyIsEnumerable,Cu=(typeof Reflect=="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(t){return t.__proto__}:null);function Su(t,e){if(t===1/0||t===-1/0||t!==t||t&&t>-1e3&&t<1e3||Yc.call(/e/,e))return e;var r=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof t=="number"){var n=t<0?-Eu(-t):Eu(t);if(n!==t){var s=String(n),u=Rs.call(e,s.length+1);return Mt.call(s,r,"$&_")+"."+Mt.call(Mt.call(u,/([0-9]{3})/g,"$&_"),/_$/,"")}}return Mt.call(e,r,"$&_")}var ts=Jh,Au=ts.custom,Tu=Zc(Au)?Au:null,cp=function t(e,r,n,s){var u=r||{};if(Ft(u,"quoteStyle")&&u.quoteStyle!=="single"&&u.quoteStyle!=="double")throw new TypeError('option "quoteStyle" must be "single" or "double"');if(Ft(u,"maxStringLength")&&(typeof u.maxStringLength=="number"?u.maxStringLength<0&&u.maxStringLength!==1/0:u.maxStringLength!==null))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var c=Ft(u,"customInspect")?u.customInspect:!0;if(typeof c!="boolean"&&c!=="symbol")throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(Ft(u,"indent")&&u.indent!==null&&u.indent!=="	"&&!(parseInt(u.indent,10)===u.indent&&u.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(Ft(u,"numericSeparator")&&typeof u.numericSeparator!="boolean")throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var i=u.numericSeparator;if(typeof e>"u")return"undefined";if(e===null)return"null";if(typeof e=="boolean")return e?"true":"false";if(typeof e=="string")return tl(e,u);if(typeof e=="number"){if(e===0)return 1/0/e>0?"0":"-0";var y=String(e);return i?Su(e,y):y}if(typeof e=="bigint"){var f=String(e)+"n";return i?Su(e,f):f}var A=typeof u.depth>"u"?5:u.depth;if(typeof n>"u"&&(n=0),n>=A&&A>0&&typeof e=="object")return rs(e)?"[Array]":"[Object]";var C=Ip(u,n);if(typeof s>"u")s=[];else if(el(s,e)>=0)return"[Circular]";function p(q,j,H){if(j&&(s=up.call(s),s.push(j)),H){var Q={depth:u.depth};return Ft(u,"quoteStyle")&&(Q.quoteStyle=u.quoteStyle),t(q,Q,n+1,s)}return t(q,u,n+1,s)}if(typeof e=="function"&&!xu(e)){var o=mp(e),m=bn(e,p);return"[Function"+(o?": "+o:" (anonymous)")+"]"+(m.length>0?" { "+mt.call(m,", ")+" }":"")}if(Zc(e)){var g=_r?Mt.call(String(e),/^(Symbol\(.*\))_[^)]*$/,"$1"):es.call(e);return typeof e=="object"&&!_r?Mr(g):g}if(xp(e)){for(var S="<"+vu.call(String(e.nodeName)),a=e.attributes||[],v=0;v<a.length;v++)S+=" "+a[v].name+"="+Xc(lp(a[v].value),"double",u);return S+=">",e.childNodes&&e.childNodes.length&&(S+="..."),S+="</"+vu.call(String(e.nodeName))+">",S}if(rs(e)){if(e.length===0)return"[]";var E=bn(e,p);return C&&!wp(E)?"["+ns(E,C)+"]":"[ "+mt.call(E,", ")+" ]"}if(dp(e)){var b=bn(e,p);return!("cause"in Error.prototype)&&"cause"in e&&!Jc.call(e,"cause")?"{ ["+String(e)+"] "+mt.call(mu.call("[cause]: "+p(e.cause),b),", ")+" }":b.length===0?"["+String(e)+"]":"{ ["+String(e)+"] "+mt.call(b,", ")+" }"}if(typeof e=="object"&&c){if(Tu&&typeof e[Tu]=="function"&&ts)return ts(e,{depth:A-n});if(c!=="symbol"&&typeof e.inspect=="function")return e.inspect()}if(Ep(e)){var R=[];return Xh.call(e,function(q,j){R.push(p(j,e,!0)+" => "+p(q,e))}),_u("Map",Gn.call(e),R,C)}if(Ap(e)){var T=[];return Zh.call(e,function(q){T.push(p(q,e))}),_u("Set",jn.call(e),T,C)}if(Cp(e))return Fa("WeakMap");if(Tp(e))return Fa("WeakSet");if(Sp(e))return Fa("WeakRef");if(pp(e))return Mr(p(Number(e)));if(gp(e))return Mr(p(Za.call(e)));if(yp(e))return Mr(np.call(e));if(hp(e))return Mr(p(String(e)));if(!fp(e)&&!xu(e)){var h=bn(e,p),l=Cu?Cu(e)===Object.prototype:e instanceof Object||e.constructor===Object,B=e instanceof Object?"":"null prototype",N=!l&&st&&Object(e)===e&&st in e?Rs.call(jt(e),8,-1):B?"Object":"",F=l||typeof e.constructor!="function"?"":e.constructor.name?e.constructor.name+" ":"",L=F+(N||B?"["+mt.call(mu.call([],N||[],B||[]),": ")+"] ":"");return h.length===0?L+"{}":C?L+"{"+ns(h,C)+"}":L+"{ "+mt.call(h,", ")+" }"}return String(e)};function Xc(t,e,r){var n=(r.quoteStyle||e)==="double"?'"':"'";return n+t+n}function lp(t){return Mt.call(String(t),/"/g,"&quot;")}function rs(t){return jt(t)==="[object Array]"&&(!st||!(typeof t=="object"&&st in t))}function fp(t){return jt(t)==="[object Date]"&&(!st||!(typeof t=="object"&&st in t))}function xu(t){return jt(t)==="[object RegExp]"&&(!st||!(typeof t=="object"&&st in t))}function dp(t){return jt(t)==="[object Error]"&&(!st||!(typeof t=="object"&&st in t))}function hp(t){return jt(t)==="[object String]"&&(!st||!(typeof t=="object"&&st in t))}function pp(t){return jt(t)==="[object Number]"&&(!st||!(typeof t=="object"&&st in t))}function yp(t){return jt(t)==="[object Boolean]"&&(!st||!(typeof t=="object"&&st in t))}function Zc(t){if(_r)return t&&typeof t=="object"&&t instanceof Symbol;if(typeof t=="symbol")return!0;if(!t||typeof t!="object"||!es)return!1;try{return es.call(t),!0}catch{}return!1}function gp(t){if(!t||typeof t!="object"||!Za)return!1;try{return Za.call(t),!0}catch{}return!1}var vp=Object.prototype.hasOwnProperty||function(t){return t in this};function Ft(t,e){return vp.call(t,e)}function jt(t){return ip.call(t)}function mp(t){if(t.name)return t.name;var e=sp.call(ap.call(t),/^function\s*([\w$]+)/);return e?e[1]:null}function el(t,e){if(t.indexOf)return t.indexOf(e);for(var r=0,n=t.length;r<n;r++)if(t[r]===e)return r;return-1}function Ep(t){if(!Gn||!t||typeof t!="object")return!1;try{Gn.call(t);try{jn.call(t)}catch{return!0}return t instanceof Map}catch{}return!1}function Cp(t){if(!Gr||!t||typeof t!="object")return!1;try{Gr.call(t,Gr);try{jr.call(t,jr)}catch{return!0}return t instanceof WeakMap}catch{}return!1}function Sp(t){if(!gu||!t||typeof t!="object")return!1;try{return gu.call(t),!0}catch{}return!1}function Ap(t){if(!jn||!t||typeof t!="object")return!1;try{jn.call(t);try{Gn.call(t)}catch{return!0}return t instanceof Set}catch{}return!1}function Tp(t){if(!jr||!t||typeof t!="object")return!1;try{jr.call(t,jr);try{Gr.call(t,Gr)}catch{return!0}return t instanceof WeakSet}catch{}return!1}function xp(t){return!t||typeof t!="object"?!1:typeof HTMLElement<"u"&&t instanceof HTMLElement?!0:typeof t.nodeName=="string"&&typeof t.getAttribute=="function"}function tl(t,e){if(t.length>e.maxStringLength){var r=t.length-e.maxStringLength,n="... "+r+" more character"+(r>1?"s":"");return tl(Rs.call(t,0,e.maxStringLength),e)+n}var s=Mt.call(Mt.call(t,/(['\\])/g,"\\$1"),/[\x00-\x1f]/g,_p);return Xc(s,"single",e)}function _p(t){var e=t.charCodeAt(0),r={8:"b",9:"t",10:"n",12:"f",13:"r"}[e];return r?"\\"+r:"\\x"+(e<16?"0":"")+op.call(e.toString(16))}function Mr(t){return"Object("+t+")"}function Fa(t){return t+" { ? }"}function _u(t,e,r,n){var s=n?ns(r,n):mt.call(r,", ");return t+" ("+e+") {"+s+"}"}function wp(t){for(var e=0;e<t.length;e++)if(el(t[e],`
`)>=0)return!1;return!0}function Ip(t,e){var r;if(t.indent==="	")r="	";else if(typeof t.indent=="number"&&t.indent>0)r=mt.call(Array(t.indent+1)," ");else return null;return{base:r,prev:mt.call(Array(e+1),r)}}function ns(t,e){if(t.length===0)return"";var r=`
`+e.prev+e.base;return r+mt.call(t,","+r)+`
`+e.prev}function bn(t,e){var r=rs(t),n=[];if(r){n.length=t.length;for(var s=0;s<t.length;s++)n[s]=Ft(t,s)?e(t[s],t):""}var u=typeof Da=="function"?Da(t):[],c;if(_r){c={};for(var i=0;i<u.length;i++)c["$"+u[i]]=u[i]}for(var y in t)Ft(t,y)&&(r&&String(Number(y))===y&&y<t.length||_r&&c["$"+y]instanceof Symbol||(Yc.call(/[^\w$]/,y)?n.push(e(y,t)+": "+e(t[y],t)):n.push(y+": "+e(t[y],t))));if(typeof Da=="function")for(var f=0;f<u.length;f++)Jc.call(t,u[f])&&n.push("["+e(u[f])+"]: "+e(t[u[f]],t));return n}var Bs=ws,Nr=Wh,bp=cp,Rp=Bs("%TypeError%"),Rn=Bs("%WeakMap%",!0),Bn=Bs("%Map%",!0),Bp=Nr("WeakMap.prototype.get",!0),Np=Nr("WeakMap.prototype.set",!0),Pp=Nr("WeakMap.prototype.has",!0),Up=Nr("Map.prototype.get",!0),Op=Nr("Map.prototype.set",!0),kp=Nr("Map.prototype.has",!0),Ns=function(t,e){for(var r=t,n;(n=r.next)!==null;r=n)if(n.key===e)return r.next=n.next,n.next=t.next,t.next=n,n},Lp=function(t,e){var r=Ns(t,e);return r&&r.value},Dp=function(t,e,r){var n=Ns(t,e);n?n.value=r:t.next={key:e,next:t.next,value:r}},Fp=function(t,e){return!!Ns(t,e)},Mp=function(){var e,r,n,s={assert:function(u){if(!s.has(u))throw new Rp("Side channel does not contain "+bp(u))},get:function(u){if(Rn&&u&&(typeof u=="object"||typeof u=="function")){if(e)return Bp(e,u)}else if(Bn){if(r)return Up(r,u)}else if(n)return Lp(n,u)},has:function(u){if(Rn&&u&&(typeof u=="object"||typeof u=="function")){if(e)return Pp(e,u)}else if(Bn){if(r)return kp(r,u)}else if(n)return Fp(n,u);return!1},set:function(u,c){Rn&&u&&(typeof u=="object"||typeof u=="function")?(e||(e=new Rn),Np(e,u,c)):Bn?(r||(r=new Bn),Op(r,u,c)):(n||(n={key:{},next:null}),Dp(n,u,c))}};return s},qp=String.prototype.replace,Vp=/%20/g,Ma={RFC1738:"RFC1738",RFC3986:"RFC3986"},Ps={default:Ma.RFC3986,formatters:{RFC1738:function(t){return qp.call(t,Vp,"+")},RFC3986:function(t){return String(t)}},RFC1738:Ma.RFC1738,RFC3986:Ma.RFC3986},Kp=Ps,qa=Object.prototype.hasOwnProperty,Yt=Array.isArray,vt=function(){for(var t=[],e=0;e<256;++e)t.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return t}(),$p=function(e){for(;e.length>1;){var r=e.pop(),n=r.obj[r.prop];if(Yt(n)){for(var s=[],u=0;u<n.length;++u)typeof n[u]<"u"&&s.push(n[u]);r.obj[r.prop]=s}}},rl=function(e,r){for(var n=r&&r.plainObjects?Object.create(null):{},s=0;s<e.length;++s)typeof e[s]<"u"&&(n[s]=e[s]);return n},Gp=function t(e,r,n){if(!r)return e;if(typeof r!="object"){if(Yt(e))e.push(r);else if(e&&typeof e=="object")(n&&(n.plainObjects||n.allowPrototypes)||!qa.call(Object.prototype,r))&&(e[r]=!0);else return[e,r];return e}if(!e||typeof e!="object")return[e].concat(r);var s=e;return Yt(e)&&!Yt(r)&&(s=rl(e,n)),Yt(e)&&Yt(r)?(r.forEach(function(u,c){if(qa.call(e,c)){var i=e[c];i&&typeof i=="object"&&u&&typeof u=="object"?e[c]=t(i,u,n):e.push(u)}else e[c]=u}),e):Object.keys(r).reduce(function(u,c){var i=r[c];return qa.call(u,c)?u[c]=t(u[c],i,n):u[c]=i,u},s)},jp=function(e,r){return Object.keys(r).reduce(function(n,s){return n[s]=r[s],n},e)},Hp=function(t,e,r){var n=t.replace(/\+/g," ");if(r==="iso-8859-1")return n.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(n)}catch{return n}},zp=function(e,r,n,s,u){if(e.length===0)return e;var c=e;if(typeof e=="symbol"?c=Symbol.prototype.toString.call(e):typeof e!="string"&&(c=String(e)),n==="iso-8859-1")return escape(c).replace(/%u[0-9a-f]{4}/gi,function(A){return"%26%23"+parseInt(A.slice(2),16)+"%3B"});for(var i="",y=0;y<c.length;++y){var f=c.charCodeAt(y);if(f===45||f===46||f===95||f===126||f>=48&&f<=57||f>=65&&f<=90||f>=97&&f<=122||u===Kp.RFC1738&&(f===40||f===41)){i+=c.charAt(y);continue}if(f<128){i=i+vt[f];continue}if(f<2048){i=i+(vt[192|f>>6]+vt[128|f&63]);continue}if(f<55296||f>=57344){i=i+(vt[224|f>>12]+vt[128|f>>6&63]+vt[128|f&63]);continue}y+=1,f=65536+((f&1023)<<10|c.charCodeAt(y)&1023),i+=vt[240|f>>18]+vt[128|f>>12&63]+vt[128|f>>6&63]+vt[128|f&63]}return i},Wp=function(e){for(var r=[{obj:{o:e},prop:"o"}],n=[],s=0;s<r.length;++s)for(var u=r[s],c=u.obj[u.prop],i=Object.keys(c),y=0;y<i.length;++y){var f=i[y],A=c[f];typeof A=="object"&&A!==null&&n.indexOf(A)===-1&&(r.push({obj:c,prop:f}),n.push(A))}return $p(r),e},Qp=function(e){return Object.prototype.toString.call(e)==="[object RegExp]"},Yp=function(e){return!e||typeof e!="object"?!1:!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))},Jp=function(e,r){return[].concat(e,r)},Xp=function(e,r){if(Yt(e)){for(var n=[],s=0;s<e.length;s+=1)n.push(r(e[s]));return n}return r(e)},nl={arrayToObject:rl,assign:jp,combine:Jp,compact:Wp,decode:Hp,encode:zp,isBuffer:Yp,isRegExp:Qp,maybeMap:Xp,merge:Gp},il=Mp,is=nl,Hr=Ps,Zp=Object.prototype.hasOwnProperty,wu={brackets:function(e){return e+"[]"},comma:"comma",indices:function(e,r){return e+"["+r+"]"},repeat:function(e){return e}},Bt=Array.isArray,ey=String.prototype.split,ty=Array.prototype.push,al=function(t,e){ty.apply(t,Bt(e)?e:[e])},ry=Date.prototype.toISOString,Iu=Hr.default,tt={addQueryPrefix:!1,allowDots:!1,charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encoder:is.encode,encodeValuesOnly:!1,format:Iu,formatter:Hr.formatters[Iu],indices:!1,serializeDate:function(e){return ry.call(e)},skipNulls:!1,strictNullHandling:!1},ny=function(e){return typeof e=="string"||typeof e=="number"||typeof e=="boolean"||typeof e=="symbol"||typeof e=="bigint"},Va={},iy=function t(e,r,n,s,u,c,i,y,f,A,C,p,o,m,g,S){for(var a=e,v=S,E=0,b=!1;(v=v.get(Va))!==void 0&&!b;){var R=v.get(e);if(E+=1,typeof R<"u"){if(R===E)throw new RangeError("Cyclic object value");b=!0}typeof v.get(Va)>"u"&&(E=0)}if(typeof y=="function"?a=y(r,a):a instanceof Date?a=C(a):n==="comma"&&Bt(a)&&(a=is.maybeMap(a,function(re){return re instanceof Date?C(re):re})),a===null){if(u)return i&&!m?i(r,tt.encoder,g,"key",p):r;a=""}if(ny(a)||is.isBuffer(a)){if(i){var T=m?r:i(r,tt.encoder,g,"key",p);if(n==="comma"&&m){for(var h=ey.call(String(a),","),l="",B=0;B<h.length;++B)l+=(B===0?"":",")+o(i(h[B],tt.encoder,g,"value",p));return[o(T)+(s&&Bt(a)&&h.length===1?"[]":"")+"="+l]}return[o(T)+"="+o(i(a,tt.encoder,g,"value",p))]}return[o(r)+"="+o(String(a))]}var N=[];if(typeof a>"u")return N;var F;if(n==="comma"&&Bt(a))F=[{value:a.length>0?a.join(",")||null:void 0}];else if(Bt(y))F=y;else{var L=Object.keys(a);F=f?L.sort(f):L}for(var q=s&&Bt(a)&&a.length===1?r+"[]":r,j=0;j<F.length;++j){var H=F[j],Q=typeof H=="object"&&typeof H.value<"u"?H.value:a[H];if(!(c&&Q===null)){var J=Bt(a)?typeof n=="function"?n(q,H):q:q+(A?"."+H:"["+H+"]");S.set(e,E);var X=il();X.set(Va,S),al(N,t(Q,J,n,s,u,c,i,y,f,A,C,p,o,m,g,X))}}return N},ay=function(e){if(!e)return tt;if(e.encoder!==null&&typeof e.encoder<"u"&&typeof e.encoder!="function")throw new TypeError("Encoder has to be a function.");var r=e.charset||tt.charset;if(typeof e.charset<"u"&&e.charset!=="utf-8"&&e.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var n=Hr.default;if(typeof e.format<"u"){if(!Zp.call(Hr.formatters,e.format))throw new TypeError("Unknown format option provided.");n=e.format}var s=Hr.formatters[n],u=tt.filter;return(typeof e.filter=="function"||Bt(e.filter))&&(u=e.filter),{addQueryPrefix:typeof e.addQueryPrefix=="boolean"?e.addQueryPrefix:tt.addQueryPrefix,allowDots:typeof e.allowDots>"u"?tt.allowDots:!!e.allowDots,charset:r,charsetSentinel:typeof e.charsetSentinel=="boolean"?e.charsetSentinel:tt.charsetSentinel,delimiter:typeof e.delimiter>"u"?tt.delimiter:e.delimiter,encode:typeof e.encode=="boolean"?e.encode:tt.encode,encoder:typeof e.encoder=="function"?e.encoder:tt.encoder,encodeValuesOnly:typeof e.encodeValuesOnly=="boolean"?e.encodeValuesOnly:tt.encodeValuesOnly,filter:u,format:n,formatter:s,serializeDate:typeof e.serializeDate=="function"?e.serializeDate:tt.serializeDate,skipNulls:typeof e.skipNulls=="boolean"?e.skipNulls:tt.skipNulls,sort:typeof e.sort=="function"?e.sort:null,strictNullHandling:typeof e.strictNullHandling=="boolean"?e.strictNullHandling:tt.strictNullHandling}},sy=function(t,e){var r=t,n=ay(e),s,u;typeof n.filter=="function"?(u=n.filter,r=u("",r)):Bt(n.filter)&&(u=n.filter,s=u);var c=[];if(typeof r!="object"||r===null)return"";var i;e&&e.arrayFormat in wu?i=e.arrayFormat:e&&"indices"in e?i=e.indices?"indices":"repeat":i="indices";var y=wu[i];if(e&&"commaRoundTrip"in e&&typeof e.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");var f=y==="comma"&&e&&e.commaRoundTrip;s||(s=Object.keys(r)),n.sort&&s.sort(n.sort);for(var A=il(),C=0;C<s.length;++C){var p=s[C];n.skipNulls&&r[p]===null||al(c,iy(r[p],p,y,f,n.strictNullHandling,n.skipNulls,n.encode?n.encoder:null,n.filter,n.sort,n.allowDots,n.serializeDate,n.format,n.formatter,n.encodeValuesOnly,n.charset,A))}var o=c.join(n.delimiter),m=n.addQueryPrefix===!0?"?":"";return n.charsetSentinel&&(n.charset==="iso-8859-1"?m+="utf8=%26%2310003%3B&":m+="utf8=%E2%9C%93&"),o.length>0?m+o:""},wr=nl,as=Object.prototype.hasOwnProperty,oy=Array.isArray,Ze={allowDots:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decoder:wr.decode,delimiter:"&",depth:5,ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictNullHandling:!1},uy=function(t){return t.replace(/&#(\d+);/g,function(e,r){return String.fromCharCode(parseInt(r,10))})},sl=function(t,e){return t&&typeof t=="string"&&e.comma&&t.indexOf(",")>-1?t.split(","):t},cy="utf8=%26%2310003%3B",ly="utf8=%E2%9C%93",fy=function(e,r){var n={},s=r.ignoreQueryPrefix?e.replace(/^\?/,""):e,u=r.parameterLimit===1/0?void 0:r.parameterLimit,c=s.split(r.delimiter,u),i=-1,y,f=r.charset;if(r.charsetSentinel)for(y=0;y<c.length;++y)c[y].indexOf("utf8=")===0&&(c[y]===ly?f="utf-8":c[y]===cy&&(f="iso-8859-1"),i=y,y=c.length);for(y=0;y<c.length;++y)if(y!==i){var A=c[y],C=A.indexOf("]="),p=C===-1?A.indexOf("="):C+1,o,m;p===-1?(o=r.decoder(A,Ze.decoder,f,"key"),m=r.strictNullHandling?null:""):(o=r.decoder(A.slice(0,p),Ze.decoder,f,"key"),m=wr.maybeMap(sl(A.slice(p+1),r),function(g){return r.decoder(g,Ze.decoder,f,"value")})),m&&r.interpretNumericEntities&&f==="iso-8859-1"&&(m=uy(m)),A.indexOf("[]=")>-1&&(m=oy(m)?[m]:m),as.call(n,o)?n[o]=wr.combine(n[o],m):n[o]=m}return n},dy=function(t,e,r,n){for(var s=n?e:sl(e,r),u=t.length-1;u>=0;--u){var c,i=t[u];if(i==="[]"&&r.parseArrays)c=[].concat(s);else{c=r.plainObjects?Object.create(null):{};var y=i.charAt(0)==="["&&i.charAt(i.length-1)==="]"?i.slice(1,-1):i,f=parseInt(y,10);!r.parseArrays&&y===""?c={0:s}:!isNaN(f)&&i!==y&&String(f)===y&&f>=0&&r.parseArrays&&f<=r.arrayLimit?(c=[],c[f]=s):y!=="__proto__"&&(c[y]=s)}s=c}return s},hy=function(e,r,n,s){if(e){var u=n.allowDots?e.replace(/\.([^.[]+)/g,"[$1]"):e,c=/(\[[^[\]]*])/,i=/(\[[^[\]]*])/g,y=n.depth>0&&c.exec(u),f=y?u.slice(0,y.index):u,A=[];if(f){if(!n.plainObjects&&as.call(Object.prototype,f)&&!n.allowPrototypes)return;A.push(f)}for(var C=0;n.depth>0&&(y=i.exec(u))!==null&&C<n.depth;){if(C+=1,!n.plainObjects&&as.call(Object.prototype,y[1].slice(1,-1))&&!n.allowPrototypes)return;A.push(y[1])}return y&&A.push("["+u.slice(y.index)+"]"),dy(A,r,n,s)}},py=function(e){if(!e)return Ze;if(e.decoder!==null&&e.decoder!==void 0&&typeof e.decoder!="function")throw new TypeError("Decoder has to be a function.");if(typeof e.charset<"u"&&e.charset!=="utf-8"&&e.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var r=typeof e.charset>"u"?Ze.charset:e.charset;return{allowDots:typeof e.allowDots>"u"?Ze.allowDots:!!e.allowDots,allowPrototypes:typeof e.allowPrototypes=="boolean"?e.allowPrototypes:Ze.allowPrototypes,allowSparse:typeof e.allowSparse=="boolean"?e.allowSparse:Ze.allowSparse,arrayLimit:typeof e.arrayLimit=="number"?e.arrayLimit:Ze.arrayLimit,charset:r,charsetSentinel:typeof e.charsetSentinel=="boolean"?e.charsetSentinel:Ze.charsetSentinel,comma:typeof e.comma=="boolean"?e.comma:Ze.comma,decoder:typeof e.decoder=="function"?e.decoder:Ze.decoder,delimiter:typeof e.delimiter=="string"||wr.isRegExp(e.delimiter)?e.delimiter:Ze.delimiter,depth:typeof e.depth=="number"||e.depth===!1?+e.depth:Ze.depth,ignoreQueryPrefix:e.ignoreQueryPrefix===!0,interpretNumericEntities:typeof e.interpretNumericEntities=="boolean"?e.interpretNumericEntities:Ze.interpretNumericEntities,parameterLimit:typeof e.parameterLimit=="number"?e.parameterLimit:Ze.parameterLimit,parseArrays:e.parseArrays!==!1,plainObjects:typeof e.plainObjects=="boolean"?e.plainObjects:Ze.plainObjects,strictNullHandling:typeof e.strictNullHandling=="boolean"?e.strictNullHandling:Ze.strictNullHandling}},yy=function(t,e){var r=py(e);if(t===""||t===null||typeof t>"u")return r.plainObjects?Object.create(null):{};for(var n=typeof t=="string"?fy(t,r):t,s=r.plainObjects?Object.create(null):{},u=Object.keys(n),c=0;c<u.length;++c){var i=u[c],y=hy(i,n[i],r,typeof t=="string");s=wr.merge(s,y,r)}return r.allowSparse===!0?s:wr.compact(s)},gy=sy,vy=yy,my=Ps,ol={formats:my,parse:vy,stringify:gy},ul={exports:{}};(function(t,e){(function(r,n){t.exports=n()})(Re,function(){function r(){}return r.prototype.encodeReserved=function(n){return n.split(/(%[0-9A-Fa-f]{2})/g).map(function(s){return/%[0-9A-Fa-f]/.test(s)||(s=encodeURI(s).replace(/%5B/g,"[").replace(/%5D/g,"]")),s}).join("")},r.prototype.encodeUnreserved=function(n){return encodeURIComponent(n).replace(/[!'()*]/g,function(s){return"%"+s.charCodeAt(0).toString(16).toUpperCase()})},r.prototype.encodeValue=function(n,s,u){return s=n==="+"||n==="#"?this.encodeReserved(s):this.encodeUnreserved(s),u?this.encodeUnreserved(u)+"="+s:s},r.prototype.isDefined=function(n){return n!=null},r.prototype.isKeyOperator=function(n){return n===";"||n==="&"||n==="?"},r.prototype.getValues=function(n,s,u,c){var i=n[u],y=[];if(this.isDefined(i)&&i!=="")if(typeof i=="string"||typeof i=="number"||typeof i=="boolean")i=i.toString(),c&&c!=="*"&&(i=i.substring(0,parseInt(c,10))),y.push(this.encodeValue(s,i,this.isKeyOperator(s)?u:null));else if(c==="*")Array.isArray(i)?i.filter(this.isDefined).forEach(function(A){y.push(this.encodeValue(s,A,this.isKeyOperator(s)?u:null))},this):Object.keys(i).forEach(function(A){this.isDefined(i[A])&&y.push(this.encodeValue(s,i[A],A))},this);else{var f=[];Array.isArray(i)?i.filter(this.isDefined).forEach(function(A){f.push(this.encodeValue(s,A))},this):Object.keys(i).forEach(function(A){this.isDefined(i[A])&&(f.push(this.encodeUnreserved(A)),f.push(this.encodeValue(s,i[A].toString())))},this),this.isKeyOperator(s)?y.push(this.encodeUnreserved(u)+"="+f.join(",")):f.length!==0&&y.push(f.join(","))}else s===";"?this.isDefined(i)&&y.push(this.encodeUnreserved(u)):i===""&&(s==="&"||s==="?")?y.push(this.encodeUnreserved(u)+"="):i===""&&y.push("");return y},r.prototype.parse=function(n){var s=this,u=["+","#",".","/",";","?","&"];return{expand:function(c){return n.replace(/\{([^\{\}]+)\}|([^\{\}]+)/g,function(i,y,f){if(y){var A=null,C=[];if(u.indexOf(y.charAt(0))!==-1&&(A=y.charAt(0),y=y.substr(1)),y.split(/,/g).forEach(function(o){var m=/([^:\*]*)(?::(\d+)|(\*))?/.exec(o);C.push.apply(C,s.getValues(c,A,m[1],m[2]||m[3]))}),A&&A!=="+"){var p=",";return A==="?"?p="&":A!=="#"&&(p=A),(C.length!==0?A:"")+C.join(p)}else return C.join(",")}else return s.encodeReserved(f)})}}},new r})})(ul);var Ey=ul.exports,cl={},hi={},pi={};Object.defineProperty(pi,"__esModule",{value:!0});pi.default=Sy;let Nn;const Cy=new Uint8Array(16);function Sy(){if(!Nn&&(Nn=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Nn))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Nn(Cy)}var Ht={},ur={},yi={};Object.defineProperty(yi,"__esModule",{value:!0});yi.default=void 0;var Ay=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;yi.default=Ay;Object.defineProperty(ur,"__esModule",{value:!0});ur.default=void 0;var Ty=xy(yi);function xy(t){return t&&t.__esModule?t:{default:t}}function _y(t){return typeof t=="string"&&Ty.default.test(t)}var wy=_y;ur.default=wy;Object.defineProperty(Ht,"__esModule",{value:!0});Ht.default=void 0;Ht.unsafeStringify=ll;var Iy=by(ur);function by(t){return t&&t.__esModule?t:{default:t}}const et=[];for(let t=0;t<256;++t)et.push((t+256).toString(16).slice(1));function ll(t,e=0){return(et[t[e+0]]+et[t[e+1]]+et[t[e+2]]+et[t[e+3]]+"-"+et[t[e+4]]+et[t[e+5]]+"-"+et[t[e+6]]+et[t[e+7]]+"-"+et[t[e+8]]+et[t[e+9]]+"-"+et[t[e+10]]+et[t[e+11]]+et[t[e+12]]+et[t[e+13]]+et[t[e+14]]+et[t[e+15]]).toLowerCase()}function Ry(t,e=0){const r=ll(t,e);if(!(0,Iy.default)(r))throw TypeError("Stringified UUID is invalid");return r}var By=Ry;Ht.default=By;Object.defineProperty(hi,"__esModule",{value:!0});hi.default=void 0;var Ny=Uy(pi),Py=Ht;function Uy(t){return t&&t.__esModule?t:{default:t}}let bu,Ka,$a=0,Ga=0;function Oy(t,e,r){let n=e&&r||0;const s=e||new Array(16);t=t||{};let u=t.node||bu,c=t.clockseq!==void 0?t.clockseq:Ka;if(u==null||c==null){const p=t.random||(t.rng||Ny.default)();u==null&&(u=bu=[p[0]|1,p[1],p[2],p[3],p[4],p[5]]),c==null&&(c=Ka=(p[6]<<8|p[7])&16383)}let i=t.msecs!==void 0?t.msecs:Date.now(),y=t.nsecs!==void 0?t.nsecs:Ga+1;const f=i-$a+(y-Ga)/1e4;if(f<0&&t.clockseq===void 0&&(c=c+1&16383),(f<0||i>$a)&&t.nsecs===void 0&&(y=0),y>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");$a=i,Ga=y,Ka=c,i+=122192928e5;const A=((i&268435455)*1e4+y)%4294967296;s[n++]=A>>>24&255,s[n++]=A>>>16&255,s[n++]=A>>>8&255,s[n++]=A&255;const C=i/4294967296*1e4&268435455;s[n++]=C>>>8&255,s[n++]=C&255,s[n++]=C>>>24&15|16,s[n++]=C>>>16&255,s[n++]=c>>>8|128,s[n++]=c&255;for(let p=0;p<6;++p)s[n+p]=u[p];return e||(0,Py.unsafeStringify)(s)}var ky=Oy;hi.default=ky;var gi={},Vt={},hn={};Object.defineProperty(hn,"__esModule",{value:!0});hn.default=void 0;var Ly=Dy(ur);function Dy(t){return t&&t.__esModule?t:{default:t}}function Fy(t){if(!(0,Ly.default)(t))throw TypeError("Invalid UUID");let e;const r=new Uint8Array(16);return r[0]=(e=parseInt(t.slice(0,8),16))>>>24,r[1]=e>>>16&255,r[2]=e>>>8&255,r[3]=e&255,r[4]=(e=parseInt(t.slice(9,13),16))>>>8,r[5]=e&255,r[6]=(e=parseInt(t.slice(14,18),16))>>>8,r[7]=e&255,r[8]=(e=parseInt(t.slice(19,23),16))>>>8,r[9]=e&255,r[10]=(e=parseInt(t.slice(24,36),16))/1099511627776&255,r[11]=e/4294967296&255,r[12]=e>>>24&255,r[13]=e>>>16&255,r[14]=e>>>8&255,r[15]=e&255,r}var My=Fy;hn.default=My;Object.defineProperty(Vt,"__esModule",{value:!0});Vt.URL=Vt.DNS=void 0;Vt.default=Gy;var qy=Ht,Vy=Ky(hn);function Ky(t){return t&&t.__esModule?t:{default:t}}function $y(t){t=unescape(encodeURIComponent(t));const e=[];for(let r=0;r<t.length;++r)e.push(t.charCodeAt(r));return e}const fl="6ba7b810-9dad-11d1-80b4-00c04fd430c8";Vt.DNS=fl;const dl="6ba7b811-9dad-11d1-80b4-00c04fd430c8";Vt.URL=dl;function Gy(t,e,r){function n(s,u,c,i){var y;if(typeof s=="string"&&(s=$y(s)),typeof u=="string"&&(u=(0,Vy.default)(u)),((y=u)===null||y===void 0?void 0:y.length)!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let f=new Uint8Array(16+s.length);if(f.set(u),f.set(s,u.length),f=r(f),f[6]=f[6]&15|e,f[8]=f[8]&63|128,c){i=i||0;for(let A=0;A<16;++A)c[i+A]=f[A];return c}return(0,qy.unsafeStringify)(f)}try{n.name=t}catch{}return n.DNS=fl,n.URL=dl,n}var vi={};Object.defineProperty(vi,"__esModule",{value:!0});vi.default=void 0;function jy(t){if(typeof t=="string"){const e=unescape(encodeURIComponent(t));t=new Uint8Array(e.length);for(let r=0;r<e.length;++r)t[r]=e.charCodeAt(r)}return Hy(zy(Wy(t),t.length*8))}function Hy(t){const e=[],r=t.length*32,n="0123456789abcdef";for(let s=0;s<r;s+=8){const u=t[s>>5]>>>s%32&255,c=parseInt(n.charAt(u>>>4&15)+n.charAt(u&15),16);e.push(c)}return e}function hl(t){return(t+64>>>9<<4)+14+1}function zy(t,e){t[e>>5]|=128<<e%32,t[hl(e)-1]=e;let r=1732584193,n=-271733879,s=-1732584194,u=271733878;for(let c=0;c<t.length;c+=16){const i=r,y=n,f=s,A=u;r=rt(r,n,s,u,t[c],7,-680876936),u=rt(u,r,n,s,t[c+1],12,-389564586),s=rt(s,u,r,n,t[c+2],17,606105819),n=rt(n,s,u,r,t[c+3],22,-1044525330),r=rt(r,n,s,u,t[c+4],7,-176418897),u=rt(u,r,n,s,t[c+5],12,1200080426),s=rt(s,u,r,n,t[c+6],17,-1473231341),n=rt(n,s,u,r,t[c+7],22,-45705983),r=rt(r,n,s,u,t[c+8],7,1770035416),u=rt(u,r,n,s,t[c+9],12,-1958414417),s=rt(s,u,r,n,t[c+10],17,-42063),n=rt(n,s,u,r,t[c+11],22,-1990404162),r=rt(r,n,s,u,t[c+12],7,1804603682),u=rt(u,r,n,s,t[c+13],12,-40341101),s=rt(s,u,r,n,t[c+14],17,-1502002290),n=rt(n,s,u,r,t[c+15],22,1236535329),r=nt(r,n,s,u,t[c+1],5,-165796510),u=nt(u,r,n,s,t[c+6],9,-1069501632),s=nt(s,u,r,n,t[c+11],14,643717713),n=nt(n,s,u,r,t[c],20,-373897302),r=nt(r,n,s,u,t[c+5],5,-701558691),u=nt(u,r,n,s,t[c+10],9,38016083),s=nt(s,u,r,n,t[c+15],14,-660478335),n=nt(n,s,u,r,t[c+4],20,-405537848),r=nt(r,n,s,u,t[c+9],5,568446438),u=nt(u,r,n,s,t[c+14],9,-1019803690),s=nt(s,u,r,n,t[c+3],14,-187363961),n=nt(n,s,u,r,t[c+8],20,1163531501),r=nt(r,n,s,u,t[c+13],5,-1444681467),u=nt(u,r,n,s,t[c+2],9,-51403784),s=nt(s,u,r,n,t[c+7],14,1735328473),n=nt(n,s,u,r,t[c+12],20,-1926607734),r=it(r,n,s,u,t[c+5],4,-378558),u=it(u,r,n,s,t[c+8],11,-2022574463),s=it(s,u,r,n,t[c+11],16,1839030562),n=it(n,s,u,r,t[c+14],23,-35309556),r=it(r,n,s,u,t[c+1],4,-1530992060),u=it(u,r,n,s,t[c+4],11,1272893353),s=it(s,u,r,n,t[c+7],16,-155497632),n=it(n,s,u,r,t[c+10],23,-1094730640),r=it(r,n,s,u,t[c+13],4,681279174),u=it(u,r,n,s,t[c],11,-358537222),s=it(s,u,r,n,t[c+3],16,-722521979),n=it(n,s,u,r,t[c+6],23,76029189),r=it(r,n,s,u,t[c+9],4,-640364487),u=it(u,r,n,s,t[c+12],11,-421815835),s=it(s,u,r,n,t[c+15],16,530742520),n=it(n,s,u,r,t[c+2],23,-995338651),r=at(r,n,s,u,t[c],6,-198630844),u=at(u,r,n,s,t[c+7],10,1126891415),s=at(s,u,r,n,t[c+14],15,-1416354905),n=at(n,s,u,r,t[c+5],21,-57434055),r=at(r,n,s,u,t[c+12],6,1700485571),u=at(u,r,n,s,t[c+3],10,-1894986606),s=at(s,u,r,n,t[c+10],15,-1051523),n=at(n,s,u,r,t[c+1],21,-2054922799),r=at(r,n,s,u,t[c+8],6,1873313359),u=at(u,r,n,s,t[c+15],10,-30611744),s=at(s,u,r,n,t[c+6],15,-1560198380),n=at(n,s,u,r,t[c+13],21,1309151649),r=at(r,n,s,u,t[c+4],6,-145523070),u=at(u,r,n,s,t[c+11],10,-1120210379),s=at(s,u,r,n,t[c+2],15,718787259),n=at(n,s,u,r,t[c+9],21,-343485551),r=qt(r,i),n=qt(n,y),s=qt(s,f),u=qt(u,A)}return[r,n,s,u]}function Wy(t){if(t.length===0)return[];const e=t.length*8,r=new Uint32Array(hl(e));for(let n=0;n<e;n+=8)r[n>>5]|=(t[n/8]&255)<<n%32;return r}function qt(t,e){const r=(t&65535)+(e&65535);return(t>>16)+(e>>16)+(r>>16)<<16|r&65535}function Qy(t,e){return t<<e|t>>>32-e}function mi(t,e,r,n,s,u){return qt(Qy(qt(qt(e,t),qt(n,u)),s),r)}function rt(t,e,r,n,s,u,c){return mi(e&r|~e&n,t,e,s,u,c)}function nt(t,e,r,n,s,u,c){return mi(e&n|r&~n,t,e,s,u,c)}function it(t,e,r,n,s,u,c){return mi(e^r^n,t,e,s,u,c)}function at(t,e,r,n,s,u,c){return mi(r^(e|~n),t,e,s,u,c)}var Yy=jy;vi.default=Yy;Object.defineProperty(gi,"__esModule",{value:!0});gi.default=void 0;var Jy=pl(Vt),Xy=pl(vi);function pl(t){return t&&t.__esModule?t:{default:t}}const Zy=(0,Jy.default)("v3",48,Xy.default);var eg=Zy;gi.default=eg;var Ei={},Ci={};Object.defineProperty(Ci,"__esModule",{value:!0});Ci.default=void 0;const tg=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);var rg={randomUUID:tg};Ci.default=rg;Object.defineProperty(Ei,"__esModule",{value:!0});Ei.default=void 0;var Ru=yl(Ci),ng=yl(pi),ig=Ht;function yl(t){return t&&t.__esModule?t:{default:t}}function ag(t,e,r){if(Ru.default.randomUUID&&!e&&!t)return Ru.default.randomUUID();t=t||{};const n=t.random||(t.rng||ng.default)();if(n[6]=n[6]&15|64,n[8]=n[8]&63|128,e){r=r||0;for(let s=0;s<16;++s)e[r+s]=n[s];return e}return(0,ig.unsafeStringify)(n)}var sg=ag;Ei.default=sg;var Si={},Ai={};Object.defineProperty(Ai,"__esModule",{value:!0});Ai.default=void 0;function og(t,e,r,n){switch(t){case 0:return e&r^~e&n;case 1:return e^r^n;case 2:return e&r^e&n^r&n;case 3:return e^r^n}}function ja(t,e){return t<<e|t>>>32-e}function ug(t){const e=[1518500249,1859775393,2400959708,3395469782],r=[1732584193,4023233417,2562383102,271733878,3285377520];if(typeof t=="string"){const c=unescape(encodeURIComponent(t));t=[];for(let i=0;i<c.length;++i)t.push(c.charCodeAt(i))}else Array.isArray(t)||(t=Array.prototype.slice.call(t));t.push(128);const n=t.length/4+2,s=Math.ceil(n/16),u=new Array(s);for(let c=0;c<s;++c){const i=new Uint32Array(16);for(let y=0;y<16;++y)i[y]=t[c*64+y*4]<<24|t[c*64+y*4+1]<<16|t[c*64+y*4+2]<<8|t[c*64+y*4+3];u[c]=i}u[s-1][14]=(t.length-1)*8/Math.pow(2,32),u[s-1][14]=Math.floor(u[s-1][14]),u[s-1][15]=(t.length-1)*8&4294967295;for(let c=0;c<s;++c){const i=new Uint32Array(80);for(let o=0;o<16;++o)i[o]=u[c][o];for(let o=16;o<80;++o)i[o]=ja(i[o-3]^i[o-8]^i[o-14]^i[o-16],1);let y=r[0],f=r[1],A=r[2],C=r[3],p=r[4];for(let o=0;o<80;++o){const m=Math.floor(o/20),g=ja(y,5)+og(m,f,A,C)+p+e[m]+i[o]>>>0;p=C,C=A,A=ja(f,30)>>>0,f=y,y=g}r[0]=r[0]+y>>>0,r[1]=r[1]+f>>>0,r[2]=r[2]+A>>>0,r[3]=r[3]+C>>>0,r[4]=r[4]+p>>>0}return[r[0]>>24&255,r[0]>>16&255,r[0]>>8&255,r[0]&255,r[1]>>24&255,r[1]>>16&255,r[1]>>8&255,r[1]&255,r[2]>>24&255,r[2]>>16&255,r[2]>>8&255,r[2]&255,r[3]>>24&255,r[3]>>16&255,r[3]>>8&255,r[3]&255,r[4]>>24&255,r[4]>>16&255,r[4]>>8&255,r[4]&255]}var cg=ug;Ai.default=cg;Object.defineProperty(Si,"__esModule",{value:!0});Si.default=void 0;var lg=gl(Vt),fg=gl(Ai);function gl(t){return t&&t.__esModule?t:{default:t}}const dg=(0,lg.default)("v5",80,fg.default);var hg=dg;Si.default=hg;var Ti={};Object.defineProperty(Ti,"__esModule",{value:!0});Ti.default=void 0;var pg="00000000-0000-0000-0000-000000000000";Ti.default=pg;var xi={};Object.defineProperty(xi,"__esModule",{value:!0});xi.default=void 0;var yg=gg(ur);function gg(t){return t&&t.__esModule?t:{default:t}}function vg(t){if(!(0,yg.default)(t))throw TypeError("Invalid UUID");return parseInt(t.slice(14,15),16)}var mg=vg;xi.default=mg;(function(t){Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"NIL",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(t,"parse",{enumerable:!0,get:function(){return f.default}}),Object.defineProperty(t,"stringify",{enumerable:!0,get:function(){return y.default}}),Object.defineProperty(t,"v1",{enumerable:!0,get:function(){return e.default}}),Object.defineProperty(t,"v3",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(t,"v4",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(t,"v5",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(t,"validate",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(t,"version",{enumerable:!0,get:function(){return c.default}});var e=A(hi),r=A(gi),n=A(Ei),s=A(Si),u=A(Ti),c=A(xi),i=A(ur),y=A(Ht),f=A(hn);function A(C){return C&&C.__esModule?C:{default:C}}})(cl);var _i={};Object.defineProperty(_i,"__esModule",{value:!0});_i.isBrowser=void 0;function Eg(){return typeof window<"u"}_i.isBrowser=Eg;var vl={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.closeSession=t.request=t.sessions=void 0;const e=Kl,r=$l,n=zn,s=ol,u=os,c=Nt,i=Pt,y=Gl,f=Ir,{HTTP2_HEADER_CONTENT_ENCODING:A,HTTP2_HEADER_CONTENT_TYPE:C,HTTP2_HEADER_METHOD:p,HTTP2_HEADER_PATH:o,HTTP2_HEADER_STATUS:m}=e.constants,g=!!y.env.HTTP2_DEBUG;t.sessions={};async function S(b){const R=u(!0,{},b);R.validateStatus=R.validateStatus||a,R.responseType=R.responseType||"json";const T=new n.URL(R.url),h=v(T.host);h.timeoutHandle!==void 0&&clearTimeout(h.timeoutHandle);let l=T.pathname;if(b.params&&Object.keys(b.params).length>0){const H=(b.paramsSerializer||s.stringify)(R.params);l+=`?${H}`}const B=Object.assign({},R.headers,{[o]:l,[p]:b.method||"GET"});B[C]||R.responseType!=="text"&&(B[C]="application/json");const N={config:b,request:{},headers:[],status:0,data:{},statusText:""},F=[],L=h.session;let q;return new Promise((j,H)=>{try{q=L.request(B).on("response",Q=>{N.headers=Q,N.status=Number(Q[m]);let J=q;if(Q[A]==="gzip"&&(J=q.pipe(r.createGunzip())),R.responseType==="stream"){N.data=J,j(N);return}J.on("data",X=>{F.push(X)}).on("error",X=>{H(X)}).on("end",()=>{const X=Buffer.concat(F);let re=X;if(X){if(R.responseType==="json")try{re=JSON.parse(X.toString("utf8"))}catch{re=X.toString("utf8")}else R.responseType==="text"?re=X.toString("utf8"):R.responseType==="arraybuffer"&&(re=X.buffer);N.data=re}if(!R.validateStatus(N.status)){let se=`Request failed with status code ${N.status}. `;if(N.data&&typeof N.data=="object"){const de=i.inspect(N.data,{depth:5});se=`${se}
'${de}`}H(new f.GaxiosError(se,R,N))}j(N)})}).on("error",Q=>{H(Q)})}catch(Q){E(T),H(Q)}if(N.request=q,b.data){if(b.data instanceof c.Stream)b.data.pipe(q);else if(typeof b.data=="string"){const Q=Buffer.from(b.data);q.end(Q)}else if(typeof b.data=="object"){const Q=JSON.stringify(b.data);q.end(Q)}}h.timeoutHandle=setTimeout(()=>{E(T)},500)})}t.request=S;function a(b){return b>=200&&b<300}function v(b){if(t.sessions[b])g&&console.log(`Used cached client for ${b}`);else{g&&console.log(`Creating client for ${b}`);const R=e.connect(`https://${b}`);R.on("error",T=>{console.error(`*ERROR*: ${T}`),delete t.sessions[b]}).on("goaway",(T,h)=>{console.error(`*GOAWAY*: ${T} : ${h}`),delete t.sessions[b]}),t.sessions[b]={session:R}}return t.sessions[b]}async function E(b){const R=t.sessions[b.host];if(!R)return;const{session:T}=R;delete t.sessions[b.host],g&&console.error(`Closing ${b.host}`),T.close(()=>{g&&console.error(`Closed ${b.host}`)}),setTimeout(()=>{T&&!T.destroyed&&(g&&console.log(`Forcing close ${b.host}`),T&&T.destroy())},1e3)}t.closeSession=E})(vl);const Cg="googleapis-common",Sg="6.0.4",Ag="A common tooling library used by the googleapis npm module. You probably don't want to use this directly.",Tg="googleapis/nodejs-googleapis-common",xg="build/src/index.js",_g="build/src/index.d.ts",wg=["build/src","!build/src/**/*.map"],Ig={prebenchmark:"npm run compile",benchmark:"node build/benchmark/bench.js",compile:"tsc -p .",test:"c8 mocha build/test","system-test":"c8 mocha build/system-test --timeout 600000","presystem-test":"npm run compile",fix:"gts fix",prepare:"npm run compile",pretest:"npm run compile",lint:"gts check","samples-test":"mocha build/samples-test",docs:"compodoc src/","docs-test":"linkinator docs",webpack:"webpack","browser-test":"karma start","predocs-test":"npm run docs",prelint:"cd samples; npm link ../; npm install",clean:"gts clean",precompile:"gts clean"},bg=[],Rg="Google LLC",Bg="Apache-2.0",Ng={extend:"^3.0.2",gaxios:"^5.0.1","google-auth-library":"^8.0.2",qs:"^6.7.0","url-template":"^2.0.8",uuid:"^9.0.0"},Pg={"@compodoc/compodoc":"^1.1.9","@types/execa":"^0.9.0","@types/extend":"^3.0.1","@types/mocha":"^9.0.0","@types/mv":"^2.1.0","@types/ncp":"^2.0.1","@types/nock":"^10.0.3","@types/proxyquire":"^1.3.28","@types/qs":"^6.5.3","@types/sinon":"^10.0.0","@types/tmp":"0.2.3","@types/url-template":"^2.0.28","@types/uuid":"^8.0.0",c8:"^7.0.0",codecov:"^3.5.0",execa:"^5.0.0",gts:"^3.1.0",http2spy:"^2.0.0","is-docker":"^2.0.0",karma:"^6.0.0","karma-chrome-launcher":"^3.0.0","karma-coverage":"^2.0.0","karma-firefox-launcher":"^2.0.0","karma-mocha":"^2.0.0","karma-remap-coverage":"^0.1.5","karma-sourcemap-loader":"^0.3.7","karma-webpack":"^5.0.0",linkinator:"^3.1.0",mocha:"^9.2.2",mv:"^2.1.1",ncp:"^2.0.0",nock:"^13.0.0","null-loader":"^4.0.0",proxyquire:"^2.1.3",puppeteer:"^18.2.1",sinon:"^14.0.0",tmp:"^0.2.0","ts-loader":"^8.0.0",typescript:"^4.6.4",webpack:"^5.30.0","webpack-cli":"^4.0.0"},Ug={node:">=12.0.0"},Og={name:Cg,version:Sg,description:Ag,repository:Tg,main:xg,types:_g,files:wg,scripts:Ig,keywords:bg,author:Rg,license:Bg,dependencies:Ng,devDependencies:Pg,engines:Ug};Object.defineProperty(Br,"__esModule",{value:!0});Br.createAPIRequest=void 0;const kg=Yr,Lg=ol,ml=Nt,Bu=Ey,Nu=cl,Ha=os,ss=_i,Dg=vl,El=Og;function Fg(t){return t!==null&&typeof t=="object"&&typeof t.pipe=="function"&&t.readable!==!1&&typeof t._read=="function"&&typeof t._readableState=="object"}function Mg(t,e){const r=new Array;return e.forEach(n=>{t[n]===void 0&&r.push(n)}),r.length>0?r:null}function qg(t,e){if(e)Pu(t).then(r=>e(null,r),e);else return Pu(t)}Br.createAPIRequest=qg;async function Pu(t){var e;const r=Ha(!0,{},((e=t.context.google)===null||e===void 0?void 0:e._options)||{},t.context._options||{},t.options),n=Ha(!0,{},r.params,t.params);r.userAgentDirectives=r.userAgentDirectives||[];const s=n.media||{};let u=n.requestBody;!n.requestBody&&n.resource&&(!t.requiredParams.includes("resource")||typeof n.resource!="string")&&(u=n.resource,delete n.resource),delete n.requestBody;let c=n.auth||r.auth;const i=typeof s.body=="string"?"text/plain":"application/octet-stream";delete n.media,delete n.auth;const y=n.headers||{};Kg(y),delete n.headers,Object.keys(n).forEach(p=>{if(p.slice(-1)==="_"){const o=p.slice(0,-1);n[o]=n[p],delete n[p]}});const f=Mg(n,t.requiredParams);if(f)throw new Error("Missing required parameters: "+f.join(", "));if(r.url&&(r.url=Bu.parse(r.url).expand(n)),t.mediaUrl&&(t.mediaUrl=Bu.parse(t.mediaUrl).expand(n)),t.context._options.rootUrl!==void 0&&r.url!==void 0){const p=new URL(r.url),o=p.href.substr(p.origin.length);r.url=new URL(o,t.context._options.rootUrl).href}r.paramsSerializer=p=>Lg.stringify(p,{arrayFormat:"repeat"}),t.pathParams.forEach(p=>delete n[p]),typeof c=="string"&&(n.key=n.key||c,c=void 0);function A(p){const o=Nu.v4(),m=`--${o}--`,g=new ml.PassThrough({flush(v){this.push(`\r
`),this.push(m),v()}}),S=new Vg,a=Fg(p[1].body);y["content-type"]=`multipart/related; boundary=${o}`;for(const v of p){const E=`--${o}\r
content-type: ${v["content-type"]}\r
\r
`;g.push(E),typeof v.body=="string"?(g.push(v.body),g.push(`\r
`)):(S.on("progress",b=>{r.onUploadProgress&&r.onUploadProgress({bytesRead:b})}),v.body.pipe(S).pipe(g))}a||(g.push(m),g.push(null)),r.data=g}function C(p){const o=Nu.v4(),m=`--${o}--`;y["content-type"]=`multipart/related; boundary=${o}`;let g="";for(const S of p){const a=`--${o}\r
content-type: ${S["content-type"]}\r
\r
`;g+=a,typeof S.body=="string"&&(g+=S.body,g+=`\r
`)}g+=m,r.data=g}if(t.mediaUrl&&s.body)if(r.url=t.mediaUrl,u){n.uploadType="multipart";const p=[{"content-type":"application/json",body:JSON.stringify(u)},{"content-type":s.mimeType||u&&u.mimeType||i,body:s.body}];(0,ss.isBrowser)()?C(p):A(p)}else n.uploadType="media",Object.assign(y,{"content-type":s.mimeType||i}),r.data=s.body;else r.data=u||void 0;if(r.headers=Ha(!0,r.headers||{},y),r.params=n,!(0,ss.isBrowser)()){r.headers["Accept-Encoding"]="gzip",r.userAgentDirectives.push({product:"google-api-nodejs-client",version:El.version,comment:"gzip"});const p=r.userAgentDirectives.map(o=>{let m=`${o.product}/${o.version}`;return o.comment&&(m+=` (${o.comment})`),m}).join(" ");r.headers["User-Agent"]=p}if(r.validateStatus||(r.validateStatus=p=>p>=200&&p<300||p===304),r.retry=r.retry===void 0?!0:r.retry,delete r.auth,c&&typeof c=="object")if(r.http2){const p=await c.getRequestHeaders(r.url),o=Object.assign({},r);return o.headers=Object.assign(o.headers,p),Dg.request(o)}else return c.request(r);else return new kg.DefaultTransporter().request(r)}class Vg extends ml.Transform{constructor(){super(...arguments),this.bytesRead=0}_transform(e,r,n){this.bytesRead+=e.length,this.emit("progress",this.bytesRead),this.push(e),n()}}function Kg(t){(0,ss.isBrowser)()||(t["x-goog-api-client"]=`gdcl/${El.version} gl-node/${process.versions.node}`)}var wi={};Object.defineProperty(wi,"__esModule",{value:!0});wi.AuthPlus=void 0;const It=Yr;class $g extends It.GoogleAuth{constructor(){super(...arguments),this.JWT=It.JWT,this.Compute=It.Compute,this.OAuth2=It.OAuth2Client,this.GoogleAuth=It.GoogleAuth,this.AwsClient=It.AwsClient,this.IdentityPoolClient=It.IdentityPoolClient,this.ExternalAccountClient=It.ExternalAccountClient}async getClient(e){return this._cachedAuth=new It.GoogleAuth(e),this._cachedAuth.getClient()}getProjectId(e){return e?this._cachedAuth?this._cachedAuth.getProjectId(e):super.getProjectId(e):this._cachedAuth?this._cachedAuth.getProjectId():super.getProjectId()}}wi.AuthPlus=$g;var Ii={},pn={};Object.defineProperty(pn,"__esModule",{value:!0});pn.Endpoint=void 0;const Uu=Br;class Gg{constructor(e){this._options=e||{}}applySchema(e,r,n,s){if(this.applyMethodsFromSchema(e,r,n,s),n.resources){for(const u in n.resources)if(Object.prototype.hasOwnProperty.call(n.resources,u)){const c=n.resources[u];e[u]||(e[u]={}),this.applySchema(e[u],r,c,s)}}}applyMethodsFromSchema(e,r,n,s){if(n.methods){for(const u in n.methods)if(Object.prototype.hasOwnProperty.call(n.methods,u)){const c=n.methods[u];e[u]=this.makeMethod(r,c,s)}}}makeMethod(e,r,n){return(s,u)=>{const c=typeof s=="function"?{}:s;u=typeof s=="function"?s:u;const i=Ou(e.rootUrl+e.servicePath+r.path),y={options:{url:i.substring(1,i.length-1),method:r.httpMethod},params:c,requiredParams:r.parameterOrder||[],pathParams:this.getPathParams(r.parameters),context:n};if(r.mediaUpload&&r.mediaUpload.protocols&&r.mediaUpload.protocols.simple&&r.mediaUpload.protocols.simple.path){const f=Ou(e.rootUrl+r.mediaUpload.protocols.simple.path);y.mediaUrl=f.substring(1,f.length-1)}if(!u)return(0,Uu.createAPIRequest)(y);(0,Uu.createAPIRequest)(y,u)}}getPathParams(e){const r=new Array;return typeof e!="object"&&(e={}),Object.keys(e).forEach(n=>{e[n].location==="path"&&r.push(n)}),r}}pn.Endpoint=Gg;function Ou(t){return t?`'${t}'`.replace(/([^:]\/)\/+/g,"$1"):""}Object.defineProperty(Ii,"__esModule",{value:!0});Ii.Discovery=void 0;const jg=nr,Hg=Yr,zg=zn,Cl=Pt,Wg=Br,Qg=pn,Yg=Cl.promisify(jg.readFile);class Jg{constructor(e){this.transporter=new Hg.DefaultTransporter,this.options=e||{}}makeEndpoint(e){return r=>{const n=new Qg.Endpoint(r);return n.applySchema(n,e,e,n),n}}log(...e){this.options&&this.options.debug&&console.log(...e)}async discoverAllAPIs(e){const r=this.options.includePrivate?{}:{"X-User-Ip":"0.0.0.0"},s=(await this.transporter.request({url:e,headers:r})).data.items,u=await Promise.all(s.map(async y=>{const f=await this.discoverAPI(y.discoveryRestUrl);return{api:y,endpointCreator:f}})),c={},i={};for(const y of u)i[y.api.name]||(c[y.api.name]={},i[y.api.name]=f=>{const A=typeof f;let C;if(A==="string")C=f,f={};else if(A==="object")C=f.version,delete f.version;else throw new Error("Argument error: Accepts only string or object");try{const p=y.endpointCreator(f,this);return Object.freeze(p)}catch(p){throw new Error(Cl.format('Unable to load endpoint %s("%s"): %s',y.api.name,C,p.message))}}),c[y.api.name][y.api.version]=y.endpointCreator;return i}async discoverAPI(e){if(typeof e=="string"){const r=zg.parse(e);if(e&&!r.protocol){this.log("Reading from file "+e);const n=await Yg(e,{encoding:"utf8"});return this.makeEndpoint(JSON.parse(n))}else{this.log("Requesting "+e);const n=await this.transporter.request({url:e});return this.makeEndpoint(n.data)}}else{const r=e;this.log("Requesting "+r.url);const n=r.url;delete r.url;const s={options:{url:n,method:"GET"},requiredParams:[],pathParams:[],params:r,context:{google:{_options:{}},_options:{}}},u=await(0,Wg.createAPIRequest)(s);return this.makeEndpoint(u.data)}}}Ii.Discovery=Jg;(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Endpoint=t.Discovery=t.AuthPlus=t.createAPIRequest=t.getAPI=t.GaxiosError=t.Gaxios=t.AwsClient=t.IdentityPoolClient=t.BaseExternalAccountClient=t.ExternalAccountClient=t.GoogleAuth=t.DefaultTransporter=t.UserRefreshClient=t.Compute=t.JWT=t.OAuth2Client=void 0;var e=Yr;Object.defineProperty(t,"OAuth2Client",{enumerable:!0,get:function(){return e.OAuth2Client}}),Object.defineProperty(t,"JWT",{enumerable:!0,get:function(){return e.JWT}}),Object.defineProperty(t,"Compute",{enumerable:!0,get:function(){return e.Compute}}),Object.defineProperty(t,"UserRefreshClient",{enumerable:!0,get:function(){return e.UserRefreshClient}}),Object.defineProperty(t,"DefaultTransporter",{enumerable:!0,get:function(){return e.DefaultTransporter}}),Object.defineProperty(t,"GoogleAuth",{enumerable:!0,get:function(){return e.GoogleAuth}}),Object.defineProperty(t,"ExternalAccountClient",{enumerable:!0,get:function(){return e.ExternalAccountClient}}),Object.defineProperty(t,"BaseExternalAccountClient",{enumerable:!0,get:function(){return e.BaseExternalAccountClient}}),Object.defineProperty(t,"IdentityPoolClient",{enumerable:!0,get:function(){return e.IdentityPoolClient}}),Object.defineProperty(t,"AwsClient",{enumerable:!0,get:function(){return e.AwsClient}});var r=At;Object.defineProperty(t,"Gaxios",{enumerable:!0,get:function(){return r.Gaxios}}),Object.defineProperty(t,"GaxiosError",{enumerable:!0,get:function(){return r.GaxiosError}});var n=di;Object.defineProperty(t,"getAPI",{enumerable:!0,get:function(){return n.getAPI}});var s=Br;Object.defineProperty(t,"createAPIRequest",{enumerable:!0,get:function(){return s.createAPIRequest}});var u=wi;Object.defineProperty(t,"AuthPlus",{enumerable:!0,get:function(){return u.AuthPlus}});var c=Ii;Object.defineProperty(t,"Discovery",{enumerable:!0,get:function(){return c.Discovery}});var i=pn;Object.defineProperty(t,"Endpoint",{enumerable:!0,get:function(){return i.Endpoint}})})(kn);var Sl={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.calendar_v3=void 0;const e=kn;(function(r){class n{constructor(o,m){this.context={_options:o||{},google:m},this.acl=new s(this.context),this.calendarList=new u(this.context),this.calendars=new c(this.context),this.channels=new i(this.context),this.colors=new y(this.context),this.events=new f(this.context),this.freebusy=new A(this.context),this.settings=new C(this.context)}}r.Calendar=n;class s{constructor(o){this.context=o}delete(o,m,g){let S=o||{},a=m||{};typeof o=="function"&&(g=o,S={},a={}),typeof m=="function"&&(g=m,a={});const v=a.rootUrl||"https://www.googleapis.com/",E={options:Object.assign({url:(v+"/calendar/v3/calendars/{calendarId}/acl/{ruleId}").replace(/([^:]\/)\/+/g,"$1"),method:"DELETE"},a),params:S,requiredParams:["calendarId","ruleId"],pathParams:["calendarId","ruleId"],context:this.context};if(g)(0,e.createAPIRequest)(E,g);else return(0,e.createAPIRequest)(E)}get(o,m,g){let S=o||{},a=m||{};typeof o=="function"&&(g=o,S={},a={}),typeof m=="function"&&(g=m,a={});const v=a.rootUrl||"https://www.googleapis.com/",E={options:Object.assign({url:(v+"/calendar/v3/calendars/{calendarId}/acl/{ruleId}").replace(/([^:]\/)\/+/g,"$1"),method:"GET"},a),params:S,requiredParams:["calendarId","ruleId"],pathParams:["calendarId","ruleId"],context:this.context};if(g)(0,e.createAPIRequest)(E,g);else return(0,e.createAPIRequest)(E)}insert(o,m,g){let S=o||{},a=m||{};typeof o=="function"&&(g=o,S={},a={}),typeof m=="function"&&(g=m,a={});const v=a.rootUrl||"https://www.googleapis.com/",E={options:Object.assign({url:(v+"/calendar/v3/calendars/{calendarId}/acl").replace(/([^:]\/)\/+/g,"$1"),method:"POST"},a),params:S,requiredParams:["calendarId"],pathParams:["calendarId"],context:this.context};if(g)(0,e.createAPIRequest)(E,g);else return(0,e.createAPIRequest)(E)}list(o,m,g){let S=o||{},a=m||{};typeof o=="function"&&(g=o,S={},a={}),typeof m=="function"&&(g=m,a={});const v=a.rootUrl||"https://www.googleapis.com/",E={options:Object.assign({url:(v+"/calendar/v3/calendars/{calendarId}/acl").replace(/([^:]\/)\/+/g,"$1"),method:"GET"},a),params:S,requiredParams:["calendarId"],pathParams:["calendarId"],context:this.context};if(g)(0,e.createAPIRequest)(E,g);else return(0,e.createAPIRequest)(E)}patch(o,m,g){let S=o||{},a=m||{};typeof o=="function"&&(g=o,S={},a={}),typeof m=="function"&&(g=m,a={});const v=a.rootUrl||"https://www.googleapis.com/",E={options:Object.assign({url:(v+"/calendar/v3/calendars/{calendarId}/acl/{ruleId}").replace(/([^:]\/)\/+/g,"$1"),method:"PATCH"},a),params:S,requiredParams:["calendarId","ruleId"],pathParams:["calendarId","ruleId"],context:this.context};if(g)(0,e.createAPIRequest)(E,g);else return(0,e.createAPIRequest)(E)}update(o,m,g){let S=o||{},a=m||{};typeof o=="function"&&(g=o,S={},a={}),typeof m=="function"&&(g=m,a={});const v=a.rootUrl||"https://www.googleapis.com/",E={options:Object.assign({url:(v+"/calendar/v3/calendars/{calendarId}/acl/{ruleId}").replace(/([^:]\/)\/+/g,"$1"),method:"PUT"},a),params:S,requiredParams:["calendarId","ruleId"],pathParams:["calendarId","ruleId"],context:this.context};if(g)(0,e.createAPIRequest)(E,g);else return(0,e.createAPIRequest)(E)}watch(o,m,g){let S=o||{},a=m||{};typeof o=="function"&&(g=o,S={},a={}),typeof m=="function"&&(g=m,a={});const v=a.rootUrl||"https://www.googleapis.com/",E={options:Object.assign({url:(v+"/calendar/v3/calendars/{calendarId}/acl/watch").replace(/([^:]\/)\/+/g,"$1"),method:"POST"},a),params:S,requiredParams:["calendarId"],pathParams:["calendarId"],context:this.context};if(g)(0,e.createAPIRequest)(E,g);else return(0,e.createAPIRequest)(E)}}r.Resource$Acl=s;class u{constructor(o){this.context=o}delete(o,m,g){let S=o||{},a=m||{};typeof o=="function"&&(g=o,S={},a={}),typeof m=="function"&&(g=m,a={});const v=a.rootUrl||"https://www.googleapis.com/",E={options:Object.assign({url:(v+"/calendar/v3/users/me/calendarList/{calendarId}").replace(/([^:]\/)\/+/g,"$1"),method:"DELETE"},a),params:S,requiredParams:["calendarId"],pathParams:["calendarId"],context:this.context};if(g)(0,e.createAPIRequest)(E,g);else return(0,e.createAPIRequest)(E)}get(o,m,g){let S=o||{},a=m||{};typeof o=="function"&&(g=o,S={},a={}),typeof m=="function"&&(g=m,a={});const v=a.rootUrl||"https://www.googleapis.com/",E={options:Object.assign({url:(v+"/calendar/v3/users/me/calendarList/{calendarId}").replace(/([^:]\/)\/+/g,"$1"),method:"GET"},a),params:S,requiredParams:["calendarId"],pathParams:["calendarId"],context:this.context};if(g)(0,e.createAPIRequest)(E,g);else return(0,e.createAPIRequest)(E)}insert(o,m,g){let S=o||{},a=m||{};typeof o=="function"&&(g=o,S={},a={}),typeof m=="function"&&(g=m,a={});const v=a.rootUrl||"https://www.googleapis.com/",E={options:Object.assign({url:(v+"/calendar/v3/users/me/calendarList").replace(/([^:]\/)\/+/g,"$1"),method:"POST"},a),params:S,requiredParams:[],pathParams:[],context:this.context};if(g)(0,e.createAPIRequest)(E,g);else return(0,e.createAPIRequest)(E)}list(o,m,g){let S=o||{},a=m||{};typeof o=="function"&&(g=o,S={},a={}),typeof m=="function"&&(g=m,a={});const v=a.rootUrl||"https://www.googleapis.com/",E={options:Object.assign({url:(v+"/calendar/v3/users/me/calendarList").replace(/([^:]\/)\/+/g,"$1"),method:"GET"},a),params:S,requiredParams:[],pathParams:[],context:this.context};if(g)(0,e.createAPIRequest)(E,g);else return(0,e.createAPIRequest)(E)}patch(o,m,g){let S=o||{},a=m||{};typeof o=="function"&&(g=o,S={},a={}),typeof m=="function"&&(g=m,a={});const v=a.rootUrl||"https://www.googleapis.com/",E={options:Object.assign({url:(v+"/calendar/v3/users/me/calendarList/{calendarId}").replace(/([^:]\/)\/+/g,"$1"),method:"PATCH"},a),params:S,requiredParams:["calendarId"],pathParams:["calendarId"],context:this.context};if(g)(0,e.createAPIRequest)(E,g);else return(0,e.createAPIRequest)(E)}update(o,m,g){let S=o||{},a=m||{};typeof o=="function"&&(g=o,S={},a={}),typeof m=="function"&&(g=m,a={});const v=a.rootUrl||"https://www.googleapis.com/",E={options:Object.assign({url:(v+"/calendar/v3/users/me/calendarList/{calendarId}").replace(/([^:]\/)\/+/g,"$1"),method:"PUT"},a),params:S,requiredParams:["calendarId"],pathParams:["calendarId"],context:this.context};if(g)(0,e.createAPIRequest)(E,g);else return(0,e.createAPIRequest)(E)}watch(o,m,g){let S=o||{},a=m||{};typeof o=="function"&&(g=o,S={},a={}),typeof m=="function"&&(g=m,a={});const v=a.rootUrl||"https://www.googleapis.com/",E={options:Object.assign({url:(v+"/calendar/v3/users/me/calendarList/watch").replace(/([^:]\/)\/+/g,"$1"),method:"POST"},a),params:S,requiredParams:[],pathParams:[],context:this.context};if(g)(0,e.createAPIRequest)(E,g);else return(0,e.createAPIRequest)(E)}}r.Resource$Calendarlist=u;class c{constructor(o){this.context=o}clear(o,m,g){let S=o||{},a=m||{};typeof o=="function"&&(g=o,S={},a={}),typeof m=="function"&&(g=m,a={});const v=a.rootUrl||"https://www.googleapis.com/",E={options:Object.assign({url:(v+"/calendar/v3/calendars/{calendarId}/clear").replace(/([^:]\/)\/+/g,"$1"),method:"POST"},a),params:S,requiredParams:["calendarId"],pathParams:["calendarId"],context:this.context};if(g)(0,e.createAPIRequest)(E,g);else return(0,e.createAPIRequest)(E)}delete(o,m,g){let S=o||{},a=m||{};typeof o=="function"&&(g=o,S={},a={}),typeof m=="function"&&(g=m,a={});const v=a.rootUrl||"https://www.googleapis.com/",E={options:Object.assign({url:(v+"/calendar/v3/calendars/{calendarId}").replace(/([^:]\/)\/+/g,"$1"),method:"DELETE"},a),params:S,requiredParams:["calendarId"],pathParams:["calendarId"],context:this.context};if(g)(0,e.createAPIRequest)(E,g);else return(0,e.createAPIRequest)(E)}get(o,m,g){let S=o||{},a=m||{};typeof o=="function"&&(g=o,S={},a={}),typeof m=="function"&&(g=m,a={});const v=a.rootUrl||"https://www.googleapis.com/",E={options:Object.assign({url:(v+"/calendar/v3/calendars/{calendarId}").replace(/([^:]\/)\/+/g,"$1"),method:"GET"},a),params:S,requiredParams:["calendarId"],pathParams:["calendarId"],context:this.context};if(g)(0,e.createAPIRequest)(E,g);else return(0,e.createAPIRequest)(E)}insert(o,m,g){let S=o||{},a=m||{};typeof o=="function"&&(g=o,S={},a={}),typeof m=="function"&&(g=m,a={});const v=a.rootUrl||"https://www.googleapis.com/",E={options:Object.assign({url:(v+"/calendar/v3/calendars").replace(/([^:]\/)\/+/g,"$1"),method:"POST"},a),params:S,requiredParams:[],pathParams:[],context:this.context};if(g)(0,e.createAPIRequest)(E,g);else return(0,e.createAPIRequest)(E)}patch(o,m,g){let S=o||{},a=m||{};typeof o=="function"&&(g=o,S={},a={}),typeof m=="function"&&(g=m,a={});const v=a.rootUrl||"https://www.googleapis.com/",E={options:Object.assign({url:(v+"/calendar/v3/calendars/{calendarId}").replace(/([^:]\/)\/+/g,"$1"),method:"PATCH"},a),params:S,requiredParams:["calendarId"],pathParams:["calendarId"],context:this.context};if(g)(0,e.createAPIRequest)(E,g);else return(0,e.createAPIRequest)(E)}update(o,m,g){let S=o||{},a=m||{};typeof o=="function"&&(g=o,S={},a={}),typeof m=="function"&&(g=m,a={});const v=a.rootUrl||"https://www.googleapis.com/",E={options:Object.assign({url:(v+"/calendar/v3/calendars/{calendarId}").replace(/([^:]\/)\/+/g,"$1"),method:"PUT"},a),params:S,requiredParams:["calendarId"],pathParams:["calendarId"],context:this.context};if(g)(0,e.createAPIRequest)(E,g);else return(0,e.createAPIRequest)(E)}}r.Resource$Calendars=c;class i{constructor(o){this.context=o}stop(o,m,g){let S=o||{},a=m||{};typeof o=="function"&&(g=o,S={},a={}),typeof m=="function"&&(g=m,a={});const v=a.rootUrl||"https://www.googleapis.com/",E={options:Object.assign({url:(v+"/calendar/v3/channels/stop").replace(/([^:]\/)\/+/g,"$1"),method:"POST"},a),params:S,requiredParams:[],pathParams:[],context:this.context};if(g)(0,e.createAPIRequest)(E,g);else return(0,e.createAPIRequest)(E)}}r.Resource$Channels=i;class y{constructor(o){this.context=o}get(o,m,g){let S=o||{},a=m||{};typeof o=="function"&&(g=o,S={},a={}),typeof m=="function"&&(g=m,a={});const v=a.rootUrl||"https://www.googleapis.com/",E={options:Object.assign({url:(v+"/calendar/v3/colors").replace(/([^:]\/)\/+/g,"$1"),method:"GET"},a),params:S,requiredParams:[],pathParams:[],context:this.context};if(g)(0,e.createAPIRequest)(E,g);else return(0,e.createAPIRequest)(E)}}r.Resource$Colors=y;class f{constructor(o){this.context=o}delete(o,m,g){let S=o||{},a=m||{};typeof o=="function"&&(g=o,S={},a={}),typeof m=="function"&&(g=m,a={});const v=a.rootUrl||"https://www.googleapis.com/",E={options:Object.assign({url:(v+"/calendar/v3/calendars/{calendarId}/events/{eventId}").replace(/([^:]\/)\/+/g,"$1"),method:"DELETE"},a),params:S,requiredParams:["calendarId","eventId"],pathParams:["calendarId","eventId"],context:this.context};if(g)(0,e.createAPIRequest)(E,g);else return(0,e.createAPIRequest)(E)}get(o,m,g){let S=o||{},a=m||{};typeof o=="function"&&(g=o,S={},a={}),typeof m=="function"&&(g=m,a={});const v=a.rootUrl||"https://www.googleapis.com/",E={options:Object.assign({url:(v+"/calendar/v3/calendars/{calendarId}/events/{eventId}").replace(/([^:]\/)\/+/g,"$1"),method:"GET"},a),params:S,requiredParams:["calendarId","eventId"],pathParams:["calendarId","eventId"],context:this.context};if(g)(0,e.createAPIRequest)(E,g);else return(0,e.createAPIRequest)(E)}import(o,m,g){let S=o||{},a=m||{};typeof o=="function"&&(g=o,S={},a={}),typeof m=="function"&&(g=m,a={});const v=a.rootUrl||"https://www.googleapis.com/",E={options:Object.assign({url:(v+"/calendar/v3/calendars/{calendarId}/events/import").replace(/([^:]\/)\/+/g,"$1"),method:"POST"},a),params:S,requiredParams:["calendarId"],pathParams:["calendarId"],context:this.context};if(g)(0,e.createAPIRequest)(E,g);else return(0,e.createAPIRequest)(E)}insert(o,m,g){let S=o||{},a=m||{};typeof o=="function"&&(g=o,S={},a={}),typeof m=="function"&&(g=m,a={});const v=a.rootUrl||"https://www.googleapis.com/",E={options:Object.assign({url:(v+"/calendar/v3/calendars/{calendarId}/events").replace(/([^:]\/)\/+/g,"$1"),method:"POST"},a),params:S,requiredParams:["calendarId"],pathParams:["calendarId"],context:this.context};if(g)(0,e.createAPIRequest)(E,g);else return(0,e.createAPIRequest)(E)}instances(o,m,g){let S=o||{},a=m||{};typeof o=="function"&&(g=o,S={},a={}),typeof m=="function"&&(g=m,a={});const v=a.rootUrl||"https://www.googleapis.com/",E={options:Object.assign({url:(v+"/calendar/v3/calendars/{calendarId}/events/{eventId}/instances").replace(/([^:]\/)\/+/g,"$1"),method:"GET"},a),params:S,requiredParams:["calendarId","eventId"],pathParams:["calendarId","eventId"],context:this.context};if(g)(0,e.createAPIRequest)(E,g);else return(0,e.createAPIRequest)(E)}list(o,m,g){let S=o||{},a=m||{};typeof o=="function"&&(g=o,S={},a={}),typeof m=="function"&&(g=m,a={});const v=a.rootUrl||"https://www.googleapis.com/",E={options:Object.assign({url:(v+"/calendar/v3/calendars/{calendarId}/events").replace(/([^:]\/)\/+/g,"$1"),method:"GET"},a),params:S,requiredParams:["calendarId"],pathParams:["calendarId"],context:this.context};if(g)(0,e.createAPIRequest)(E,g);else return(0,e.createAPIRequest)(E)}move(o,m,g){let S=o||{},a=m||{};typeof o=="function"&&(g=o,S={},a={}),typeof m=="function"&&(g=m,a={});const v=a.rootUrl||"https://www.googleapis.com/",E={options:Object.assign({url:(v+"/calendar/v3/calendars/{calendarId}/events/{eventId}/move").replace(/([^:]\/)\/+/g,"$1"),method:"POST"},a),params:S,requiredParams:["calendarId","eventId","destination"],pathParams:["calendarId","eventId"],context:this.context};if(g)(0,e.createAPIRequest)(E,g);else return(0,e.createAPIRequest)(E)}patch(o,m,g){let S=o||{},a=m||{};typeof o=="function"&&(g=o,S={},a={}),typeof m=="function"&&(g=m,a={});const v=a.rootUrl||"https://www.googleapis.com/",E={options:Object.assign({url:(v+"/calendar/v3/calendars/{calendarId}/events/{eventId}").replace(/([^:]\/)\/+/g,"$1"),method:"PATCH"},a),params:S,requiredParams:["calendarId","eventId"],pathParams:["calendarId","eventId"],context:this.context};if(g)(0,e.createAPIRequest)(E,g);else return(0,e.createAPIRequest)(E)}quickAdd(o,m,g){let S=o||{},a=m||{};typeof o=="function"&&(g=o,S={},a={}),typeof m=="function"&&(g=m,a={});const v=a.rootUrl||"https://www.googleapis.com/",E={options:Object.assign({url:(v+"/calendar/v3/calendars/{calendarId}/events/quickAdd").replace(/([^:]\/)\/+/g,"$1"),method:"POST"},a),params:S,requiredParams:["calendarId","text"],pathParams:["calendarId"],context:this.context};if(g)(0,e.createAPIRequest)(E,g);else return(0,e.createAPIRequest)(E)}update(o,m,g){let S=o||{},a=m||{};typeof o=="function"&&(g=o,S={},a={}),typeof m=="function"&&(g=m,a={});const v=a.rootUrl||"https://www.googleapis.com/",E={options:Object.assign({url:(v+"/calendar/v3/calendars/{calendarId}/events/{eventId}").replace(/([^:]\/)\/+/g,"$1"),method:"PUT"},a),params:S,requiredParams:["calendarId","eventId"],pathParams:["calendarId","eventId"],context:this.context};if(g)(0,e.createAPIRequest)(E,g);else return(0,e.createAPIRequest)(E)}watch(o,m,g){let S=o||{},a=m||{};typeof o=="function"&&(g=o,S={},a={}),typeof m=="function"&&(g=m,a={});const v=a.rootUrl||"https://www.googleapis.com/",E={options:Object.assign({url:(v+"/calendar/v3/calendars/{calendarId}/events/watch").replace(/([^:]\/)\/+/g,"$1"),method:"POST"},a),params:S,requiredParams:["calendarId"],pathParams:["calendarId"],context:this.context};if(g)(0,e.createAPIRequest)(E,g);else return(0,e.createAPIRequest)(E)}}r.Resource$Events=f;class A{constructor(o){this.context=o}query(o,m,g){let S=o||{},a=m||{};typeof o=="function"&&(g=o,S={},a={}),typeof m=="function"&&(g=m,a={});const v=a.rootUrl||"https://www.googleapis.com/",E={options:Object.assign({url:(v+"/calendar/v3/freeBusy").replace(/([^:]\/)\/+/g,"$1"),method:"POST"},a),params:S,requiredParams:[],pathParams:[],context:this.context};if(g)(0,e.createAPIRequest)(E,g);else return(0,e.createAPIRequest)(E)}}r.Resource$Freebusy=A;class C{constructor(o){this.context=o}get(o,m,g){let S=o||{},a=m||{};typeof o=="function"&&(g=o,S={},a={}),typeof m=="function"&&(g=m,a={});const v=a.rootUrl||"https://www.googleapis.com/",E={options:Object.assign({url:(v+"/calendar/v3/users/me/settings/{setting}").replace(/([^:]\/)\/+/g,"$1"),method:"GET"},a),params:S,requiredParams:["setting"],pathParams:["setting"],context:this.context};if(g)(0,e.createAPIRequest)(E,g);else return(0,e.createAPIRequest)(E)}list(o,m,g){let S=o||{},a=m||{};typeof o=="function"&&(g=o,S={},a={}),typeof m=="function"&&(g=m,a={});const v=a.rootUrl||"https://www.googleapis.com/",E={options:Object.assign({url:(v+"/calendar/v3/users/me/settings").replace(/([^:]\/)\/+/g,"$1"),method:"GET"},a),params:S,requiredParams:[],pathParams:[],context:this.context};if(g)(0,e.createAPIRequest)(E,g);else return(0,e.createAPIRequest)(E)}watch(o,m,g){let S=o||{},a=m||{};typeof o=="function"&&(g=o,S={},a={}),typeof m=="function"&&(g=m,a={});const v=a.rootUrl||"https://www.googleapis.com/",E={options:Object.assign({url:(v+"/calendar/v3/users/me/settings/watch").replace(/([^:]\/)\/+/g,"$1"),method:"POST"},a),params:S,requiredParams:[],pathParams:[],context:this.context};if(g)(0,e.createAPIRequest)(E,g);else return(0,e.createAPIRequest)(E)}}r.Resource$Settings=C})(t.calendar_v3||(t.calendar_v3={}))})(Sl);(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.AuthPlus=t.calendar_v3=t.auth=t.calendar=t.VERSIONS=void 0;/*! THIS FILE IS AUTO-GENERATED */const e=kn,r=Sl;Object.defineProperty(t,"calendar_v3",{enumerable:!0,get:function(){return r.calendar_v3}}),t.VERSIONS={v3:r.calendar_v3.Calendar};function n(c){return(0,e.getAPI)("calendar",c,t.VERSIONS,this)}t.calendar=n;const s=new e.AuthPlus;t.auth=s;var u=kn;Object.defineProperty(t,"AuthPlus",{enumerable:!0,get:function(){return u.AuthPlus}})})(qu);const za="tokens",qr="connected_calendars",ku="upsert-item-from-event",Pn="channels",Xg=jl("google-calendar",t=>{const e=async()=>{const n=await t.store.getPluginItem(za);if(!n)throw new Error("NOT_AUTHENTICATED: You are not authenticated and will need to connect your Google account first.");const s=n.value;if(t.dayjs().isAfter(s.expires_at)){const u=await fetch("https://google-calendar.vercel.com/api/auth/refresh?refresh_token="+s.refresh_token);if(!u.ok)throw new Error("COULD_NOT_REFRESH_TOKEN: Could not refresh token.");const c=await u.json(),i={...c,expires_at:t.dayjs().add((c.expires_in??10)-10,"seconds").toISOString()};return await t.store.setSecretItem(za,i),i}return s},r=async()=>{const n=await e();return qu.calendar({version:"v3",auth:n.access_token})};return{onRequest:async(n,s)=>{if(n.path==="/auth")return s.redirect("https://google-calendar.vercel.com/api/auth");if(n.path==="/auth/callback"&&n.method==="POST"){const u={...n.body,expires_at:t.dayjs().add((n.body.expires_in??10)-10,"seconds").toISOString()};return delete u.expires_in,await t.store.setSecretItem(za,u),s.status(200).send()}},operations:{calendars:async()=>{var i;const s=await(await r()).calendarList.list(),u=await t.store.getPluginItem(qr),c=new Set((u==null?void 0:u.value)??[]);return{data:((i=s.data.items)==null?void 0:i.map(y=>({...y,connected:c.has(y.id??"")})))??[]}},connectCalendars:async n=>{var C;const s=await r(),u=await t.store.getPluginItem(qr),c=new Set((u==null?void 0:u.value)??[]),i=await t.store.getPluginItem(Pn),y=i==null?void 0:i.value,f=[];for(const p of n.calendarIds){if(c.has(p))continue;c.add(p);const o=await s.calendarList.get({calendarId:p}),m=await s.events.list({calendarId:p,timeMin:t.dayjs().toISOString(),timeMax:t.dayjs().add(7,"day").toISOString(),singleEvents:!0,orderBy:"startTime"});for(const S of m.data.items??[])await t.pgBoss.send(ku,{...S,calendarColor:o.data.backgroundColor??null});const g=await s.events.watch({calendarId:p,requestBody:{id:"flow-calendar-events-webhook",type:"web_hook",address:t.serverOrigin+`${t.serverOrigin}/api/plugin/${t.pluginSlug}/events/webhook`}});f.push({calendarId:p,id:g.data.id??"flow-calendar-events-webhook",resourceId:g.data.resourceId})}return await t.store.setItem(Pn,[...y,...f]),await t.store.setItem(qr,Array.from(c)),{operationName:"calendars",data:((C=(await s.calendarList.list()).data.items)==null?void 0:C.map(p=>({...p,connected:c.has(p.id??"")})))??[]}},disconnectCalendars:async n=>{var C;const s=await r(),u=await t.store.getPluginItem(qr),c=new Set((u==null?void 0:u.value)??[]),i=await t.store.getPluginItem(Pn),y=i==null?void 0:i.value,f=[];for(const p of n.calendarIds){if(!c.has(p))continue;c.delete(p);const o=y.find(m=>m.calendarId===p);o&&(await s.channels.stop({requestBody:{id:o.id,resourceId:o.resourceId}}),f.push(o))}return await t.store.setItem(Pn,y.filter(p=>!f.includes(p))),await t.store.setItem(qr,Array.from(c)),{operationName:"calendars",data:((C=(await s.calendarList.list()).data.items)==null?void 0:C.map(p=>({...p,connected:c.has(p.id??"")})))??[]}}},pgBossWorkHandlers:{[ku]:{fn:async n=>{var f,A,C,p,o,m,g;const s=n.data,u=await t.prisma.item.findFirst({where:{pluginDatas:{some:{originalId:s.id,pluginSlug:t.pluginSlug}}},include:{pluginDatas:{where:{originalId:s.id,pluginSlug:t.pluginSlug},select:{id:!0}}}}),c={title:s.summary??"No title",color:s.calendarColor?t.getNearestItemColor(s.calendarColor):null,isAllDay:!!((f=s.start)!=null&&f.date),scheduledAt:((A=s.start)==null?void 0:A.dateTime)??null,durationInMinutes:t.dayjs((C=s.end)==null?void 0:C.dateTime).diff((p=s.start)==null?void 0:p.dateTime,"minute"),isRelevant:!0},i={htmlLink:s.htmlLink,numOfAttendees:((o=s.attendees)==null?void 0:o.length)??0},y={...i,description:s.description??null,attendees:((m=s.attendees)==null?void 0:m.map(S=>({...S})))??[],eventType:s.eventType??null,organizer:s.organizer??null,hangoutLink:s.hangoutLink,conferenceData:JSON.parse(JSON.stringify(s.conferenceData))??null};u?await t.prisma.item.update({where:{id:u.id},data:{...c,pluginDatas:{update:{where:{id:(g=u.pluginDatas[0])==null?void 0:g.id},data:{min:i,full:y}}}}}):await t.prisma.item.create({data:{...c,pluginDatas:{create:{pluginSlug:t.pluginSlug,originalId:s.id,min:i,full:y}}}})}}}}});module.exports=Xg;
